

============================== 2021-12-25 23:29:04.077476 | 5bf92a3a-8c17-49e8-83f0-d26c5fc3843a ==============================
23:29:04.077476 [info ] [MainThread]: Running with dbt=1.0.0
23:29:04.078303 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:29:04.079453 [debug] [MainThread]: Tracking: tracking
23:29:04.152679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11fea4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11fea4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11fea4ed0>]}
23:29:04.292917 [debug] [MainThread]: Executing "git --help"
23:29:04.339739 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:29:04.341124 [debug] [MainThread]: STDERR: "b''"
23:29:04.342326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11fead7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11feb3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11feb3390>]}


============================== 2021-12-25 23:30:22.184329 | b5f07334-f569-4a01-a08f-7396b81c723b ==============================
23:30:22.184329 [info ] [MainThread]: Running with dbt=1.0.0
23:30:22.185251 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:30:22.185895 [debug] [MainThread]: Tracking: tracking
23:30:22.206177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bee62a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bbb552d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bee625d0>]}
23:30:22.318367 [debug] [MainThread]: Executing "git --help"
23:30:22.348390 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:30:22.349836 [debug] [MainThread]: STDERR: "b''"
23:30:22.350935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bee7d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bef70950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2bef70a10>]}


============================== 2021-12-25 23:31:34.565601 | 6649e61f-0cc6-498f-b2ab-1ec39c663575 ==============================
23:31:34.565601 [info ] [MainThread]: Running with dbt=1.0.0
23:31:34.566601 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:31:34.567278 [debug] [MainThread]: Tracking: tracking
23:31:34.590842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba74f57c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba74f523d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba74f52a90>]}
23:31:34.713348 [debug] [MainThread]: Executing "git --help"
23:31:34.764490 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:31:34.765608 [debug] [MainThread]: STDERR: "b''"
23:31:34.766615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba74f7d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba74f8f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba74f73490>]}


============================== 2021-12-25 23:34:10.257480 | 8ed785b2-2dec-4b1b-ba6b-e072253f68cc ==============================
23:34:10.257480 [info ] [MainThread]: Running with dbt=1.0.0
23:34:10.258333 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:34:10.258674 [debug] [MainThread]: Tracking: tracking
23:34:10.275873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0e76bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0e76b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0e76e90>]}
23:34:10.387932 [debug] [MainThread]: Executing "git --help"
23:34:10.434246 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:34:10.435329 [debug] [MainThread]: STDERR: "b''"
23:34:10.437451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0f88910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0e85e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede0e85290>]}


============================== 2021-12-25 23:35:50.555217 | 9a0cadf9-d01d-413f-9644-8469547faa2f ==============================
23:35:50.555217 [info ] [MainThread]: Running with dbt=1.0.0
23:35:50.556186 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:35:50.556532 [debug] [MainThread]: Tracking: tracking
23:35:50.571187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1bb690e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1bb697d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1bb6a45d0>]}
23:35:50.687426 [debug] [MainThread]: Executing "git --help"
23:35:50.717932 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:35:50.718977 [debug] [MainThread]: STDERR: "b''"
23:35:50.719925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1bb6b3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1bb6b3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1bb6b3150>]}


============================== 2021-12-25 23:36:04.275466 | ecba8f8f-2d90-4247-a2f1-9f372147deb3 ==============================
23:36:04.275466 [info ] [MainThread]: Running with dbt=1.0.0
23:36:04.276309 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:36:04.276692 [debug] [MainThread]: Tracking: tracking
23:36:04.293033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75dea3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75dea3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75dea3d90>]}
23:36:04.425994 [debug] [MainThread]: Executing "git --help"
23:36:04.457511 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:36:04.458651 [debug] [MainThread]: STDERR: "b''"
23:36:04.459810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75df9e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75deb1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75deb1a50>]}


============================== 2021-12-25 23:38:18.695171 | e64e6ccf-d5b9-41d3-88b7-9f8066a02d4a ==============================
23:38:18.695171 [info ] [MainThread]: Running with dbt=1.0.0
23:38:18.696091 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:38:18.696505 [debug] [MainThread]: Tracking: tracking
23:38:18.717621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07efa2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07efa2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07efa2d90>]}
23:38:18.854529 [debug] [MainThread]: Executing "git --help"
23:38:18.884230 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:38:18.885777 [debug] [MainThread]: STDERR: "b''"
23:38:18.889892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07efef410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07efb3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd07efb3d50>]}


============================== 2021-12-25 23:38:49.772821 | b2f2863a-d1b9-4d22-99ed-1716d830a1c6 ==============================
23:38:49.772821 [info ] [MainThread]: Running with dbt=1.0.0
23:38:49.773694 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:38:49.774442 [debug] [MainThread]: Tracking: tracking
23:38:49.792931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e9f8ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e9fa4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e9fa4510>]}
23:38:49.918963 [debug] [MainThread]: Executing "git --help"
23:38:49.952968 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:38:49.953918 [debug] [MainThread]: STDERR: "b''"
23:38:49.955040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e9fb3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e9fb3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e9fb3610>]}


============================== 2021-12-25 23:39:03.806075 | 3ed31b44-42e5-415b-ac40-fdaf83b2d3c6 ==============================
23:39:03.806075 [info ] [MainThread]: Running with dbt=1.0.0
23:39:03.806935 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:39:03.807313 [debug] [MainThread]: Tracking: tracking
23:39:03.823445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5c7e4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5c7e4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5c7e4510>]}
23:39:03.939999 [debug] [MainThread]: Executing "git --help"
23:39:03.971368 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:39:03.972284 [debug] [MainThread]: STDERR: "b''"
23:39:03.973229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f58a80c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5c80f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5c7f3310>]}


============================== 2021-12-25 23:39:16.333807 | 6eb0f15a-5f4d-49f2-baad-0d031073f014 ==============================
23:39:16.333807 [info ] [MainThread]: Running with dbt=1.0.0
23:39:16.334475 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:39:16.334838 [debug] [MainThread]: Tracking: tracking
23:39:16.349720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5df664b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5df6645d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5df664c10>]}
23:39:16.455687 [debug] [MainThread]: Executing "git --help"
23:39:16.480623 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:39:16.483032 [debug] [MainThread]: STDERR: "b''"
23:39:16.484655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5df6af4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5df673150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5df6735d0>]}


============================== 2021-12-25 23:39:48.921519 | 2d6d1442-dcdb-423a-bc22-7a2d79ecd2ae ==============================
23:39:48.921519 [info ] [MainThread]: Running with dbt=1.0.0
23:39:48.922383 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:39:48.923068 [debug] [MainThread]: Tracking: tracking
23:39:48.941149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eaea2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eaea2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eaea2250>]}
23:39:49.069066 [debug] [MainThread]: Executing "git --help"
23:39:49.110943 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:39:49.112318 [debug] [MainThread]: STDERR: "b''"
23:39:49.113508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eaea2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eaec7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eaeb0190>]}


============================== 2021-12-25 23:42:03.812950 | e0328cdd-c48d-451d-a091-b76e7506ecef ==============================
23:42:03.812950 [info ] [MainThread]: Running with dbt=1.0.0
23:42:03.814477 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:42:03.815590 [debug] [MainThread]: Tracking: tracking
23:42:03.836927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c8e74d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c8e74210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c8e74e10>]}
23:42:03.995404 [debug] [MainThread]: Executing "git --help"
23:42:04.026906 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:42:04.029251 [debug] [MainThread]: STDERR: "b''"
23:42:04.030456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c8e74a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c8ea1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c8e83ad0>]}


============================== 2021-12-25 23:42:14.460942 | a8193bde-5044-4aa4-af2a-ad812d7fccba ==============================
23:42:14.460942 [info ] [MainThread]: Running with dbt=1.0.0
23:42:14.461650 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:42:14.462064 [debug] [MainThread]: Tracking: tracking
23:42:14.477141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c66a3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c66a3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c66a3c90>]}
23:42:14.593595 [debug] [MainThread]: Executing "git --help"
23:42:14.624484 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:42:14.625683 [debug] [MainThread]: STDERR: "b''"
23:42:14.626565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c634d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c66bd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c6718a90>]}


============================== 2021-12-25 23:42:26.861702 | 6b6275c3-ee07-46a4-b91b-41e82fa50ab8 ==============================
23:42:26.861702 [info ] [MainThread]: Running with dbt=1.0.0
23:42:26.862421 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:42:26.862801 [debug] [MainThread]: Tracking: tracking
23:42:26.882281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16d6a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16d6a5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16d6a5ed0>]}
23:42:26.998425 [debug] [MainThread]: Executing "git --help"
23:42:27.028573 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:42:27.030199 [debug] [MainThread]: STDERR: "b''"
23:42:27.031202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16d6ace90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16d6b3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16d6b3310>]}


============================== 2021-12-25 23:43:12.824538 | a7e4926e-2eeb-41db-b995-2d4468b6ba1d ==============================
23:43:12.824538 [info ] [MainThread]: Running with dbt=1.0.0
23:43:12.825479 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:43:12.825890 [debug] [MainThread]: Tracking: tracking
23:43:12.859022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce69e79b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce69e79050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce69e89590>]}
23:43:12.980402 [debug] [MainThread]: Executing "git --help"
23:43:13.016750 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:43:13.017659 [debug] [MainThread]: STDERR: "b''"
23:43:13.018600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6a802050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce69e98250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce69e98d10>]}


============================== 2021-12-25 23:44:04.500477 | 5e92c0cd-b7d5-42b9-a19f-5331cdbb0eba ==============================
23:44:04.500477 [info ] [MainThread]: Running with dbt=1.0.0
23:44:04.501353 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:44:04.501740 [debug] [MainThread]: Tracking: tracking
23:44:04.530616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c57e2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c57e2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c57e2d10>]}
23:44:04.648513 [debug] [MainThread]: Executing "git --help"
23:44:04.685377 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:44:04.687545 [debug] [MainThread]: STDERR: "b''"
23:44:04.688816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c57ec990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c57f1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91c57f1150>]}


============================== 2021-12-25 23:49:45.350842 | 91aee15e-6f8a-4a5c-9122-4ede776189d8 ==============================
23:49:45.350842 [info ] [MainThread]: Running with dbt=1.0.0
23:49:45.351770 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:49:45.352165 [debug] [MainThread]: Tracking: tracking
23:49:45.371632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ef62d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ef62dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ef62e10>]}
23:49:45.484606 [debug] [MainThread]: Executing "git --help"
23:49:45.516419 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:49:45.517284 [debug] [MainThread]: STDERR: "b''"
23:49:45.518273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38efad1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ef6ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb38ef70190>]}


============================== 2021-12-25 23:53:08.507458 | cae5c206-f66e-44de-8644-720132c06b9e ==============================
23:53:08.507458 [info ] [MainThread]: Running with dbt=1.0.0
23:53:08.508356 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:53:08.508684 [debug] [MainThread]: Tracking: tracking
23:53:08.528114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525eadb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525eb2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525e7fd10>]}
23:53:08.672395 [debug] [MainThread]: Executing "git --help"
23:53:08.716519 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:53:08.717662 [debug] [MainThread]: STDERR: "b''"
23:53:08.732024 [debug] [MainThread]: Acquiring new postgres connection "debug"
23:53:08.734396 [debug] [MainThread]: Using postgres connection "debug"
23:53:08.735239 [debug] [MainThread]: On debug: select 1 as id
23:53:08.735923 [debug] [MainThread]: Opening a new connection, currently in state init
23:53:08.812836 [debug] [MainThread]: Postgres adapter: Got an error when attempting to open a postgres connection: 'could not translate host name "dbtpostgres" to address: nodename nor servname provided, or not known
'
23:53:08.825728 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
23:53:08.826310 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
23:53:08.828531 [debug] [MainThread]: On debug: No close available on handle
23:53:08.831306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525ea8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525ea8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9525ea8b10>]}
23:53:09.340603 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-25 23:54:20.730715 | 17d75c4c-7b4f-4e95-8a44-6bb56081ab70 ==============================
23:54:20.730715 [info ] [MainThread]: Running with dbt=1.0.0
23:54:20.731678 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
23:54:20.736371 [debug] [MainThread]: Tracking: tracking
23:54:20.754739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f16be550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f16bea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f1698d50>]}
23:54:20.879022 [debug] [MainThread]: Executing "git --help"
23:54:20.919259 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
23:54:20.920176 [debug] [MainThread]: STDERR: "b''"
23:54:20.929887 [debug] [MainThread]: Acquiring new postgres connection "debug"
23:54:20.931775 [debug] [MainThread]: Using postgres connection "debug"
23:54:20.932146 [debug] [MainThread]: On debug: select 1 as id
23:54:20.932506 [debug] [MainThread]: Opening a new connection, currently in state init
23:54:21.042242 [debug] [MainThread]: SQL status: SELECT 1 in 0.11 seconds
23:54:21.047497 [debug] [MainThread]: On debug: Close
23:54:21.048784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f0b5fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f17a6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6f0b619d0>]}
23:54:21.450798 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-25 23:54:47.256400 | 51aeedbd-2455-41c9-8111-6f34b6b866f9 ==============================
23:54:47.256400 [info ] [MainThread]: Running with dbt=1.0.0
23:54:47.257622 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
23:54:47.258333 [debug] [MainThread]: Tracking: tracking
23:54:47.272423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4cfd97d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4cfd9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4cfd94d0>]}
23:54:47.305175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4ce8fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4ce972d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc4ce978d0>]}


============================== 2021-12-25 23:57:13.152474 | fae28bc9-791e-4495-b44b-70f62920b8b7 ==============================
23:57:13.152474 [info ] [MainThread]: Running with dbt=1.0.0
23:57:13.153713 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='clean', write_json=None)
23:57:13.154059 [debug] [MainThread]: Tracking: tracking
23:57:13.175497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f6fa3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f6ff9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f6fa3850>]}
23:57:13.186485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f6fac690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f6facd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f6fac710>]}


============================== 2021-12-25 23:57:24.351813 | 49e2afa0-a003-46d4-80f2-2c4680c933ea ==============================
23:57:24.351813 [info ] [MainThread]: Running with dbt=1.0.0
23:57:24.353149 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
23:57:24.354321 [debug] [MainThread]: Tracking: tracking
23:57:24.391437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83427dafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83427da890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83427da250>]}
23:57:24.411325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8342681310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83426c3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83426c3290>]}


============================== 2021-12-26 00:02:08.999695 | bfa993dc-a206-4240-a040-969b78868c38 ==============================
00:02:08.999695 [info ] [MainThread]: Running with dbt=1.0.0
00:02:09.001540 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:02:09.002309 [debug] [MainThread]: Tracking: tracking
00:02:09.046992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f07c93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f07c9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f07c9a50>]}
00:02:09.067575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f06b3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f06b3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3f0687e50>]}


============================== 2021-12-26 00:03:04.639676 | 27c1f912-8daf-4980-ad2e-bc31a22d0e8d ==============================
00:03:04.639676 [info ] [MainThread]: Running with dbt=1.0.0
00:03:04.641560 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:03:04.642039 [debug] [MainThread]: Tracking: tracking
00:03:04.668631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb223119990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb223119c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb223119b90>]}
00:03:04.706378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb223119f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb221040a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22312f950>]}


============================== 2021-12-26 00:06:21.754178 | adc7d429-261b-4684-8acf-d55298e9ff1e ==============================
00:06:21.754178 [info ] [MainThread]: Running with dbt=1.0.0
00:06:21.755278 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
00:06:21.755663 [debug] [MainThread]: Tracking: tracking
00:06:21.774134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9190e87d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9190e7ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9190e877d0>]}
00:06:21.895312 [debug] [MainThread]: Executing "git --help"
00:06:21.941957 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
00:06:21.942874 [debug] [MainThread]: STDERR: "b''"
00:06:21.949468 [debug] [MainThread]: Acquiring new postgres connection "debug"
00:06:21.951411 [debug] [MainThread]: Using postgres connection "debug"
00:06:21.951756 [debug] [MainThread]: On debug: select 1 as id
00:06:21.952275 [debug] [MainThread]: Opening a new connection, currently in state init
00:06:22.024373 [debug] [MainThread]: SQL status: SELECT 1 in 0.07 seconds
00:06:22.029408 [debug] [MainThread]: On debug: Close
00:06:22.030490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9190fa47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9190ea8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9190ea89d0>]}
00:06:22.519358 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-26 00:06:50.931962 | 06c02b61-4027-4f32-bc2c-7714e74c94ea ==============================
00:06:50.931962 [info ] [MainThread]: Running with dbt=1.0.0
00:06:50.933696 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:06:50.934447 [debug] [MainThread]: Tracking: tracking
00:06:50.959662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac77036210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac77036450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac770366d0>]}
00:06:50.982018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7711bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7711b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac76fd7990>]}


============================== 2021-12-26 00:09:22.177083 | 36859e20-7557-45ad-89d3-7609bd139591 ==============================
00:09:22.177083 [info ] [MainThread]: Running with dbt=1.0.0
00:09:22.179251 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:09:22.180071 [debug] [MainThread]: Tracking: tracking
00:09:22.215990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69fd9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf68e4f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69fd9b10>]}
00:09:22.241321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69e25910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69e97490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69e97ad0>]}


============================== 2021-12-26 00:09:36.427675 | 56fd22ad-2b45-4052-bfe4-257ebc895aed ==============================
00:09:36.427675 [info ] [MainThread]: Running with dbt=1.0.0
00:09:36.429020 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:09:36.430001 [debug] [MainThread]: Tracking: tracking
00:09:36.462539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd38d9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd38d9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd38d9d50>]}
00:09:36.488661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd37c2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd378ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fd38d9d90>]}


============================== 2021-12-26 00:13:20.876350 | 6f52e764-2cd7-44c1-9613-4beae8cdff1d ==============================
00:13:20.876350 [info ] [MainThread]: Running with dbt=1.0.0
00:13:20.878358 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:13:20.879404 [debug] [MainThread]: Tracking: tracking
00:13:20.914050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0f8e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0ebe5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0f8ecd0>]}
00:13:20.941305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0e77290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0e77350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c0f8e710>]}


============================== 2021-12-26 00:16:24.232514 | 84d9b0a9-6fea-4304-8c86-e8b927c389a3 ==============================
00:16:24.232514 [info ] [MainThread]: Running with dbt=1.0.0
00:16:24.234364 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:16:24.235474 [debug] [MainThread]: Tracking: tracking
00:16:24.264282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce420d9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce420d9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce420d9f10>]}
00:16:24.287919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4178ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce41797c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce41797450>]}


============================== 2021-12-26 00:18:36.892343 | 8255a095-3d6b-4968-aeab-cca5906359f3 ==============================
00:18:36.892343 [info ] [MainThread]: Running with dbt=1.0.0
00:18:36.894301 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:18:36.894963 [debug] [MainThread]: Tracking: tracking
00:18:36.931036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8187b3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8187b3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8187b3910>]}
00:18:36.957696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818797f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd818785bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8187bd050>]}


============================== 2021-12-26 00:20:11.348777 | 8c8e745e-0f5f-40cb-b46e-0460e77aad9c ==============================
00:20:11.348777 [info ] [MainThread]: Running with dbt=1.0.0
00:20:11.350393 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:20:11.351291 [debug] [MainThread]: Tracking: tracking
00:20:11.373503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9450d95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9450d94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9450d9950>]}
00:20:11.397393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd943637c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd944fc2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd944fc25d0>]}


============================== 2021-12-26 00:22:50.590533 | 2a74c690-bc57-48f7-a86b-f29583a76530 ==============================
00:22:50.590533 [info ] [MainThread]: Running with dbt=1.0.0
00:22:50.592203 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:22:50.592641 [debug] [MainThread]: Tracking: tracking
00:22:50.617257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac417c9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac417c9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac417c9e10>]}
00:22:50.652489 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:22:50.653118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a74c690-bc57-48f7-a86b-f29583a76530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac41687e50>]}
00:22:50.717594 [debug] [MainThread]: Parsing macros/catalog.sql
00:22:50.726364 [debug] [MainThread]: Parsing macros/relations.sql
00:22:50.728892 [debug] [MainThread]: Parsing macros/adapters.sql
00:22:50.762195 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:22:50.764671 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:22:50.770665 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:22:50.774177 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:22:50.776563 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:22:50.801328 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:22:50.817277 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:22:50.835382 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:22:50.842036 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:22:50.844830 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:22:50.847603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:22:50.854218 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:22:50.870352 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:22:50.872563 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:22:50.887877 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:22:50.912639 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:22:50.923422 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:22:50.927692 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:22:50.937835 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:22:50.939767 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:22:50.943692 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:22:50.947226 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:22:50.956026 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:22:50.979601 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:22:50.981819 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:22:50.985287 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:22:50.987507 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:22:50.988781 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:22:50.989590 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:22:50.990594 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:22:50.992721 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:22:50.998946 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:22:51.010929 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:22:51.014061 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:22:51.017978 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:22:51.038219 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:22:51.042641 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:22:51.049529 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:22:51.061437 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:22:51.076349 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:22:51.336083 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
00:22:51.351658 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
00:22:51.411704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:22:51.418423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a74c690-bc57-48f7-a86b-f29583a76530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac41a411d0>]}
00:22:51.425307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a74c690-bc57-48f7-a86b-f29583a76530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac419e42d0>]}
00:22:51.425752 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:22:51.427281 [info ] [MainThread]: 
00:22:51.428049 [debug] [MainThread]: Acquiring new postgres connection "master"
00:22:51.429571 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:22:51.451642 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:22:51.452587 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:22:51.453349 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:22:51.527946 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
00:22:51.530125 [debug] [ThreadPool]: On list_dbt: Close
00:22:51.531481 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
00:22:51.532590 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
00:22:51.533271 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev', identifier=None)"
00:22:51.547812 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
00:22:51.548146 [debug] [ThreadPool]: On create_dbt_dev: BEGIN
00:22:51.548385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:22:51.565428 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:22:51.565828 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
00:22:51.566161 [debug] [ThreadPool]: On create_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "create_dbt_dev"} */
create schema if not exists "dev"
00:22:51.572525 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.01 seconds
00:22:51.574758 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
00:22:51.575116 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
00:22:51.575376 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
00:22:51.580819 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
00:22:51.581221 [debug] [ThreadPool]: On create_dbt_dev: Close
00:22:51.583014 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:22:51.592478 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:22:51.592830 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:22:51.593098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:22:51.609395 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:22:51.609771 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:22:51.610034 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:22:51.616828 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
00:22:51.618503 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:22:51.620853 [debug] [ThreadPool]: On list_dbt_dev: Close
00:22:51.627212 [debug] [MainThread]: Using postgres connection "master"
00:22:51.627656 [debug] [MainThread]: On master: BEGIN
00:22:51.627973 [debug] [MainThread]: Opening a new connection, currently in state init
00:22:51.644712 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:22:51.645242 [debug] [MainThread]: Using postgres connection "master"
00:22:51.645573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:22:51.653833 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:22:51.655508 [debug] [MainThread]: On master: ROLLBACK
00:22:51.657765 [debug] [MainThread]: Using postgres connection "master"
00:22:51.658127 [debug] [MainThread]: On master: BEGIN
00:22:51.662644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:22:51.663188 [debug] [MainThread]: On master: COMMIT
00:22:51.663685 [debug] [MainThread]: Using postgres connection "master"
00:22:51.664016 [debug] [MainThread]: On master: COMMIT
00:22:51.666252 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:22:51.666657 [debug] [MainThread]: On master: Close
00:22:51.667305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:22:51.668283 [info ] [MainThread]: 
00:22:51.674187 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
00:22:51.674846 [info ] [Thread-1  ]: 1 of 2 START view model dev.my_first_dbt_model.................................. [RUN]
00:22:51.675863 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
00:22:51.676263 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
00:22:51.676644 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
00:22:51.682921 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
00:22:51.684400 [debug] [Thread-1  ]: finished collecting timing info
00:22:51.685138 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
00:22:51.778279 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_first_dbt_model"
00:22:51.799821 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:22:51.800264 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: BEGIN
00:22:51.800601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:22:51.859060 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
00:22:51.861148 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:22:51.863020 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */

  create view "dbt"."dev"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
00:22:51.881662 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
00:22:51.906633 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:22:51.907215 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:22:51.913912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
00:22:51.934352 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:22:51.934756 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:22:51.935041 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:22:51.940777 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:22:51.949682 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:22:51.950220 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
drop view if exists "dbt"."dev"."my_first_dbt_model__dbt_backup" cascade
00:22:51.954205 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:22:51.958559 [debug] [Thread-1  ]: finished collecting timing info
00:22:51.959399 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: Close
00:22:51.960919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a74c690-bc57-48f7-a86b-f29583a76530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac419cfc10>]}
00:22:51.961960 [info ] [Thread-1  ]: 1 of 2 OK created view model dev.my_first_dbt_model............................. [[32mCREATE VIEW[0m in 0.29s]
00:22:51.963055 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
00:22:51.964822 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
00:22:51.965836 [info ] [Thread-1  ]: 2 of 2 START view model dev.my_second_dbt_model................................. [RUN]
00:22:51.968602 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
00:22:51.969226 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
00:22:51.969827 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
00:22:51.975554 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
00:22:51.977266 [debug] [Thread-1  ]: finished collecting timing info
00:22:51.978912 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
00:22:51.985458 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_second_dbt_model"
00:22:51.986566 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:22:51.987925 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: BEGIN
00:22:51.990346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:22:52.027292 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
00:22:52.028125 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:22:52.028786 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */

  create view "dbt"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."dev"."my_first_dbt_model"
where id = 1
  );
00:22:52.037610 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
00:22:52.043090 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:22:52.044200 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
alter table "dbt"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:22:52.054599 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
00:22:52.056542 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:22:52.056902 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:22:52.057192 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:22:52.064560 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:22:52.069424 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:22:52.069830 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
drop view if exists "dbt"."dev"."my_second_dbt_model__dbt_backup" cascade
00:22:52.073555 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:22:52.075834 [debug] [Thread-1  ]: finished collecting timing info
00:22:52.076250 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: Close
00:22:52.077495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a74c690-bc57-48f7-a86b-f29583a76530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac41ad8a90>]}
00:22:52.078762 [info ] [Thread-1  ]: 2 of 2 OK created view model dev.my_second_dbt_model............................ [[32mCREATE VIEW[0m in 0.11s]
00:22:52.079975 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
00:22:52.087347 [debug] [MainThread]: Acquiring new postgres connection "master"
00:22:52.087755 [debug] [MainThread]: Using postgres connection "master"
00:22:52.087999 [debug] [MainThread]: On master: BEGIN
00:22:52.088359 [debug] [MainThread]: Opening a new connection, currently in state closed
00:22:52.124599 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
00:22:52.125472 [debug] [MainThread]: On master: COMMIT
00:22:52.126051 [debug] [MainThread]: Using postgres connection "master"
00:22:52.126554 [debug] [MainThread]: On master: COMMIT
00:22:52.129809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:22:52.130473 [debug] [MainThread]: On master: Close
00:22:52.131735 [info ] [MainThread]: 
00:22:52.133210 [info ] [MainThread]: Finished running 2 view models in 0.70s.
00:22:52.134660 [debug] [MainThread]: Connection 'master' was properly closed.
00:22:52.135160 [debug] [MainThread]: Connection 'model.bungie_dwh.my_second_dbt_model' was properly closed.
00:22:52.148867 [info ] [MainThread]: 
00:22:52.149718 [info ] [MainThread]: [32mCompleted successfully[0m
00:22:52.150522 [info ] [MainThread]: 
00:22:52.151670 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
00:22:52.153866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac419e4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac41b5ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac41b5cdd0>]}


============================== 2021-12-26 00:25:56.662290 | 776f0615-1b1a-4fe0-95b1-2d24c6083e95 ==============================
00:25:56.662290 [info ] [MainThread]: Running with dbt=1.0.0
00:25:56.663900 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
00:25:56.664285 [debug] [MainThread]: Tracking: tracking
00:25:56.683190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16fa2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16fa2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac16fa24d0>]}
00:25:56.746637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:25:56.747046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:25:56.747783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:25:56.760263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '776f0615-1b1a-4fe0-95b1-2d24c6083e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac17178810>]}
00:25:56.769989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '776f0615-1b1a-4fe0-95b1-2d24c6083e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1717e3d0>]}
00:25:56.771160 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:25:56.774418 [info ] [MainThread]: 
00:25:56.775646 [debug] [MainThread]: Acquiring new postgres connection "master"
00:25:56.778290 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:25:56.797856 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:25:56.798169 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:25:56.798387 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:25:56.849003 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
00:25:56.849771 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:25:56.850397 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:25:56.856976 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:25:56.859712 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:25:56.862628 [debug] [ThreadPool]: On list_dbt_dev: Close
00:25:56.873487 [debug] [MainThread]: Using postgres connection "master"
00:25:56.874152 [debug] [MainThread]: On master: BEGIN
00:25:56.874676 [debug] [MainThread]: Opening a new connection, currently in state init
00:25:56.897667 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:25:56.898198 [debug] [MainThread]: Using postgres connection "master"
00:25:56.898457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:25:56.909720 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:25:56.911742 [debug] [MainThread]: On master: ROLLBACK
00:25:56.914998 [debug] [MainThread]: On master: Close
00:25:56.915903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:25:56.916936 [info ] [MainThread]: 
00:25:56.926349 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
00:25:56.927198 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
00:25:56.927533 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
00:25:56.927822 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
00:25:56.931740 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
00:25:56.933360 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.934633 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
00:25:56.937151 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.938121 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
00:25:56.939556 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
00:25:56.941118 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
00:25:56.941456 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
00:25:56.941716 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
00:25:56.945981 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
00:25:56.946647 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.946899 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
00:25:56.947119 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.947565 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
00:25:56.947829 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:25:56.948333 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:25:56.948682 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:25:56.948932 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:25:56.965813 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:25:56.966600 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.966861 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:25:56.967087 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.967530 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:25:56.967789 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:25:56.968650 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:25:56.969292 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:25:56.969537 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:25:56.981911 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:25:56.982790 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.983320 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:25:56.983767 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.984752 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:25:56.985319 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:25:56.985914 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:25:56.986185 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:25:56.986412 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:25:56.990638 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:25:56.991287 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.991566 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:25:56.991807 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.992263 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:25:56.992563 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:25:56.993067 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:25:56.993309 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:25:56.993769 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:25:56.998583 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:25:56.999329 [debug] [Thread-1  ]: finished collecting timing info
00:25:56.999627 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:25:56.999869 [debug] [Thread-1  ]: finished collecting timing info
00:25:57.000335 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:25:57.024785 [debug] [MainThread]: Connection 'master' was properly closed.
00:25:57.025106 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:25:57.031361 [info ] [MainThread]: Done.
00:25:57.037087 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:25:57.037437 [info ] [MainThread]: Building catalog
00:25:57.039969 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
00:25:57.052437 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
00:25:57.052776 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
00:25:57.052980 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:25:57.075834 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:25:57.077973 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
00:25:57.081361 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:25:57.099165 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.02 seconds
00:25:57.106003 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
00:25:57.108573 [debug] [ThreadPool]: On dbt.information_schema: Close
00:25:57.120877 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dairflow/bungie_dwh/target/catalog.json
00:25:57.121824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1710f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1710f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1710fe10>]}
00:25:57.607401 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:25:57.607792 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-26 00:26:55.869232 | c9675f1c-91e8-4f4d-9616-1121add7958d ==============================
00:26:55.869232 [info ] [MainThread]: Running with dbt=1.0.0
00:26:55.870873 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
00:26:55.871526 [debug] [MainThread]: Tracking: tracking
00:26:55.892829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df795bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df795e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df795790>]}
00:26:55.907396 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:26:55.908105 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:26:55.908977 [info ] [MainThread]: 
00:26:55.909852 [info ] [MainThread]: 
00:26:55.910640 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 00:33:24.363371 | e3ddc4eb-e631-4aea-9a41-86602327b4dd ==============================
00:33:24.363371 [info ] [MainThread]: Running with dbt=1.0.0
00:33:24.365029 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:33:24.365476 [debug] [MainThread]: Tracking: tracking
00:33:24.384935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b5119b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b5110850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b5119c50>]}
00:33:24.458659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:33:24.459421 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/my_first_dbt_model.sql
00:33:24.475706 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
00:33:24.522538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:33:24.531566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3ddc4eb-e631-4aea-9a41-86602327b4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b5164f90>]}
00:33:24.548288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3ddc4eb-e631-4aea-9a41-86602327b4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b51be650>]}
00:33:24.548950 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:33:24.552994 [info ] [MainThread]: 
00:33:24.555047 [debug] [MainThread]: Acquiring new postgres connection "master"
00:33:24.558225 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:33:24.580447 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:33:24.580842 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:33:24.581144 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:33:24.653228 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.07 seconds
00:33:24.655400 [debug] [ThreadPool]: On list_dbt: Close
00:33:24.658142 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:33:24.671400 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:33:24.671741 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:33:24.671968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:33:24.686654 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:33:24.687180 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:33:24.687494 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:33:24.693650 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:33:24.696619 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:33:24.700041 [debug] [ThreadPool]: On list_dbt_dev: Close
00:33:24.707379 [debug] [MainThread]: Using postgres connection "master"
00:33:24.707799 [debug] [MainThread]: On master: BEGIN
00:33:24.708048 [debug] [MainThread]: Opening a new connection, currently in state init
00:33:24.725731 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:33:24.726121 [debug] [MainThread]: Using postgres connection "master"
00:33:24.726471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:33:24.733523 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:33:24.735591 [debug] [MainThread]: On master: ROLLBACK
00:33:24.738405 [debug] [MainThread]: Using postgres connection "master"
00:33:24.738733 [debug] [MainThread]: On master: BEGIN
00:33:24.744391 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:33:24.745026 [debug] [MainThread]: On master: COMMIT
00:33:24.745334 [debug] [MainThread]: Using postgres connection "master"
00:33:24.745584 [debug] [MainThread]: On master: COMMIT
00:33:24.748309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:33:24.748724 [debug] [MainThread]: On master: Close
00:33:24.749519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:33:24.750157 [info ] [MainThread]: 
00:33:24.766375 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
00:33:24.767081 [info ] [Thread-1  ]: 1 of 2 START view model dev.my_first_dbt_model.................................. [RUN]
00:33:24.768009 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
00:33:24.768441 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
00:33:24.768930 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
00:33:24.775175 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
00:33:24.777394 [debug] [Thread-1  ]: finished collecting timing info
00:33:24.777857 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
00:33:24.825467 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_first_dbt_model"
00:33:24.826470 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:33:24.826769 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: BEGIN
00:33:24.827000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:33:24.844213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:33:24.844779 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:33:24.845112 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */

  create view "dbt"."dev"."my_first_dbt_model__dbt_tmp" as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

where id is not null
  );
00:33:24.853216 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
00:33:24.861925 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:33:24.862664 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
00:33:24.868851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
00:33:24.872082 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:33:24.872398 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:33:24.874651 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:33:24.884253 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:33:24.884601 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:33:24.884846 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:33:24.888617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:33:24.894973 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:33:24.895293 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
drop view if exists "dbt"."dev"."my_first_dbt_model__dbt_backup" cascade
00:33:24.900334 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:33:24.902097 [debug] [Thread-1  ]: finished collecting timing info
00:33:24.902583 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: Close
00:33:24.903980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3ddc4eb-e631-4aea-9a41-86602327b4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b51507d0>]}
00:33:24.905264 [info ] [Thread-1  ]: 1 of 2 OK created view model dev.my_first_dbt_model............................. [[32mCREATE VIEW[0m in 0.14s]
00:33:24.906439 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
00:33:24.908176 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
00:33:24.908678 [info ] [Thread-1  ]: 2 of 2 START view model dev.my_second_dbt_model................................. [RUN]
00:33:24.909673 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
00:33:24.910063 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
00:33:24.910654 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
00:33:24.914025 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
00:33:24.914918 [debug] [Thread-1  ]: finished collecting timing info
00:33:24.915282 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
00:33:24.920553 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_second_dbt_model"
00:33:24.923733 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:33:24.924097 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: BEGIN
00:33:24.924365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:33:24.956870 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
00:33:24.957619 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:33:24.959438 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */

  create view "dbt"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."dev"."my_first_dbt_model"
where id = 1
  );
00:33:24.963975 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
00:33:24.966982 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:33:24.967309 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
alter table "dbt"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:33:24.969927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:33:24.972028 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:33:24.972346 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:33:24.972587 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:33:24.977670 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:33:24.980750 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:33:24.981051 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
drop view if exists "dbt"."dev"."my_second_dbt_model__dbt_backup" cascade
00:33:24.983330 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:33:24.984796 [debug] [Thread-1  ]: finished collecting timing info
00:33:24.985125 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: Close
00:33:24.986060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3ddc4eb-e631-4aea-9a41-86602327b4dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b5166ad0>]}
00:33:24.986705 [info ] [Thread-1  ]: 2 of 2 OK created view model dev.my_second_dbt_model............................ [[32mCREATE VIEW[0m in 0.08s]
00:33:24.987357 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
00:33:25.069460 [debug] [MainThread]: Acquiring new postgres connection "master"
00:33:25.070041 [debug] [MainThread]: Using postgres connection "master"
00:33:25.070442 [debug] [MainThread]: On master: BEGIN
00:33:25.070812 [debug] [MainThread]: Opening a new connection, currently in state closed
00:33:25.089136 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:33:25.089654 [debug] [MainThread]: On master: COMMIT
00:33:25.090010 [debug] [MainThread]: Using postgres connection "master"
00:33:25.090309 [debug] [MainThread]: On master: COMMIT
00:33:25.093119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:33:25.093556 [debug] [MainThread]: On master: Close
00:33:25.094313 [info ] [MainThread]: 
00:33:25.095342 [info ] [MainThread]: Finished running 2 view models in 0.54s.
00:33:25.096432 [debug] [MainThread]: Connection 'master' was properly closed.
00:33:25.096824 [debug] [MainThread]: Connection 'model.bungie_dwh.my_second_dbt_model' was properly closed.
00:33:25.108873 [info ] [MainThread]: 
00:33:25.110562 [info ] [MainThread]: [32mCompleted successfully[0m
00:33:25.113295 [info ] [MainThread]: 
00:33:25.114313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
00:33:25.115300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b5144f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b5174d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7b50ea150>]}


============================== 2021-12-26 00:36:56.481453 | 4b77c385-73cf-40bf-9524-6ce38d58a0df ==============================
00:36:56.481453 [info ] [MainThread]: Running with dbt=1.0.0
00:36:56.483112 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:36:56.484285 [debug] [MainThread]: Tracking: tracking
00:36:56.520272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e289bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e289b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e289bcd0>]}
00:36:56.605860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:36:56.607203 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/my_first_dbt_model.sql
00:36:56.628066 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
00:36:56.682916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:36:56.696132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b77c385-73cf-40bf-9524-6ce38d58a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e28e6d90>]}
00:36:56.711604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b77c385-73cf-40bf-9524-6ce38d58a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e2a3edd0>]}
00:36:56.712552 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:36:56.714253 [info ] [MainThread]: 
00:36:56.714967 [debug] [MainThread]: Acquiring new postgres connection "master"
00:36:56.716901 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:36:56.748076 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:36:56.749040 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:36:56.749727 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:36:56.817690 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.07 seconds
00:36:56.820339 [debug] [ThreadPool]: On list_dbt: Close
00:36:56.823616 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:36:56.840855 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:36:56.841208 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:36:56.841462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:36:56.860063 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:36:56.860598 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:36:56.860889 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:36:56.867105 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:36:56.870172 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:36:56.873380 [debug] [ThreadPool]: On list_dbt_dev: Close
00:36:56.885046 [debug] [MainThread]: Using postgres connection "master"
00:36:56.885463 [debug] [MainThread]: On master: BEGIN
00:36:56.885925 [debug] [MainThread]: Opening a new connection, currently in state init
00:36:57.910224 [debug] [MainThread]: SQL status: BEGIN in 1.02 seconds
00:36:57.910954 [debug] [MainThread]: Using postgres connection "master"
00:36:57.911436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:36:57.920972 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:36:57.923594 [debug] [MainThread]: On master: ROLLBACK
00:36:57.927114 [debug] [MainThread]: Using postgres connection "master"
00:36:57.927590 [debug] [MainThread]: On master: BEGIN
00:36:57.932394 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:36:57.932946 [debug] [MainThread]: On master: COMMIT
00:36:57.933305 [debug] [MainThread]: Using postgres connection "master"
00:36:57.933743 [debug] [MainThread]: On master: COMMIT
00:36:57.935900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:36:57.936320 [debug] [MainThread]: On master: Close
00:36:57.937206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:36:57.938283 [info ] [MainThread]: 
00:36:57.944999 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
00:36:57.946053 [info ] [Thread-1  ]: 1 of 2 START table model dev.my_first_dbt_model................................. [RUN]
00:36:57.947328 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
00:36:57.947722 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
00:36:57.948137 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
00:36:57.956466 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
00:36:57.958877 [debug] [Thread-1  ]: finished collecting timing info
00:36:57.959572 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
00:36:58.042368 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_first_dbt_model"
00:36:58.043207 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:36:58.043498 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: BEGIN
00:36:58.043730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:36:58.058900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:36:58.059598 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:36:58.059907 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */


  create  table "dbt"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

where id is not null
  );
00:36:58.067176 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
00:36:58.075739 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:36:58.076085 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
00:36:58.078639 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:58.082173 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:36:58.082519 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:36:58.085144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:58.107202 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:36:58.107597 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:36:58.107884 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:36:58.114542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:36:58.121061 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:36:58.121371 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
drop view if exists "dbt"."dev"."my_first_dbt_model__dbt_backup" cascade
00:36:58.126122 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:36:58.127929 [debug] [Thread-1  ]: finished collecting timing info
00:36:58.128320 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: Close
00:36:58.129318 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b77c385-73cf-40bf-9524-6ce38d58a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e28d0b50>]}
00:36:58.130402 [info ] [Thread-1  ]: 1 of 2 OK created table model dev.my_first_dbt_model............................ [[32mSELECT 1[0m in 0.18s]
00:36:58.131089 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
00:36:58.133186 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
00:36:58.133746 [info ] [Thread-1  ]: 2 of 2 START view model dev.my_second_dbt_model................................. [RUN]
00:36:58.135171 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
00:36:58.135737 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
00:36:58.136080 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
00:36:58.139823 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
00:36:58.140628 [debug] [Thread-1  ]: finished collecting timing info
00:36:58.141183 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
00:36:58.201045 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_second_dbt_model"
00:36:58.201723 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:36:58.201965 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: BEGIN
00:36:58.202165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:36:58.229607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
00:36:58.230343 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:36:58.230938 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */

  create view "dbt"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."dev"."my_first_dbt_model"
where id = 1
  );
00:36:58.235255 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
00:36:58.238969 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:36:58.239346 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
alter table "dbt"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:36:58.241752 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:58.243387 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:36:58.243677 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:36:58.243906 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:36:58.248071 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:36:58.251093 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:36:58.251478 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
drop view if exists "dbt"."dev"."my_second_dbt_model__dbt_backup" cascade
00:36:58.254126 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:36:58.256770 [debug] [Thread-1  ]: finished collecting timing info
00:36:58.257289 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: Close
00:36:58.258235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b77c385-73cf-40bf-9524-6ce38d58a0df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e2a0a690>]}
00:36:58.258979 [info ] [Thread-1  ]: 2 of 2 OK created view model dev.my_second_dbt_model............................ [[32mCREATE VIEW[0m in 0.12s]
00:36:58.259782 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
00:36:58.362540 [debug] [MainThread]: Acquiring new postgres connection "master"
00:36:58.363146 [debug] [MainThread]: Using postgres connection "master"
00:36:58.363545 [debug] [MainThread]: On master: BEGIN
00:36:58.363916 [debug] [MainThread]: Opening a new connection, currently in state closed
00:36:58.379640 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:36:58.380195 [debug] [MainThread]: On master: COMMIT
00:36:58.380561 [debug] [MainThread]: Using postgres connection "master"
00:36:58.380851 [debug] [MainThread]: On master: COMMIT
00:36:58.383606 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:36:58.384316 [debug] [MainThread]: On master: Close
00:36:58.385097 [info ] [MainThread]: 
00:36:58.385786 [info ] [MainThread]: Finished running 1 table model, 1 view model in 1.67s.
00:36:58.386831 [debug] [MainThread]: Connection 'master' was properly closed.
00:36:58.387429 [debug] [MainThread]: Connection 'model.bungie_dwh.my_second_dbt_model' was properly closed.
00:36:58.399044 [info ] [MainThread]: 
00:36:58.399693 [info ] [MainThread]: [32mCompleted successfully[0m
00:36:58.400233 [info ] [MainThread]: 
00:36:58.400724 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
00:36:58.401400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e0e18090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e286c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5e286c390>]}


============================== 2021-12-26 00:39:49.284847 | 01cc62d5-04a7-478f-8043-c59751157174 ==============================
00:39:49.284847 [info ] [MainThread]: Running with dbt=1.0.0
00:39:49.287539 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
00:39:49.289115 [debug] [MainThread]: Tracking: tracking
00:39:49.341246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99508dc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99508dccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99508dc3d0>]}
00:39:49.417514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:39:49.417860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:39:49.418566 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:39:49.434852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01cc62d5-04a7-478f-8043-c59751157174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9950968e10>]}
00:39:49.451084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01cc62d5-04a7-478f-8043-c59751157174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f995097c5d0>]}
00:39:49.451599 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:39:49.453464 [info ] [MainThread]: 
00:39:49.455668 [debug] [MainThread]: Acquiring new postgres connection "master"
00:39:49.456968 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:39:49.487215 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:39:49.488876 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:39:49.490493 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:39:49.550492 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
00:39:49.551164 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:39:49.551629 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:39:49.558079 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:39:49.564246 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:39:49.578049 [debug] [ThreadPool]: On list_dbt_dev: Close
00:39:49.602349 [debug] [MainThread]: Using postgres connection "master"
00:39:49.602863 [debug] [MainThread]: On master: BEGIN
00:39:49.603244 [debug] [MainThread]: Opening a new connection, currently in state init
00:39:49.671755 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
00:39:49.672553 [debug] [MainThread]: Using postgres connection "master"
00:39:49.672931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:39:49.683516 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:39:49.685875 [debug] [MainThread]: On master: ROLLBACK
00:39:49.688459 [debug] [MainThread]: On master: Close
00:39:49.697680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:39:49.700901 [info ] [MainThread]: 
00:39:49.706395 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
00:39:49.707310 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
00:39:49.707824 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
00:39:49.708311 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
00:39:49.713872 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
00:39:49.715191 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.715737 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
00:39:49.716190 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.716961 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
00:39:49.717906 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
00:39:49.718782 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
00:39:49.719247 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
00:39:49.719666 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
00:39:49.724860 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
00:39:49.726204 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.726777 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
00:39:49.727218 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.728044 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
00:39:49.728582 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:39:49.729738 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:39:49.730240 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:39:49.730628 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:39:49.761347 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:39:49.763724 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.764440 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:39:49.764994 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.766332 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:39:49.767499 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:39:49.768794 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:39:49.769212 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:39:49.769674 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:39:49.787351 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:39:49.788800 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.789345 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:39:49.789846 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.790813 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:39:49.791195 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:39:49.791915 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:39:49.792230 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:39:49.792506 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:39:49.801583 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:39:49.803177 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.803766 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:39:49.804268 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.805153 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:39:49.805674 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:39:49.806475 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:39:49.806910 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:39:49.807359 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:39:49.817448 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:39:49.818912 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.819311 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:39:49.819630 [debug] [Thread-1  ]: finished collecting timing info
00:39:49.820292 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:39:49.910574 [debug] [MainThread]: Connection 'master' was properly closed.
00:39:49.911195 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:39:49.919015 [info ] [MainThread]: Done.
00:39:49.932268 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:39:49.934931 [info ] [MainThread]: Building catalog
00:39:49.938315 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
00:39:49.954721 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
00:39:49.955161 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
00:39:49.955464 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:39:49.990326 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
00:39:49.991289 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
00:39:49.992059 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:39:50.007128 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:39:50.017757 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
00:39:50.020568 [debug] [ThreadPool]: On dbt.information_schema: Close
00:39:50.034151 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dairflow/bungie_dwh/target/catalog.json
00:39:50.035401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99508b7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9950907f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9950907dd0>]}
00:39:50.532902 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:39:50.533429 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-26 00:39:59.896982 | 2fe1bdb7-6058-4158-8b00-713c640fd873 ==============================
00:39:59.896982 [info ] [MainThread]: Running with dbt=1.0.0
00:39:59.898400 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
00:39:59.899115 [debug] [MainThread]: Tracking: tracking
00:39:59.924178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd337fcced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd337fcc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd337fcc4d0>]}
00:39:59.933593 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:39:59.934267 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:39:59.934703 [info ] [MainThread]: 
00:39:59.935100 [info ] [MainThread]: 
00:39:59.935780 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 00:49:27.185382 | 59d184b0-142f-4b5e-aaf4-a415078bd221 ==============================
00:49:27.185382 [info ] [MainThread]: Running with dbt=1.0.0
00:49:27.186920 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:49:27.187323 [debug] [MainThread]: Tracking: tracking
00:49:27.208428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf35e74750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf35e741d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf35e74c90>]}
00:49:27.282943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:49:27.283305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:49:27.284015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:49:27.302683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d184b0-142f-4b5e-aaf4-a415078bd221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf3556c590>]}
00:49:27.316988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d184b0-142f-4b5e-aaf4-a415078bd221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf361805d0>]}
00:49:27.317605 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:49:27.320969 [info ] [MainThread]: 
00:49:27.326811 [debug] [MainThread]: Acquiring new postgres connection "master"
00:49:27.329351 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:49:27.355746 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:49:27.356307 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:49:27.360456 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:49:27.419118 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
00:49:27.423100 [debug] [ThreadPool]: On list_dbt: Close
00:49:27.430104 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:49:27.442551 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:49:27.443124 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:49:27.443763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:49:27.487412 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
00:49:27.487823 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:49:27.488129 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:49:27.496761 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:49:27.498507 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:49:27.500691 [debug] [ThreadPool]: On list_dbt_dev: Close
00:49:27.506968 [debug] [MainThread]: Using postgres connection "master"
00:49:27.507358 [debug] [MainThread]: On master: BEGIN
00:49:27.507885 [debug] [MainThread]: Opening a new connection, currently in state init
00:49:27.523534 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:49:27.524690 [debug] [MainThread]: Using postgres connection "master"
00:49:27.524981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:49:27.532314 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:49:27.534109 [debug] [MainThread]: On master: ROLLBACK
00:49:27.536254 [debug] [MainThread]: Using postgres connection "master"
00:49:27.536781 [debug] [MainThread]: On master: BEGIN
00:49:27.542145 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:49:27.542588 [debug] [MainThread]: On master: COMMIT
00:49:27.542857 [debug] [MainThread]: Using postgres connection "master"
00:49:27.543403 [debug] [MainThread]: On master: COMMIT
00:49:27.545955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:49:27.546538 [debug] [MainThread]: On master: Close
00:49:27.547854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:49:27.548988 [info ] [MainThread]: 
00:49:27.554789 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
00:49:27.555877 [info ] [Thread-1  ]: 1 of 2 START table model dev.my_first_dbt_model................................. [RUN]
00:49:27.557722 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
00:49:27.558315 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
00:49:27.558799 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
00:49:27.562426 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
00:49:27.563952 [debug] [Thread-1  ]: finished collecting timing info
00:49:27.564463 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
00:49:27.626836 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_first_dbt_model"
00:49:27.627781 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:49:27.628098 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: BEGIN
00:49:27.628336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:49:27.648374 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:49:27.649182 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:49:27.649621 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */


  create  table "dbt"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

where id is not null
  );
00:49:27.659279 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
00:49:27.667472 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:49:27.667789 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
00:49:27.670281 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:49:27.673689 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:49:27.674016 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:49:27.677492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:49:27.691568 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:49:27.691901 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:49:27.692142 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:49:27.696150 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:49:27.704283 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:49:27.704606 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
drop table if exists "dbt"."dev"."my_first_dbt_model__dbt_backup" cascade
00:49:27.709725 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:49:27.711359 [debug] [Thread-1  ]: finished collecting timing info
00:49:27.711681 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: Close
00:49:27.712424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d184b0-142f-4b5e-aaf4-a415078bd221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf36121ed0>]}
00:49:27.713271 [info ] [Thread-1  ]: 1 of 2 OK created table model dev.my_first_dbt_model............................ [[32mSELECT 1[0m in 0.16s]
00:49:27.713876 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
00:49:27.715521 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
00:49:27.716042 [info ] [Thread-1  ]: 2 of 2 START view model dev.my_second_dbt_model................................. [RUN]
00:49:27.717106 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
00:49:27.717857 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
00:49:27.718572 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
00:49:27.724434 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
00:49:27.725956 [debug] [Thread-1  ]: finished collecting timing info
00:49:27.726938 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
00:49:27.770824 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_second_dbt_model"
00:49:27.772835 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:49:27.773146 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: BEGIN
00:49:27.773411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:49:27.792556 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:49:27.793026 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:49:27.793294 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */

  create view "dbt"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."dev"."my_first_dbt_model"
where id = 1
  );
00:49:27.797445 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
00:49:27.805423 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:49:27.805717 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
alter table "dbt"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:49:27.808145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:49:27.809766 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:49:27.810048 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:49:27.810274 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:49:27.813562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:49:27.816043 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:49:27.816397 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
drop view if exists "dbt"."dev"."my_second_dbt_model__dbt_backup" cascade
00:49:27.818689 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:49:27.820304 [debug] [Thread-1  ]: finished collecting timing info
00:49:27.820700 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: Close
00:49:27.821589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d184b0-142f-4b5e-aaf4-a415078bd221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf361043d0>]}
00:49:27.822307 [info ] [Thread-1  ]: 2 of 2 OK created view model dev.my_second_dbt_model............................ [[32mCREATE VIEW[0m in 0.10s]
00:49:27.822920 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
00:49:27.868309 [debug] [MainThread]: Acquiring new postgres connection "master"
00:49:27.869129 [debug] [MainThread]: Using postgres connection "master"
00:49:27.870176 [debug] [MainThread]: On master: BEGIN
00:49:27.870507 [debug] [MainThread]: Opening a new connection, currently in state closed
00:49:27.893117 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:49:27.893680 [debug] [MainThread]: On master: COMMIT
00:49:27.894127 [debug] [MainThread]: Using postgres connection "master"
00:49:27.894594 [debug] [MainThread]: On master: COMMIT
00:49:27.896846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:49:27.897294 [debug] [MainThread]: On master: Close
00:49:27.898076 [info ] [MainThread]: 
00:49:27.899093 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.58s.
00:49:27.899573 [debug] [MainThread]: Connection 'master' was properly closed.
00:49:27.899824 [debug] [MainThread]: Connection 'model.bungie_dwh.my_second_dbt_model' was properly closed.
00:49:27.910511 [info ] [MainThread]: 
00:49:27.911238 [info ] [MainThread]: [32mCompleted successfully[0m
00:49:27.911807 [info ] [MainThread]: 
00:49:27.912248 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
00:49:27.912757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf35f96e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf361080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf36108050>]}


============================== 2021-12-26 00:49:35.851257 | 34381b9c-dbf4-462e-b6b7-f466c2c427fd ==============================
00:49:35.851257 [info ] [MainThread]: Running with dbt=1.0.0
00:49:35.852539 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
00:49:35.854114 [debug] [MainThread]: Tracking: tracking
00:49:35.877569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba0dad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba0dad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba0da6d0>]}
00:49:35.951089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:49:35.951427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:49:35.952021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:49:35.965734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34381b9c-dbf4-462e-b6b7-f466c2c427fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba16cb90>]}
00:49:35.974014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34381b9c-dbf4-462e-b6b7-f466c2c427fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba180bd0>]}
00:49:35.974516 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:49:35.976578 [info ] [MainThread]: 
00:49:35.977843 [debug] [MainThread]: Acquiring new postgres connection "master"
00:49:35.981597 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:49:36.006016 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:49:36.006376 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:49:36.006754 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:49:36.042249 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
00:49:36.042815 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:49:36.043159 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:49:36.053543 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:49:36.055866 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:49:36.058246 [debug] [ThreadPool]: On list_dbt_dev: Close
00:49:36.067837 [debug] [MainThread]: Using postgres connection "master"
00:49:36.068176 [debug] [MainThread]: On master: BEGIN
00:49:36.068414 [debug] [MainThread]: Opening a new connection, currently in state init
00:49:36.084497 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:49:36.085135 [debug] [MainThread]: Using postgres connection "master"
00:49:36.085525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:49:36.092985 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:49:36.094733 [debug] [MainThread]: On master: ROLLBACK
00:49:36.097151 [debug] [MainThread]: Using postgres connection "master"
00:49:36.097552 [debug] [MainThread]: On master: BEGIN
00:49:36.101930 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:49:36.102405 [debug] [MainThread]: On master: COMMIT
00:49:36.102787 [debug] [MainThread]: Using postgres connection "master"
00:49:36.103133 [debug] [MainThread]: On master: COMMIT
00:49:36.105537 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:49:36.105946 [debug] [MainThread]: On master: Close
00:49:36.106688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:49:36.107540 [info ] [MainThread]: 
00:49:36.112709 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:49:36.113400 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id................................ [RUN]
00:49:36.115142 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:49:36.115515 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:49:36.115827 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:49:36.140471 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:49:36.141813 [debug] [Thread-1  ]: finished collecting timing info
00:49:36.142154 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:49:36.173514 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:49:36.174389 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:49:36.174671 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
00:49:36.174892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:49:36.193791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:49:36.194381 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:49:36.195107 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
00:49:36.199161 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:49:36.202306 [debug] [Thread-1  ]: finished collecting timing info
00:49:36.203099 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
00:49:36.205522 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: Close
00:49:36.206306 [info ] [Thread-1  ]: 1 of 4 PASS not_null_my_first_dbt_model_id...................................... [[32mPASS[0m in 0.09s]
00:49:36.207022 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:49:36.207385 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:49:36.207664 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id............................... [RUN]
00:49:36.208375 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:49:36.208640 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:49:36.208870 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:49:36.217201 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:49:36.218509 [debug] [Thread-1  ]: finished collecting timing info
00:49:36.219187 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:49:36.225625 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:49:36.228031 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:49:36.229290 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: BEGIN
00:49:36.230108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:49:36.255265 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
00:49:36.255854 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:49:36.256209 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
00:49:36.259611 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:49:36.261390 [debug] [Thread-1  ]: finished collecting timing info
00:49:36.261719 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
00:49:36.264494 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: Close
00:49:36.266011 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id..................................... [[32mPASS[0m in 0.06s]
00:49:36.266911 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:49:36.269107 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:49:36.269815 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id.................................. [RUN]
00:49:36.271649 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:49:36.272353 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:49:36.272999 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:49:36.288119 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:49:36.288891 [debug] [Thread-1  ]: finished collecting timing info
00:49:36.289249 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:49:36.296317 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:49:36.297208 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:49:36.297667 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: BEGIN
00:49:36.297920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:49:36.334857 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
00:49:36.335846 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:49:36.337105 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."dev"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
00:49:36.344241 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
00:49:36.346204 [debug] [Thread-1  ]: finished collecting timing info
00:49:36.346716 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
00:49:36.354160 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: Close
00:49:36.355453 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id........................................ [[32mPASS[0m in 0.08s]
00:49:36.356191 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:49:36.356807 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:49:36.357272 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id................................. [RUN]
00:49:36.358839 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:49:36.359520 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:49:36.359853 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:49:36.371821 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:49:36.376357 [debug] [Thread-1  ]: finished collecting timing info
00:49:36.377069 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:49:36.380054 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:49:36.381040 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:49:36.381350 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
00:49:36.381585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:49:37.414215 [debug] [Thread-1  ]: SQL status: BEGIN in 1.03 seconds
00:49:37.414647 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:49:37.414973 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."dev"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
00:49:37.419363 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:49:37.421407 [debug] [Thread-1  ]: finished collecting timing info
00:49:37.421806 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
00:49:37.424583 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: Close
00:49:37.425479 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id....................................... [[32mPASS[0m in 1.07s]
00:49:37.426135 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:49:37.458331 [debug] [MainThread]: Acquiring new postgres connection "master"
00:49:37.459349 [debug] [MainThread]: Using postgres connection "master"
00:49:37.460925 [debug] [MainThread]: On master: BEGIN
00:49:37.462848 [debug] [MainThread]: Opening a new connection, currently in state closed
00:49:37.500144 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
00:49:37.500569 [debug] [MainThread]: On master: COMMIT
00:49:37.500851 [debug] [MainThread]: Using postgres connection "master"
00:49:37.501093 [debug] [MainThread]: On master: COMMIT
00:49:37.504550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:49:37.505102 [debug] [MainThread]: On master: Close
00:49:37.505995 [info ] [MainThread]: 
00:49:37.506953 [info ] [MainThread]: Finished running 4 tests in 1.53s.
00:49:37.507688 [debug] [MainThread]: Connection 'master' was properly closed.
00:49:37.507968 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:49:37.521489 [info ] [MainThread]: 
00:49:37.522062 [info ] [MainThread]: [32mCompleted successfully[0m
00:49:37.522565 [info ] [MainThread]: 
00:49:37.523255 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
00:49:37.523734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba180150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba10b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ba10b250>]}


============================== 2021-12-26 00:53:32.279074 | bf0fb636-1382-42c8-a9d3-f83f823f05dc ==============================
00:53:32.279074 [info ] [MainThread]: Running with dbt=1.0.0
00:53:32.280977 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
00:53:32.281467 [debug] [MainThread]: Tracking: tracking
00:53:32.304273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca758d1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca758d1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca758d18d0>]}
00:53:32.381129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:53:32.381888 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/my_first_dbt_model.sql
00:53:32.397756 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
00:53:32.447770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:53:32.455391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf0fb636-1382-42c8-a9d3-f83f823f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca746496d0>]}
00:53:32.472414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf0fb636-1382-42c8-a9d3-f83f823f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7597ed10>]}
00:53:32.473184 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:53:32.475089 [info ] [MainThread]: 
00:53:32.476219 [debug] [MainThread]: Acquiring new postgres connection "master"
00:53:32.477887 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:53:32.502535 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:53:32.502880 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:53:32.503136 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:53:32.562807 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
00:53:32.565854 [debug] [ThreadPool]: On list_dbt: Close
00:53:32.568897 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:53:32.583219 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:53:32.583739 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:53:32.584196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:53:32.606481 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:53:32.606932 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:53:32.607263 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:53:32.612725 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:53:32.614680 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:53:32.616879 [debug] [ThreadPool]: On list_dbt_dev: Close
00:53:32.624472 [debug] [MainThread]: Using postgres connection "master"
00:53:32.624855 [debug] [MainThread]: On master: BEGIN
00:53:32.625116 [debug] [MainThread]: Opening a new connection, currently in state init
00:53:32.639821 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:53:32.640322 [debug] [MainThread]: Using postgres connection "master"
00:53:32.640650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:53:32.647235 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:53:32.649072 [debug] [MainThread]: On master: ROLLBACK
00:53:32.651149 [debug] [MainThread]: Using postgres connection "master"
00:53:32.651504 [debug] [MainThread]: On master: BEGIN
00:53:32.656933 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:53:32.657354 [debug] [MainThread]: On master: COMMIT
00:53:32.657634 [debug] [MainThread]: Using postgres connection "master"
00:53:32.657875 [debug] [MainThread]: On master: COMMIT
00:53:32.660121 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:53:32.660515 [debug] [MainThread]: On master: Close
00:53:32.661334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:53:32.662043 [info ] [MainThread]: 
00:53:32.668022 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
00:53:32.668655 [info ] [Thread-1  ]: 1 of 2 START table model dev.my_first_dbt_model................................. [RUN]
00:53:32.669578 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
00:53:32.669984 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
00:53:32.670579 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
00:53:32.675598 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
00:53:32.676321 [debug] [Thread-1  ]: finished collecting timing info
00:53:32.676624 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
00:53:32.722359 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_first_dbt_model"
00:53:32.723202 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:53:32.723559 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: BEGIN
00:53:32.723842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:53:32.742934 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:53:32.743445 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:53:32.744103 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */


  create  table "dbt"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

-- where id is not null
  );
00:53:32.752624 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
00:53:32.760725 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:53:32.761083 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
00:53:32.763436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:53:32.766567 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:53:32.766859 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:53:32.769296 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:53:32.783564 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:53:32.783893 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:53:32.784137 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
00:53:32.788956 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:53:32.795620 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
00:53:32.795961 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
drop table if exists "dbt"."dev"."my_first_dbt_model__dbt_backup" cascade
00:53:32.802499 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
00:53:32.804094 [debug] [Thread-1  ]: finished collecting timing info
00:53:32.804419 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: Close
00:53:32.805235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf0fb636-1382-42c8-a9d3-f83f823f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca75916d50>]}
00:53:32.805898 [info ] [Thread-1  ]: 1 of 2 OK created table model dev.my_first_dbt_model............................ [[32mSELECT 2[0m in 0.14s]
00:53:32.806640 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
00:53:32.808394 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
00:53:32.808958 [info ] [Thread-1  ]: 2 of 2 START view model dev.my_second_dbt_model................................. [RUN]
00:53:32.810492 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
00:53:32.811129 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
00:53:32.811474 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
00:53:32.815621 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
00:53:32.816583 [debug] [Thread-1  ]: finished collecting timing info
00:53:32.817169 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
00:53:32.865046 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_second_dbt_model"
00:53:32.866458 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:53:32.866792 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: BEGIN
00:53:32.867036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:53:32.883489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:53:32.883990 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:53:32.884330 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */

  create view "dbt"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."dev"."my_first_dbt_model"
where id = 1
  );
00:53:32.889309 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
00:53:32.892802 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:53:32.893150 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
alter table "dbt"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:53:32.895495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:53:32.897144 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:53:32.897475 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:53:32.897719 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: COMMIT
00:53:32.901120 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:53:32.903404 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_second_dbt_model"
00:53:32.903730 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_second_dbt_model"} */
drop view if exists "dbt"."dev"."my_second_dbt_model__dbt_backup" cascade
00:53:32.906003 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
00:53:32.907925 [debug] [Thread-1  ]: finished collecting timing info
00:53:32.908270 [debug] [Thread-1  ]: On model.bungie_dwh.my_second_dbt_model: Close
00:53:32.909235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf0fb636-1382-42c8-a9d3-f83f823f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74eb2210>]}
00:53:32.909895 [info ] [Thread-1  ]: 2 of 2 OK created view model dev.my_second_dbt_model............................ [[32mCREATE VIEW[0m in 0.10s]
00:53:32.911070 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
00:53:32.988417 [debug] [MainThread]: Acquiring new postgres connection "master"
00:53:32.988961 [debug] [MainThread]: Using postgres connection "master"
00:53:32.989323 [debug] [MainThread]: On master: BEGIN
00:53:32.989658 [debug] [MainThread]: Opening a new connection, currently in state closed
00:53:33.068628 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
00:53:33.069373 [debug] [MainThread]: On master: COMMIT
00:53:33.069785 [debug] [MainThread]: Using postgres connection "master"
00:53:33.070206 [debug] [MainThread]: On master: COMMIT
00:53:33.073685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:53:33.074405 [debug] [MainThread]: On master: Close
00:53:33.075506 [info ] [MainThread]: 
00:53:33.076378 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.60s.
00:53:33.076919 [debug] [MainThread]: Connection 'master' was properly closed.
00:53:33.077191 [debug] [MainThread]: Connection 'model.bungie_dwh.my_second_dbt_model' was properly closed.
00:53:33.089187 [info ] [MainThread]: 
00:53:33.092332 [info ] [MainThread]: [32mCompleted successfully[0m
00:53:33.093793 [info ] [MainThread]: 
00:53:33.095926 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
00:53:33.099380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7593b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca758b6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7597ea10>]}


============================== 2021-12-26 00:54:04.215864 | dc5e28ac-a9a4-44f3-b9ad-18dce234b5d4 ==============================
00:54:04.215864 [info ] [MainThread]: Running with dbt=1.0.0
00:54:04.217146 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
00:54:04.217585 [debug] [MainThread]: Tracking: tracking
00:54:04.248247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c919ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c919390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c919e90>]}
00:54:04.313816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:54:04.314242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:54:04.314891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt.example

00:54:04.326574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc5e28ac-a9a4-44f3-b9ad-18dce234b5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c9acd50>]}
00:54:04.339138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc5e28ac-a9a4-44f3-b9ad-18dce234b5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c9c0610>]}
00:54:04.340070 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
00:54:04.345185 [info ] [MainThread]: 
00:54:04.346202 [debug] [MainThread]: Acquiring new postgres connection "master"
00:54:04.350050 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:54:04.378141 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:54:04.378497 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:54:04.378772 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:54:04.434233 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
00:54:04.434690 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:54:04.434964 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:54:04.443708 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
00:54:04.445924 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:54:04.449840 [debug] [ThreadPool]: On list_dbt_dev: Close
00:54:04.459212 [debug] [MainThread]: Using postgres connection "master"
00:54:04.459578 [debug] [MainThread]: On master: BEGIN
00:54:04.459843 [debug] [MainThread]: Opening a new connection, currently in state init
00:54:04.478384 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:54:04.478900 [debug] [MainThread]: Using postgres connection "master"
00:54:04.479207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:54:04.485906 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
00:54:04.488096 [debug] [MainThread]: On master: ROLLBACK
00:54:04.490398 [debug] [MainThread]: Using postgres connection "master"
00:54:04.490783 [debug] [MainThread]: On master: BEGIN
00:54:04.495300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:54:04.495847 [debug] [MainThread]: On master: COMMIT
00:54:04.496195 [debug] [MainThread]: Using postgres connection "master"
00:54:04.496553 [debug] [MainThread]: On master: COMMIT
00:54:04.498974 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:54:04.499389 [debug] [MainThread]: On master: Close
00:54:04.500195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:54:04.500767 [info ] [MainThread]: 
00:54:04.507420 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:54:04.508110 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id................................ [RUN]
00:54:04.509553 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:54:04.509900 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:54:04.510201 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:54:04.539275 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:54:04.540394 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.540780 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:54:04.569947 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:54:04.570747 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:54:04.571038 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
00:54:04.571260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:54:04.595719 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:54:04.597221 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
00:54:04.597988 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
00:54:04.601990 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:54:04.606413 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.606971 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
00:54:04.609285 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710: Close
00:54:04.610247 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id.................................... [[31mFAIL 1[0m in 0.10s]
00:54:04.611453 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
00:54:04.612581 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:54:04.613527 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id............................... [RUN]
00:54:04.616020 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:54:04.616704 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:54:04.618527 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:54:04.633397 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:54:04.636761 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.637657 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:54:04.641435 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:54:04.642226 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:54:04.642800 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: BEGIN
00:54:04.643024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:54:04.682878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
00:54:04.683437 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
00:54:04.683719 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
00:54:04.690305 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
00:54:04.692857 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.693229 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
00:54:04.694837 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778: Close
00:54:04.695755 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id..................................... [[32mPASS[0m in 0.08s]
00:54:04.696851 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
00:54:04.699095 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:54:04.700148 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id.................................. [RUN]
00:54:04.701577 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:54:04.702206 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:54:04.702540 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:54:04.724490 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:54:04.725413 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.726933 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:54:04.731341 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:54:04.733521 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:54:04.734155 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: BEGIN
00:54:04.734439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:54:04.754364 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:54:04.755478 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
00:54:04.756454 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."dev"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
00:54:04.760430 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:54:04.762824 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.763521 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
00:54:04.766044 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321: Close
00:54:04.766913 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id........................................ [[32mPASS[0m in 0.07s]
00:54:04.767670 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
00:54:04.769004 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:54:04.769503 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id................................. [RUN]
00:54:04.774555 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:54:04.775009 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:54:04.775361 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:54:04.789982 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:54:04.790734 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.791015 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:54:04.792975 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:54:04.793728 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:54:04.793999 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
00:54:04.794198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:54:04.830078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
00:54:04.830712 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
00:54:04.831242 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."dev"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
00:54:04.836129 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:54:04.838362 [debug] [Thread-1  ]: finished collecting timing info
00:54:04.838709 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
00:54:04.841231 [debug] [Thread-1  ]: On test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493: Close
00:54:04.842099 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id....................................... [[32mPASS[0m in 0.07s]
00:54:04.842970 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
00:54:04.923498 [debug] [MainThread]: Acquiring new postgres connection "master"
00:54:04.924090 [debug] [MainThread]: Using postgres connection "master"
00:54:04.924481 [debug] [MainThread]: On master: BEGIN
00:54:04.924848 [debug] [MainThread]: Opening a new connection, currently in state closed
00:54:04.939738 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:54:04.940316 [debug] [MainThread]: On master: COMMIT
00:54:04.940675 [debug] [MainThread]: Using postgres connection "master"
00:54:04.940970 [debug] [MainThread]: On master: COMMIT
00:54:04.943922 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:54:04.944312 [debug] [MainThread]: On master: Close
00:54:04.944999 [info ] [MainThread]: 
00:54:04.945707 [info ] [MainThread]: Finished running 4 tests in 0.60s.
00:54:04.946189 [debug] [MainThread]: Connection 'master' was properly closed.
00:54:04.946776 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:54:04.960536 [info ] [MainThread]: 
00:54:04.961659 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:54:04.962221 [info ] [MainThread]: 
00:54:04.962944 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
00:54:04.963600 [error] [MainThread]:   Got 1 result, configured to fail if != 0
00:54:04.965228 [info ] [MainThread]: 
00:54:04.966687 [info ] [MainThread]:   compiled SQL at target/compiled/bungie_dwh/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
00:54:04.967410 [info ] [MainThread]: 
00:54:04.968995 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
00:54:04.971075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c94bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c94b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993c94be50>]}


============================== 2021-12-26 01:03:59.868407 | 637724b3-5ba2-4013-8a87-89d30f709c60 ==============================
01:03:59.868407 [info ] [MainThread]: Running with dbt=1.0.0
01:03:59.870552 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
01:03:59.875648 [debug] [MainThread]: Tracking: tracking
01:03:59.921065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a68f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a658050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a68fe50>]}
01:03:59.930308 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
01:03:59.931380 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
01:03:59.932876 [info ] [MainThread]: 
01:03:59.933701 [info ] [MainThread]: 
01:03:59.934869 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 02:11:41.063914 | d4e6c292-4a3a-4954-8f99-f2784424f39b ==============================
02:11:41.063914 [info ] [MainThread]: Running with dbt=1.0.0
02:11:41.065437 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
02:11:41.066207 [debug] [MainThread]: Tracking: tracking
02:11:41.097241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc31e72d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc31e720d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc31e72150>]}
02:11:41.137013 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:11:41.137673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd4e6c292-4a3a-4954-8f99-f2784424f39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc32149f90>]}
02:11:41.203987 [debug] [MainThread]: Parsing macros/catalog.sql
02:11:41.211721 [debug] [MainThread]: Parsing macros/relations.sql
02:11:41.213697 [debug] [MainThread]: Parsing macros/adapters.sql
02:11:41.248816 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
02:11:41.251407 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:11:41.256976 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:11:41.260449 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:11:41.262780 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:11:41.286993 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:11:41.303193 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:11:41.320550 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:11:41.327457 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:11:41.330220 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:11:41.332809 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:11:41.339268 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:11:41.355304 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:11:41.357529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:11:41.372306 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:11:41.395245 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:11:41.406147 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:11:41.410476 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:11:41.420680 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:11:41.422643 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:11:41.426782 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:11:41.430286 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:11:41.439246 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:11:41.462760 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:11:41.465048 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:11:41.469388 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:11:41.471806 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:11:41.473349 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:11:41.474268 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:11:41.475320 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:11:41.477581 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:11:41.484376 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:11:41.496462 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:11:41.499750 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:11:41.503669 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:11:41.517584 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:11:41.521982 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:11:41.528498 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:11:41.539330 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:11:41.553951 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:11:41.811971 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
02:11:41.827430 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
02:11:41.887300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.example

02:11:41.896046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4e6c292-4a3a-4954-8f99-f2784424f39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc320fd150>]}
02:11:41.912358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4e6c292-4a3a-4954-8f99-f2784424f39b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc321ebbd0>]}
02:11:41.912834 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
02:11:41.914404 [info ] [MainThread]: 
02:11:41.915001 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
02:11:41.927995 [info ] [MainThread]: 
02:11:41.932056 [info ] [MainThread]: [32mCompleted successfully[0m
02:11:41.934924 [info ] [MainThread]: 
02:11:41.935975 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
02:11:41.936965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc321aff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc321b76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc321b7710>]}


============================== 2021-12-26 02:15:21.741310 | ce497e30-d68c-42b3-86a1-f6220ca62ef2 ==============================
02:15:21.741310 [info ] [MainThread]: Running with dbt=1.0.0
02:15:21.742610 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
02:15:21.747194 [debug] [MainThread]: Tracking: tracking
02:15:21.774546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f97fdf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f97fdbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f97fd110>]}
02:15:21.843476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
02:15:21.844108 [debug] [MainThread]: Partial parsing: added file: bungie_dwh://seeds/products.csv
02:15:21.844516 [debug] [MainThread]: Partial parsing: added file: bungie_dwh://seeds/orders.csv
02:15:21.844869 [debug] [MainThread]: Partial parsing: added file: bungie_dwh://seeds/users.csv
02:15:21.890399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.example

02:15:21.898047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce497e30-d68c-42b3-86a1-f6220ca62ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9996710>]}
02:15:21.905978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce497e30-d68c-42b3-86a1-f6220ca62ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f99c6190>]}
02:15:21.906597 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:15:21.908646 [info ] [MainThread]: 
02:15:21.909652 [debug] [MainThread]: Acquiring new postgres connection "master"
02:15:21.914523 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
02:15:21.933462 [debug] [ThreadPool]: Using postgres connection "list_dbt"
02:15:21.934374 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
02:15:21.935074 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:15:22.018129 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.08 seconds
02:15:22.021100 [debug] [ThreadPool]: On list_dbt: Close
02:15:22.024455 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:15:22.036756 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:15:22.037097 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:15:22.037350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:15:22.054149 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:15:22.054705 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:15:22.055370 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:15:22.066477 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
02:15:22.068200 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:15:22.071000 [debug] [ThreadPool]: On list_dbt_dev: Close
02:15:22.079219 [debug] [MainThread]: Using postgres connection "master"
02:15:22.079635 [debug] [MainThread]: On master: BEGIN
02:15:22.080112 [debug] [MainThread]: Opening a new connection, currently in state init
02:15:22.095910 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:15:22.096544 [debug] [MainThread]: Using postgres connection "master"
02:15:22.097200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:15:22.111343 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
02:15:22.112991 [debug] [MainThread]: On master: ROLLBACK
02:15:22.114776 [debug] [MainThread]: Using postgres connection "master"
02:15:22.115156 [debug] [MainThread]: On master: BEGIN
02:15:22.119611 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:15:22.120205 [debug] [MainThread]: On master: COMMIT
02:15:22.120620 [debug] [MainThread]: Using postgres connection "master"
02:15:22.120925 [debug] [MainThread]: On master: COMMIT
02:15:22.123403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:15:22.123831 [debug] [MainThread]: On master: Close
02:15:22.124556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:15:22.125434 [info ] [MainThread]: 
02:15:22.130550 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:15:22.131213 [info ] [Thread-1  ]: 1 of 3 START seed file dev.orders............................................... [RUN]
02:15:22.132337 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:15:22.132832 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:15:22.133406 [debug] [Thread-1  ]: finished collecting timing info
02:15:22.133814 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:15:22.198990 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:15:22.199286 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
02:15:22.199531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:15:22.219866 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
02:15:22.220846 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:15:22.221297 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer)
  
02:15:22.232572 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
02:15:22.258785 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:15:22.259143 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev"."orders" ("order_id", "user_id", "product_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:15:22.266086 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.01 seconds
02:15:22.271683 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
02:15:22.286043 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:15:22.286382 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:15:22.286628 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:15:22.290672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:15:22.291535 [debug] [Thread-1  ]: finished collecting timing info
02:15:22.291855 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
02:15:22.292563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce497e30-d68c-42b3-86a1-f6220ca62ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9963510>]}
02:15:22.293084 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.orders........................................... [[32mINSERT 5[0m in 0.16s]
02:15:22.293874 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:15:22.294249 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:15:22.294651 [info ] [Thread-1  ]: 2 of 3 START seed file dev.products............................................. [RUN]
02:15:22.295352 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:15:22.295615 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:15:22.295880 [debug] [Thread-1  ]: finished collecting timing info
02:15:22.296138 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:15:22.302776 [debug] [Thread-1  ]: finished collecting timing info
02:15:22.303384 [debug] [Thread-1  ]: Compilation Error in seed products (seeds/products.csv)
  Row 2 has 4 values, but Table only has 3 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed products (seeds/products.csv)
02:15:22.304011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce497e30-d68c-42b3-86a1-f6220ca62ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9980210>]}
02:15:22.304722 [error] [Thread-1  ]: 2 of 3 ERROR loading seed file dev.products..................................... [[31mERROR[0m in 0.01s]
02:15:22.305696 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:15:22.306258 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:15:22.307001 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
02:15:22.308252 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:15:22.308807 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:15:22.309298 [debug] [Thread-1  ]: finished collecting timing info
02:15:22.309754 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:15:22.324947 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:15:22.327428 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
02:15:22.327835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:15:22.364890 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
02:15:22.365597 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:15:22.366275 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
02:15:22.395264 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.03 seconds
02:15:22.403569 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:15:22.403912 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
02:15:22.407247 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:15:22.408162 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
02:15:22.410506 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:15:22.410828 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:15:22.411148 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:15:22.414654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:15:22.415691 [debug] [Thread-1  ]: finished collecting timing info
02:15:22.416147 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
02:15:22.418380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce497e30-d68c-42b3-86a1-f6220ca62ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9980690>]}
02:15:22.419630 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mINSERT 5[0m in 0.11s]
02:15:22.420944 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:15:22.448834 [debug] [MainThread]: Acquiring new postgres connection "master"
02:15:22.449496 [debug] [MainThread]: Using postgres connection "master"
02:15:22.449971 [debug] [MainThread]: On master: BEGIN
02:15:22.451513 [debug] [MainThread]: Opening a new connection, currently in state closed
02:15:22.472052 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:15:22.472719 [debug] [MainThread]: On master: COMMIT
02:15:22.473511 [debug] [MainThread]: Using postgres connection "master"
02:15:22.474469 [debug] [MainThread]: On master: COMMIT
02:15:22.479370 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:15:22.479781 [debug] [MainThread]: On master: Close
02:15:22.480640 [info ] [MainThread]: 
02:15:22.485459 [info ] [MainThread]: Finished running 3 seeds in 0.57s.
02:15:22.486072 [debug] [MainThread]: Connection 'master' was properly closed.
02:15:22.486424 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
02:15:22.496267 [info ] [MainThread]: 
02:15:22.500455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:15:22.502475 [info ] [MainThread]: 
02:15:22.503912 [error] [MainThread]: [33mCompilation Error in seed products (seeds/products.csv)[0m
02:15:22.505352 [error] [MainThread]:   Row 2 has 4 values, but Table only has 3 columns.
02:15:22.505805 [error] [MainThread]:   
02:15:22.506186 [error] [MainThread]:   > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
02:15:22.506750 [error] [MainThread]:   > called by seed products (seeds/products.csv)
02:15:22.507921 [info ] [MainThread]: 
02:15:22.509559 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
02:15:22.510235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9970ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f98fbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f98fb6d0>]}


============================== 2021-12-26 02:21:23.359486 | 83981ae0-5afd-45bb-8204-dacb056c4a9d ==============================
02:21:23.359486 [info ] [MainThread]: Running with dbt=1.0.0
02:21:23.361909 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
02:21:23.363416 [debug] [MainThread]: Tracking: tracking
02:21:23.399017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a77c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a77ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a77cb90>]}
02:21:23.433006 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:21:23.433693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83981ae0-5afd-45bb-8204-dacb056c4a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a94ffd0>]}
02:21:23.559458 [debug] [MainThread]: Parsing macros/catalog.sql
02:21:23.573797 [debug] [MainThread]: Parsing macros/relations.sql
02:21:23.576153 [debug] [MainThread]: Parsing macros/adapters.sql
02:21:23.649163 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
02:21:23.657263 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:21:23.669194 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:21:23.675741 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:21:23.681921 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:21:23.730245 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:21:23.760350 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:21:23.792989 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:21:23.808238 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:21:23.811234 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:21:23.824446 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:21:23.840488 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:21:23.874145 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:21:23.877473 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:21:23.907193 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:21:23.945616 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:21:23.965677 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:21:23.973536 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:21:23.992145 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:21:23.995078 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:21:24.005235 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:21:24.008912 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:21:24.025734 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:21:24.086012 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:21:24.091962 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:21:24.109804 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:21:24.122303 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:21:24.123769 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:21:24.124679 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:21:24.125739 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:21:24.133262 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:21:24.141601 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:21:24.158528 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:21:24.162240 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:21:24.166272 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:21:24.180581 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:21:24.184964 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:21:24.191321 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:21:24.203145 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:21:24.217607 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:21:24.478314 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
02:21:24.493763 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
02:21:24.577404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.example
- seeds.users

02:21:24.591829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83981ae0-5afd-45bb-8204-dacb056c4a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe49ce5bd0>]}
02:21:24.602080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83981ae0-5afd-45bb-8204-dacb056c4a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a98f410>]}
02:21:24.603129 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:21:24.605358 [info ] [MainThread]: 
02:21:24.606590 [debug] [MainThread]: Acquiring new postgres connection "master"
02:21:24.608255 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
02:21:24.636083 [debug] [ThreadPool]: Using postgres connection "list_dbt"
02:21:24.636410 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
02:21:24.636631 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:21:24.686933 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
02:21:24.690024 [debug] [ThreadPool]: On list_dbt: Close
02:21:24.691603 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_dev"
02:21:24.692684 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_dev"
02:21:24.693430 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_dev', identifier=None)"
02:21:24.707809 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_dev"
02:21:24.708158 [debug] [ThreadPool]: On create_dbt_dev_dev: BEGIN
02:21:24.708419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:21:24.725712 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:21:24.726368 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_dev"
02:21:24.726833 [debug] [ThreadPool]: On create_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "create_dbt_dev_dev"} */
create schema if not exists "dev_dev"
02:21:24.731054 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
02:21:24.733363 [debug] [ThreadPool]: On create_dbt_dev_dev: COMMIT
02:21:24.734020 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_dev"
02:21:24.734445 [debug] [ThreadPool]: On create_dbt_dev_dev: COMMIT
02:21:24.738567 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
02:21:24.738970 [debug] [ThreadPool]: On create_dbt_dev_dev: Close
02:21:24.741321 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:21:24.750562 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:21:24.750883 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:21:24.751121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:21:24.766606 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:21:24.767255 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:21:24.767808 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:21:24.774521 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
02:21:24.776686 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:21:24.779633 [debug] [ThreadPool]: On list_dbt_dev: Close
02:21:24.780946 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:21:24.783641 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:21:24.783988 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:21:24.784388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:21:24.800630 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:21:24.801536 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:21:24.801998 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:21:24.808170 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
02:21:24.810739 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:21:24.813782 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:21:24.823620 [debug] [MainThread]: Using postgres connection "master"
02:21:24.823952 [debug] [MainThread]: On master: BEGIN
02:21:24.824195 [debug] [MainThread]: Opening a new connection, currently in state init
02:21:24.838523 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:21:24.839292 [debug] [MainThread]: Using postgres connection "master"
02:21:24.839703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:21:24.848960 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
02:21:24.850606 [debug] [MainThread]: On master: ROLLBACK
02:21:24.852893 [debug] [MainThread]: Using postgres connection "master"
02:21:24.853304 [debug] [MainThread]: On master: BEGIN
02:21:24.857073 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:21:24.857733 [debug] [MainThread]: On master: COMMIT
02:21:24.858105 [debug] [MainThread]: Using postgres connection "master"
02:21:24.858404 [debug] [MainThread]: On master: COMMIT
02:21:24.861842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:21:24.862607 [debug] [MainThread]: On master: Close
02:21:24.863604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:21:24.864913 [info ] [MainThread]: 
02:21:24.871687 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:21:24.872484 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
02:21:24.873400 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:21:24.873940 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:21:24.874328 [debug] [Thread-1  ]: finished collecting timing info
02:21:24.874815 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:21:24.926310 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:21:24.926561 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
02:21:24.926758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:21:24.943199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
02:21:24.944470 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:21:24.944930 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer)
  
02:21:24.956229 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
02:21:24.986561 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:21:24.986994 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:21:24.990045 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:21:24.996759 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
02:21:25.056798 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:21:25.057347 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:21:25.057617 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:21:25.061713 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:21:25.062443 [debug] [Thread-1  ]: finished collecting timing info
02:21:25.062714 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
02:21:25.063319 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83981ae0-5afd-45bb-8204-dacb056c4a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4aa14f90>]}
02:21:25.064007 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mINSERT 5[0m in 0.19s]
02:21:25.064781 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:21:25.065089 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:21:25.065442 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
02:21:25.067327 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:21:25.067698 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:21:25.068019 [debug] [Thread-1  ]: finished collecting timing info
02:21:25.068297 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:21:25.074260 [debug] [Thread-1  ]: finished collecting timing info
02:21:25.074919 [debug] [Thread-1  ]: Compilation Error in seed products (seeds/products.csv)
  Row 2 has 4 values, but Table only has 3 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed products (seeds/products.csv)
02:21:25.075410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83981ae0-5afd-45bb-8204-dacb056c4a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a88c5d0>]}
02:21:25.075843 [error] [Thread-1  ]: 2 of 3 ERROR loading seed file dev_dev.products................................. [[31mERROR[0m in 0.01s]
02:21:25.077247 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:21:25.078250 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:21:25.078815 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
02:21:25.080397 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:21:25.081192 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:21:25.083604 [debug] [Thread-1  ]: finished collecting timing info
02:21:25.084245 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:21:25.096656 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:21:25.097490 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
02:21:25.097763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:21:25.116022 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
02:21:25.116713 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:21:25.117079 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
02:21:25.131646 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
02:21:25.136981 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:21:25.137307 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
02:21:25.139478 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:21:25.140127 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
02:21:25.142457 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:21:25.142769 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:21:25.143038 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:21:25.146327 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:21:25.147148 [debug] [Thread-1  ]: finished collecting timing info
02:21:25.147467 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
02:21:25.148356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83981ae0-5afd-45bb-8204-dacb056c4a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a88c1d0>]}
02:21:25.149307 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.07s]
02:21:25.150488 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:21:25.188150 [debug] [MainThread]: Acquiring new postgres connection "master"
02:21:25.188763 [debug] [MainThread]: Using postgres connection "master"
02:21:25.189162 [debug] [MainThread]: On master: BEGIN
02:21:25.189529 [debug] [MainThread]: Opening a new connection, currently in state closed
02:21:25.207276 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:21:25.207715 [debug] [MainThread]: On master: COMMIT
02:21:25.207991 [debug] [MainThread]: Using postgres connection "master"
02:21:25.208244 [debug] [MainThread]: On master: COMMIT
02:21:25.211550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:21:25.212207 [debug] [MainThread]: On master: Close
02:21:25.213073 [info ] [MainThread]: 
02:21:25.213911 [info ] [MainThread]: Finished running 3 seeds in 0.61s.
02:21:25.215029 [debug] [MainThread]: Connection 'master' was properly closed.
02:21:25.215645 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
02:21:25.224850 [info ] [MainThread]: 
02:21:25.225989 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:21:25.226885 [info ] [MainThread]: 
02:21:25.227599 [error] [MainThread]: [33mCompilation Error in seed products (seeds/products.csv)[0m
02:21:25.228981 [error] [MainThread]:   Row 2 has 4 values, but Table only has 3 columns.
02:21:25.230884 [error] [MainThread]:   
02:21:25.233401 [error] [MainThread]:   > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
02:21:25.233936 [error] [MainThread]:   > called by seed products (seeds/products.csv)
02:21:25.234412 [info ] [MainThread]: 
02:21:25.234869 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
02:21:25.235405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4a83c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4aab4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffe4aab44d0>]}


============================== 2021-12-26 02:24:06.220280 | 45829c3c-e568-4afa-9e80-55573147355d ==============================
02:24:06.220280 [info ] [MainThread]: Running with dbt=1.0.0
02:24:06.221740 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
02:24:06.222196 [debug] [MainThread]: Tracking: tracking
02:24:06.241664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e7f5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e8015d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e7f53d0>]}
02:24:06.281996 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:24:06.282644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45829c3c-e568-4afa-9e80-55573147355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e9d4fd0>]}
02:24:06.322353 [debug] [MainThread]: Parsing macros/catalog.sql
02:24:06.332733 [debug] [MainThread]: Parsing macros/relations.sql
02:24:06.336299 [debug] [MainThread]: Parsing macros/adapters.sql
02:24:06.375958 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
02:24:06.378429 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:24:06.385025 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:24:06.390074 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:24:06.392606 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:24:06.417319 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:24:06.433748 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:24:06.450704 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:24:06.457118 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:24:06.459687 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:24:06.462348 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:24:06.468991 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:24:06.485652 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:24:06.487950 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:24:06.502842 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:24:06.524820 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:24:06.535526 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:24:06.539685 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:24:06.549964 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:24:06.551909 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:24:06.555720 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:24:06.559031 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:24:06.567730 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:24:06.590730 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:24:06.592919 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:24:06.596386 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:24:06.598603 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:24:06.599852 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:24:06.600663 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:24:06.601672 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:24:06.603809 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:24:06.610070 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:24:06.622009 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:24:06.625165 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:24:06.628978 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:24:06.642341 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:24:06.646457 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:24:06.653025 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:24:06.663321 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:24:06.677196 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:24:06.926193 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
02:24:06.940896 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
02:24:07.027888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.orders
- seeds.users

02:24:07.037156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45829c3c-e568-4afa-9e80-55573147355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e9ca790>]}
02:24:07.048260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45829c3c-e568-4afa-9e80-55573147355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0ea11fd0>]}
02:24:07.048914 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:24:07.053044 [info ] [MainThread]: 
02:24:07.053979 [debug] [MainThread]: Acquiring new postgres connection "master"
02:24:07.055502 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
02:24:07.072953 [debug] [ThreadPool]: Using postgres connection "list_dbt"
02:24:07.074479 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
02:24:07.075131 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:24:07.134197 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
02:24:07.136370 [debug] [ThreadPool]: On list_dbt: Close
02:24:07.139566 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:24:07.153591 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:24:07.153975 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:24:07.154298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:24:07.172527 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:24:07.173231 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:24:07.173523 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:24:07.181101 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
02:24:07.183181 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:24:07.185711 [debug] [ThreadPool]: On list_dbt_dev: Close
02:24:07.186907 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:24:07.189321 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:24:07.189831 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:24:07.190446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:24:07.205831 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:24:07.206298 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:24:07.206645 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:24:07.211449 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
02:24:07.213687 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:24:07.216098 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:24:07.224735 [debug] [MainThread]: Using postgres connection "master"
02:24:07.225305 [debug] [MainThread]: On master: BEGIN
02:24:07.225582 [debug] [MainThread]: Opening a new connection, currently in state init
02:24:07.244483 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:24:07.245129 [debug] [MainThread]: Using postgres connection "master"
02:24:07.245659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:24:07.256596 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
02:24:07.258235 [debug] [MainThread]: On master: ROLLBACK
02:24:07.260285 [debug] [MainThread]: Using postgres connection "master"
02:24:07.260648 [debug] [MainThread]: On master: BEGIN
02:24:07.265507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:24:07.266254 [debug] [MainThread]: On master: COMMIT
02:24:07.266622 [debug] [MainThread]: Using postgres connection "master"
02:24:07.266964 [debug] [MainThread]: On master: COMMIT
02:24:07.270507 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:24:07.271306 [debug] [MainThread]: On master: Close
02:24:07.272476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:24:07.273002 [info ] [MainThread]: 
02:24:07.282531 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:24:07.283090 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
02:24:07.283827 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:24:07.284093 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:24:07.284364 [debug] [Thread-1  ]: finished collecting timing info
02:24:07.284604 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:24:07.341759 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:07.342110 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
02:24:07.342350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:07.361454 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
02:24:07.361936 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:07.362279 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
02:24:07.371721 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
02:24:07.402555 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:07.402903 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:24:07.406637 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:24:07.412519 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
02:24:07.421608 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:24:07.421956 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:07.422214 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:24:07.428123 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
02:24:07.429505 [debug] [Thread-1  ]: finished collecting timing info
02:24:07.430157 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
02:24:07.431233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45829c3c-e568-4afa-9e80-55573147355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e943050>]}
02:24:07.432283 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mINSERT 5[0m in 0.15s]
02:24:07.433588 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:24:07.434301 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:24:07.434998 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
02:24:07.436296 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:24:07.436831 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:24:07.437259 [debug] [Thread-1  ]: finished collecting timing info
02:24:07.437530 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:24:07.500089 [debug] [Thread-1  ]: finished collecting timing info
02:24:07.500603 [debug] [Thread-1  ]: Compilation Error in seed products (seeds/products.csv)
  Row 2 has 4 values, but Table only has 3 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by seed products (seeds/products.csv)
02:24:07.500997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45829c3c-e568-4afa-9e80-55573147355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e920b10>]}
02:24:07.501481 [error] [Thread-1  ]: 2 of 3 ERROR loading seed file dev_dev.products................................. [[31mERROR[0m in 0.07s]
02:24:07.502107 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:24:07.502461 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:24:07.502911 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
02:24:07.505522 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:24:07.505909 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:24:07.506264 [debug] [Thread-1  ]: finished collecting timing info
02:24:07.506865 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:24:07.516092 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:07.516580 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
02:24:07.517159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:07.547593 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
02:24:07.548079 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:07.548606 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
02:24:07.567435 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.02 seconds
02:24:07.574832 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:07.575140 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
02:24:07.577895 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:24:07.578510 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
02:24:07.580816 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:24:07.581294 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:07.581577 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:24:07.586636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:24:07.588200 [debug] [Thread-1  ]: finished collecting timing info
02:24:07.588764 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
02:24:07.590226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45829c3c-e568-4afa-9e80-55573147355d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e920510>]}
02:24:07.591137 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.08s]
02:24:07.592177 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:24:07.603375 [debug] [MainThread]: Acquiring new postgres connection "master"
02:24:07.603903 [debug] [MainThread]: Using postgres connection "master"
02:24:07.604242 [debug] [MainThread]: On master: BEGIN
02:24:07.604529 [debug] [MainThread]: Opening a new connection, currently in state closed
02:24:07.645918 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
02:24:07.646597 [debug] [MainThread]: On master: COMMIT
02:24:07.646973 [debug] [MainThread]: Using postgres connection "master"
02:24:07.647270 [debug] [MainThread]: On master: COMMIT
02:24:07.650572 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:24:07.651214 [debug] [MainThread]: On master: Close
02:24:07.652482 [info ] [MainThread]: 
02:24:07.656189 [info ] [MainThread]: Finished running 3 seeds in 0.60s.
02:24:07.656762 [debug] [MainThread]: Connection 'master' was properly closed.
02:24:07.657117 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
02:24:07.667495 [info ] [MainThread]: 
02:24:07.669313 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:24:07.670965 [info ] [MainThread]: 
02:24:07.673349 [error] [MainThread]: [33mCompilation Error in seed products (seeds/products.csv)[0m
02:24:07.674381 [error] [MainThread]:   Row 2 has 4 values, but Table only has 3 columns.
02:24:07.674988 [error] [MainThread]:   
02:24:07.675377 [error] [MainThread]:   > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
02:24:07.676157 [error] [MainThread]:   > called by seed products (seeds/products.csv)
02:24:07.676793 [info ] [MainThread]: 
02:24:07.677691 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
02:24:07.678859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0e920850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0eae09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0eae0350>]}


============================== 2021-12-26 02:24:30.530057 | 0fea3fe3-73e2-4fda-bd85-942123c17b9d ==============================
02:24:30.530057 [info ] [MainThread]: Running with dbt=1.0.0
02:24:30.532603 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
02:24:30.534158 [debug] [MainThread]: Tracking: tracking
02:24:30.557673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfbeb6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfbeb6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfbeb6cd0>]}
02:24:30.624029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:24:30.625241 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://seeds/products.csv
02:24:30.678149 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.users
- seeds.products

02:24:30.686947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fea3fe3-73e2-4fda-bd85-942123c17b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfb489b90>]}
02:24:30.698832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fea3fe3-73e2-4fda-bd85-942123c17b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfc18f0d0>]}
02:24:30.700282 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:24:30.705285 [info ] [MainThread]: 
02:24:30.706824 [debug] [MainThread]: Acquiring new postgres connection "master"
02:24:30.709707 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
02:24:30.732031 [debug] [ThreadPool]: Using postgres connection "list_dbt"
02:24:30.732389 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
02:24:30.732642 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:24:30.792159 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
02:24:30.795458 [debug] [ThreadPool]: On list_dbt: Close
02:24:30.799286 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:24:30.811061 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:24:30.811634 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:24:30.812041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:24:30.834554 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:24:30.835110 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:24:30.835899 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:24:30.847312 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
02:24:30.850867 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:24:30.853868 [debug] [ThreadPool]: On list_dbt_dev: Close
02:24:30.855293 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:24:30.863119 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:24:30.863885 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:24:30.865020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:24:30.887561 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:24:30.888066 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:24:30.888454 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:24:30.898353 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
02:24:30.901050 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:24:30.903982 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:24:30.913201 [debug] [MainThread]: Using postgres connection "master"
02:24:30.913574 [debug] [MainThread]: On master: BEGIN
02:24:30.913839 [debug] [MainThread]: Opening a new connection, currently in state init
02:24:30.930891 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:24:30.931452 [debug] [MainThread]: Using postgres connection "master"
02:24:30.931850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:24:30.948034 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
02:24:30.949995 [debug] [MainThread]: On master: ROLLBACK
02:24:30.952416 [debug] [MainThread]: Using postgres connection "master"
02:24:30.952795 [debug] [MainThread]: On master: BEGIN
02:24:30.957067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:24:30.957771 [debug] [MainThread]: On master: COMMIT
02:24:30.958187 [debug] [MainThread]: Using postgres connection "master"
02:24:30.959111 [debug] [MainThread]: On master: COMMIT
02:24:30.962318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:24:30.962918 [debug] [MainThread]: On master: Close
02:24:30.964414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:24:30.965985 [info ] [MainThread]: 
02:24:30.971655 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:24:30.972936 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
02:24:30.974234 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:24:30.975282 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:24:30.975773 [debug] [Thread-1  ]: finished collecting timing info
02:24:30.976818 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:24:31.047380 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:31.047823 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
02:24:31.048141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:31.069003 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
02:24:31.070324 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:31.070795 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
02:24:31.076040 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
02:24:31.109574 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:31.109911 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:24:31.115142 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:24:31.120701 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
02:24:31.129430 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:24:31.129758 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:31.129999 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:24:31.134063 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:24:31.134927 [debug] [Thread-1  ]: finished collecting timing info
02:24:31.135249 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
02:24:31.136470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fea3fe3-73e2-4fda-bd85-942123c17b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfc117550>]}
02:24:31.137566 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mINSERT 5[0m in 0.16s]
02:24:31.139323 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:24:31.139794 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:24:31.141096 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
02:24:31.153144 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:24:31.153671 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:24:31.154228 [debug] [Thread-1  ]: finished collecting timing info
02:24:31.154665 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:24:31.184983 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:31.185623 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
02:24:31.186047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:31.218428 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
02:24:31.220098 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:31.221620 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
02:24:31.235780 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
02:24:31.239486 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:31.239810 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:24:31.244904 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
02:24:31.245472 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
02:24:31.253333 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
02:24:31.253662 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:31.253879 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
02:24:31.257816 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:24:31.258535 [debug] [Thread-1  ]: finished collecting timing info
02:24:31.258801 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
02:24:31.259486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fea3fe3-73e2-4fda-bd85-942123c17b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfc10ab50>]}
02:24:31.259958 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.11s]
02:24:31.260598 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:24:31.262142 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:24:31.263116 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
02:24:31.265053 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:24:31.265839 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:24:31.268494 [debug] [Thread-1  ]: finished collecting timing info
02:24:31.269042 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:24:31.291731 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:31.293828 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
02:24:31.294334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:31.326746 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
02:24:31.327494 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:31.327963 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
02:24:31.343156 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
02:24:31.350852 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:31.351197 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
02:24:31.356498 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:24:31.357873 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
02:24:31.363158 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:24:31.363617 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:31.364072 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:24:31.372673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
02:24:31.373858 [debug] [Thread-1  ]: finished collecting timing info
02:24:31.374205 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
02:24:31.375128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fea3fe3-73e2-4fda-bd85-942123c17b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfc10a2d0>]}
02:24:31.375978 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.11s]
02:24:31.377023 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:24:31.392767 [debug] [MainThread]: Acquiring new postgres connection "master"
02:24:31.393488 [debug] [MainThread]: Using postgres connection "master"
02:24:31.394049 [debug] [MainThread]: On master: BEGIN
02:24:31.394417 [debug] [MainThread]: Opening a new connection, currently in state closed
02:24:31.416342 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:24:31.417199 [debug] [MainThread]: On master: COMMIT
02:24:31.417854 [debug] [MainThread]: Using postgres connection "master"
02:24:31.418463 [debug] [MainThread]: On master: COMMIT
02:24:31.426511 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
02:24:31.427343 [debug] [MainThread]: On master: Close
02:24:31.428407 [info ] [MainThread]: 
02:24:31.429603 [info ] [MainThread]: Finished running 3 seeds in 0.72s.
02:24:31.430260 [debug] [MainThread]: Connection 'master' was properly closed.
02:24:31.430645 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
02:24:31.445051 [info ] [MainThread]: 
02:24:31.445658 [info ] [MainThread]: [32mCompleted successfully[0m
02:24:31.446394 [info ] [MainThread]: 
02:24:31.447126 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
02:24:31.447865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfc17f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfbfbabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dfbfba550>]}


============================== 2021-12-26 02:24:43.525954 | bfe82218-e29e-4197-9f97-4dd934702992 ==============================
02:24:43.525954 [info ] [MainThread]: Running with dbt=1.0.0
02:24:43.527115 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
02:24:43.528790 [debug] [MainThread]: Tracking: tracking
02:24:43.545195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a6eb6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a6eb6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a6eb6c50>]}
02:24:43.578475 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:24:43.579432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfe82218-e29e-4197-9f97-4dd934702992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a7094f90>]}
02:24:43.613340 [debug] [MainThread]: Parsing macros/catalog.sql
02:24:43.619117 [debug] [MainThread]: Parsing macros/relations.sql
02:24:43.621065 [debug] [MainThread]: Parsing macros/adapters.sql
02:24:43.659976 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
02:24:43.662511 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:24:43.669503 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:24:43.674373 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:24:43.677051 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:24:43.707801 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:24:43.726467 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:24:43.746203 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:24:43.752869 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:24:43.755515 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:24:43.758129 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:24:43.766783 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:24:43.787561 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:24:43.789874 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:24:43.806534 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:24:43.843563 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:24:43.857591 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:24:43.862243 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:24:43.874011 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:24:43.876084 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:24:43.881593 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:24:43.885173 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:24:43.897263 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:24:43.925541 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:24:43.928991 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:24:43.932679 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:24:43.936438 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:24:43.937846 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:24:43.938723 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:24:43.939784 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:24:43.943388 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:24:43.951317 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:24:43.965187 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:24:43.969550 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:24:43.974803 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:24:43.991384 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:24:43.995786 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:24:44.005299 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:24:44.022913 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:24:44.042548 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:24:44.386818 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
02:24:44.404559 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
02:24:44.597828 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.products
- seeds.users

02:24:44.618786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfe82218-e29e-4197-9f97-4dd934702992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a70a8710>]}
02:24:44.629360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfe82218-e29e-4197-9f97-4dd934702992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a70acf50>]}
02:24:44.629841 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:24:44.631977 [info ] [MainThread]: 
02:24:44.636706 [debug] [MainThread]: Acquiring new postgres connection "master"
02:24:44.641200 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
02:24:44.655210 [debug] [ThreadPool]: Using postgres connection "list_dbt"
02:24:44.655547 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
02:24:44.655772 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:24:44.677703 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
02:24:44.680505 [debug] [ThreadPool]: On list_dbt: Close
02:24:44.683469 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:24:44.694757 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:24:44.695773 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:24:44.696435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:24:44.717152 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:24:44.718587 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:24:44.718992 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:24:44.725754 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
02:24:44.727636 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:24:44.730456 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:24:44.731643 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:24:44.734275 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:24:44.734655 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:24:44.734935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:24:44.757033 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:24:44.757627 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:24:44.758039 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:24:44.765656 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
02:24:44.767648 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:24:44.771955 [debug] [ThreadPool]: On list_dbt_dev: Close
02:24:44.786334 [debug] [MainThread]: Using postgres connection "master"
02:24:44.786832 [debug] [MainThread]: On master: BEGIN
02:24:44.787378 [debug] [MainThread]: Opening a new connection, currently in state init
02:24:44.806489 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:24:44.807221 [debug] [MainThread]: Using postgres connection "master"
02:24:44.807942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:24:44.822552 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
02:24:44.824854 [debug] [MainThread]: On master: ROLLBACK
02:24:44.826895 [debug] [MainThread]: Using postgres connection "master"
02:24:44.827295 [debug] [MainThread]: On master: BEGIN
02:24:44.832958 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:24:44.833849 [debug] [MainThread]: On master: COMMIT
02:24:44.835011 [debug] [MainThread]: Using postgres connection "master"
02:24:44.835622 [debug] [MainThread]: On master: COMMIT
02:24:44.849236 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
02:24:44.849981 [debug] [MainThread]: On master: Close
02:24:44.851265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:24:44.852343 [info ] [MainThread]: 
02:24:44.874941 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:24:44.876235 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
02:24:44.878035 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:24:44.879223 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:24:44.879991 [debug] [Thread-1  ]: finished collecting timing info
02:24:44.880473 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:24:45.179853 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:45.180204 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
02:24:45.180860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:45.208029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
02:24:45.208964 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:45.210069 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
02:24:45.221864 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
02:24:45.261769 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:45.262163 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:24:45.267372 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:24:45.283885 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
02:24:45.295889 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:24:45.296252 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:24:45.296496 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:24:45.302664 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
02:24:45.304450 [debug] [Thread-1  ]: finished collecting timing info
02:24:45.305195 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
02:24:45.306802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfe82218-e29e-4197-9f97-4dd934702992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a71f5350>]}
02:24:45.308734 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mINSERT 5[0m in 0.43s]
02:24:45.309770 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:24:45.313955 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:24:45.315019 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
02:24:45.316152 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:24:45.317866 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:24:45.318728 [debug] [Thread-1  ]: finished collecting timing info
02:24:45.319364 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:24:45.413727 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:45.414097 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
02:24:45.414356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:45.440745 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
02:24:45.441846 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:45.442307 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
truncate table "dbt"."dev_dev"."products"
02:24:45.462384 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.02 seconds
02:24:45.470209 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:45.470688 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:24:45.476203 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.01 seconds
02:24:45.479289 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
02:24:45.484642 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
02:24:45.486686 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:24:45.493593 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
02:24:45.511921 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
02:24:45.515437 [debug] [Thread-1  ]: finished collecting timing info
02:24:45.516106 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
02:24:45.518079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfe82218-e29e-4197-9f97-4dd934702992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a720c210>]}
02:24:45.533197 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.20s]
02:24:45.534225 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:24:45.538066 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:24:45.541321 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
02:24:45.548888 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:24:45.550848 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:24:45.551974 [debug] [Thread-1  ]: finished collecting timing info
02:24:45.552611 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:24:45.577822 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:45.578565 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
02:24:45.579118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:24:45.627132 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
02:24:45.627848 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:45.635214 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
02:24:45.800412 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.15 seconds
02:24:45.902929 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:45.903466 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
02:24:45.917469 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.01 seconds
02:24:45.919615 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
02:24:45.957196 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:24:45.970390 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:24:45.979229 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:24:46.017783 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
02:24:46.022549 [debug] [Thread-1  ]: finished collecting timing info
02:24:46.025984 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
02:24:46.033402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfe82218-e29e-4197-9f97-4dd934702992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a6fe4d90>]}
02:24:46.034297 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.49s]
02:24:46.041796 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:24:46.058890 [debug] [MainThread]: Acquiring new postgres connection "master"
02:24:46.059793 [debug] [MainThread]: Using postgres connection "master"
02:24:46.060380 [debug] [MainThread]: On master: BEGIN
02:24:46.060855 [debug] [MainThread]: Opening a new connection, currently in state closed
02:24:46.102889 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
02:24:46.103982 [debug] [MainThread]: On master: COMMIT
02:24:46.104464 [debug] [MainThread]: Using postgres connection "master"
02:24:46.104719 [debug] [MainThread]: On master: COMMIT
02:24:46.108417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:24:46.109038 [debug] [MainThread]: On master: Close
02:24:46.110074 [info ] [MainThread]: 
02:24:46.111476 [info ] [MainThread]: Finished running 3 seeds in 1.48s.
02:24:46.112959 [debug] [MainThread]: Connection 'master' was properly closed.
02:24:46.113375 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
02:24:46.125122 [info ] [MainThread]: 
02:24:46.126116 [info ] [MainThread]: [32mCompleted successfully[0m
02:24:46.128236 [info ] [MainThread]: 
02:24:46.129055 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
02:24:46.130672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a720c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a710c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a710c8d0>]}


============================== 2021-12-26 02:26:00.696320 | 188828ce-51c3-471d-8a2a-30aff07b14e3 ==============================
02:26:00.696320 [info ] [MainThread]: Running with dbt=1.0.0
02:26:00.697582 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
02:26:00.697945 [debug] [MainThread]: Tracking: tracking
02:26:00.729511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9168ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9168a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9168a850>]}
02:26:00.798183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:26:00.798554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:26:00.799699 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.users
- seeds.products

02:26:00.834196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '188828ce-51c3-471d-8a2a-30aff07b14e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb92179cd0>]}
02:26:00.845354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '188828ce-51c3-471d-8a2a-30aff07b14e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9218bd50>]}
02:26:00.845860 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:26:00.848760 [info ] [MainThread]: 
02:26:00.850020 [debug] [MainThread]: Acquiring new postgres connection "master"
02:26:00.851694 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:26:00.878568 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:26:00.878980 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:26:00.879331 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:26:00.933091 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
02:26:00.933855 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:26:00.934585 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:26:00.942693 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
02:26:00.945612 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:26:00.948293 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:26:00.949647 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:26:00.954443 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:26:00.955152 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:26:00.955790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:26:00.972564 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:26:00.973141 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:26:00.973490 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:26:00.979485 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
02:26:00.982639 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:26:00.986068 [debug] [ThreadPool]: On list_dbt_dev: Close
02:26:00.995249 [debug] [MainThread]: Using postgres connection "master"
02:26:00.995852 [debug] [MainThread]: On master: BEGIN
02:26:00.996108 [debug] [MainThread]: Opening a new connection, currently in state init
02:26:01.010846 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:26:01.011552 [debug] [MainThread]: Using postgres connection "master"
02:26:01.011914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:26:01.024965 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
02:26:01.026687 [debug] [MainThread]: On master: ROLLBACK
02:26:01.029008 [debug] [MainThread]: On master: Close
02:26:01.030000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:26:01.030776 [info ] [MainThread]: 
02:26:01.035458 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
02:26:01.036449 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
02:26:01.037290 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
02:26:01.037667 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
02:26:01.042033 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
02:26:01.045103 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.048105 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
02:26:01.048559 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.049528 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
02:26:01.050266 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:26:01.051069 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:26:01.051541 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:26:01.051851 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.orders
02:26:01.053929 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.orders"
02:26:01.054487 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.054984 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:26:01.055288 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.055891 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:26:01.056493 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:26:01.058604 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:26:01.059263 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:26:01.059872 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.products
02:26:01.063110 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.products"
02:26:01.063754 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.064312 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:26:01.064855 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.067690 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:26:01.068468 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:26:01.069547 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:26:01.069923 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:26:01.070249 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
02:26:01.072331 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
02:26:01.072767 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.073111 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:26:01.073476 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.075190 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:26:01.075905 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_second_dbt_model
02:26:01.076886 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_second_dbt_model"
02:26:01.077179 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_second_dbt_model
02:26:01.077426 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_second_dbt_model
02:26:01.080592 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_second_dbt_model"
02:26:01.082505 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.082861 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_second_dbt_model
02:26:01.083146 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.083752 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_second_dbt_model
02:26:01.084115 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
02:26:01.084691 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
02:26:01.085094 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
02:26:01.085411 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
02:26:01.101875 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710"
02:26:01.104328 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.104738 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
02:26:01.105062 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.105556 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_first_dbt_model_id.5fb22c2710
02:26:01.105835 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
02:26:01.106301 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
02:26:01.106534 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
02:26:01.106748 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
02:26:01.113930 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321"
02:26:01.114593 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.114847 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
02:26:01.115188 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.115717 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_first_dbt_model_id.16e066b321
02:26:01.115985 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
02:26:01.116441 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
02:26:01.116670 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
02:26:01.116887 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
02:26:01.121208 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778"
02:26:01.121895 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.122153 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
02:26:01.122381 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.122833 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_my_second_dbt_model_id.151b76d778
02:26:01.123096 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
02:26:01.123550 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
02:26:01.123779 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
02:26:01.123991 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
02:26:01.129373 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493"
02:26:01.130025 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.130277 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
02:26:01.130504 [debug] [Thread-1  ]: finished collecting timing info
02:26:01.130935 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493
02:26:01.138048 [debug] [MainThread]: Connection 'master' was properly closed.
02:26:01.138676 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
02:26:01.146258 [info ] [MainThread]: Done.
02:26:01.152567 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
02:26:01.153302 [info ] [MainThread]: Building catalog
02:26:01.157593 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
02:26:01.175415 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
02:26:01.175790 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
02:26:01.176055 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:26:01.258061 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
02:26:01.258466 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
02:26:01.258852 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev') or upper(sch.nspname) = upper('dev_dev'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
02:26:01.279580 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.02 seconds
02:26:01.295798 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
02:26:01.306392 [debug] [ThreadPool]: On dbt.information_schema: Close
02:26:01.339306 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dairflow/bungie_dwh/target/catalog.json
02:26:01.340787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9214d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb92119990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb92119790>]}
02:26:01.733152 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
02:26:01.733481 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-26 02:26:12.849019 | d435ae2b-5379-445f-af5d-729a3026db4f ==============================
02:26:12.849019 [info ] [MainThread]: Running with dbt=1.0.0
02:26:12.850170 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
02:26:12.851103 [debug] [MainThread]: Tracking: tracking
02:26:12.873318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff513eb7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff513eb7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff513eb7090>]}
02:26:12.880347 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:26:12.881508 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:26:12.881993 [info ] [MainThread]: 
02:26:12.882418 [info ] [MainThread]: 
02:26:12.883138 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 02:36:24.304053 | 20fe934b-53fa-4017-b361-f6da4be0f15d ==============================
02:36:24.304053 [info ] [MainThread]: Running with dbt=1.0.0
02:36:24.305730 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
02:36:24.306183 [debug] [MainThread]: Tracking: tracking
02:36:24.332564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ee776090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ee776050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ee776e10>]}
02:36:24.413144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
02:36:24.413829 [debug] [MainThread]: Partial parsing: added file: bungie_dwh://seeds/dev.yml
02:36:24.436471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.users
- seeds.orders
- seeds.products

02:36:24.450870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20fe934b-53fa-4017-b361-f6da4be0f15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ef118ad0>]}
02:36:24.463075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20fe934b-53fa-4017-b361-f6da4be0f15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ef14d490>]}
02:36:24.463533 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:36:24.465425 [info ] [MainThread]: 
02:36:24.466360 [debug] [MainThread]: Acquiring new postgres connection "master"
02:36:24.468345 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
02:36:24.495884 [debug] [ThreadPool]: Using postgres connection "list_dbt"
02:36:24.496256 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
02:36:24.496532 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:36:24.564684 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.07 seconds
02:36:24.567089 [debug] [ThreadPool]: On list_dbt: Close
02:36:24.570447 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:36:24.583560 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:36:24.583951 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:36:24.584232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:36:24.604888 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:36:24.605537 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:36:24.606094 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:36:24.613309 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
02:36:24.615007 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:36:24.617745 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:36:24.618763 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:36:24.622235 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:36:24.623457 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:36:24.623974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:36:24.640162 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:36:24.640813 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:36:24.641283 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:36:24.646826 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
02:36:24.649008 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:36:24.651481 [debug] [ThreadPool]: On list_dbt_dev: Close
02:36:24.659618 [debug] [MainThread]: Using postgres connection "master"
02:36:24.659964 [debug] [MainThread]: On master: BEGIN
02:36:24.660208 [debug] [MainThread]: Opening a new connection, currently in state init
02:36:24.677391 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:36:24.677923 [debug] [MainThread]: Using postgres connection "master"
02:36:24.678517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:36:24.694779 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
02:36:24.696441 [debug] [MainThread]: On master: ROLLBACK
02:36:24.698305 [debug] [MainThread]: Using postgres connection "master"
02:36:24.698685 [debug] [MainThread]: On master: BEGIN
02:36:24.703541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:36:24.704406 [debug] [MainThread]: On master: COMMIT
02:36:24.704911 [debug] [MainThread]: Using postgres connection "master"
02:36:24.705451 [debug] [MainThread]: On master: COMMIT
02:36:24.708140 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:36:24.708631 [debug] [MainThread]: On master: Close
02:36:24.709818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:36:24.710405 [info ] [MainThread]: 
02:36:24.716989 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:36:24.717578 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
02:36:24.718453 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:36:24.718813 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:36:24.719171 [debug] [Thread-1  ]: finished collecting timing info
02:36:24.719747 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:36:24.781753 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:36:24.782061 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
02:36:24.782266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:36:24.796745 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
02:36:24.797452 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:36:24.798346 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
02:36:24.801469 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
02:36:24.829280 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:36:24.829626 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:36:24.832184 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:36:24.838077 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
02:36:24.846943 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:36:24.847284 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
02:36:24.847536 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
02:36:24.851356 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:36:24.852266 [debug] [Thread-1  ]: finished collecting timing info
02:36:24.852580 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
02:36:24.853338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fe934b-53fa-4017-b361-f6da4be0f15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ef0f1e90>]}
02:36:24.853818 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mINSERT 5[0m in 0.14s]
02:36:24.854424 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:36:24.855324 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:36:24.856281 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
02:36:24.857664 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:36:24.858368 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:36:24.858945 [debug] [Thread-1  ]: finished collecting timing info
02:36:24.859343 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:36:24.871035 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:36:24.871731 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
02:36:24.872341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:36:24.904586 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
02:36:24.905209 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:36:24.905540 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
truncate table "dbt"."dev_dev"."products"
02:36:24.925685 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.02 seconds
02:36:24.930306 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:36:24.930667 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
02:36:24.939324 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.01 seconds
02:36:24.940059 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
02:36:24.942336 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
02:36:24.942673 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
02:36:24.942936 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
02:36:24.982949 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
02:36:24.983792 [debug] [Thread-1  ]: finished collecting timing info
02:36:24.984111 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
02:36:24.984830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fe934b-53fa-4017-b361-f6da4be0f15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ef0ff110>]}
02:36:24.985395 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.13s]
02:36:24.986093 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:36:24.986895 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:36:24.987570 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
02:36:24.988370 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:36:24.988671 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:36:24.988969 [debug] [Thread-1  ]: finished collecting timing info
02:36:24.989253 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:36:25.012822 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:36:25.013181 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
02:36:25.013431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:36:25.043045 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
02:36:25.044788 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:36:25.045374 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
02:36:25.058773 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
02:36:25.064312 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:36:25.064650 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
02:36:25.068133 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
02:36:25.068814 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
02:36:25.071214 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:36:25.071567 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
02:36:25.071826 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
02:36:25.076032 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
02:36:25.076933 [debug] [Thread-1  ]: finished collecting timing info
02:36:25.077246 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
02:36:25.078020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fe934b-53fa-4017-b361-f6da4be0f15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ef0c1d50>]}
02:36:25.078819 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.09s]
02:36:25.079507 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:36:25.135301 [debug] [MainThread]: Acquiring new postgres connection "master"
02:36:25.135913 [debug] [MainThread]: Using postgres connection "master"
02:36:25.136401 [debug] [MainThread]: On master: BEGIN
02:36:25.136907 [debug] [MainThread]: Opening a new connection, currently in state closed
02:36:25.162163 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
02:36:25.162952 [debug] [MainThread]: On master: COMMIT
02:36:25.163596 [debug] [MainThread]: Using postgres connection "master"
02:36:25.163938 [debug] [MainThread]: On master: COMMIT
02:36:25.166809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:36:25.167323 [debug] [MainThread]: On master: Close
02:36:25.168122 [info ] [MainThread]: 
02:36:25.169120 [info ] [MainThread]: Finished running 3 seeds in 0.70s.
02:36:25.169977 [debug] [MainThread]: Connection 'master' was properly closed.
02:36:25.170363 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
02:36:25.185088 [info ] [MainThread]: 
02:36:25.185970 [info ] [MainThread]: [32mCompleted successfully[0m
02:36:25.186930 [info ] [MainThread]: 
02:36:25.188016 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
02:36:25.189309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ec0609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ee771f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ef058850>]}


============================== 2021-12-26 02:43:58.610638 | b1b34f0e-b178-4f7c-a204-b0ef00666818 ==============================
02:43:58.610638 [info ] [MainThread]: Running with dbt=1.0.0
02:43:58.613252 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:43:58.614109 [debug] [MainThread]: Tracking: tracking
02:43:58.631850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa679e883d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa679e887d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa679e88c90>]}
02:43:58.721524 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
02:43:58.722272 [debug] [MainThread]: Partial parsing: update schema file: bungie_dwh://models/example/schema.yml
02:43:58.722590 [debug] [MainThread]: Partial parsing: deleted file: bungie_dwh://models/example/my_second_dbt_model.sql
02:43:58.723052 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/my_first_dbt_model.sql
02:43:58.738652 [debug] [MainThread]: 1603: static parser failed on example/my_first_dbt_model.sql
02:43:58.742074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67a96b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67a981250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa67a95ca90>]}


============================== 2021-12-26 02:44:34.984604 | 11135288-08a3-414d-b353-1971ff7eea28 ==============================
02:44:34.984604 [info ] [MainThread]: Running with dbt=1.0.0
02:44:34.985654 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
02:44:34.986542 [debug] [MainThread]: Tracking: tracking
02:44:35.009605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98eb6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98eb6dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98eb6d90>]}
02:44:35.081443 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
02:44:35.082360 [debug] [MainThread]: Partial parsing: update schema file: bungie_dwh://models/example/schema.yml
02:44:35.082749 [debug] [MainThread]: Partial parsing: deleted file: bungie_dwh://models/example/my_second_dbt_model.sql
02:44:35.083308 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/my_first_dbt_model.sql
02:44:35.099153 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
02:44:35.146783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.orders
- seeds.users

02:44:35.154716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11135288-08a3-414d-b353-1971ff7eea28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98542dd0>]}
02:44:35.170709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11135288-08a3-414d-b353-1971ff7eea28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb99091550>]}
02:44:35.172417 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:44:35.176001 [info ] [MainThread]: 
02:44:35.177204 [debug] [MainThread]: Acquiring new postgres connection "master"
02:44:35.178762 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
02:44:35.201558 [debug] [ThreadPool]: Using postgres connection "list_dbt"
02:44:35.202175 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
02:44:35.202777 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:44:35.264737 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
02:44:35.266655 [debug] [ThreadPool]: On list_dbt: Close
02:44:35.269561 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:44:35.280544 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:44:35.280880 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:44:35.281127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:44:35.305113 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:44:35.305878 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:44:35.306423 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:44:35.314794 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
02:44:35.316868 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:44:35.320508 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:44:35.322506 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:44:35.324944 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:44:35.325300 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:44:35.325575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:44:35.348044 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:44:35.348789 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:44:35.349193 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:44:35.354913 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
02:44:35.356981 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:44:35.359868 [debug] [ThreadPool]: On list_dbt_dev: Close
02:44:35.371815 [debug] [MainThread]: Using postgres connection "master"
02:44:35.373487 [debug] [MainThread]: On master: BEGIN
02:44:35.373802 [debug] [MainThread]: Opening a new connection, currently in state init
02:44:35.389671 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
02:44:35.390187 [debug] [MainThread]: Using postgres connection "master"
02:44:35.390693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:44:35.403142 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
02:44:35.404870 [debug] [MainThread]: On master: ROLLBACK
02:44:35.406778 [debug] [MainThread]: Using postgres connection "master"
02:44:35.407204 [debug] [MainThread]: On master: BEGIN
02:44:35.410283 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
02:44:35.411059 [debug] [MainThread]: On master: COMMIT
02:44:35.411773 [debug] [MainThread]: Using postgres connection "master"
02:44:35.412301 [debug] [MainThread]: On master: COMMIT
02:44:35.414782 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:44:35.415221 [debug] [MainThread]: On master: Close
02:44:35.416040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:44:35.416927 [info ] [MainThread]: 
02:44:35.423230 [debug] [Thread-1  ]: Began running node model.bungie_dwh.my_first_dbt_model
02:44:35.424025 [info ] [Thread-1  ]: 1 of 1 START table model dev.my_first_dbt_model................................. [RUN]
02:44:35.424855 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.my_first_dbt_model"
02:44:35.425165 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.my_first_dbt_model
02:44:35.425476 [debug] [Thread-1  ]: Compiling model.bungie_dwh.my_first_dbt_model
02:44:35.440895 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.my_first_dbt_model"
02:44:35.442417 [debug] [Thread-1  ]: finished collecting timing info
02:44:35.443166 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.my_first_dbt_model
02:44:35.496601 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.my_first_dbt_model"
02:44:35.497636 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
02:44:35.497938 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: BEGIN
02:44:35.498165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
02:44:35.517585 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
02:44:35.519343 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
02:44:35.520510 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */


  create  table "dbt"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    

SELECT
    *
FROM "dbt"."dev_dev"."users"
WHERE user_id BETWEEN 1 AND 3
  );
02:44:35.539237 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.02 seconds
02:44:35.546836 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
02:44:35.547133 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
02:44:35.550096 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:44:35.554538 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
02:44:35.554857 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
02:44:35.558475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
02:44:35.576841 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
02:44:35.577197 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
02:44:35.577466 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: COMMIT
02:44:35.584535 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
02:44:35.590968 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.my_first_dbt_model"
02:44:35.591307 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.my_first_dbt_model"} */
drop table if exists "dbt"."dev"."my_first_dbt_model__dbt_backup" cascade
02:44:35.600628 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
02:44:35.602594 [debug] [Thread-1  ]: finished collecting timing info
02:44:35.602998 [debug] [Thread-1  ]: On model.bungie_dwh.my_first_dbt_model: Close
02:44:35.604154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11135288-08a3-414d-b353-1971ff7eea28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb990698d0>]}
02:44:35.605022 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.my_first_dbt_model............................ [[32mSELECT 3[0m in 0.18s]
02:44:35.606994 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.my_first_dbt_model
02:44:35.628847 [debug] [MainThread]: Acquiring new postgres connection "master"
02:44:35.629327 [debug] [MainThread]: Using postgres connection "master"
02:44:35.629619 [debug] [MainThread]: On master: BEGIN
02:44:35.629863 [debug] [MainThread]: Opening a new connection, currently in state closed
02:44:35.657755 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
02:44:35.658445 [debug] [MainThread]: On master: COMMIT
02:44:35.658809 [debug] [MainThread]: Using postgres connection "master"
02:44:35.659199 [debug] [MainThread]: On master: COMMIT
02:44:35.661670 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
02:44:35.662125 [debug] [MainThread]: On master: Close
02:44:35.662762 [info ] [MainThread]: 
02:44:35.663283 [info ] [MainThread]: Finished running 1 table model in 0.49s.
02:44:35.664161 [debug] [MainThread]: Connection 'master' was properly closed.
02:44:35.664620 [debug] [MainThread]: Connection 'model.bungie_dwh.my_first_dbt_model' was properly closed.
02:44:35.675336 [info ] [MainThread]: 
02:44:35.676010 [info ] [MainThread]: [32mCompleted successfully[0m
02:44:35.676724 [info ] [MainThread]: 
02:44:35.677334 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
02:44:35.678031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9902a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9901ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9901e110>]}


============================== 2021-12-26 02:49:51.774497 | 88b5ec73-0af8-405d-be2f-fcb1f7682bfa ==============================
02:49:51.774497 [info ] [MainThread]: Running with dbt=1.0.0
02:49:51.776251 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
02:49:51.777039 [debug] [MainThread]: Tracking: tracking
02:49:51.801438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf8eb7990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf8eb7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf8eb7c90>]}
02:49:51.878819 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
02:49:51.879670 [debug] [MainThread]: Partial parsing: added file: bungie_dwh://models/example/filtered_users.sql
02:49:51.880425 [debug] [MainThread]: Partial parsing: update schema file: bungie_dwh://models/example/schema.yml
02:49:51.880836 [debug] [MainThread]: Partial parsing: deleted file: bungie_dwh://models/example/my_first_dbt_model.sql
02:49:51.897309 [debug] [MainThread]: 1699: static parser successfully parsed example/filtered_users.sql
02:49:51.948510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.users
- seeds.orders

02:49:51.957157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b5ec73-0af8-405d-be2f-fcb1f7682bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf999a690>]}
02:49:51.969467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b5ec73-0af8-405d-be2f-fcb1f7682bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf99c4ad0>]}
02:49:51.969968 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
02:49:51.971825 [info ] [MainThread]: 
02:49:51.973119 [debug] [MainThread]: Acquiring new postgres connection "master"
02:49:51.974679 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
02:49:51.995976 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:49:51.996327 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
02:49:51.996579 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:49:52.063313 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
02:49:52.064092 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
02:49:52.064498 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
02:49:52.072798 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
02:49:52.075923 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
02:49:52.078521 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
02:49:52.079901 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
02:49:52.085027 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:49:52.085768 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
02:49:52.086330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
02:49:52.105150 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:49:52.105688 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
02:49:52.106020 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
02:49:52.111652 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
02:49:52.114993 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
02:49:52.117218 [debug] [ThreadPool]: On list_dbt_dev: Close
02:49:52.125519 [debug] [MainThread]: Using postgres connection "master"
02:49:52.125913 [debug] [MainThread]: On master: BEGIN
02:49:52.126156 [debug] [MainThread]: Opening a new connection, currently in state init
02:49:52.140419 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
02:49:52.141076 [debug] [MainThread]: Using postgres connection "master"
02:49:52.141759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:49:52.153618 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
02:49:52.155103 [debug] [MainThread]: On master: ROLLBACK
02:49:52.157091 [debug] [MainThread]: On master: Close
02:49:52.157832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
02:49:52.158468 [info ] [MainThread]: 
02:49:52.164682 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
02:49:52.165611 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
02:49:52.165962 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
02:49:52.166265 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.orders
02:49:52.168877 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.orders"
02:49:52.169274 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.169580 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
02:49:52.170080 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.170735 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
02:49:52.171079 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
02:49:52.171679 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
02:49:52.171950 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
02:49:52.172202 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.products
02:49:52.173981 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.products"
02:49:52.174284 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.174542 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
02:49:52.174802 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.175310 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
02:49:52.175614 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
02:49:52.176125 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
02:49:52.176366 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
02:49:52.176589 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
02:49:52.178354 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
02:49:52.178606 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.178894 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
02:49:52.179173 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.179749 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
02:49:52.180352 [debug] [Thread-1  ]: Began running node model.bungie_dwh.filtered_users
02:49:52.180897 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.filtered_users"
02:49:52.181178 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.filtered_users
02:49:52.181416 [debug] [Thread-1  ]: Compiling model.bungie_dwh.filtered_users
02:49:52.187842 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.filtered_users"
02:49:52.188751 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.189048 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.filtered_users
02:49:52.189311 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.189822 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.filtered_users
02:49:52.190367 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
02:49:52.190820 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d"
02:49:52.191041 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
02:49:52.191252 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
02:49:52.207497 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d"
02:49:52.208515 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.208828 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
02:49:52.209092 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.209604 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
02:49:52.209887 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
02:49:52.210463 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a"
02:49:52.210715 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
02:49:52.210929 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
02:49:52.221914 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a"
02:49:52.222592 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.222853 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
02:49:52.223077 [debug] [Thread-1  ]: finished collecting timing info
02:49:52.223532 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
02:49:52.268397 [debug] [MainThread]: Connection 'master' was properly closed.
02:49:52.268719 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a' was properly closed.
02:49:52.275309 [info ] [MainThread]: Done.
02:49:52.285285 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
02:49:52.287191 [info ] [MainThread]: Building catalog
02:49:52.291405 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
02:49:52.308826 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
02:49:52.309752 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
02:49:52.310142 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:49:52.330593 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
02:49:52.331200 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
02:49:52.331537 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_dev') or upper(sch.nspname) = upper('dev'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
02:49:52.343394 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.01 seconds
02:49:52.355299 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
02:49:52.360128 [debug] [ThreadPool]: On dbt.information_schema: Close
02:49:52.374105 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dairflow/bungie_dwh/target/catalog.json
02:49:52.374890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf99c45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf99c4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf99c4890>]}
02:49:52.761839 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
02:49:52.762170 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-26 02:50:02.473467 | 1c9c6a7c-f90c-4ecd-9bf8-58a53b4a9628 ==============================
02:50:02.473467 [info ] [MainThread]: Running with dbt=1.0.0
02:50:02.474704 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
02:50:02.475411 [debug] [MainThread]: Tracking: tracking
02:50:02.501906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe596b5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe596b5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe596b5e10>]}
02:50:02.511115 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:50:02.511872 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:50:02.512919 [info ] [MainThread]: 
02:50:02.513864 [info ] [MainThread]: 
02:50:02.514778 [info ] [MainThread]: Press Ctrl+C to exit.
02:50:02.516056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe596bc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe596bcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe596bcc90>]}


============================== 2021-12-26 02:50:18.576985 | 5985cb34-8809-403e-94e8-c0a6cda1fb0a ==============================
02:50:18.576985 [info ] [MainThread]: Running with dbt=1.0.0
02:50:18.578483 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
02:50:18.579339 [debug] [MainThread]: Tracking: tracking
02:50:18.604113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f1b6b5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f1b6b5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f1b6b5610>]}
02:50:18.613719 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
02:50:18.614975 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
02:50:18.617821 [info ] [MainThread]: 
02:50:18.619534 [info ] [MainThread]: 
02:50:18.620533 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 08:06:05.175535 | 76cc6cf2-116a-4ffc-8c22-5e9f61d2bef2 ==============================
08:06:05.175535 [info ] [MainThread]: Running with dbt=1.0.0
08:06:05.177760 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:06:05.178521 [debug] [MainThread]: Tracking: tracking
08:06:05.227762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc41aff58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc41b002790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc41aff5910>]}
08:06:05.464807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:06:05.467479 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://seeds/orders.csv
08:06:05.568253 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.products
- seeds.users

08:06:05.583019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76cc6cf2-116a-4ffc-8c22-5e9f61d2bef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc41b198710>]}
08:06:05.597418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76cc6cf2-116a-4ffc-8c22-5e9f61d2bef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc41b1cb910>]}
08:06:05.598212 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:06:05.601288 [info ] [MainThread]: 
08:06:05.602268 [debug] [MainThread]: Acquiring new postgres connection "master"
08:06:05.604035 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:06:05.634418 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:06:05.634836 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:06:05.635190 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:06:05.643518 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
'
08:06:05.644353 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:06:05.644943 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
08:06:05.645304 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
08:06:05.645643 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
08:06:05.646036 [debug] [ThreadPool]: On list_dbt: No close available on handle
08:06:05.647210 [debug] [MainThread]: Connection 'master' was properly closed.
08:06:05.647788 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
08:06:05.649763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc41b1cb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc419e67450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc41b1724d0>]}


============================== 2021-12-26 08:07:28.747789 | 8e686e66-f920-441f-a87b-3003ded24d50 ==============================
08:07:28.747789 [info ] [MainThread]: Running with dbt=1.0.0
08:07:28.753422 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:07:28.754517 [debug] [MainThread]: Tracking: tracking
08:07:28.790486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d526b5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d526b5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d526b5990>]}
08:07:28.973653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:07:28.974210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:07:28.975305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.users
- seeds.orders

08:07:29.011282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e686e66-f920-441f-a87b-3003ded24d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d51c3ec10>]}
08:07:29.050667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e686e66-f920-441f-a87b-3003ded24d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5288c750>]}
08:07:29.062961 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:07:29.074418 [info ] [MainThread]: 
08:07:29.075960 [debug] [MainThread]: Acquiring new postgres connection "master"
08:07:29.078196 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:07:29.098669 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:07:29.099121 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:07:29.099443 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:07:29.320214 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.22 seconds
08:07:29.328480 [debug] [ThreadPool]: On list_dbt: Close
08:07:29.347967 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:07:29.367485 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:07:29.368222 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:07:29.368835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:07:29.396841 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
08:07:29.397438 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:07:29.397900 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:07:29.433977 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.04 seconds
08:07:29.437295 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:07:29.439553 [debug] [ThreadPool]: On list_dbt_dev: Close
08:07:29.440890 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:07:29.444211 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:07:29.444743 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:07:29.445751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:07:29.472179 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
08:07:29.472687 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:07:29.473086 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:07:29.480352 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:07:29.483171 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:07:29.485050 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:07:29.496895 [debug] [MainThread]: Using postgres connection "master"
08:07:29.497449 [debug] [MainThread]: On master: BEGIN
08:07:29.497871 [debug] [MainThread]: Opening a new connection, currently in state init
08:07:29.555401 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
08:07:29.556031 [debug] [MainThread]: Using postgres connection "master"
08:07:29.556760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:07:29.590225 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
08:07:29.591622 [debug] [MainThread]: On master: ROLLBACK
08:07:29.593211 [debug] [MainThread]: Using postgres connection "master"
08:07:29.593552 [debug] [MainThread]: On master: BEGIN
08:07:29.596727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:07:29.597545 [debug] [MainThread]: On master: COMMIT
08:07:29.597796 [debug] [MainThread]: Using postgres connection "master"
08:07:29.598002 [debug] [MainThread]: On master: COMMIT
08:07:29.599348 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:07:29.599892 [debug] [MainThread]: On master: Close
08:07:29.600718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:07:29.602313 [info ] [MainThread]: 
08:07:29.608482 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:07:29.609163 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:07:29.610357 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:07:29.610725 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:07:29.611329 [debug] [Thread-1  ]: finished collecting timing info
08:07:29.611906 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:07:29.728799 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:07:29.729389 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:07:29.730556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:07:29.746209 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:07:29.747332 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:07:29.747612 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
08:07:29.755111 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:07:29.796961 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:07:29.797629 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:07:29.805562 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "created_at" of relation "orders" does not exist
LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
                                                             ^

08:07:29.805947 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: ROLLBACK
08:07:29.809842 [debug] [Thread-1  ]: finished collecting timing info
08:07:29.810458 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:07:29.811552 [debug] [Thread-1  ]: Database Error in seed orders (seeds/orders.csv)
  column "created_at" of relation "orders" does not exist
  LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
                                                               ^
08:07:29.812916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e686e66-f920-441f-a87b-3003ded24d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52819b90>]}
08:07:29.813921 [error] [Thread-1  ]: 1 of 3 ERROR loading seed file dev_dev.orders................................... [[31mERROR[0m in 0.20s]
08:07:29.815309 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:07:29.815981 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:07:29.816821 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:07:29.819415 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:07:29.819746 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:07:29.820218 [debug] [Thread-1  ]: finished collecting timing info
08:07:29.820615 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:07:29.828728 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:07:29.829048 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:07:29.829258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:07:29.862336 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
08:07:29.862876 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:07:29.863207 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
truncate table "dbt"."dev_dev"."products"
08:07:29.870930 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:07:29.876143 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:07:29.876472 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:07:29.879308 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:07:29.885196 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:07:29.895525 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:07:29.895890 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:07:29.896212 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:07:29.899936 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:07:29.900786 [debug] [Thread-1  ]: finished collecting timing info
08:07:29.901082 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:07:29.901884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e686e66-f920-441f-a87b-3003ded24d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5284f210>]}
08:07:29.902461 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.08s]
08:07:29.903565 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:07:29.905039 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:07:29.905906 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:07:29.907617 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:07:29.908137 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:07:29.908978 [debug] [Thread-1  ]: finished collecting timing info
08:07:29.909617 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:07:29.918196 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:07:29.918728 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:07:29.918950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:07:29.939000 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:07:29.940783 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:07:29.941476 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
08:07:29.962330 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.02 seconds
08:07:29.969279 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:07:29.969616 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:07:29.972084 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:07:29.972794 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:07:29.974816 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:07:29.975189 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:07:29.975427 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:07:29.978348 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:07:29.979089 [debug] [Thread-1  ]: finished collecting timing info
08:07:29.979421 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:07:29.980268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e686e66-f920-441f-a87b-3003ded24d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52350210>]}
08:07:29.980816 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.07s]
08:07:29.981613 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:07:30.019781 [debug] [MainThread]: Acquiring new postgres connection "master"
08:07:30.020139 [debug] [MainThread]: Using postgres connection "master"
08:07:30.020356 [debug] [MainThread]: On master: BEGIN
08:07:30.020562 [debug] [MainThread]: Opening a new connection, currently in state closed
08:07:30.036479 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:07:30.037162 [debug] [MainThread]: On master: COMMIT
08:07:30.037655 [debug] [MainThread]: Using postgres connection "master"
08:07:30.038148 [debug] [MainThread]: On master: COMMIT
08:07:30.041968 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:07:30.042572 [debug] [MainThread]: On master: Close
08:07:30.043697 [info ] [MainThread]: 
08:07:30.044665 [info ] [MainThread]: Finished running 3 seeds in 0.97s.
08:07:30.045371 [debug] [MainThread]: Connection 'master' was properly closed.
08:07:30.045737 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:07:30.061216 [info ] [MainThread]: 
08:07:30.062691 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:07:30.068952 [info ] [MainThread]: 
08:07:30.070631 [error] [MainThread]: [33mDatabase Error in seed orders (seeds/orders.csv)[0m
08:07:30.071645 [error] [MainThread]:   column "created_at" of relation "orders" does not exist
08:07:30.072775 [error] [MainThread]:   LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
08:07:30.074047 [error] [MainThread]:                                                                ^
08:07:30.074937 [info ] [MainThread]: 
08:07:30.075927 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
08:07:30.081287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52842050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52877b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52877cd0>]}


============================== 2021-12-26 08:08:52.782805 | 999e749d-95da-4530-b1b5-906d6890841f ==============================
08:08:52.782805 [info ] [MainThread]: Running with dbt=1.0.0
08:08:52.785464 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:08:52.785919 [debug] [MainThread]: Tracking: tracking
08:08:52.807825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e65ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e65ad890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e65addd0>]}
08:08:52.849327 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
08:08:52.851858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '999e749d-95da-4530-b1b5-906d6890841f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e6996fd0>]}
08:08:52.900546 [debug] [MainThread]: Parsing macros/catalog.sql
08:08:52.906569 [debug] [MainThread]: Parsing macros/relations.sql
08:08:52.910690 [debug] [MainThread]: Parsing macros/adapters.sql
08:08:52.974558 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
08:08:52.977947 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:08:52.987366 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:08:52.992273 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:08:52.995384 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:08:53.028011 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:08:53.047539 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:08:53.069231 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:08:53.077767 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:08:53.080992 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:08:53.085025 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:08:53.093512 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:08:53.117767 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:08:53.120760 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:08:53.143808 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:08:53.172593 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:08:53.186136 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:08:53.190695 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:08:53.203591 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:08:53.205850 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:08:53.211520 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:08:53.216260 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:08:53.232266 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:08:53.258368 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:08:53.261618 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:08:53.267243 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:08:53.270890 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:08:53.272724 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:08:53.273896 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:08:53.275212 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:08:53.277837 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:08:53.284668 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:08:53.301464 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:08:53.305340 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:08:53.309879 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:08:53.325061 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:08:53.332032 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:08:53.342379 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:08:53.354864 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:08:53.372362 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:08:53.631617 [debug] [MainThread]: 1699: static parser successfully parsed example/filtered_users.sql
08:08:53.726250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.products
- seeds.users

08:08:53.733431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '999e749d-95da-4530-b1b5-906d6890841f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e6985850>]}
08:08:53.744883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '999e749d-95da-4530-b1b5-906d6890841f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e698bb10>]}
08:08:53.746376 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:08:53.748662 [info ] [MainThread]: 
08:08:53.749471 [debug] [MainThread]: Acquiring new postgres connection "master"
08:08:53.751155 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:08:53.771409 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:08:53.771736 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:08:53.772287 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:08:53.855913 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
08:08:53.860054 [debug] [ThreadPool]: On list_dbt: Close
08:08:53.863434 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:08:53.876568 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:08:53.877142 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:08:53.877643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:08:53.893786 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:08:53.894124 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:08:53.894345 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:08:53.900554 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:08:53.902713 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:08:53.905021 [debug] [ThreadPool]: On list_dbt_dev: Close
08:08:53.906254 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:08:53.908711 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:08:53.909036 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:08:53.909460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:08:53.922928 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:08:53.923290 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:08:53.923585 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:08:53.927941 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:08:53.929872 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:08:53.931731 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:08:53.938844 [debug] [MainThread]: Using postgres connection "master"
08:08:53.939153 [debug] [MainThread]: On master: BEGIN
08:08:53.939410 [debug] [MainThread]: Opening a new connection, currently in state init
08:08:53.950949 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:08:53.951393 [debug] [MainThread]: Using postgres connection "master"
08:08:53.951678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:08:53.960885 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:08:53.962392 [debug] [MainThread]: On master: ROLLBACK
08:08:53.963858 [debug] [MainThread]: Using postgres connection "master"
08:08:53.964180 [debug] [MainThread]: On master: BEGIN
08:08:53.967546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:08:53.967983 [debug] [MainThread]: On master: COMMIT
08:08:53.968312 [debug] [MainThread]: Using postgres connection "master"
08:08:53.968606 [debug] [MainThread]: On master: COMMIT
08:08:53.970552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:08:53.970911 [debug] [MainThread]: On master: Close
08:08:53.971530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:08:53.972119 [info ] [MainThread]: 
08:08:53.976935 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:08:53.977614 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:08:53.978402 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:08:53.978733 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:08:53.979142 [debug] [Thread-1  ]: finished collecting timing info
08:08:53.979653 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:08:54.033012 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:08:54.033335 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:08:54.033541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:08:54.045964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:08:54.046472 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:08:54.046927 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
08:08:54.049439 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
08:08:54.076657 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:08:54.076989 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:08:54.084140 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "created_at" of relation "orders" does not exist
LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
                                                             ^

08:08:54.084727 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: ROLLBACK
08:08:54.087174 [debug] [Thread-1  ]: finished collecting timing info
08:08:54.087825 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:08:54.088651 [debug] [Thread-1  ]: Database Error in seed orders (seeds/orders.csv)
  column "created_at" of relation "orders" does not exist
  LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
                                                               ^
08:08:54.089421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '999e749d-95da-4530-b1b5-906d6890841f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e6b0ddd0>]}
08:08:54.089947 [error] [Thread-1  ]: 1 of 3 ERROR loading seed file dev_dev.orders................................... [[31mERROR[0m in 0.11s]
08:08:54.090666 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:08:54.091619 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:08:54.092162 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:08:54.093500 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:08:54.093887 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:08:54.094260 [debug] [Thread-1  ]: finished collecting timing info
08:08:54.094584 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:08:54.151095 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:08:54.151404 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:08:54.151607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:08:54.164079 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:08:54.164496 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:08:54.164724 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
truncate table "dbt"."dev_dev"."products"
08:08:54.173405 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:08:54.177083 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:08:54.177396 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:08:54.179622 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:08:54.184920 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:08:54.193738 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:08:54.194046 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:08:54.194252 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:08:54.197255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:08:54.198411 [debug] [Thread-1  ]: finished collecting timing info
08:08:54.198881 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:08:54.199831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '999e749d-95da-4530-b1b5-906d6890841f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e67d0e90>]}
08:08:54.200357 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.11s]
08:08:54.201344 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:08:54.202480 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:08:54.204924 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:08:54.207602 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:08:54.207941 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:08:54.208198 [debug] [Thread-1  ]: finished collecting timing info
08:08:54.208614 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:08:54.223181 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:08:54.223631 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:08:54.224028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:08:54.244944 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:08:54.245341 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:08:54.245604 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
08:08:54.253874 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:08:54.262960 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:08:54.263353 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:08:54.265901 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:08:54.267838 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:08:54.270800 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:08:54.271170 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:08:54.271430 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:08:54.274340 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:08:54.275120 [debug] [Thread-1  ]: finished collecting timing info
08:08:54.275508 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:08:54.276291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '999e749d-95da-4530-b1b5-906d6890841f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e67d00d0>]}
08:08:54.276841 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.07s]
08:08:54.277533 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:08:54.289645 [debug] [MainThread]: Acquiring new postgres connection "master"
08:08:54.290028 [debug] [MainThread]: Using postgres connection "master"
08:08:54.290299 [debug] [MainThread]: On master: BEGIN
08:08:54.290546 [debug] [MainThread]: Opening a new connection, currently in state closed
08:08:54.313150 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:08:54.313763 [debug] [MainThread]: On master: COMMIT
08:08:54.314027 [debug] [MainThread]: Using postgres connection "master"
08:08:54.314257 [debug] [MainThread]: On master: COMMIT
08:08:54.316190 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:08:54.316621 [debug] [MainThread]: On master: Close
08:08:54.317630 [info ] [MainThread]: 
08:08:54.318840 [info ] [MainThread]: Finished running 3 seeds in 0.57s.
08:08:54.320819 [debug] [MainThread]: Connection 'master' was properly closed.
08:08:54.322083 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:08:54.332452 [info ] [MainThread]: 
08:08:54.333054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:08:54.334054 [info ] [MainThread]: 
08:08:54.335733 [error] [MainThread]: [33mDatabase Error in seed orders (seeds/orders.csv)[0m
08:08:54.336996 [error] [MainThread]:   column "created_at" of relation "orders" does not exist
08:08:54.337453 [error] [MainThread]:   LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
08:08:54.337992 [error] [MainThread]:                                                                ^
08:08:54.338997 [info ] [MainThread]: 
08:08:54.339455 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
08:08:54.339987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e6a57e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e67b6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e67b61d0>]}


============================== 2021-12-26 08:10:21.859493 | c0251ba8-34b3-46ca-848e-c86197857848 ==============================
08:10:21.859493 [info ] [MainThread]: Running with dbt=1.0.0
08:10:21.860521 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
08:10:21.860803 [debug] [MainThread]: Tracking: tracking
08:10:21.872421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee7ee64490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee7ee64350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee7ee64ed0>]}
08:10:22.022052 [debug] [MainThread]: Executing "git --help"
08:10:22.071605 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
08:10:22.074353 [debug] [MainThread]: STDERR: "b''"
08:10:22.083687 [debug] [MainThread]: Acquiring new postgres connection "debug"
08:10:22.086771 [debug] [MainThread]: Using postgres connection "debug"
08:10:22.087440 [debug] [MainThread]: On debug: select 1 as id
08:10:22.089409 [debug] [MainThread]: Opening a new connection, currently in state init
08:10:22.193123 [debug] [MainThread]: SQL status: SELECT 1 in 0.1 seconds
08:10:22.198358 [debug] [MainThread]: On debug: Close
08:10:22.199551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee7f8b26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee7ee8f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee7ee8f4d0>]}
08:10:22.737353 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-26 08:10:35.713441 | 96aa8892-1773-427b-81b8-790ba63df381 ==============================
08:10:35.713441 [info ] [MainThread]: Running with dbt=1.0.0
08:10:35.715314 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:10:35.716292 [debug] [MainThread]: Tracking: tracking
08:10:35.785313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b967c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b967c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b967c7d0>]}
08:10:35.870916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:10:35.871298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:10:35.872018 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.products
- seeds.users

08:10:35.883684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96aa8892-1773-427b-81b8-790ba63df381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b983cf50>]}
08:10:35.898506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96aa8892-1773-427b-81b8-790ba63df381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b984ec50>]}
08:10:35.899013 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:10:35.900896 [info ] [MainThread]: 
08:10:35.902063 [debug] [MainThread]: Acquiring new postgres connection "master"
08:10:35.905097 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:10:35.929868 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:10:35.930186 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:10:35.930412 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:10:35.959530 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
08:10:35.961620 [debug] [ThreadPool]: On list_dbt: Close
08:10:35.964304 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:10:35.978539 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:10:35.978867 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:10:35.979099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:10:35.994488 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:10:35.995099 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:10:35.995593 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:10:36.002700 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:10:36.004790 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:10:36.007339 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:10:36.008471 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:10:36.010904 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:10:36.011666 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:10:36.012243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:10:36.030294 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:10:36.030811 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:10:36.031220 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:10:36.036276 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:10:36.038426 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:10:36.040598 [debug] [ThreadPool]: On list_dbt_dev: Close
08:10:36.050514 [debug] [MainThread]: Using postgres connection "master"
08:10:36.050961 [debug] [MainThread]: On master: BEGIN
08:10:36.051274 [debug] [MainThread]: Opening a new connection, currently in state init
08:10:36.067441 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:10:36.068070 [debug] [MainThread]: Using postgres connection "master"
08:10:36.068462 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:10:36.080851 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:10:36.082422 [debug] [MainThread]: On master: ROLLBACK
08:10:36.084085 [debug] [MainThread]: Using postgres connection "master"
08:10:36.084487 [debug] [MainThread]: On master: BEGIN
08:10:36.087294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:10:36.088063 [debug] [MainThread]: On master: COMMIT
08:10:36.088876 [debug] [MainThread]: Using postgres connection "master"
08:10:36.089353 [debug] [MainThread]: On master: COMMIT
08:10:36.091253 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:10:36.091792 [debug] [MainThread]: On master: Close
08:10:36.092586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:10:36.093408 [info ] [MainThread]: 
08:10:36.098121 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:10:36.098828 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:10:36.100046 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:10:36.100568 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:10:36.100984 [debug] [Thread-1  ]: finished collecting timing info
08:10:36.101367 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:10:36.177321 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:10:36.177675 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:10:36.177889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:10:36.192780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:10:36.193358 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:10:36.193875 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
08:10:36.197402 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
08:10:36.227276 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:10:36.227610 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:10:36.232660 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "created_at" of relation "orders" does not exist
LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
                                                             ^

08:10:36.233319 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: ROLLBACK
08:10:36.236412 [debug] [Thread-1  ]: finished collecting timing info
08:10:36.237093 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:10:36.238103 [debug] [Thread-1  ]: Database Error in seed orders (seeds/orders.csv)
  column "created_at" of relation "orders" does not exist
  LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
                                                               ^
08:10:36.238931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96aa8892-1773-427b-81b8-790ba63df381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b97d0050>]}
08:10:36.239843 [error] [Thread-1  ]: 1 of 3 ERROR loading seed file dev_dev.orders................................... [[31mERROR[0m in 0.14s]
08:10:36.240774 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:10:36.241501 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:10:36.242282 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:10:36.243796 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:10:36.244462 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:10:36.244805 [debug] [Thread-1  ]: finished collecting timing info
08:10:36.245084 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:10:36.255199 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:10:36.255666 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:10:36.256036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:10:36.279864 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:10:36.280619 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:10:36.280905 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
truncate table "dbt"."dev_dev"."products"
08:10:36.289189 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:10:36.296001 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:10:36.296368 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:10:36.298765 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:10:36.306564 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:10:36.318325 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:10:36.318647 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:10:36.318878 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:10:36.322314 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:10:36.323226 [debug] [Thread-1  ]: finished collecting timing info
08:10:36.323680 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:10:36.324830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96aa8892-1773-427b-81b8-790ba63df381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b97ec3d0>]}
08:10:36.325751 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.08s]
08:10:36.327131 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:10:36.328376 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:10:36.329609 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:10:36.331590 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:10:36.332115 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:10:36.332880 [debug] [Thread-1  ]: finished collecting timing info
08:10:36.333589 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:10:36.348332 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:10:36.348664 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:10:36.348884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:10:36.371020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:10:36.371570 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:10:36.372395 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
08:10:36.383609 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:10:36.389033 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:10:36.389345 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:10:36.391466 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:10:36.392062 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:10:36.394440 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:10:36.394750 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:10:36.394956 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:10:36.398541 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:10:36.399545 [debug] [Thread-1  ]: finished collecting timing info
08:10:36.399971 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:10:36.401106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96aa8892-1773-427b-81b8-790ba63df381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b9809b50>]}
08:10:36.401755 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.07s]
08:10:36.402329 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:10:36.422202 [debug] [MainThread]: Acquiring new postgres connection "master"
08:10:36.423233 [debug] [MainThread]: Using postgres connection "master"
08:10:36.423638 [debug] [MainThread]: On master: BEGIN
08:10:36.424034 [debug] [MainThread]: Opening a new connection, currently in state closed
08:10:36.440243 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:10:36.440791 [debug] [MainThread]: On master: COMMIT
08:10:36.441050 [debug] [MainThread]: Using postgres connection "master"
08:10:36.441253 [debug] [MainThread]: On master: COMMIT
08:10:36.442915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:10:36.443338 [debug] [MainThread]: On master: Close
08:10:36.444027 [info ] [MainThread]: 
08:10:36.444815 [info ] [MainThread]: Finished running 3 seeds in 0.54s.
08:10:36.445869 [debug] [MainThread]: Connection 'master' was properly closed.
08:10:36.447280 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:10:36.456598 [info ] [MainThread]: 
08:10:36.458177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:10:36.459553 [info ] [MainThread]: 
08:10:36.461460 [error] [MainThread]: [33mDatabase Error in seed orders (seeds/orders.csv)[0m
08:10:36.462732 [error] [MainThread]:   column "created_at" of relation "orders" does not exist
08:10:36.464723 [error] [MainThread]:   LINE 2: ...v"."orders" ("order_id", "user_id", "product_id", "created_a...
08:10:36.466530 [error] [MainThread]:                                                                ^
08:10:36.468203 [info ] [MainThread]: 
08:10:36.470564 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
08:10:36.472301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b980d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b9825310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90b9825490>]}


============================== 2021-12-26 08:11:27.281360 | 32f14c25-d49d-4e8e-ad02-bb2f9ea5a981 ==============================
08:11:27.281360 [info ] [MainThread]: Running with dbt=1.0.0
08:11:27.282786 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:11:27.283209 [debug] [MainThread]: Tracking: tracking
08:11:27.300289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c76bd8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c76bd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c76bd890>]}
08:11:27.367660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:11:27.368032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:11:27.368648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.users
- seeds.products

08:11:27.378450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32f14c25-d49d-4e8e-ad02-bb2f9ea5a981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c797cdd0>]}
08:11:27.390791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32f14c25-d49d-4e8e-ad02-bb2f9ea5a981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c798ec50>]}
08:11:27.391316 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:11:27.393162 [info ] [MainThread]: 
08:11:27.394055 [debug] [MainThread]: Acquiring new postgres connection "master"
08:11:27.396377 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:11:27.422580 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:11:27.422923 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:11:27.423197 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:11:27.467146 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.04 seconds
08:11:27.469326 [debug] [ThreadPool]: On list_dbt: Close
08:11:27.471729 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:11:27.481557 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:11:27.481948 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:11:27.482222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:11:27.495812 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:11:27.496289 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:11:27.496680 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:11:27.502728 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:11:27.504643 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:11:27.506402 [debug] [ThreadPool]: On list_dbt_dev: Close
08:11:27.507390 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:11:27.510452 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:11:27.510868 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:11:27.511122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:11:27.522954 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:11:27.523514 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:11:27.523854 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:11:27.528454 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:11:27.529915 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:11:27.532163 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:11:27.539274 [debug] [MainThread]: Using postgres connection "master"
08:11:27.539594 [debug] [MainThread]: On master: BEGIN
08:11:27.539852 [debug] [MainThread]: Opening a new connection, currently in state init
08:11:27.552884 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:11:27.553293 [debug] [MainThread]: Using postgres connection "master"
08:11:27.553562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:11:27.563107 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:11:27.565134 [debug] [MainThread]: On master: ROLLBACK
08:11:27.566973 [debug] [MainThread]: Using postgres connection "master"
08:11:27.567304 [debug] [MainThread]: On master: BEGIN
08:11:27.571229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:11:27.571759 [debug] [MainThread]: On master: COMMIT
08:11:27.572106 [debug] [MainThread]: Using postgres connection "master"
08:11:27.572364 [debug] [MainThread]: On master: COMMIT
08:11:27.574360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:11:27.574769 [debug] [MainThread]: On master: Close
08:11:27.575500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:11:27.576260 [info ] [MainThread]: 
08:11:27.580708 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:11:27.581168 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:11:27.582038 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:11:27.582429 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:11:27.582771 [debug] [Thread-1  ]: finished collecting timing info
08:11:27.583025 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:11:27.633847 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:11:27.634456 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
drop table if exists "dbt"."dev_dev"."orders" cascade
08:11:27.634764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:11:27.654313 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:11:27.668607 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:11:27.668911 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:11:27.670971 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:11:27.671533 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:11:27.671877 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:11:27.685444 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:11:27.711498 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:11:27.711813 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:11:27.713867 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:11:27.719009 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:11:27.732920 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:11:27.733229 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:11:27.733439 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:11:27.736488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:11:27.737221 [debug] [Thread-1  ]: finished collecting timing info
08:11:27.737494 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:11:27.738109 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f14c25-d49d-4e8e-ad02-bb2f9ea5a981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c7942090>]}
08:11:27.738697 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mCREATE 5[0m in 0.16s]
08:11:27.739687 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:11:27.740454 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:11:27.741462 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:11:27.742765 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:11:27.743086 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:11:27.743344 [debug] [Thread-1  ]: finished collecting timing info
08:11:27.743605 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:11:27.755507 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:11:27.755944 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
drop table if exists "dbt"."dev_dev"."products" cascade
08:11:27.756236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:11:27.779882 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:11:27.786108 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:11:27.787196 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:11:27.790379 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:11:27.790760 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:11:27.791019 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:11:27.803044 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:11:27.809356 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:11:27.809745 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:11:27.811841 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:11:27.812460 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:11:27.814806 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:11:27.815130 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:11:27.815351 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:11:27.818945 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:11:27.819912 [debug] [Thread-1  ]: finished collecting timing info
08:11:27.820294 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:11:27.821342 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f14c25-d49d-4e8e-ad02-bb2f9ea5a981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c7942450>]}
08:11:27.822324 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mCREATE 3[0m in 0.08s]
08:11:27.823516 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:11:27.824349 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:11:27.824853 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:11:27.826154 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:11:27.826701 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:11:27.827288 [debug] [Thread-1  ]: finished collecting timing info
08:11:27.828045 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:11:27.838306 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:11:27.838711 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev_dev"."users" cascade
08:11:27.839006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:11:27.870508 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
08:11:27.878779 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:11:27.879106 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:11:27.882823 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:11:27.883344 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:11:27.883641 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:11:27.898712 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:11:27.907078 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:11:27.907573 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:11:27.910475 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:11:27.911278 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:11:27.913740 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:11:27.914054 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:11:27.914262 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:11:27.918768 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:11:27.919661 [debug] [Thread-1  ]: finished collecting timing info
08:11:27.919991 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:11:27.920855 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32f14c25-d49d-4e8e-ad02-bb2f9ea5a981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c795e410>]}
08:11:27.921760 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mCREATE 5[0m in 0.09s]
08:11:27.922791 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:11:27.984837 [debug] [MainThread]: Acquiring new postgres connection "master"
08:11:27.985228 [debug] [MainThread]: Using postgres connection "master"
08:11:27.985496 [debug] [MainThread]: On master: BEGIN
08:11:27.985734 [debug] [MainThread]: Opening a new connection, currently in state closed
08:11:28.003391 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:11:28.004120 [debug] [MainThread]: On master: COMMIT
08:11:28.004654 [debug] [MainThread]: Using postgres connection "master"
08:11:28.005102 [debug] [MainThread]: On master: COMMIT
08:11:28.006874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:11:28.007383 [debug] [MainThread]: On master: Close
08:11:28.008221 [info ] [MainThread]: 
08:11:28.008775 [info ] [MainThread]: Finished running 3 seeds in 0.61s.
08:11:28.009279 [debug] [MainThread]: Connection 'master' was properly closed.
08:11:28.009771 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:11:28.017998 [info ] [MainThread]: 
08:11:28.018738 [info ] [MainThread]: [32mCompleted successfully[0m
08:11:28.021259 [info ] [MainThread]: 
08:11:28.022778 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:11:28.024896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c7915dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c795e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c795e8d0>]}


============================== 2021-12-26 08:15:00.958684 | c1821d9d-bed4-4632-b046-224568c1b179 ==============================
08:15:00.958684 [info ] [MainThread]: Running with dbt=1.0.0
08:15:00.961525 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:15:00.961994 [debug] [MainThread]: Tracking: tracking
08:15:01.028420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8326a4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8326a4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8326a4990>]}
08:15:01.149049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:15:01.149507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:15:01.151842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.users
- seeds.orders

08:15:01.163096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1821d9d-bed4-4632-b046-224568c1b179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83297c8d0>]}
08:15:01.173714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1821d9d-bed4-4632-b046-224568c1b179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83298e690>]}
08:15:01.174716 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:15:01.179872 [info ] [MainThread]: 
08:15:01.181730 [debug] [MainThread]: Acquiring new postgres connection "master"
08:15:01.185457 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:15:01.208962 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:15:01.209382 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:15:01.209639 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:15:01.262658 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
08:15:01.264807 [debug] [ThreadPool]: On list_dbt: Close
08:15:01.267442 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:15:01.282874 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:15:01.283277 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:15:01.283560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:15:01.302342 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:15:01.303078 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:15:01.303433 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:15:01.307970 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:15:01.311157 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:15:01.313091 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:15:01.313894 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:15:01.317568 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:15:01.318718 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:15:01.319283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:15:01.332626 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:15:01.333405 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:15:01.334068 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:15:01.344384 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:15:01.346723 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:15:01.352429 [debug] [ThreadPool]: On list_dbt_dev: Close
08:15:01.367144 [debug] [MainThread]: Using postgres connection "master"
08:15:01.367798 [debug] [MainThread]: On master: BEGIN
08:15:01.368067 [debug] [MainThread]: Opening a new connection, currently in state init
08:15:01.391308 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:15:01.391865 [debug] [MainThread]: Using postgres connection "master"
08:15:01.392160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:15:01.405011 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:15:01.408990 [debug] [MainThread]: On master: ROLLBACK
08:15:01.411267 [debug] [MainThread]: Using postgres connection "master"
08:15:01.411756 [debug] [MainThread]: On master: BEGIN
08:15:01.418581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:15:01.420319 [debug] [MainThread]: On master: COMMIT
08:15:01.421968 [debug] [MainThread]: Using postgres connection "master"
08:15:01.422577 [debug] [MainThread]: On master: COMMIT
08:15:01.424414 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:15:01.424798 [debug] [MainThread]: On master: Close
08:15:01.425979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:15:01.431356 [info ] [MainThread]: 
08:15:01.438959 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:15:01.439511 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:15:01.440634 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:15:01.441216 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:15:01.441607 [debug] [Thread-1  ]: finished collecting timing info
08:15:01.441909 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:15:01.526887 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:01.527190 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
drop table if exists "dbt"."dev_dev"."orders" cascade
08:15:01.527394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:15:01.544659 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:15:01.561842 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:01.562104 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:15:01.565947 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:15:01.566368 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:01.566643 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:15:01.570629 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
08:15:01.601456 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:01.601795 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:15:01.606532 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:15:01.612578 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:15:01.627526 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:15:01.627838 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:01.628043 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:15:01.630879 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:15:01.631703 [debug] [Thread-1  ]: finished collecting timing info
08:15:01.631992 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:15:01.632883 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1821d9d-bed4-4632-b046-224568c1b179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc832942290>]}
08:15:01.633541 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mCREATE 5[0m in 0.19s]
08:15:01.634855 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:15:01.636021 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:15:01.637071 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:15:01.639061 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:15:01.639641 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:15:01.639955 [debug] [Thread-1  ]: finished collecting timing info
08:15:01.640269 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:15:01.648983 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:01.649300 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
drop table if exists "dbt"."dev_dev"."products" cascade
08:15:01.649556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:15:01.677254 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
08:15:01.679685 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:01.679927 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:15:01.681688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:15:01.682106 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:01.682374 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:15:01.714816 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.03 seconds
08:15:01.718983 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:01.719301 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:15:01.721588 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:15:01.723227 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:15:01.725956 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:15:01.726297 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:01.726551 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:15:01.729745 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:15:01.730830 [debug] [Thread-1  ]: finished collecting timing info
08:15:01.731275 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:15:01.732365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1821d9d-bed4-4632-b046-224568c1b179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8329424d0>]}
08:15:01.733054 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mCREATE 3[0m in 0.09s]
08:15:01.733666 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:15:01.735466 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:15:01.737354 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:15:01.739655 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:15:01.740063 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:15:01.740348 [debug] [Thread-1  ]: finished collecting timing info
08:15:01.740722 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:15:01.751961 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:01.752325 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev_dev"."users" cascade
08:15:01.752533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:15:01.779408 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
08:15:01.782592 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:01.782943 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:15:01.786865 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:15:01.790179 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:01.791753 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:15:01.799581 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:15:01.807207 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:01.807574 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:15:01.810153 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:15:01.810731 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:15:01.812828 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:15:01.813126 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:01.813422 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:15:01.816320 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:15:01.817554 [debug] [Thread-1  ]: finished collecting timing info
08:15:01.817999 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:15:01.818958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1821d9d-bed4-4632-b046-224568c1b179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc832933f10>]}
08:15:01.819484 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mCREATE 5[0m in 0.08s]
08:15:01.820119 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:15:01.849475 [debug] [MainThread]: Acquiring new postgres connection "master"
08:15:01.850056 [debug] [MainThread]: Using postgres connection "master"
08:15:01.850462 [debug] [MainThread]: On master: BEGIN
08:15:01.850832 [debug] [MainThread]: Opening a new connection, currently in state closed
08:15:01.866605 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:15:01.867123 [debug] [MainThread]: On master: COMMIT
08:15:01.867470 [debug] [MainThread]: Using postgres connection "master"
08:15:01.867681 [debug] [MainThread]: On master: COMMIT
08:15:01.869409 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:15:01.869789 [debug] [MainThread]: On master: Close
08:15:01.870592 [info ] [MainThread]: 
08:15:01.871706 [info ] [MainThread]: Finished running 3 seeds in 0.69s.
08:15:01.874403 [debug] [MainThread]: Connection 'master' was properly closed.
08:15:01.875221 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:15:01.882423 [info ] [MainThread]: 
08:15:01.882914 [info ] [MainThread]: [32mCompleted successfully[0m
08:15:01.883484 [info ] [MainThread]: 
08:15:01.884512 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:15:01.885243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8329460d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83295a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83295a0d0>]}


============================== 2021-12-26 08:15:38.002639 | 2044d05a-46fb-4ac4-a444-4a199c742ad5 ==============================
08:15:38.002639 [info ] [MainThread]: Running with dbt=1.0.0
08:15:38.003766 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:15:38.004233 [debug] [MainThread]: Tracking: tracking
08:15:38.028103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cdebc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cdebc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cdebc7d0>]}
08:15:38.086008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:15:38.086729 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://seeds/orders.csv
08:15:38.141535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.users
- seeds.products

08:15:38.150124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2044d05a-46fb-4ac4-a444-4a199c742ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ce0574d0>]}
08:15:38.165036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2044d05a-46fb-4ac4-a444-4a199c742ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ce090a50>]}
08:15:38.166774 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:15:38.169479 [info ] [MainThread]: 
08:15:38.171897 [debug] [MainThread]: Acquiring new postgres connection "master"
08:15:38.174907 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:15:38.198509 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:15:38.199347 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:15:38.199925 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:15:38.252620 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
08:15:38.255192 [debug] [ThreadPool]: On list_dbt: Close
08:15:38.257664 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:15:38.269530 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:15:38.269844 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:15:38.270157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:15:38.282730 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:15:38.283529 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:15:38.284111 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:15:38.288900 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:15:38.292765 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:15:38.294732 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:15:38.295824 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:15:38.299216 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:15:38.299768 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:15:38.300238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:15:38.312509 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:15:38.313192 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:15:38.313507 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:15:38.318739 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:15:38.323905 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:15:38.326133 [debug] [ThreadPool]: On list_dbt_dev: Close
08:15:38.334272 [debug] [MainThread]: Using postgres connection "master"
08:15:38.334657 [debug] [MainThread]: On master: BEGIN
08:15:38.334928 [debug] [MainThread]: Opening a new connection, currently in state init
08:15:38.348364 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:15:38.348860 [debug] [MainThread]: Using postgres connection "master"
08:15:38.349249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:15:38.360713 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:15:38.362155 [debug] [MainThread]: On master: ROLLBACK
08:15:38.364750 [debug] [MainThread]: Using postgres connection "master"
08:15:38.365203 [debug] [MainThread]: On master: BEGIN
08:15:38.368349 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:15:38.368953 [debug] [MainThread]: On master: COMMIT
08:15:38.369311 [debug] [MainThread]: Using postgres connection "master"
08:15:38.369664 [debug] [MainThread]: On master: COMMIT
08:15:38.372138 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:15:38.372541 [debug] [MainThread]: On master: Close
08:15:38.373223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:15:38.374068 [info ] [MainThread]: 
08:15:38.378348 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:15:38.379238 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:15:38.380922 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:15:38.381345 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:15:38.381836 [debug] [Thread-1  ]: finished collecting timing info
08:15:38.382201 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:15:38.446090 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:38.446406 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
drop table if exists "dbt"."dev_dev"."orders" cascade
08:15:38.446616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:15:38.459722 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:15:38.475979 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:38.476251 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:15:38.479363 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:15:38.479791 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:38.480010 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:15:38.485350 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:15:38.513357 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:38.513723 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:15:38.515941 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:15:38.522583 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:15:38.536954 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:15:38.537304 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:15:38.537559 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:15:38.540904 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:15:38.542023 [debug] [Thread-1  ]: finished collecting timing info
08:15:38.542434 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:15:38.543254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2044d05a-46fb-4ac4-a444-4a199c742ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ce0245d0>]}
08:15:38.544029 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mCREATE 5[0m in 0.16s]
08:15:38.544708 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:15:38.545242 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:15:38.545667 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:15:38.546720 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:15:38.547211 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:15:38.547575 [debug] [Thread-1  ]: finished collecting timing info
08:15:38.548317 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:15:38.559082 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:38.560107 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
drop table if exists "dbt"."dev_dev"."products" cascade
08:15:38.560527 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:15:38.578852 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:15:38.583990 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:38.584687 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:15:38.589024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:15:38.589543 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:38.589895 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:15:38.597066 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:15:38.603812 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:38.604173 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:15:38.607165 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:15:38.607841 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:15:38.610109 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:15:38.610443 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:15:38.610691 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:15:38.614036 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:15:38.615287 [debug] [Thread-1  ]: finished collecting timing info
08:15:38.615736 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:15:38.616882 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2044d05a-46fb-4ac4-a444-4a199c742ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ce05b710>]}
08:15:38.617689 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mCREATE 3[0m in 0.07s]
08:15:38.619620 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:15:38.620219 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:15:38.622070 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:15:38.623885 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:15:38.624216 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:15:38.624691 [debug] [Thread-1  ]: finished collecting timing info
08:15:38.624999 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:15:38.637618 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:38.638052 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev_dev"."users" cascade
08:15:38.638333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:15:38.668094 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
08:15:38.670928 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:38.671176 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:15:38.676071 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:15:38.676572 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:38.676856 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:15:38.686523 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:15:38.694889 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:38.695252 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:15:38.697525 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:15:38.698199 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:15:38.700386 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:15:38.700698 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:15:38.701056 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:15:38.704342 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:15:38.705661 [debug] [Thread-1  ]: finished collecting timing info
08:15:38.706168 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:15:38.707272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2044d05a-46fb-4ac4-a444-4a199c742ad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cdfa3150>]}
08:15:38.707860 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mCREATE 5[0m in 0.08s]
08:15:38.708500 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:15:38.782777 [debug] [MainThread]: Acquiring new postgres connection "master"
08:15:38.783658 [debug] [MainThread]: Using postgres connection "master"
08:15:38.783988 [debug] [MainThread]: On master: BEGIN
08:15:38.784239 [debug] [MainThread]: Opening a new connection, currently in state closed
08:15:38.796969 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:15:38.797397 [debug] [MainThread]: On master: COMMIT
08:15:38.797695 [debug] [MainThread]: Using postgres connection "master"
08:15:38.798077 [debug] [MainThread]: On master: COMMIT
08:15:38.799806 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:15:38.800219 [debug] [MainThread]: On master: Close
08:15:38.800897 [info ] [MainThread]: 
08:15:38.801516 [info ] [MainThread]: Finished running 3 seeds in 0.63s.
08:15:38.802102 [debug] [MainThread]: Connection 'master' was properly closed.
08:15:38.802350 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:15:38.810035 [info ] [MainThread]: 
08:15:38.810549 [info ] [MainThread]: [32mCompleted successfully[0m
08:15:38.812201 [info ] [MainThread]: 
08:15:38.813855 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:15:38.815360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cdec7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ce0ebdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ce0ebd50>]}


============================== 2021-12-26 08:17:06.220096 | 34836301-f4a3-47bb-bd2c-f3f7eb8093d6 ==============================
08:17:06.220096 [info ] [MainThread]: Running with dbt=1.0.0
08:17:06.221620 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:17:06.222075 [debug] [MainThread]: Tracking: tracking
08:17:06.256723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e497bc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e497bc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e497bc890>]}
08:17:06.302456 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
08:17:06.303041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34836301-f4a3-47bb-bd2c-f3f7eb8093d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a194fd0>]}
08:17:06.338301 [debug] [MainThread]: Parsing macros/catalog.sql
08:17:06.344657 [debug] [MainThread]: Parsing macros/relations.sql
08:17:06.346556 [debug] [MainThread]: Parsing macros/adapters.sql
08:17:06.379642 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
08:17:06.381981 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:17:06.387668 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:17:06.390997 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:17:06.393303 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:17:06.417101 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:17:06.432839 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:17:06.449577 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:17:06.456035 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:17:06.458844 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:17:06.462642 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:17:06.474590 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:17:06.490321 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:17:06.492507 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:17:06.507042 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:17:06.529355 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:17:06.539984 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:17:06.545227 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:17:06.556141 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:17:06.558122 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:17:06.562049 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:17:06.565383 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:17:06.575159 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:17:06.598247 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:17:06.600391 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:17:06.603922 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:17:06.606142 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:17:06.607470 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:17:06.608302 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:17:06.609311 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:17:06.611467 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:17:06.617653 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:17:06.631778 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:17:06.634975 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:17:06.638861 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:17:06.653285 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:17:06.657507 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:17:06.664505 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:17:06.676483 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:17:06.691503 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:17:06.937528 [debug] [MainThread]: 1699: static parser successfully parsed example/filtered_users.sql
08:17:07.035171 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.users
- seeds.orders

08:17:07.042820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34836301-f4a3-47bb-bd2c-f3f7eb8093d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a1d6990>]}
08:17:07.054481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34836301-f4a3-47bb-bd2c-f3f7eb8093d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a1d1890>]}
08:17:07.055000 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:17:07.057010 [info ] [MainThread]: 
08:17:07.058586 [debug] [MainThread]: Acquiring new postgres connection "master"
08:17:07.060556 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:17:07.077809 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:17:07.078246 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:17:07.078662 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:17:07.159886 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.08 seconds
08:17:07.163224 [debug] [ThreadPool]: On list_dbt: Close
08:17:07.166361 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:17:07.181123 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:17:07.181662 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:17:07.182081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:17:07.202019 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:17:07.202755 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:17:07.203221 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:17:07.213407 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:17:07.217112 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:17:07.224433 [debug] [ThreadPool]: On list_dbt_dev: Close
08:17:07.226225 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:17:07.229898 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:17:07.230458 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:17:07.230903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:17:07.247025 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:17:07.247613 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:17:07.248090 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:17:07.255102 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:17:07.257190 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:17:07.259043 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:17:07.266431 [debug] [MainThread]: Using postgres connection "master"
08:17:07.266762 [debug] [MainThread]: On master: BEGIN
08:17:07.267032 [debug] [MainThread]: Opening a new connection, currently in state init
08:17:07.279537 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:17:07.279943 [debug] [MainThread]: Using postgres connection "master"
08:17:07.280217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:17:07.291660 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:17:07.293082 [debug] [MainThread]: On master: ROLLBACK
08:17:07.294651 [debug] [MainThread]: Using postgres connection "master"
08:17:07.294985 [debug] [MainThread]: On master: BEGIN
08:17:07.298563 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:17:07.299119 [debug] [MainThread]: On master: COMMIT
08:17:07.299397 [debug] [MainThread]: Using postgres connection "master"
08:17:07.299612 [debug] [MainThread]: On master: COMMIT
08:17:07.301510 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:17:07.301905 [debug] [MainThread]: On master: Close
08:17:07.302544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:17:07.303378 [info ] [MainThread]: 
08:17:07.308088 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:17:07.308799 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:17:07.309656 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:17:07.310027 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:17:07.310546 [debug] [Thread-1  ]: finished collecting timing info
08:17:07.311064 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:17:07.385559 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:17:07.385910 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
drop table if exists "dbt"."dev_dev"."orders" cascade
08:17:07.386198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:17:07.398857 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:17:07.417839 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:17:07.418222 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:17:07.424917 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:17:07.427796 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:17:07.429043 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:17:07.437023 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:17:07.526515 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:17:07.526998 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:17:07.530053 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:17:07.537186 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:17:07.558605 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:17:07.558913 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:17:07.559133 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:17:07.561701 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:17:07.562430 [debug] [Thread-1  ]: finished collecting timing info
08:17:07.562755 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:17:07.563411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34836301-f4a3-47bb-bd2c-f3f7eb8093d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a0cc650>]}
08:17:07.563959 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mCREATE 5[0m in 0.25s]
08:17:07.564535 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:17:07.565195 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:17:07.566019 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:17:07.566991 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:17:07.567319 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:17:07.567701 [debug] [Thread-1  ]: finished collecting timing info
08:17:07.567963 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:17:07.575481 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:17:07.576719 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
drop table if exists "dbt"."dev_dev"."products" cascade
08:17:07.578388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:17:07.598540 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:17:07.602857 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:17:07.603147 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:17:07.606920 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:17:07.608278 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:17:07.609563 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:17:07.618731 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:17:07.623614 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:17:07.624011 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:17:07.629122 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:17:07.629932 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:17:07.632229 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:17:07.632618 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:17:07.632918 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:17:07.636622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:17:07.637699 [debug] [Thread-1  ]: finished collecting timing info
08:17:07.638023 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:17:07.638745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34836301-f4a3-47bb-bd2c-f3f7eb8093d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a360310>]}
08:17:07.639393 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mCREATE 3[0m in 0.07s]
08:17:07.639939 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:17:07.640242 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:17:07.640586 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:17:07.642394 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:17:07.642874 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:17:07.643197 [debug] [Thread-1  ]: finished collecting timing info
08:17:07.643451 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:17:07.651886 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:17:07.652972 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev_dev"."users" cascade
08:17:07.653603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:17:07.673192 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:17:07.676119 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:17:07.676445 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:17:07.680567 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:17:07.681154 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:17:07.681481 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:17:07.688952 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:17:07.695892 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:17:07.696228 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:17:07.698649 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:17:07.699240 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:17:07.701522 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:17:07.701862 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:17:07.702106 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:17:07.705650 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:17:07.706434 [debug] [Thread-1  ]: finished collecting timing info
08:17:07.706883 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:17:07.707596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34836301-f4a3-47bb-bd2c-f3f7eb8093d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a360610>]}
08:17:07.708128 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mCREATE 5[0m in 0.07s]
08:17:07.708719 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:17:07.729408 [debug] [MainThread]: Acquiring new postgres connection "master"
08:17:07.729961 [debug] [MainThread]: Using postgres connection "master"
08:17:07.730229 [debug] [MainThread]: On master: BEGIN
08:17:07.730426 [debug] [MainThread]: Opening a new connection, currently in state closed
08:17:07.742934 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:17:07.743547 [debug] [MainThread]: On master: COMMIT
08:17:07.744095 [debug] [MainThread]: Using postgres connection "master"
08:17:07.744890 [debug] [MainThread]: On master: COMMIT
08:17:07.747326 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:17:07.747699 [debug] [MainThread]: On master: Close
08:17:07.748254 [info ] [MainThread]: 
08:17:07.748745 [info ] [MainThread]: Finished running 3 seeds in 0.69s.
08:17:07.749155 [debug] [MainThread]: Connection 'master' was properly closed.
08:17:07.749359 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:17:07.757534 [info ] [MainThread]: 
08:17:07.758055 [info ] [MainThread]: [32mCompleted successfully[0m
08:17:07.759273 [info ] [MainThread]: 
08:17:07.760298 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:17:07.762675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e497e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a310410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4a3100d0>]}


============================== 2021-12-26 08:20:18.160985 | fa0a4525-38ab-4d3e-be7c-bf7cecea26a7 ==============================
08:20:18.160985 [info ] [MainThread]: Running with dbt=1.0.0
08:20:18.162484 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
08:20:18.162848 [debug] [MainThread]: Tracking: tracking
08:20:18.191244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e68e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e68e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e68e690>]}
08:20:18.266180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:20:18.266989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:20:18.268454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.users
- seeds.products

08:20:18.278239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa0a4525-38ab-4d3e-be7c-bf7cecea26a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e97de50>]}
08:20:18.289138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa0a4525-38ab-4d3e-be7c-bf7cecea26a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e98f650>]}
08:20:18.289901 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:20:18.291920 [info ] [MainThread]: 
08:20:18.293352 [debug] [MainThread]: Acquiring new postgres connection "master"
08:20:18.294582 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:20:18.327537 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:20:18.328034 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:20:18.328336 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:20:18.375031 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
08:20:18.378553 [debug] [ThreadPool]: On list_dbt: Close
08:20:18.381775 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:20:18.397874 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:20:18.398403 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:20:18.398805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:20:18.414411 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:20:18.415007 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:20:18.415427 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:20:18.422929 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:20:18.424568 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:20:18.426270 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:20:18.427338 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:20:18.430453 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:20:18.431021 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:20:18.431386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:20:18.442855 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:20:18.443291 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:20:18.443816 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:20:18.448998 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:20:18.450895 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:20:18.452681 [debug] [ThreadPool]: On list_dbt_dev: Close
08:20:18.459774 [debug] [MainThread]: Using postgres connection "master"
08:20:18.460281 [debug] [MainThread]: On master: BEGIN
08:20:18.460657 [debug] [MainThread]: Opening a new connection, currently in state init
08:20:18.479990 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:20:18.480425 [debug] [MainThread]: Using postgres connection "master"
08:20:18.480733 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:20:18.490566 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:20:18.492034 [debug] [MainThread]: On master: ROLLBACK
08:20:18.493508 [debug] [MainThread]: Using postgres connection "master"
08:20:18.493833 [debug] [MainThread]: On master: BEGIN
08:20:18.497750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:20:18.498458 [debug] [MainThread]: On master: COMMIT
08:20:18.498976 [debug] [MainThread]: Using postgres connection "master"
08:20:18.499539 [debug] [MainThread]: On master: COMMIT
08:20:18.506894 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
08:20:18.507366 [debug] [MainThread]: On master: Close
08:20:18.508535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:20:18.509483 [info ] [MainThread]: 
08:20:18.516470 [debug] [Thread-1  ]: Began running node model.bungie_dwh.filtered_users
08:20:18.517075 [info ] [Thread-1  ]: 1 of 1 START table model dev.filtered_users..................................... [RUN]
08:20:18.518326 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.filtered_users"
08:20:18.518922 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.filtered_users
08:20:18.519286 [debug] [Thread-1  ]: Compiling model.bungie_dwh.filtered_users
08:20:18.524935 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.filtered_users"
08:20:18.527296 [debug] [Thread-1  ]: finished collecting timing info
08:20:18.527688 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.filtered_users
08:20:18.594053 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.filtered_users"
08:20:18.594757 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.filtered_users"
08:20:18.595002 [debug] [Thread-1  ]: On model.bungie_dwh.filtered_users: BEGIN
08:20:18.595209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:20:18.609430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:20:18.610484 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.filtered_users"
08:20:18.610811 [debug] [Thread-1  ]: On model.bungie_dwh.filtered_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.filtered_users"} */


  create  table "dbt"."dev"."filtered_users__dbt_tmp"
  as (
    

SELECT
    *
FROM "dbt"."dev_dev"."users"
WHERE user_id BETWEEN 1 AND 3
  );
08:20:18.621761 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
08:20:18.629594 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.filtered_users"
08:20:18.629905 [debug] [Thread-1  ]: On model.bungie_dwh.filtered_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.filtered_users"} */
alter table "dbt"."dev"."filtered_users__dbt_tmp" rename to "filtered_users"
08:20:18.631994 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:20:18.645591 [debug] [Thread-1  ]: On model.bungie_dwh.filtered_users: COMMIT
08:20:18.645922 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.filtered_users"
08:20:18.646164 [debug] [Thread-1  ]: On model.bungie_dwh.filtered_users: COMMIT
08:20:18.650328 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:20:18.656662 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.filtered_users"
08:20:18.656989 [debug] [Thread-1  ]: On model.bungie_dwh.filtered_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.filtered_users"} */
drop table if exists "dbt"."dev"."filtered_users__dbt_backup" cascade
08:20:18.659439 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:20:18.661340 [debug] [Thread-1  ]: finished collecting timing info
08:20:18.661680 [debug] [Thread-1  ]: On model.bungie_dwh.filtered_users: Close
08:20:18.663120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa0a4525-38ab-4d3e-be7c-bf7cecea26a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e950810>]}
08:20:18.663801 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.filtered_users................................ [[32mSELECT 3[0m in 0.15s]
08:20:18.664455 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.filtered_users
08:20:18.721554 [debug] [MainThread]: Acquiring new postgres connection "master"
08:20:18.722325 [debug] [MainThread]: Using postgres connection "master"
08:20:18.722778 [debug] [MainThread]: On master: BEGIN
08:20:18.723153 [debug] [MainThread]: Opening a new connection, currently in state closed
08:20:18.737535 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:20:18.738160 [debug] [MainThread]: On master: COMMIT
08:20:18.738539 [debug] [MainThread]: Using postgres connection "master"
08:20:18.738902 [debug] [MainThread]: On master: COMMIT
08:20:18.741289 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:20:18.741759 [debug] [MainThread]: On master: Close
08:20:18.742439 [info ] [MainThread]: 
08:20:18.743317 [info ] [MainThread]: Finished running 1 table model in 0.45s.
08:20:18.744042 [debug] [MainThread]: Connection 'master' was properly closed.
08:20:18.744381 [debug] [MainThread]: Connection 'model.bungie_dwh.filtered_users' was properly closed.
08:20:18.754021 [info ] [MainThread]: 
08:20:18.755015 [info ] [MainThread]: [32mCompleted successfully[0m
08:20:18.755599 [info ] [MainThread]: 
08:20:18.756402 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:20:18.757544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e98ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e928390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95e928090>]}


============================== 2021-12-26 08:23:09.905626 | f185e10f-9c3e-4b90-b131-21a55d1f462f ==============================
08:23:09.905626 [info ] [MainThread]: Running with dbt=1.0.0
08:23:09.907308 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:23:09.908237 [debug] [MainThread]: Tracking: tracking
08:23:09.940871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e7fde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e7fd810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e7fdc50>]}
08:23:10.010006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:23:10.010736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:23:10.011848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.orders
- seeds.users

08:23:10.037009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f185e10f-9c3e-4b90-b131-21a55d1f462f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e9bdd50>]}
08:23:10.045268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f185e10f-9c3e-4b90-b131-21a55d1f462f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e9cfe10>]}
08:23:10.045734 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:23:10.047721 [info ] [MainThread]: 
08:23:10.050671 [debug] [MainThread]: Acquiring new postgres connection "master"
08:23:10.052229 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:23:10.073807 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:23:10.074384 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:23:10.075260 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:23:10.124632 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
08:23:10.127122 [debug] [ThreadPool]: On list_dbt: Close
08:23:10.130225 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:23:10.143302 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:23:10.143822 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:23:10.144105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:23:10.156935 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:23:10.157409 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:23:10.157919 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:23:10.162584 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:23:10.164390 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:23:10.166317 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:23:10.167421 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:23:10.170237 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:23:10.170650 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:23:10.171180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:23:10.182890 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:23:10.183460 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:23:10.183847 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:23:10.188752 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
08:23:10.190312 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:23:10.192161 [debug] [ThreadPool]: On list_dbt_dev: Close
08:23:10.202107 [debug] [MainThread]: Using postgres connection "master"
08:23:10.202490 [debug] [MainThread]: On master: BEGIN
08:23:10.202759 [debug] [MainThread]: Opening a new connection, currently in state init
08:23:10.214587 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:23:10.215252 [debug] [MainThread]: Using postgres connection "master"
08:23:10.215811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:23:10.229095 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:23:10.230655 [debug] [MainThread]: On master: ROLLBACK
08:23:10.232490 [debug] [MainThread]: Using postgres connection "master"
08:23:10.232843 [debug] [MainThread]: On master: BEGIN
08:23:10.237069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:23:10.237564 [debug] [MainThread]: On master: COMMIT
08:23:10.237967 [debug] [MainThread]: Using postgres connection "master"
08:23:10.238229 [debug] [MainThread]: On master: COMMIT
08:23:10.240469 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:23:10.240950 [debug] [MainThread]: On master: Close
08:23:10.241656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:23:10.242342 [info ] [MainThread]: 
08:23:10.246889 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:23:10.247536 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:23:10.248556 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:23:10.249035 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:23:10.249524 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.249856 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:23:10.321315 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:23:10.321646 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:23:10.321895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:23:10.341932 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:23:10.342316 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:23:10.342572 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
truncate table "dbt"."dev_dev"."orders"
08:23:10.345116 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
08:23:10.373599 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:23:10.373928 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:23:10.377796 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:23:10.384362 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:23:10.393096 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:23:10.393405 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:23:10.393613 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:23:10.396421 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:23:10.397241 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.397540 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:23:10.398234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f185e10f-9c3e-4b90-b131-21a55d1f462f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e981c10>]}
08:23:10.398845 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mINSERT 5[0m in 0.15s]
08:23:10.399701 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:23:10.400393 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:23:10.401184 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:23:10.402864 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:23:10.403227 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:23:10.403531 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.403783 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:23:10.415336 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:23:10.416193 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:23:10.416825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:23:10.439665 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:23:10.440043 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:23:10.440367 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
truncate table "dbt"."dev_dev"."products"
08:23:10.448676 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:23:10.454415 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:23:10.454734 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:23:10.456863 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:23:10.457511 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:23:10.459458 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:23:10.459756 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:23:10.459990 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:23:10.463675 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:23:10.464593 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.465007 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:23:10.466177 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f185e10f-9c3e-4b90-b131-21a55d1f462f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e94bfd0>]}
08:23:10.467217 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.06s]
08:23:10.469803 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:23:10.470334 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:23:10.470782 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:23:10.472212 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:23:10.472699 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:23:10.473220 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.473583 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:23:10.484945 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:23:10.487063 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:23:10.487539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:23:10.512303 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:23:10.512852 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:23:10.513188 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev_dev"."users"
08:23:10.522301 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
08:23:10.527336 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:23:10.527644 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:23:10.529631 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:23:10.530216 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:23:10.532486 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:23:10.533205 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:23:10.533840 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:23:10.539661 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
08:23:10.540397 [debug] [Thread-1  ]: finished collecting timing info
08:23:10.540676 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:23:10.541284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f185e10f-9c3e-4b90-b131-21a55d1f462f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e957b90>]}
08:23:10.541949 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.07s]
08:23:10.542563 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:23:10.559479 [debug] [MainThread]: Acquiring new postgres connection "master"
08:23:10.560024 [debug] [MainThread]: Using postgres connection "master"
08:23:10.560632 [debug] [MainThread]: On master: BEGIN
08:23:10.560902 [debug] [MainThread]: Opening a new connection, currently in state closed
08:23:10.577303 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:23:10.577882 [debug] [MainThread]: On master: COMMIT
08:23:10.578271 [debug] [MainThread]: Using postgres connection "master"
08:23:10.578620 [debug] [MainThread]: On master: COMMIT
08:23:10.580369 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:23:10.580781 [debug] [MainThread]: On master: Close
08:23:10.581505 [info ] [MainThread]: 
08:23:10.582535 [info ] [MainThread]: Finished running 3 seeds in 0.53s.
08:23:10.583370 [debug] [MainThread]: Connection 'master' was properly closed.
08:23:10.584263 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:23:10.594899 [info ] [MainThread]: 
08:23:10.595716 [info ] [MainThread]: [32mCompleted successfully[0m
08:23:10.596487 [info ] [MainThread]: 
08:23:10.597104 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:23:10.597921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e957b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e993150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868e993210>]}


============================== 2021-12-26 08:25:23.883000 | e127dc96-5951-4a86-b69e-31706d6b5416 ==============================
08:25:23.883000 [info ] [MainThread]: Running with dbt=1.0.0
08:25:23.884720 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:25:23.885646 [debug] [MainThread]: Tracking: tracking
08:25:23.908194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd767fc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd767fc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd767fc810>]}
08:25:23.977140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:25:23.977507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:25:23.978231 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.orders
- seeds.users

08:25:23.988335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e127dc96-5951-4a86-b69e-31706d6b5416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd769bb650>]}
08:25:24.002551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e127dc96-5951-4a86-b69e-31706d6b5416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd769cdb10>]}
08:25:24.003098 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:25:24.006416 [info ] [MainThread]: 
08:25:24.007791 [debug] [MainThread]: Acquiring new postgres connection "master"
08:25:24.009877 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:25:24.028735 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:25:24.030712 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:25:24.031245 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:25:24.079560 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
08:25:24.082052 [debug] [ThreadPool]: On list_dbt: Close
08:25:24.084892 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:25:24.096129 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:25:24.096480 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:25:24.096768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:25:24.110375 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:25:24.110933 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:25:24.111394 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:25:24.117315 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
08:25:24.119149 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:25:24.120986 [debug] [ThreadPool]: On list_dbt_dev: Close
08:25:24.122161 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:25:24.125064 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:25:24.125601 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:25:24.126216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:25:24.138349 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:25:24.138752 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:25:24.139197 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:25:24.143518 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:25:24.145186 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:25:24.147228 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:25:24.154519 [debug] [MainThread]: Using postgres connection "master"
08:25:24.154873 [debug] [MainThread]: On master: BEGIN
08:25:24.155140 [debug] [MainThread]: Opening a new connection, currently in state init
08:25:24.166775 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:25:24.167412 [debug] [MainThread]: Using postgres connection "master"
08:25:24.167791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:25:24.179870 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:25:24.181440 [debug] [MainThread]: On master: ROLLBACK
08:25:24.184009 [debug] [MainThread]: Using postgres connection "master"
08:25:24.184479 [debug] [MainThread]: On master: BEGIN
08:25:24.189442 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:25:24.190085 [debug] [MainThread]: On master: COMMIT
08:25:24.190394 [debug] [MainThread]: Using postgres connection "master"
08:25:24.190660 [debug] [MainThread]: On master: COMMIT
08:25:24.192902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:25:24.193285 [debug] [MainThread]: On master: Close
08:25:24.193933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:25:24.194543 [info ] [MainThread]: 
08:25:24.200239 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:25:24.200922 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:25:24.201717 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:25:24.202005 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:25:24.202584 [debug] [Thread-1  ]: finished collecting timing info
08:25:24.203021 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:25:24.265202 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:25:24.265988 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
drop table if exists "dbt"."dev_dev"."orders" cascade
08:25:24.266507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:25:24.279964 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:25:24.294978 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:25:24.295237 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:25:24.298092 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:25:24.298560 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:25:24.298857 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:25:24.302956 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
08:25:24.331077 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:25:24.331464 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:25:24.333990 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:25:24.340125 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:25:24.355292 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:25:24.355622 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:25:24.355863 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:25:24.358701 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:25:24.359546 [debug] [Thread-1  ]: finished collecting timing info
08:25:24.359963 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:25:24.360690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e127dc96-5951-4a86-b69e-31706d6b5416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd7698c790>]}
08:25:24.361297 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mCREATE 5[0m in 0.16s]
08:25:24.362207 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:25:24.362596 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:25:24.362988 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:25:24.363756 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:25:24.364526 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:25:24.365620 [debug] [Thread-1  ]: finished collecting timing info
08:25:24.365956 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:25:24.379817 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:25:24.380157 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
drop table if exists "dbt"."dev_dev"."products" cascade
08:25:24.380360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:25:24.393986 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:25:24.396509 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:25:24.396755 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:25:24.399097 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:25:24.399712 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:25:24.400188 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:25:24.411708 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:25:24.417610 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:25:24.417969 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:25:24.420779 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:25:24.421439 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:25:24.423725 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:25:24.424037 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:25:24.424269 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:25:24.427278 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:25:24.428188 [debug] [Thread-1  ]: finished collecting timing info
08:25:24.428546 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:25:24.429346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e127dc96-5951-4a86-b69e-31706d6b5416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd76959a90>]}
08:25:24.429848 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mCREATE 3[0m in 0.07s]
08:25:24.430455 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:25:24.430774 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:25:24.431155 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:25:24.431833 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:25:24.432108 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:25:24.432433 [debug] [Thread-1  ]: finished collecting timing info
08:25:24.433630 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:25:24.441225 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:25:24.441607 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev_dev"."users" cascade
08:25:24.441985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:25:24.462533 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:25:24.466398 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:25:24.466665 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:25:24.469878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:25:24.470426 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:25:24.470818 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:25:24.482896 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:25:24.493172 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:25:24.493501 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:25:24.495780 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:25:24.496697 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:25:24.499396 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:25:24.499988 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:25:24.500378 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:25:24.503777 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:25:24.505772 [debug] [Thread-1  ]: finished collecting timing info
08:25:24.506378 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:25:24.507328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e127dc96-5951-4a86-b69e-31706d6b5416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd769a4f10>]}
08:25:24.508129 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mCREATE 5[0m in 0.08s]
08:25:24.508715 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:25:24.512389 [debug] [MainThread]: Acquiring new postgres connection "master"
08:25:24.513109 [debug] [MainThread]: Using postgres connection "master"
08:25:24.513577 [debug] [MainThread]: On master: BEGIN
08:25:24.513987 [debug] [MainThread]: Opening a new connection, currently in state closed
08:25:24.537689 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
08:25:24.538405 [debug] [MainThread]: On master: COMMIT
08:25:24.538982 [debug] [MainThread]: Using postgres connection "master"
08:25:24.539420 [debug] [MainThread]: On master: COMMIT
08:25:24.542740 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:25:24.543201 [debug] [MainThread]: On master: Close
08:25:24.543909 [info ] [MainThread]: 
08:25:24.544769 [info ] [MainThread]: Finished running 3 seeds in 0.54s.
08:25:24.545442 [debug] [MainThread]: Connection 'master' was properly closed.
08:25:24.545708 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:25:24.555012 [info ] [MainThread]: 
08:25:24.555929 [info ] [MainThread]: [32mCompleted successfully[0m
08:25:24.557151 [info ] [MainThread]: 
08:25:24.557908 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:25:24.558563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd769530d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd76955750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd769a2210>]}


============================== 2021-12-26 08:31:37.992213 | 9402ad77-f63a-4ca2-8c2e-149c7758044f ==============================
08:31:37.992213 [info ] [MainThread]: Running with dbt=1.0.0
08:31:37.994640 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:31:37.996377 [debug] [MainThread]: Tracking: tracking
08:31:38.021559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3f68e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3f68e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3f68e790>]}
08:31:38.124467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:31:38.125386 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://seeds/orders.csv
08:31:38.191278 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.users
- seeds.products
- seeds.orders

08:31:38.204301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9402ad77-f63a-4ca2-8c2e-149c7758044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a40033650>]}
08:31:38.219032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9402ad77-f63a-4ca2-8c2e-149c7758044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4008fc10>]}
08:31:38.220862 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:31:38.224017 [info ] [MainThread]: 
08:31:38.225401 [debug] [MainThread]: Acquiring new postgres connection "master"
08:31:38.227020 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:31:38.256942 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:31:38.257478 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:31:38.257869 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:31:38.318058 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.06 seconds
08:31:38.321331 [debug] [ThreadPool]: On list_dbt: Close
08:31:38.324285 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:31:38.334666 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:31:38.335052 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:31:38.335383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:31:38.351428 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
08:31:38.351934 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:31:38.352482 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:31:38.358578 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
08:31:38.360440 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:31:38.362035 [debug] [ThreadPool]: On list_dbt_dev: Close
08:31:38.362917 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:31:38.365468 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:31:38.365921 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:31:38.366390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:31:38.378063 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:31:38.378525 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:31:38.378935 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:31:38.383269 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
08:31:38.386152 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:31:38.388262 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:31:38.395037 [debug] [MainThread]: Using postgres connection "master"
08:31:38.395391 [debug] [MainThread]: On master: BEGIN
08:31:38.395617 [debug] [MainThread]: Opening a new connection, currently in state init
08:31:38.407194 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:31:38.407750 [debug] [MainThread]: Using postgres connection "master"
08:31:38.408391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:31:38.421427 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:31:38.422807 [debug] [MainThread]: On master: ROLLBACK
08:31:38.424994 [debug] [MainThread]: Using postgres connection "master"
08:31:38.425327 [debug] [MainThread]: On master: BEGIN
08:31:38.429043 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:31:38.429673 [debug] [MainThread]: On master: COMMIT
08:31:38.430041 [debug] [MainThread]: Using postgres connection "master"
08:31:38.430351 [debug] [MainThread]: On master: COMMIT
08:31:38.433423 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:31:38.434066 [debug] [MainThread]: On master: Close
08:31:38.435080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:31:38.435940 [info ] [MainThread]: 
08:31:38.442483 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:31:38.443200 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:31:38.444758 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:31:38.445257 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:31:38.445572 [debug] [Thread-1  ]: finished collecting timing info
08:31:38.445830 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:31:38.514526 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:31:38.514860 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */
drop table if exists "dbt"."dev_dev"."orders" cascade
08:31:38.515098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:31:38.527358 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:31:38.545006 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:31:38.545270 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:31:38.547727 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:31:38.548601 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:31:38.549076 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:31:38.552790 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
08:31:38.584340 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:31:38.584679 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:31:38.586983 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
08:31:38.593577 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:31:38.609279 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:31:38.609612 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:31:38.609857 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:31:38.612935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:31:38.613834 [debug] [Thread-1  ]: finished collecting timing info
08:31:38.614256 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:31:38.615141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9402ad77-f63a-4ca2-8c2e-149c7758044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a40056fd0>]}
08:31:38.615694 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mCREATE 4[0m in 0.17s]
08:31:38.616647 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:31:38.617528 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:31:38.618007 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:31:38.619064 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:31:38.619488 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:31:38.620279 [debug] [Thread-1  ]: finished collecting timing info
08:31:38.621102 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:31:38.633347 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:31:38.633759 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */
drop table if exists "dbt"."dev_dev"."products" cascade
08:31:38.634644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:31:38.665409 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
08:31:38.667961 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:31:38.668210 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:31:38.674603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:31:38.675314 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:31:38.675741 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:31:38.685149 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:31:38.690449 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:31:38.690770 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:31:38.693011 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:31:38.694055 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:31:38.698402 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:31:38.698754 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:31:38.699069 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:31:38.703802 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:31:38.704795 [debug] [Thread-1  ]: finished collecting timing info
08:31:38.705232 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:31:38.706308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9402ad77-f63a-4ca2-8c2e-149c7758044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a400068d0>]}
08:31:38.707319 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mCREATE 3[0m in 0.09s]
08:31:38.708979 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:31:38.712681 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:31:38.713980 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:31:38.715820 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:31:38.716395 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:31:38.717456 [debug] [Thread-1  ]: finished collecting timing info
08:31:38.717863 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:31:38.729874 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:31:38.730196 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev_dev"."users" cascade
08:31:38.730400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:31:38.754515 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
08:31:38.769536 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:31:38.771011 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:31:38.775700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
08:31:38.777188 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:31:38.779918 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:31:38.793474 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:31:38.806421 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:31:38.808304 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:31:38.812639 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:31:38.815448 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:31:38.819442 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:31:38.819829 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:31:38.820325 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:31:38.833712 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
08:31:38.835054 [debug] [Thread-1  ]: finished collecting timing info
08:31:38.835411 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:31:38.836231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9402ad77-f63a-4ca2-8c2e-149c7758044f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3f78f110>]}
08:31:38.839182 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mCREATE 5[0m in 0.12s]
08:31:38.840568 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:31:38.863613 [debug] [MainThread]: Acquiring new postgres connection "master"
08:31:38.864150 [debug] [MainThread]: Using postgres connection "master"
08:31:38.864541 [debug] [MainThread]: On master: BEGIN
08:31:38.864896 [debug] [MainThread]: Opening a new connection, currently in state closed
08:31:38.979977 [debug] [MainThread]: SQL status: BEGIN in 0.12 seconds
08:31:38.980789 [debug] [MainThread]: On master: COMMIT
08:31:38.981553 [debug] [MainThread]: Using postgres connection "master"
08:31:38.982224 [debug] [MainThread]: On master: COMMIT
08:31:38.985106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:31:38.985657 [debug] [MainThread]: On master: Close
08:31:38.986697 [info ] [MainThread]: 
08:31:38.987784 [info ] [MainThread]: Finished running 3 seeds in 0.76s.
08:31:38.989641 [debug] [MainThread]: Connection 'master' was properly closed.
08:31:38.990097 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:31:39.002325 [info ] [MainThread]: 
08:31:39.003011 [info ] [MainThread]: [32mCompleted successfully[0m
08:31:39.003554 [info ] [MainThread]: 
08:31:39.003987 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:31:39.004511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3f78bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3f78b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a3f78b510>]}


============================== 2021-12-26 08:36:19.875897 | ab555a41-7572-4c5b-878b-b5112443ecca ==============================
08:36:19.875897 [info ] [MainThread]: Running with dbt=1.0.0
08:36:19.877971 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:36:19.878470 [debug] [MainThread]: Tracking: tracking
08:36:19.925418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6bebc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6bebc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6bebc750>]}
08:36:19.968036 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
08:36:19.969766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab555a41-7572-4c5b-878b-b5112443ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c195fd0>]}
08:36:20.034901 [debug] [MainThread]: Parsing macros/catalog.sql
08:36:20.039670 [debug] [MainThread]: Parsing macros/relations.sql
08:36:20.041577 [debug] [MainThread]: Parsing macros/adapters.sql
08:36:20.073615 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
08:36:20.076087 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:36:20.082701 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:36:20.086157 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:36:20.088532 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:36:20.113799 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:36:20.130738 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:36:20.147798 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:36:20.154322 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:36:20.156924 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:36:20.159532 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:36:20.165888 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:36:20.182027 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:36:20.184434 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:36:20.199114 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:36:20.225595 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:36:20.242152 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:36:20.249940 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:36:20.267612 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:36:20.270610 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:36:20.277161 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:36:20.282938 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:36:20.295906 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:36:20.328248 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:36:20.331874 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:36:20.336529 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:36:20.339920 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:36:20.341680 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:36:20.343024 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:36:20.344533 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:36:20.347504 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:36:20.355658 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:36:20.369866 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:36:20.375682 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:36:20.381767 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:36:20.400314 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:36:20.405436 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:36:20.414721 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:36:20.428840 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:36:20.447374 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:36:20.812868 [debug] [MainThread]: 1699: static parser successfully parsed example/filtered_users.sql
08:36:20.908301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.orders
- seeds.products
- seeds.users

08:36:20.917407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab555a41-7572-4c5b-878b-b5112443ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c1b1610>]}
08:36:20.930042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab555a41-7572-4c5b-878b-b5112443ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c1a8550>]}
08:36:20.931025 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:36:20.935037 [info ] [MainThread]: 
08:36:20.936157 [debug] [MainThread]: Acquiring new postgres connection "master"
08:36:20.938450 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:36:20.958364 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:36:20.959063 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:36:20.960084 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:36:21.035988 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.08 seconds
08:36:21.038160 [debug] [ThreadPool]: On list_dbt: Close
08:36:21.046674 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_dev"
08:36:21.047618 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_dev"
08:36:21.048335 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_dev', identifier=None)"
08:36:21.057567 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_dev"
08:36:21.057877 [debug] [ThreadPool]: On create_dbt_dev_dev: BEGIN
08:36:21.058081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:36:21.070048 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:36:21.071131 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_dev"
08:36:21.071589 [debug] [ThreadPool]: On create_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "create_dbt_dev_dev"} */
create schema if not exists "dev_dev"
08:36:21.074207 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
08:36:21.076131 [debug] [ThreadPool]: On create_dbt_dev_dev: COMMIT
08:36:21.076794 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_dev"
08:36:21.077347 [debug] [ThreadPool]: On create_dbt_dev_dev: COMMIT
08:36:21.082668 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
08:36:21.083022 [debug] [ThreadPool]: On create_dbt_dev_dev: Close
08:36:21.085269 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:36:21.093670 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:36:21.093981 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:36:21.094190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:36:21.105378 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:36:21.105851 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:36:21.106249 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:36:21.113223 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
08:36:21.114733 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:36:21.116560 [debug] [ThreadPool]: On list_dbt_dev: Close
08:36:21.117651 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_dev"
08:36:21.120240 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:36:21.120739 [debug] [ThreadPool]: On list_dbt_dev_dev: BEGIN
08:36:21.121089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:36:21.135361 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:36:21.135833 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_dev"
08:36:21.136116 [debug] [ThreadPool]: On list_dbt_dev_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_dev'
  
08:36:21.142584 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
08:36:21.144802 [debug] [ThreadPool]: On list_dbt_dev_dev: ROLLBACK
08:36:21.146714 [debug] [ThreadPool]: On list_dbt_dev_dev: Close
08:36:21.154440 [debug] [MainThread]: Using postgres connection "master"
08:36:21.154842 [debug] [MainThread]: On master: BEGIN
08:36:21.155137 [debug] [MainThread]: Opening a new connection, currently in state init
08:36:21.169767 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:36:21.170351 [debug] [MainThread]: Using postgres connection "master"
08:36:21.170728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:36:21.179018 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:36:21.180631 [debug] [MainThread]: On master: ROLLBACK
08:36:21.182472 [debug] [MainThread]: Using postgres connection "master"
08:36:21.182817 [debug] [MainThread]: On master: BEGIN
08:36:21.186678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:36:21.187344 [debug] [MainThread]: On master: COMMIT
08:36:21.187754 [debug] [MainThread]: Using postgres connection "master"
08:36:21.188048 [debug] [MainThread]: On master: COMMIT
08:36:21.190032 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:36:21.190467 [debug] [MainThread]: On master: Close
08:36:21.191230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:36:21.192050 [info ] [MainThread]: 
08:36:21.198810 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:36:21.199333 [info ] [Thread-1  ]: 1 of 3 START seed file dev_dev.orders........................................... [RUN]
08:36:21.200322 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:36:21.200720 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:36:21.201078 [debug] [Thread-1  ]: finished collecting timing info
08:36:21.201409 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:36:21.268770 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:36:21.269055 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:36:21.269275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:36:21.282786 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:36:21.283452 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:36:21.284021 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev_dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:36:21.288271 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
08:36:21.321307 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:36:21.321632 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev_dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:36:21.324488 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:36:21.330270 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:36:21.396815 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:36:21.397130 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:36:21.397338 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:36:21.401099 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:36:21.402282 [debug] [Thread-1  ]: finished collecting timing info
08:36:21.402919 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:36:21.404497 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab555a41-7572-4c5b-878b-b5112443ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c0771d0>]}
08:36:21.405042 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_dev.orders....................................... [[32mINSERT 5[0m in 0.20s]
08:36:21.405660 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:36:21.406061 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:36:21.406437 [info ] [Thread-1  ]: 2 of 3 START seed file dev_dev.products......................................... [RUN]
08:36:21.407096 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:36:21.407696 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:36:21.408050 [debug] [Thread-1  ]: finished collecting timing info
08:36:21.408400 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:36:21.416369 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:36:21.416633 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:36:21.416842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:36:21.445693 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
08:36:21.446903 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:36:21.447288 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev_dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:36:21.462037 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:36:21.465201 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:36:21.465532 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev_dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:36:21.470355 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:36:21.470934 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:36:21.472973 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:36:21.473287 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:36:21.473595 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:36:21.477317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:36:21.478271 [debug] [Thread-1  ]: finished collecting timing info
08:36:21.478597 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:36:21.479268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab555a41-7572-4c5b-878b-b5112443ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c077f10>]}
08:36:21.479916 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev_dev.products..................................... [[32mINSERT 3[0m in 0.07s]
08:36:21.480508 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:36:21.480788 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:36:21.481195 [info ] [Thread-1  ]: 3 of 3 START seed file dev_dev.users............................................ [RUN]
08:36:21.484635 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:36:21.485125 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:36:21.485769 [debug] [Thread-1  ]: finished collecting timing info
08:36:21.486427 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:36:21.496171 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:36:21.496746 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:36:21.497454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:36:21.528342 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
08:36:21.528775 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:36:21.529207 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev_dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:36:21.544710 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.02 seconds
08:36:21.557365 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:36:21.557727 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev_dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:36:21.560765 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:36:21.561730 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:36:21.565504 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:36:21.565848 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:36:21.566099 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:36:21.571829 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
08:36:21.572694 [debug] [Thread-1  ]: finished collecting timing info
08:36:21.573032 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:36:21.573986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab555a41-7572-4c5b-878b-b5112443ecca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6bed3f90>]}
08:36:21.575063 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_dev.users........................................ [[32mINSERT 5[0m in 0.09s]
08:36:21.576011 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:36:21.623226 [debug] [MainThread]: Acquiring new postgres connection "master"
08:36:21.623932 [debug] [MainThread]: Using postgres connection "master"
08:36:21.624588 [debug] [MainThread]: On master: BEGIN
08:36:21.624995 [debug] [MainThread]: Opening a new connection, currently in state closed
08:36:21.663777 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
08:36:21.664410 [debug] [MainThread]: On master: COMMIT
08:36:21.665071 [debug] [MainThread]: Using postgres connection "master"
08:36:21.665683 [debug] [MainThread]: On master: COMMIT
08:36:21.668743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:36:21.669233 [debug] [MainThread]: On master: Close
08:36:21.669945 [info ] [MainThread]: 
08:36:21.670682 [info ] [MainThread]: Finished running 3 seeds in 0.73s.
08:36:21.671331 [debug] [MainThread]: Connection 'master' was properly closed.
08:36:21.671756 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:36:21.683202 [info ] [MainThread]: 
08:36:21.684137 [info ] [MainThread]: [32mCompleted successfully[0m
08:36:21.685434 [info ] [MainThread]: 
08:36:21.686488 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:36:21.687868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c2b0d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c2f48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb6c2f44d0>]}


============================== 2021-12-26 08:39:12.293309 | 293eba42-5084-4919-8941-641a9bf09276 ==============================
08:39:12.293309 [info ] [MainThread]: Running with dbt=1.0.0
08:39:12.295324 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
08:39:12.296282 [debug] [MainThread]: Tracking: tracking
08:39:12.335284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadeea6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadeea6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadeea6e10>]}
08:39:12.373544 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
08:39:12.374358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '293eba42-5084-4919-8941-641a9bf09276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadf996fd0>]}
08:39:12.429407 [debug] [MainThread]: Parsing macros/catalog.sql
08:39:12.437996 [debug] [MainThread]: Parsing macros/relations.sql
08:39:12.440709 [debug] [MainThread]: Parsing macros/adapters.sql
08:39:12.477615 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
08:39:12.480186 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:39:12.486143 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:39:12.490743 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:39:12.493558 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:39:12.518834 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:39:12.536271 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:39:12.553548 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:39:12.560137 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:39:12.562762 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:39:12.565642 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:39:12.572060 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:39:12.588181 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:39:12.590636 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:39:12.605613 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:39:12.627983 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:39:12.639966 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:39:12.644233 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:39:12.655953 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:39:12.658269 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:39:12.662891 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:39:12.666572 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:39:12.675655 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:39:12.701883 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:39:12.704106 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:39:12.707632 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:39:12.710065 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:39:12.711398 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:39:12.712243 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:39:12.713272 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:39:12.715444 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:39:12.721870 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:39:12.734096 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:39:12.737332 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:39:12.741946 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:39:12.756161 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:39:12.760482 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:39:12.767724 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:39:12.778249 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:39:12.792542 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:39:13.071308 [debug] [MainThread]: 1699: static parser successfully parsed example/filtered_users.sql
08:39:13.172001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.users
- seeds.orders
- seeds.products

08:39:13.187301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293eba42-5084-4919-8941-641a9bf09276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadee98510>]}
08:39:13.196284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293eba42-5084-4919-8941-641a9bf09276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadf9ad750>]}
08:39:13.197643 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:39:13.200047 [info ] [MainThread]: 
08:39:13.201570 [debug] [MainThread]: Acquiring new postgres connection "master"
08:39:13.204686 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
08:39:13.225392 [debug] [ThreadPool]: Using postgres connection "list_dbt"
08:39:13.225992 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
08:39:13.226420 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:39:13.318359 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.09 seconds
08:39:13.323425 [debug] [ThreadPool]: On list_dbt: Close
08:39:13.329532 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
08:39:13.330279 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
08:39:13.330877 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev', identifier=None)"
08:39:13.345607 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
08:39:13.346208 [debug] [ThreadPool]: On create_dbt_dev: BEGIN
08:39:13.346598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:39:13.359233 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:39:13.361278 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
08:39:13.361568 [debug] [ThreadPool]: On create_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "create_dbt_dev"} */
create schema if not exists "dev"
08:39:13.364432 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
08:39:13.365589 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
08:39:13.365861 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
08:39:13.366308 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
08:39:13.370479 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
08:39:13.371073 [debug] [ThreadPool]: On create_dbt_dev: Close
08:39:13.373478 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:39:13.382307 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:39:13.382615 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:39:13.382821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:39:13.395207 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
08:39:13.395757 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:39:13.396210 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:39:13.402011 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
08:39:13.403848 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:39:13.405702 [debug] [ThreadPool]: On list_dbt_dev: Close
08:39:13.412954 [debug] [MainThread]: Using postgres connection "master"
08:39:13.413313 [debug] [MainThread]: On master: BEGIN
08:39:13.413535 [debug] [MainThread]: Opening a new connection, currently in state init
08:39:13.428393 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:39:13.428785 [debug] [MainThread]: Using postgres connection "master"
08:39:13.429066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:39:13.435776 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:39:13.437360 [debug] [MainThread]: On master: ROLLBACK
08:39:13.439005 [debug] [MainThread]: Using postgres connection "master"
08:39:13.439366 [debug] [MainThread]: On master: BEGIN
08:39:13.446589 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:39:13.447209 [debug] [MainThread]: On master: COMMIT
08:39:13.447917 [debug] [MainThread]: Using postgres connection "master"
08:39:13.448730 [debug] [MainThread]: On master: COMMIT
08:39:13.451273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:39:13.451795 [debug] [MainThread]: On master: Close
08:39:13.453283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:39:13.454322 [info ] [MainThread]: 
08:39:13.460467 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:39:13.461326 [info ] [Thread-1  ]: 1 of 3 START seed file dev.orders............................................... [RUN]
08:39:13.462172 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:39:13.462884 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:39:13.463556 [debug] [Thread-1  ]: finished collecting timing info
08:39:13.464529 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:39:13.545353 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:39:13.545923 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: BEGIN
08:39:13.546225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:39:13.557865 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
08:39:13.558577 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:39:13.559497 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.orders"} */

    create table "dbt"."dev"."orders" ("order_id" integer,"user_id" integer,"product_id" integer,"created_at" date)
  
08:39:13.564647 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
08:39:13.595975 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:39:13.596297 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: 
          insert into "dbt"."dev"."orders" ("order_id", "user_id", "product_id", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:39:13.598324 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:39:13.603630 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.orders"
08:39:13.617979 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:39:13.618405 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.orders"
08:39:13.618622 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: COMMIT
08:39:13.621198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:39:13.621947 [debug] [Thread-1  ]: finished collecting timing info
08:39:13.622218 [debug] [Thread-1  ]: On seed.bungie_dwh.orders: Close
08:39:13.622863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293eba42-5084-4919-8941-641a9bf09276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadfac9c10>]}
08:39:13.623351 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.orders........................................... [[32mINSERT 5[0m in 0.16s]
08:39:13.623915 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:39:13.624192 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:39:13.624542 [info ] [Thread-1  ]: 2 of 3 START seed file dev.products............................................. [RUN]
08:39:13.625153 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:39:13.625391 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:39:13.626840 [debug] [Thread-1  ]: finished collecting timing info
08:39:13.627544 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:39:13.635959 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:39:13.636283 [debug] [Thread-1  ]: On seed.bungie_dwh.products: BEGIN
08:39:13.636526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:39:13.656574 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
08:39:13.657022 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:39:13.657329 [debug] [Thread-1  ]: On seed.bungie_dwh.products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.products"} */

    create table "dbt"."dev"."products" ("product_id" integer,"name" text,"price" float8)
  
08:39:13.670696 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:39:13.723653 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:39:13.723959 [debug] [Thread-1  ]: On seed.bungie_dwh.products: 
          insert into "dbt"."dev"."products" ("product_id", "name", "price") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
08:39:13.725923 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
08:39:13.726461 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.products"
08:39:13.728446 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:39:13.728735 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.products"
08:39:13.729052 [debug] [Thread-1  ]: On seed.bungie_dwh.products: COMMIT
08:39:13.732013 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:39:13.733169 [debug] [Thread-1  ]: finished collecting timing info
08:39:13.733562 [debug] [Thread-1  ]: On seed.bungie_dwh.products: Close
08:39:13.734518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293eba42-5084-4919-8941-641a9bf09276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadf8cc3d0>]}
08:39:13.735128 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.products......................................... [[32mINSERT 3[0m in 0.11s]
08:39:13.735976 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:39:13.736963 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:39:13.737528 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
08:39:13.740982 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:39:13.741453 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:39:13.744019 [debug] [Thread-1  ]: finished collecting timing info
08:39:13.744455 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:39:13.761960 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:39:13.762368 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
08:39:13.767602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:39:13.796615 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
08:39:13.797234 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:39:13.797630 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
08:39:13.811002 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
08:39:13.818541 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:39:13.818865 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
08:39:13.821899 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
08:39:13.822709 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
08:39:13.825693 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:39:13.826144 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
08:39:13.826485 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
08:39:13.829338 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:39:13.830539 [debug] [Thread-1  ]: finished collecting timing info
08:39:13.830896 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
08:39:13.831807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293eba42-5084-4919-8941-641a9bf09276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadf8cc890>]}
08:39:13.832348 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mINSERT 5[0m in 0.09s]
08:39:13.833063 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:39:13.867614 [debug] [MainThread]: Acquiring new postgres connection "master"
08:39:13.868123 [debug] [MainThread]: Using postgres connection "master"
08:39:13.868369 [debug] [MainThread]: On master: BEGIN
08:39:13.868587 [debug] [MainThread]: Opening a new connection, currently in state closed
08:39:13.882175 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:39:13.883796 [debug] [MainThread]: On master: COMMIT
08:39:13.884470 [debug] [MainThread]: Using postgres connection "master"
08:39:13.884801 [debug] [MainThread]: On master: COMMIT
08:39:13.887104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:39:13.887571 [debug] [MainThread]: On master: Close
08:39:13.888560 [info ] [MainThread]: 
08:39:13.889387 [info ] [MainThread]: Finished running 3 seeds in 0.69s.
08:39:13.890136 [debug] [MainThread]: Connection 'master' was properly closed.
08:39:13.890430 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
08:39:13.899181 [info ] [MainThread]: 
08:39:13.899858 [info ] [MainThread]: [32mCompleted successfully[0m
08:39:13.900594 [info ] [MainThread]: 
08:39:13.901315 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
08:39:13.902182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadb1c3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadf8e3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadf8e3d10>]}


============================== 2021-12-26 08:39:57.558930 | c0cdcee8-8bb1-434a-bdbd-28cd813691ae ==============================
08:39:57.558930 [info ] [MainThread]: Running with dbt=1.0.0
08:39:57.561222 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
08:39:57.561984 [debug] [MainThread]: Tracking: tracking
08:39:57.618593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aff6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aff6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aff6c50>]}
08:39:57.720562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:39:57.720898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:39:57.721533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.orders
- seeds.users

08:39:57.738289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0cdcee8-8bb1-434a-bdbd-28cd813691ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b1b1650>]}
08:39:57.757772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0cdcee8-8bb1-434a-bdbd-28cd813691ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b1cd450>]}
08:39:57.758627 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
08:39:57.761382 [info ] [MainThread]: 
08:39:57.762169 [debug] [MainThread]: Acquiring new postgres connection "master"
08:39:57.763755 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
08:39:57.783470 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:39:57.783800 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
08:39:57.784022 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:39:57.835134 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
08:39:57.835691 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
08:39:57.836011 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
08:39:57.842274 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
08:39:57.845754 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
08:39:57.848075 [debug] [ThreadPool]: On list_dbt_dev: Close
08:39:57.858580 [debug] [MainThread]: Using postgres connection "master"
08:39:57.859091 [debug] [MainThread]: On master: BEGIN
08:39:57.859501 [debug] [MainThread]: Opening a new connection, currently in state init
08:39:57.872250 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
08:39:57.873219 [debug] [MainThread]: Using postgres connection "master"
08:39:57.873596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:39:57.880341 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:39:57.882115 [debug] [MainThread]: On master: ROLLBACK
08:39:57.883717 [debug] [MainThread]: On master: Close
08:39:57.884559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:39:57.885592 [info ] [MainThread]: 
08:39:57.891317 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.orders
08:39:57.892204 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.orders"
08:39:57.892609 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.orders
08:39:57.892895 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.orders
08:39:57.899000 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.orders"
08:39:57.899378 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.899620 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.orders
08:39:57.899885 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.900739 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.orders
08:39:57.901089 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.products
08:39:57.901765 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.products"
08:39:57.903310 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.products
08:39:57.904178 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.products
08:39:57.907722 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.products"
08:39:57.908054 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.908273 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.products
08:39:57.908495 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.908940 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.products
08:39:57.909202 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
08:39:57.909669 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
08:39:57.909911 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
08:39:57.910129 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
08:39:57.911791 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
08:39:57.912062 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.912278 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
08:39:57.912503 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.912934 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
08:39:57.913411 [debug] [Thread-1  ]: Began running node model.bungie_dwh.filtered_users
08:39:57.913831 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.filtered_users"
08:39:57.914056 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.filtered_users
08:39:57.914270 [debug] [Thread-1  ]: Compiling model.bungie_dwh.filtered_users
08:39:57.918341 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.filtered_users"
08:39:57.919646 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.919940 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.filtered_users
08:39:57.920181 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.920769 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.filtered_users
08:39:57.921474 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
08:39:57.922061 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d"
08:39:57.923159 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
08:39:57.923662 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
08:39:57.938505 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d"
08:39:57.941280 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.941609 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
08:39:57.941845 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.942326 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_filtered_users_user_id.470df16b5d
08:39:57.942597 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
08:39:57.943073 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a"
08:39:57.943314 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
08:39:57.943535 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
08:39:57.951286 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a"
08:39:57.952004 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.952542 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
08:39:57.952914 [debug] [Thread-1  ]: finished collecting timing info
08:39:57.953535 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a
08:39:57.992792 [debug] [MainThread]: Connection 'master' was properly closed.
08:39:57.993143 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_filtered_users_user_id.fc96a22a2a' was properly closed.
08:39:57.999548 [info ] [MainThread]: Done.
08:39:58.005782 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
08:39:58.006363 [info ] [MainThread]: Building catalog
08:39:58.010805 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
08:39:58.031128 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
08:39:58.031708 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
08:39:58.032136 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:39:58.075735 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
08:39:58.076462 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
08:39:58.076773 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
08:39:58.089725 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
08:39:58.099324 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
08:39:58.101746 [debug] [ThreadPool]: On dbt.information_schema: Close
08:39:58.117477 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dairflow/bungie_dwh/target/catalog.json
08:39:58.118739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b151350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b151a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b1518d0>]}
08:39:58.510603 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
08:39:58.511076 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-26 08:40:15.868625 | e8dcaf41-8ab6-4e22-84d3-e43c198f6283 ==============================
08:40:15.868625 [info ] [MainThread]: Running with dbt=1.0.0
08:40:15.870156 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
08:40:15.871011 [debug] [MainThread]: Tracking: tracking
08:40:15.890497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda15eb82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda15eb8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda15eb8d50>]}
08:40:15.898401 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
08:40:15.900533 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
08:40:15.901547 [info ] [MainThread]: 
08:40:15.902535 [info ] [MainThread]: 
08:40:15.903027 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 17:15:00.527755 | 71834e15-db14-4296-b305-8926fd826b48 ==============================
17:15:00.527755 [info ] [MainThread]: Running with dbt=1.0.0
17:15:00.529648 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
17:15:00.530414 [debug] [MainThread]: Tracking: tracking
17:15:00.570475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f6b5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6e20d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f6b5d10>]}
17:15:00.650324 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
17:15:00.650982 [debug] [MainThread]: Partial parsing: added file: bungie_dwh://seeds/sessions.csv
17:15:00.651393 [debug] [MainThread]: Partial parsing: added file: bungie_dwh://seeds/payments.csv
17:15:00.651775 [debug] [MainThread]: Partial parsing: deleted file: bungie_dwh://seeds/orders.csv
17:15:00.652235 [debug] [MainThread]: Partial parsing: deleted file: bungie_dwh://seeds/products.csv
17:15:00.701493 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'seeds' section of file 'seeds/dev.yml'
17:15:00.704725 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'products' in the 'seeds' section of file 'seeds/dev.yml'
17:15:00.712384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.products
- seeds.users
- seeds.orders

17:15:00.728312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71834e15-db14-4296-b305-8926fd826b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f859f90>]}
17:15:00.741716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71834e15-db14-4296-b305-8926fd826b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f88df50>]}
17:15:00.746040 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:15:00.750588 [info ] [MainThread]: 
17:15:00.752027 [debug] [MainThread]: Acquiring new postgres connection "master"
17:15:00.756048 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:15:00.885378 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:15:00.886009 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:15:00.886463 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:15:01.053462 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.17 seconds
17:15:01.057449 [debug] [ThreadPool]: On list_dbt: Close
17:15:01.060127 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:15:01.074224 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:15:01.074537 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:15:01.074758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:15:01.089111 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:15:01.089965 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:15:01.090739 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:15:01.109894 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.02 seconds
17:15:01.111585 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:15:01.113219 [debug] [ThreadPool]: On list_dbt_dev: Close
17:15:01.120620 [debug] [MainThread]: Using postgres connection "master"
17:15:01.120972 [debug] [MainThread]: On master: BEGIN
17:15:01.121332 [debug] [MainThread]: Opening a new connection, currently in state init
17:15:01.132893 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:15:01.133394 [debug] [MainThread]: Using postgres connection "master"
17:15:01.133964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:15:01.157606 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
17:15:01.160155 [debug] [MainThread]: On master: ROLLBACK
17:15:01.164979 [debug] [MainThread]: Using postgres connection "master"
17:15:01.165488 [debug] [MainThread]: On master: BEGIN
17:15:01.168658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:15:01.169276 [debug] [MainThread]: On master: COMMIT
17:15:01.169701 [debug] [MainThread]: Using postgres connection "master"
17:15:01.170023 [debug] [MainThread]: On master: COMMIT
17:15:01.172377 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:15:01.172783 [debug] [MainThread]: On master: Close
17:15:01.173471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:15:01.174199 [info ] [MainThread]: 
17:15:01.181372 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
17:15:01.181944 [info ] [Thread-1  ]: 1 of 3 START seed file dev.payments............................................. [RUN]
17:15:01.182939 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
17:15:01.183312 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
17:15:01.183803 [debug] [Thread-1  ]: finished collecting timing info
17:15:01.184205 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
17:15:01.266316 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:15:01.266559 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: BEGIN
17:15:01.266751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:15:01.280022 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:15:01.280609 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:15:01.280938 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */

    create table "dbt"."dev"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" date)
  
17:15:01.296480 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.02 seconds
17:15:01.322781 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:15:01.323104 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: 
          insert into "dbt"."dev"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:15:01.326404 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
17:15:01.332921 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.payments"
17:15:01.354030 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:15:01.354631 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:15:01.355225 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:15:01.360824 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:15:01.362116 [debug] [Thread-1  ]: finished collecting timing info
17:15:01.362631 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: Close
17:15:01.363748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71834e15-db14-4296-b305-8926fd826b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f857bd0>]}
17:15:01.364583 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.payments......................................... [[32mINSERT 3[0m in 0.18s]
17:15:01.365729 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
17:15:01.366242 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
17:15:01.366659 [info ] [Thread-1  ]: 2 of 3 START seed file dev.sessions............................................. [RUN]
17:15:01.368308 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
17:15:01.368775 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
17:15:01.369453 [debug] [Thread-1  ]: finished collecting timing info
17:15:01.370318 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
17:15:01.384235 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:15:01.384867 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: BEGIN
17:15:01.385327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:15:01.436330 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
17:15:01.436951 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:15:01.437456 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */

    create table "dbt"."dev"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" text)
  
17:15:01.487468 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.05 seconds
17:15:01.495151 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:15:01.495634 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: 
          insert into "dbt"."dev"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:15:01.498993 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
17:15:01.500084 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.sessions"
17:15:01.503995 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:15:01.504548 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:15:01.505049 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:15:01.508656 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:15:01.509460 [debug] [Thread-1  ]: finished collecting timing info
17:15:01.509769 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: Close
17:15:01.510522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71834e15-db14-4296-b305-8926fd826b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f88acd0>]}
17:15:01.511480 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.sessions......................................... [[32mINSERT 4[0m in 0.14s]
17:15:01.512491 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
17:15:01.513011 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
17:15:01.513623 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
17:15:01.515273 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
17:15:01.515696 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
17:15:01.516391 [debug] [Thread-1  ]: finished collecting timing info
17:15:01.517045 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
17:15:01.544337 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:15:01.544654 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
17:15:01.544891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:15:01.564238 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:15:01.564750 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:15:01.565050 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev"."users"
17:15:01.574548 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
17:15:01.581263 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:15:01.581583 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:15:01.583933 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
17:15:01.584617 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
17:15:01.587304 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:15:01.587597 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:15:01.587821 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:15:01.590970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:15:01.592053 [debug] [Thread-1  ]: finished collecting timing info
17:15:01.592502 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
17:15:01.593415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71834e15-db14-4296-b305-8926fd826b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f80ed10>]}
17:15:01.593879 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mINSERT 5[0m in 0.08s]
17:15:01.594435 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
17:15:01.694433 [debug] [MainThread]: Acquiring new postgres connection "master"
17:15:01.695027 [debug] [MainThread]: Using postgres connection "master"
17:15:01.695418 [debug] [MainThread]: On master: BEGIN
17:15:01.695778 [debug] [MainThread]: Opening a new connection, currently in state closed
17:15:01.709337 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:15:01.709934 [debug] [MainThread]: On master: COMMIT
17:15:01.710328 [debug] [MainThread]: Using postgres connection "master"
17:15:01.710636 [debug] [MainThread]: On master: COMMIT
17:15:01.712797 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:15:01.713174 [debug] [MainThread]: On master: Close
17:15:01.713879 [info ] [MainThread]: 
17:15:01.714731 [info ] [MainThread]: Finished running 3 seeds in 0.96s.
17:15:01.716006 [debug] [MainThread]: Connection 'master' was properly closed.
17:15:01.716559 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
17:15:01.729854 [info ] [MainThread]: 
17:15:01.731301 [info ] [MainThread]: [32mCompleted successfully[0m
17:15:01.732307 [info ] [MainThread]: 
17:15:01.732861 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
17:15:01.734199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f85f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f808210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6f8083d0>]}


============================== 2021-12-26 17:22:05.874296 | 74244e1e-7883-44ca-a373-7029bde849c6 ==============================
17:22:05.874296 [info ] [MainThread]: Running with dbt=1.0.0
17:22:05.875843 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
17:22:05.876211 [debug] [MainThread]: Tracking: tracking
17:22:05.902257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec87ebd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec87ebd510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec87ebd790>]}
17:22:05.949780 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
17:22:05.950772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74244e1e-7883-44ca-a373-7029bde849c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec82b4f310>]}
17:22:05.993563 [debug] [MainThread]: Parsing macros/catalog.sql
17:22:06.005048 [debug] [MainThread]: Parsing macros/relations.sql
17:22:06.011343 [debug] [MainThread]: Parsing macros/adapters.sql
17:22:06.045870 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:22:06.048932 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:22:06.054640 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:22:06.058239 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:22:06.060639 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:22:06.086321 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:22:06.102512 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:22:06.120473 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:22:06.127103 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:22:06.129710 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:22:06.132309 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:22:06.138960 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:22:06.155056 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:22:06.157338 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:22:06.172292 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:22:06.194441 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:22:06.205327 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:22:06.209519 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:22:06.219813 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:22:06.221800 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:22:06.225622 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:22:06.229359 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:22:06.238328 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:22:06.262102 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:22:06.264414 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:22:06.268194 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:22:06.270525 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:22:06.271878 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:22:06.272771 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:22:06.273817 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:22:06.276164 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:22:06.282581 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:22:06.295077 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:22:06.298370 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:22:06.302297 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:22:06.317964 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:22:06.322231 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:22:06.328568 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:22:06.339505 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:22:06.353630 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:22:06.613595 [debug] [MainThread]: 1699: static parser successfully parsed example/filtered_users.sql
17:22:06.712787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.users
- seeds.payments
- seeds.sessions

17:22:06.721513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74244e1e-7883-44ca-a373-7029bde849c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec88a1e1d0>]}
17:22:06.736016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74244e1e-7883-44ca-a373-7029bde849c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec88974610>]}
17:22:06.736801 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:22:06.739532 [info ] [MainThread]: 
17:22:06.740497 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:06.742097 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:22:06.761706 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:22:06.762072 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:22:06.762326 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:06.821515 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
17:22:06.823912 [debug] [ThreadPool]: On list_dbt: Close
17:22:06.826827 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:22:06.839789 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:22:06.840356 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:22:06.840834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:22:06.860420 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
17:22:06.861001 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:22:06.861584 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:22:06.868526 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
17:22:06.871091 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:22:06.873919 [debug] [ThreadPool]: On list_dbt_dev: Close
17:22:06.885129 [debug] [MainThread]: Using postgres connection "master"
17:22:06.885671 [debug] [MainThread]: On master: BEGIN
17:22:06.886274 [debug] [MainThread]: Opening a new connection, currently in state init
17:22:06.904167 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:22:06.904939 [debug] [MainThread]: Using postgres connection "master"
17:22:06.905373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:22:06.921073 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
17:22:06.923625 [debug] [MainThread]: On master: ROLLBACK
17:22:06.926145 [debug] [MainThread]: Using postgres connection "master"
17:22:06.926745 [debug] [MainThread]: On master: BEGIN
17:22:06.931580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:06.933658 [debug] [MainThread]: On master: COMMIT
17:22:06.935093 [debug] [MainThread]: Using postgres connection "master"
17:22:06.935867 [debug] [MainThread]: On master: COMMIT
17:22:06.939551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:06.940682 [debug] [MainThread]: On master: Close
17:22:06.942326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:22:06.943486 [info ] [MainThread]: 
17:22:06.972146 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
17:22:06.973288 [info ] [Thread-1  ]: 1 of 3 START seed file dev.payments............................................. [RUN]
17:22:06.974782 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
17:22:06.976694 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
17:22:06.977336 [debug] [Thread-1  ]: finished collecting timing info
17:22:06.977899 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
17:22:07.098602 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:22:07.099035 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: BEGIN
17:22:07.099322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:22:07.115583 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:22:07.116176 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:22:07.116638 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */
truncate table "dbt"."dev"."payments"
17:22:07.121084 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
17:22:07.153320 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:22:07.153725 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: 
          insert into "dbt"."dev"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:22:07.158577 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
17:22:07.165659 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.payments"
17:22:07.174948 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:22:07.175318 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:22:07.175569 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:22:07.178719 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:22:07.179487 [debug] [Thread-1  ]: finished collecting timing info
17:22:07.179765 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: Close
17:22:07.180866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74244e1e-7883-44ca-a373-7029bde849c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec889bad50>]}
17:22:07.181666 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.payments......................................... [[32mINSERT 3[0m in 0.21s]
17:22:07.182638 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
17:22:07.183184 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
17:22:07.183861 [info ] [Thread-1  ]: 2 of 3 START seed file dev.sessions............................................. [RUN]
17:22:07.185212 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
17:22:07.185656 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
17:22:07.185941 [debug] [Thread-1  ]: finished collecting timing info
17:22:07.186195 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
17:22:07.200417 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:22:07.200929 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: BEGIN
17:22:07.201454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:22:07.274148 [debug] [Thread-1  ]: SQL status: BEGIN in 0.07 seconds
17:22:07.274745 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:22:07.275024 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */
truncate table "dbt"."dev"."sessions"
17:22:07.285780 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
17:22:07.290678 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:22:07.291083 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: 
          insert into "dbt"."dev"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:22:07.297922 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.01 seconds
17:22:07.299000 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.sessions"
17:22:07.303328 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:22:07.304103 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:22:07.304787 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:22:07.318853 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:22:07.321709 [debug] [Thread-1  ]: finished collecting timing info
17:22:07.322457 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: Close
17:22:07.324680 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74244e1e-7883-44ca-a373-7029bde849c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec8890c050>]}
17:22:07.325957 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.sessions......................................... [[32mINSERT 4[0m in 0.14s]
17:22:07.328277 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
17:22:07.333785 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
17:22:07.334571 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
17:22:07.335895 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
17:22:07.336540 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
17:22:07.337217 [debug] [Thread-1  ]: finished collecting timing info
17:22:07.337851 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
17:22:07.351030 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:22:07.351455 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
17:22:07.351725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:22:07.402594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
17:22:07.403173 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:22:07.403802 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
truncate table "dbt"."dev"."users"
17:22:07.416353 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.01 seconds
17:22:07.423650 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:22:07.423989 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:22:07.426400 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
17:22:07.427262 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
17:22:07.430666 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:22:07.431310 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:22:07.432311 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:22:07.436147 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:22:07.437002 [debug] [Thread-1  ]: finished collecting timing info
17:22:07.437320 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
17:22:07.438162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74244e1e-7883-44ca-a373-7029bde849c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec88938ed0>]}
17:22:07.438771 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mINSERT 5[0m in 0.10s]
17:22:07.439993 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
17:22:07.484026 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:07.484428 [debug] [MainThread]: Using postgres connection "master"
17:22:07.484690 [debug] [MainThread]: On master: BEGIN
17:22:07.484901 [debug] [MainThread]: Opening a new connection, currently in state closed
17:22:07.502707 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:22:07.503091 [debug] [MainThread]: On master: COMMIT
17:22:07.503359 [debug] [MainThread]: Using postgres connection "master"
17:22:07.503594 [debug] [MainThread]: On master: COMMIT
17:22:07.505498 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:07.505888 [debug] [MainThread]: On master: Close
17:22:07.506607 [info ] [MainThread]: 
17:22:07.507641 [info ] [MainThread]: Finished running 3 seeds in 0.77s.
17:22:07.508426 [debug] [MainThread]: Connection 'master' was properly closed.
17:22:07.508804 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
17:22:07.518730 [info ] [MainThread]: 
17:22:07.519540 [info ] [MainThread]: [32mCompleted successfully[0m
17:22:07.520146 [info ] [MainThread]: 
17:22:07.520574 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
17:22:07.521103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec88af6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec88af6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec88af6890>]}


============================== 2021-12-26 17:23:03.251865 | f1c46bca-7124-48f7-924f-11f5a97b38ba ==============================
17:23:03.251865 [info ] [MainThread]: Running with dbt=1.0.0
17:23:03.254094 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
17:23:03.254597 [debug] [MainThread]: Tracking: tracking
17:23:03.289980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b6bc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b6bc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b6bc8d0>]}
17:23:03.353284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:23:03.353602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:23:03.354204 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.example
- seeds.sessions
- seeds.payments
- seeds.users

17:23:03.363815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c46bca-7124-48f7-924f-11f5a97b38ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b97cf50>]}
17:23:03.376593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c46bca-7124-48f7-924f-11f5a97b38ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b98db10>]}
17:23:03.378000 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:23:03.380776 [info ] [MainThread]: 
17:23:03.381680 [debug] [MainThread]: Acquiring new postgres connection "master"
17:23:03.383729 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:23:03.405154 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:23:03.405748 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:23:03.406100 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:23:03.453864 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
17:23:03.456091 [debug] [ThreadPool]: On list_dbt: Close
17:23:03.458474 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:23:03.467272 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:23:03.467663 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:23:03.468250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:23:03.481844 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:23:03.482485 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:23:03.482974 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:23:03.488598 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
17:23:03.490850 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:23:03.493399 [debug] [ThreadPool]: On list_dbt_dev: Close
17:23:03.502552 [debug] [MainThread]: Using postgres connection "master"
17:23:03.502984 [debug] [MainThread]: On master: BEGIN
17:23:03.503332 [debug] [MainThread]: Opening a new connection, currently in state init
17:23:03.515499 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:23:03.516076 [debug] [MainThread]: Using postgres connection "master"
17:23:03.516405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:23:03.524793 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:23:03.526450 [debug] [MainThread]: On master: ROLLBACK
17:23:03.527944 [debug] [MainThread]: Using postgres connection "master"
17:23:03.528314 [debug] [MainThread]: On master: BEGIN
17:23:03.531842 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:23:03.532552 [debug] [MainThread]: On master: COMMIT
17:23:03.532948 [debug] [MainThread]: Using postgres connection "master"
17:23:03.533224 [debug] [MainThread]: On master: COMMIT
17:23:03.535394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:23:03.535960 [debug] [MainThread]: On master: Close
17:23:03.537039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:23:03.538165 [info ] [MainThread]: 
17:23:03.545039 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
17:23:03.545549 [info ] [Thread-1  ]: 1 of 3 START seed file dev.payments............................................. [RUN]
17:23:03.546436 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
17:23:03.546737 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
17:23:03.547777 [debug] [Thread-1  ]: finished collecting timing info
17:23:03.548362 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
17:23:03.622171 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:23:03.622509 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */
drop table if exists "dbt"."dev"."payments" cascade
17:23:03.622744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:23:03.642357 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
17:23:03.656174 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:23:03.656447 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: BEGIN
17:23:03.658478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:23:03.659130 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:23:03.659469 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */

    create table "dbt"."dev"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
17:23:03.663262 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
17:23:03.691810 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:23:03.692150 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: 
          insert into "dbt"."dev"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:23:03.694342 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
17:23:03.700171 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.payments"
17:23:03.716181 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:23:03.716688 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:23:03.717076 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:23:03.720421 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:23:03.721370 [debug] [Thread-1  ]: finished collecting timing info
17:23:03.721734 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: Close
17:23:03.722946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c46bca-7124-48f7-924f-11f5a97b38ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b933c10>]}
17:23:03.723874 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.payments......................................... [[32mCREATE 3[0m in 0.18s]
17:23:03.724999 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
17:23:03.725721 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
17:23:03.726356 [info ] [Thread-1  ]: 2 of 3 START seed file dev.sessions............................................. [RUN]
17:23:03.728855 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
17:23:03.729274 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
17:23:03.729887 [debug] [Thread-1  ]: finished collecting timing info
17:23:03.730297 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
17:23:03.742727 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:23:03.743251 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */
drop table if exists "dbt"."dev"."sessions" cascade
17:23:03.743826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:23:03.811975 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.07 seconds
17:23:03.818037 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:23:03.818510 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: BEGIN
17:23:03.822761 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:23:03.823978 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:23:03.824729 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */

    create table "dbt"."dev"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
17:23:03.833926 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
17:23:03.844654 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:23:03.845250 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: 
          insert into "dbt"."dev"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:23:03.848832 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
17:23:03.849765 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.sessions"
17:23:03.852895 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:23:03.853228 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:23:03.853759 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:23:03.858485 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:23:03.859927 [debug] [Thread-1  ]: finished collecting timing info
17:23:03.860554 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: Close
17:23:03.861780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c46bca-7124-48f7-924f-11f5a97b38ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b92d150>]}
17:23:03.862216 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.sessions......................................... [[32mCREATE 4[0m in 0.13s]
17:23:03.862683 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
17:23:03.862943 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
17:23:03.863265 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
17:23:03.864044 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
17:23:03.864932 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
17:23:03.865605 [debug] [Thread-1  ]: finished collecting timing info
17:23:03.866184 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
17:23:03.876427 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:23:03.877039 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev"."users" cascade
17:23:03.878400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:23:03.903082 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
17:23:03.910059 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:23:03.910423 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
17:23:03.912900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:23:03.913532 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:23:03.913928 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text)
  
17:23:03.924519 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
17:23:03.933247 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:23:03.933606 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:23:03.936174 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
17:23:03.936856 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
17:23:03.939032 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:23:03.939329 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:23:03.939561 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:23:03.942545 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:23:03.943400 [debug] [Thread-1  ]: finished collecting timing info
17:23:03.943774 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
17:23:03.944694 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c46bca-7124-48f7-924f-11f5a97b38ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b958b10>]}
17:23:03.945476 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mCREATE 5[0m in 0.08s]
17:23:03.946116 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
17:23:03.958310 [debug] [MainThread]: Acquiring new postgres connection "master"
17:23:03.958966 [debug] [MainThread]: Using postgres connection "master"
17:23:03.959474 [debug] [MainThread]: On master: BEGIN
17:23:03.959887 [debug] [MainThread]: Opening a new connection, currently in state closed
17:23:03.985966 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
17:23:03.986473 [debug] [MainThread]: On master: COMMIT
17:23:03.986838 [debug] [MainThread]: Using postgres connection "master"
17:23:03.987129 [debug] [MainThread]: On master: COMMIT
17:23:03.989042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:23:03.989463 [debug] [MainThread]: On master: Close
17:23:03.990436 [info ] [MainThread]: 
17:23:03.991567 [info ] [MainThread]: Finished running 3 seeds in 0.61s.
17:23:03.992299 [debug] [MainThread]: Connection 'master' was properly closed.
17:23:03.992986 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
17:23:04.004160 [info ] [MainThread]: 
17:23:04.004719 [info ] [MainThread]: [32mCompleted successfully[0m
17:23:04.005507 [info ] [MainThread]: 
17:23:04.007014 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
17:23:04.007698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b9174d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b96d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa13b96d490>]}


============================== 2021-12-26 17:28:43.192080 | 9cca28fb-acdc-4f02-a134-a70746ccd560 ==============================
17:28:43.192080 [info ] [MainThread]: Running with dbt=1.0.0
17:28:43.194517 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
17:28:43.195146 [debug] [MainThread]: Tracking: tracking
17:28:43.246408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8232e8c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8232e8c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8232e8cad0>]}
17:28:43.421955 [debug] [MainThread]: Executing "git --help"
17:28:43.461438 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:28:43.462456 [debug] [MainThread]: STDERR: "b''"
17:28:43.472269 [debug] [MainThread]: Acquiring new postgres connection "debug"
17:28:43.474418 [debug] [MainThread]: Using postgres connection "debug"
17:28:43.474902 [debug] [MainThread]: On debug: select 1 as id
17:28:43.475477 [debug] [MainThread]: Opening a new connection, currently in state init
17:28:43.550244 [debug] [MainThread]: SQL status: SELECT 1 in 0.07 seconds
17:28:43.559900 [debug] [MainThread]: On debug: Close
17:28:43.570999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8232eace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8232e98710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8232eb75d0>]}
17:28:44.077695 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-26 17:48:52.809950 | 76192f75-190d-4e31-b26e-b87086cfe38d ==============================
17:48:52.809950 [info ] [MainThread]: Running with dbt=1.0.0
17:48:52.811173 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
17:48:52.811563 [debug] [MainThread]: Tracking: tracking
17:48:52.860826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bee6e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bee6edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bee6e790>]}
17:48:53.006459 [debug] [MainThread]: Executing "git --help"
17:48:53.037782 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:48:53.038683 [debug] [MainThread]: STDERR: "b''"
17:48:53.053720 [debug] [MainThread]: Acquiring new postgres connection "debug"
17:48:53.056859 [debug] [MainThread]: Using postgres connection "debug"
17:48:53.059228 [debug] [MainThread]: On debug: select 1 as id
17:48:53.064021 [debug] [MainThread]: Opening a new connection, currently in state init
17:48:53.163055 [debug] [MainThread]: SQL status: SELECT 1 in 0.1 seconds
17:48:53.168819 [debug] [MainThread]: On debug: Close
17:48:53.170053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bee8f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2be34c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bee54e10>]}
17:48:53.736404 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-26 17:50:07.307755 | f81b288f-951c-46ef-99f2-1d2cd440a8f1 ==============================
17:50:07.307755 [info ] [MainThread]: Running with dbt=1.0.0
17:50:07.309272 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
17:50:07.309688 [debug] [MainThread]: Tracking: tracking
17:50:07.331312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c967c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c967c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c967c950>]}
17:50:07.369218 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
17:50:07.370180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f81b288f-951c-46ef-99f2-1d2cd440a8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ca155fd0>]}
17:50:07.421618 [debug] [MainThread]: Parsing macros/catalog.sql
17:50:07.428648 [debug] [MainThread]: Parsing macros/relations.sql
17:50:07.430974 [debug] [MainThread]: Parsing macros/adapters.sql
17:50:07.462248 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:50:07.465027 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:50:07.470569 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:50:07.473883 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:50:07.476270 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:50:07.501556 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:50:07.517410 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:50:07.534360 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:50:07.540965 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:50:07.543762 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:50:07.547112 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:50:07.555849 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:50:07.574524 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:50:07.576825 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:50:07.592356 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:50:07.615566 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:50:07.626300 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:50:07.630536 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:50:07.640650 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:50:07.642579 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:50:07.646420 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:50:07.649743 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:50:07.658522 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:50:07.681424 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:50:07.683562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:50:07.687046 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:50:07.689299 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:50:07.690622 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:50:07.691489 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:50:07.692505 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:50:07.694639 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:50:07.700969 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:50:07.712882 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:50:07.716020 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:50:07.719845 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:50:07.733427 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:50:07.737615 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:50:07.743908 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:50:07.754862 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:50:07.768878 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:50:08.025968 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
17:50:08.043967 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
17:50:08.127437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- seeds.users
- seeds.sessions
- seeds.payments

17:50:08.134861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f81b288f-951c-46ef-99f2-1d2cd440a8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ca175d90>]}
17:50:08.148547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f81b288f-951c-46ef-99f2-1d2cd440a8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ca186d50>]}
17:50:08.149605 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:50:08.152466 [info ] [MainThread]: 
17:50:08.153414 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:08.154729 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:50:08.169941 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:50:08.170392 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:50:08.171176 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:50:08.238874 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.07 seconds
17:50:08.241217 [debug] [ThreadPool]: On list_dbt: Close
17:50:08.244056 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:50:08.256540 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:50:08.256931 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:50:08.257162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:50:08.270972 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:50:08.271372 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:50:08.271681 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:50:08.276952 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
17:50:08.278703 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:50:08.280803 [debug] [ThreadPool]: On list_dbt_dev: Close
17:50:08.289574 [debug] [MainThread]: Using postgres connection "master"
17:50:08.289977 [debug] [MainThread]: On master: BEGIN
17:50:08.290231 [debug] [MainThread]: Opening a new connection, currently in state init
17:50:08.302293 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:50:08.302847 [debug] [MainThread]: Using postgres connection "master"
17:50:08.303222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:50:08.311623 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:50:08.313596 [debug] [MainThread]: On master: ROLLBACK
17:50:08.315421 [debug] [MainThread]: Using postgres connection "master"
17:50:08.315783 [debug] [MainThread]: On master: BEGIN
17:50:08.319164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:08.319897 [debug] [MainThread]: On master: COMMIT
17:50:08.320357 [debug] [MainThread]: Using postgres connection "master"
17:50:08.320912 [debug] [MainThread]: On master: COMMIT
17:50:08.323088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:08.323478 [debug] [MainThread]: On master: Close
17:50:08.324102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:50:08.324769 [info ] [MainThread]: 
17:50:08.329895 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
17:50:08.330747 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
17:50:08.331723 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
17:50:08.332130 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
17:50:08.332926 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
17:50:08.338588 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
17:50:08.340533 [debug] [Thread-1  ]: finished collecting timing info
17:50:08.341941 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
17:50:08.422028 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
17:50:08.423073 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:50:08.423493 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
17:50:08.423812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:50:08.440348 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:50:08.441911 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:50:08.442335 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    DATE() AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= 
AND b.created_at <= 
AND c.created_at <= 
GROUP BY 1,2,3,4,5
  );
  
17:50:08.448658 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "AND"
LINE 23: AND b.created_at <= 
         ^

17:50:08.450659 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
17:50:08.453079 [debug] [Thread-1  ]: finished collecting timing info
17:50:08.453442 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
17:50:08.456104 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  syntax error at or near "AND"
  LINE 23: AND b.created_at <= 
           ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:50:08.459089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f81b288f-951c-46ef-99f2-1d2cd440a8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ca291e50>]}
17:50:08.459906 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.13s]
17:50:08.461651 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
17:50:08.533080 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:08.533642 [debug] [MainThread]: Using postgres connection "master"
17:50:08.534032 [debug] [MainThread]: On master: BEGIN
17:50:08.534390 [debug] [MainThread]: Opening a new connection, currently in state closed
17:50:08.550347 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:50:08.550860 [debug] [MainThread]: On master: COMMIT
17:50:08.551330 [debug] [MainThread]: Using postgres connection "master"
17:50:08.551915 [debug] [MainThread]: On master: COMMIT
17:50:08.554047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:08.554458 [debug] [MainThread]: On master: Close
17:50:08.555143 [info ] [MainThread]: 
17:50:08.556007 [info ] [MainThread]: Finished running 1 incremental model in 0.40s.
17:50:08.556620 [debug] [MainThread]: Connection 'master' was properly closed.
17:50:08.556916 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
17:50:08.635499 [info ] [MainThread]: 
17:50:08.635953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:50:08.637076 [info ] [MainThread]: 
17:50:08.638469 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
17:50:08.639611 [error] [MainThread]:   syntax error at or near "AND"
17:50:08.641009 [error] [MainThread]:   LINE 23: AND b.created_at <= 
17:50:08.642179 [error] [MainThread]:            ^
17:50:08.643768 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:50:08.646030 [info ] [MainThread]: 
17:50:08.647710 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
17:50:08.650680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c9720a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c9737b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c9737850>]}


============================== 2021-12-26 17:51:25.208132 | 43d2690a-b645-417b-a5e5-736c4643f969 ==============================
17:51:25.208132 [info ] [MainThread]: Running with dbt=1.0.0
17:51:25.210432 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
17:51:25.211422 [debug] [MainThread]: Tracking: tracking
17:51:25.234400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ce8eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0cfb5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ce8e150>]}
17:51:25.277862 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
17:51:25.278535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43d2690a-b645-417b-a5e5-736c4643f969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0d07dfd0>]}
17:51:25.336321 [debug] [MainThread]: Parsing macros/catalog.sql
17:51:25.348432 [debug] [MainThread]: Parsing macros/relations.sql
17:51:25.351321 [debug] [MainThread]: Parsing macros/adapters.sql
17:51:25.392918 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:51:25.395840 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:51:25.404509 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:51:25.408243 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:51:25.411432 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:51:25.444683 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:51:25.466979 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:51:25.495775 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:51:25.506794 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:51:25.509504 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:51:25.513034 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:51:25.523274 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:51:25.541656 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:51:25.544520 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:51:25.561824 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:51:25.587589 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:51:25.598758 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:51:25.604370 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:51:25.614916 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:51:25.618115 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:51:25.623339 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:51:25.626774 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:51:25.638509 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:51:25.663544 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:51:25.666400 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:51:25.670774 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:51:25.673188 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:51:25.674481 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:51:25.675304 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:51:25.676318 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:51:25.678449 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:51:25.685930 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:51:25.697822 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:51:25.701959 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:51:25.706383 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:51:25.721404 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:51:25.725652 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:51:25.732686 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:51:25.743591 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:51:25.759040 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:51:26.031185 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
17:51:26.051107 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
17:51:26.153299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43d2690a-b645-417b-a5e5-736c4643f969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0d0a8050>]}
17:51:26.161004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43d2690a-b645-417b-a5e5-736c4643f969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0d0c6c50>]}
17:51:26.161486 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:51:26.163487 [info ] [MainThread]: 
17:51:26.164403 [debug] [MainThread]: Acquiring new postgres connection "master"
17:51:26.166358 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:51:26.192835 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:51:26.193941 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:51:26.194211 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:51:26.253227 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
17:51:26.255886 [debug] [ThreadPool]: On list_dbt: Close
17:51:26.258855 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:51:26.271945 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:51:26.272342 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:51:26.272615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:51:26.288327 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
17:51:26.288847 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:51:26.289178 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:51:26.298915 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
17:51:26.301059 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:51:26.304284 [debug] [ThreadPool]: On list_dbt_dev: Close
17:51:26.316440 [debug] [MainThread]: Using postgres connection "master"
17:51:26.317117 [debug] [MainThread]: On master: BEGIN
17:51:26.317540 [debug] [MainThread]: Opening a new connection, currently in state init
17:51:26.335147 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:51:26.335667 [debug] [MainThread]: Using postgres connection "master"
17:51:26.336124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:51:26.344425 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:51:26.346547 [debug] [MainThread]: On master: ROLLBACK
17:51:26.348017 [debug] [MainThread]: Using postgres connection "master"
17:51:26.348425 [debug] [MainThread]: On master: BEGIN
17:51:26.351506 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:51:26.352051 [debug] [MainThread]: On master: COMMIT
17:51:26.352484 [debug] [MainThread]: Using postgres connection "master"
17:51:26.352947 [debug] [MainThread]: On master: COMMIT
17:51:26.354987 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:51:26.355436 [debug] [MainThread]: On master: Close
17:51:26.356186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:51:26.356795 [info ] [MainThread]: 
17:51:26.361383 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
17:51:26.362240 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
17:51:26.363231 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
17:51:26.363605 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
17:51:26.364087 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
17:51:26.370988 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
17:51:26.372521 [debug] [Thread-1  ]: finished collecting timing info
17:51:26.374297 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
17:51:26.458095 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
17:51:26.458928 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:51:26.459218 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
17:51:26.459451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:51:26.474168 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:51:26.475037 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:51:26.475509 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    DATE() AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= 
AND b.created_at <= 
AND c.created_at <= 
GROUP BY 1,2,3,4,5
  );
  
17:51:26.479209 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "AND"
LINE 23: AND b.created_at <= 
         ^

17:51:26.479894 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
17:51:26.484667 [debug] [Thread-1  ]: finished collecting timing info
17:51:26.485347 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
17:51:26.486733 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  syntax error at or near "AND"
  LINE 23: AND b.created_at <= 
           ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:51:26.487753 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d2690a-b645-417b-a5e5-736c4643f969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0d2da290>]}
17:51:26.488939 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.12s]
17:51:26.490306 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
17:51:26.566887 [debug] [MainThread]: Acquiring new postgres connection "master"
17:51:26.567518 [debug] [MainThread]: Using postgres connection "master"
17:51:26.567919 [debug] [MainThread]: On master: BEGIN
17:51:26.568285 [debug] [MainThread]: Opening a new connection, currently in state closed
17:51:26.582008 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:51:26.582482 [debug] [MainThread]: On master: COMMIT
17:51:26.582831 [debug] [MainThread]: Using postgres connection "master"
17:51:26.583384 [debug] [MainThread]: On master: COMMIT
17:51:26.585953 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:51:26.586433 [debug] [MainThread]: On master: Close
17:51:26.587094 [info ] [MainThread]: 
17:51:26.587851 [info ] [MainThread]: Finished running 1 incremental model in 0.42s.
17:51:26.588319 [debug] [MainThread]: Connection 'master' was properly closed.
17:51:26.588561 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
17:51:26.650511 [info ] [MainThread]: 
17:51:26.651015 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:51:26.651536 [info ] [MainThread]: 
17:51:26.651997 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
17:51:26.652445 [error] [MainThread]:   syntax error at or near "AND"
17:51:26.653285 [error] [MainThread]:   LINE 23: AND b.created_at <= 
17:51:26.653898 [error] [MainThread]:            ^
17:51:26.654384 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:51:26.654927 [info ] [MainThread]: 
17:51:26.655564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
17:51:26.657385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0cf3e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0cf4c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0cf4c890>]}


============================== 2021-12-26 17:55:47.126923 | f15a5402-17ea-4dca-8bf2-022f56ca4f7a ==============================
17:55:47.126923 [info ] [MainThread]: Running with dbt=1.0.0
17:55:47.128492 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
17:55:47.128945 [debug] [MainThread]: Tracking: tracking
17:55:47.154736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979ffc450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979ffc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979ffc8d0>]}
17:55:47.217006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
17:55:47.217710 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://seeds/sessions.csv
17:55:47.218104 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://seeds/users.csv
17:55:47.283637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f15a5402-17ea-4dca-8bf2-022f56ca4f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a1787d0>]}
17:55:47.290503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f15a5402-17ea-4dca-8bf2-022f56ca4f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a1cdbd0>]}
17:55:47.290957 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:55:47.292918 [info ] [MainThread]: 
17:55:47.294604 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:47.296031 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:55:47.318141 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:55:47.318502 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:55:47.318756 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:47.372426 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
17:55:47.374787 [debug] [ThreadPool]: On list_dbt: Close
17:55:47.378237 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:55:47.391490 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:55:47.391870 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:55:47.392095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:55:47.404735 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:55:47.405555 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:55:47.406152 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:55:47.410743 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
17:55:47.414409 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:55:47.416438 [debug] [ThreadPool]: On list_dbt_dev: Close
17:55:47.424519 [debug] [MainThread]: Using postgres connection "master"
17:55:47.425105 [debug] [MainThread]: On master: BEGIN
17:55:47.425497 [debug] [MainThread]: Opening a new connection, currently in state init
17:55:47.437696 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:47.438611 [debug] [MainThread]: Using postgres connection "master"
17:55:47.439083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:55:47.448305 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:55:47.449699 [debug] [MainThread]: On master: ROLLBACK
17:55:47.451389 [debug] [MainThread]: Using postgres connection "master"
17:55:47.451715 [debug] [MainThread]: On master: BEGIN
17:55:47.479555 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
17:55:47.480636 [debug] [MainThread]: On master: COMMIT
17:55:47.481126 [debug] [MainThread]: Using postgres connection "master"
17:55:47.481571 [debug] [MainThread]: On master: COMMIT
17:55:47.484004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:47.484583 [debug] [MainThread]: On master: Close
17:55:47.485636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:55:47.486509 [info ] [MainThread]: 
17:55:47.495278 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
17:55:47.495763 [info ] [Thread-1  ]: 1 of 3 START seed file dev.payments............................................. [RUN]
17:55:47.496538 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
17:55:47.496876 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
17:55:47.497210 [debug] [Thread-1  ]: finished collecting timing info
17:55:47.497458 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
17:55:47.566061 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:55:47.566429 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */
drop table if exists "dbt"."dev"."payments" cascade
17:55:47.566680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:47.579255 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:55:47.593804 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:55:47.594063 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: BEGIN
17:55:47.596264 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:55:47.596959 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:55:47.597319 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */

    create table "dbt"."dev"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
17:55:47.600864 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
17:55:47.627684 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:55:47.628021 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: 
          insert into "dbt"."dev"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:55:47.630483 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
17:55:47.636301 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.payments"
17:55:47.653401 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:55:47.653843 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
17:55:47.654234 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
17:55:47.658278 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:55:47.659639 [debug] [Thread-1  ]: finished collecting timing info
17:55:47.660171 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: Close
17:55:47.661305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f15a5402-17ea-4dca-8bf2-022f56ca4f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a156090>]}
17:55:47.662223 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.payments......................................... [[32mCREATE 3[0m in 0.16s]
17:55:47.663363 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
17:55:47.663988 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
17:55:47.664698 [info ] [Thread-1  ]: 2 of 3 START seed file dev.sessions............................................. [RUN]
17:55:47.666174 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
17:55:47.666921 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
17:55:47.667295 [debug] [Thread-1  ]: finished collecting timing info
17:55:47.668250 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
17:55:47.677553 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:55:47.678094 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */
drop table if exists "dbt"."dev"."sessions" cascade
17:55:47.678905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:47.706934 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
17:55:47.712949 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:55:47.713461 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: BEGIN
17:55:47.720020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:55:47.720696 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:55:47.720999 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */

    create table "dbt"."dev"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
17:55:47.724906 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
17:55:47.731081 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:55:47.731396 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: 
          insert into "dbt"."dev"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
17:55:47.733812 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
17:55:47.734420 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.sessions"
17:55:47.738394 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:55:47.738867 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
17:55:47.739215 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
17:55:47.742743 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:55:47.743786 [debug] [Thread-1  ]: finished collecting timing info
17:55:47.744191 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: Close
17:55:47.745277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f15a5402-17ea-4dca-8bf2-022f56ca4f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a1911d0>]}
17:55:47.746029 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.sessions......................................... [[32mCREATE 4[0m in 0.08s]
17:55:47.747449 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
17:55:47.748616 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
17:55:47.749810 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
17:55:47.751888 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
17:55:47.752818 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
17:55:47.753582 [debug] [Thread-1  ]: finished collecting timing info
17:55:47.754032 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
17:55:47.773586 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:55:47.774101 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */
drop table if exists "dbt"."dev"."users" cascade
17:55:47.774842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:47.804282 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
17:55:47.809802 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:55:47.811066 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
17:55:47.815847 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:55:47.816240 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:55:47.816501 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text,"created_at" timestamp without time zone)
  
17:55:47.830200 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
17:55:47.838779 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:55:47.839098 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
17:55:47.841177 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
17:55:47.842028 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
17:55:47.844242 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:55:47.844538 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
17:55:47.844768 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
17:55:47.847514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:55:47.848325 [debug] [Thread-1  ]: finished collecting timing info
17:55:47.848639 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
17:55:47.849405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f15a5402-17ea-4dca-8bf2-022f56ca4f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a148910>]}
17:55:47.849896 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mCREATE 5[0m in 0.10s]
17:55:47.851107 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
17:55:47.904319 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:47.904931 [debug] [MainThread]: Using postgres connection "master"
17:55:47.905172 [debug] [MainThread]: On master: BEGIN
17:55:47.905392 [debug] [MainThread]: Opening a new connection, currently in state closed
17:55:47.918185 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:47.919294 [debug] [MainThread]: On master: COMMIT
17:55:47.919665 [debug] [MainThread]: Using postgres connection "master"
17:55:47.919926 [debug] [MainThread]: On master: COMMIT
17:55:47.921770 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:47.922194 [debug] [MainThread]: On master: Close
17:55:47.922941 [info ] [MainThread]: 
17:55:47.923538 [info ] [MainThread]: Finished running 3 seeds in 0.63s.
17:55:47.925457 [debug] [MainThread]: Connection 'master' was properly closed.
17:55:47.926399 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
17:55:47.935962 [info ] [MainThread]: 
17:55:47.936908 [info ] [MainThread]: [32mCompleted successfully[0m
17:55:47.939732 [info ] [MainThread]: 
17:55:47.941791 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
17:55:47.942659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a0f4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a0fb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a0fba50>]}


============================== 2021-12-26 17:56:57.617078 | b1b3b582-f792-4881-b073-c5d66cb8d93f ==============================
17:56:57.617078 [info ] [MainThread]: Running with dbt=1.0.0
17:56:57.617926 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
17:56:57.618264 [debug] [MainThread]: Tracking: tracking
17:56:57.637369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06ee51c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06ee77990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06ee51b90>]}
17:56:57.757947 [debug] [MainThread]: Executing "git --help"
17:56:57.791251 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:56:57.792201 [debug] [MainThread]: STDERR: "b''"
17:56:57.807214 [debug] [MainThread]: Acquiring new postgres connection "debug"
17:56:57.809547 [debug] [MainThread]: Using postgres connection "debug"
17:56:57.810329 [debug] [MainThread]: On debug: select 1 as id
17:56:57.814596 [debug] [MainThread]: Opening a new connection, currently in state init
17:56:57.878950 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
17:56:57.884306 [debug] [MainThread]: On debug: Close
17:56:57.892530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06f873e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06e321890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06ee5d410>]}
17:56:58.285394 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-26 17:57:39.271467 | 35a0cc9a-2a63-4b40-b568-b240d4daac80 ==============================
17:57:39.271467 [info ] [MainThread]: Running with dbt=1.0.0
17:57:39.273094 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{ds: 2021-12-24}', version_check=None, warn_error=None, which='run', write_json=None)
17:57:39.273551 [debug] [MainThread]: Tracking: tracking
17:57:39.291870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d56bc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d56bc510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d56bc290>]}
17:57:39.331134 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
17:57:39.331724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35a0cc9a-2a63-4b40-b568-b240d4daac80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5891fd0>]}
17:57:39.378541 [debug] [MainThread]: Parsing macros/catalog.sql
17:57:39.383730 [debug] [MainThread]: Parsing macros/relations.sql
17:57:39.386619 [debug] [MainThread]: Parsing macros/adapters.sql
17:57:39.418129 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:57:39.420542 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:57:39.426005 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:57:39.429390 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:57:39.431699 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:57:39.455853 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:57:39.471557 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:57:39.488551 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:57:39.495185 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:57:39.497800 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:57:39.500343 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:57:39.506952 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:57:39.523129 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:57:39.525472 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:57:39.540204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:57:39.562072 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:57:39.572762 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:57:39.576968 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:57:39.588960 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:57:39.591187 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:57:39.595126 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:57:39.598561 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:57:39.607418 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:57:39.630668 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:57:39.632881 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:57:39.636365 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:57:39.638576 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:57:39.639867 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:57:39.640725 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:57:39.641728 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:57:39.643868 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:57:39.650787 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:57:39.662624 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:57:39.665705 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:57:39.669526 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:57:39.682965 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:57:39.687171 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:57:39.693430 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:57:39.703558 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:57:39.717965 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:57:39.967957 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
17:57:39.987484 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
17:57:40.078239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35a0cc9a-2a63-4b40-b568-b240d4daac80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5a1ae50>]}
17:57:40.088758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35a0cc9a-2a63-4b40-b568-b240d4daac80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d582eb90>]}
17:57:40.089392 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:57:40.090855 [info ] [MainThread]: 
17:57:40.092536 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:40.094001 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:57:40.121259 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:57:40.121843 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:57:40.123018 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:57:40.180871 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
17:57:40.184054 [debug] [ThreadPool]: On list_dbt: Close
17:57:40.186837 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:57:40.196790 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:57:40.197129 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:57:40.197365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:57:40.209319 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:57:40.209730 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:57:40.210007 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:57:40.215829 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
17:57:40.217662 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:57:40.220290 [debug] [ThreadPool]: On list_dbt_dev: Close
17:57:40.228050 [debug] [MainThread]: Using postgres connection "master"
17:57:40.228421 [debug] [MainThread]: On master: BEGIN
17:57:40.228711 [debug] [MainThread]: Opening a new connection, currently in state init
17:57:40.241308 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:57:40.241826 [debug] [MainThread]: Using postgres connection "master"
17:57:40.242295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:57:40.250132 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:57:40.252048 [debug] [MainThread]: On master: ROLLBACK
17:57:40.253767 [debug] [MainThread]: Using postgres connection "master"
17:57:40.254119 [debug] [MainThread]: On master: BEGIN
17:57:40.257484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:57:40.257953 [debug] [MainThread]: On master: COMMIT
17:57:40.258317 [debug] [MainThread]: Using postgres connection "master"
17:57:40.258660 [debug] [MainThread]: On master: COMMIT
17:57:40.260703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:40.261091 [debug] [MainThread]: On master: Close
17:57:40.261772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:57:40.262355 [info ] [MainThread]: 
17:57:40.267161 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
17:57:40.267836 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
17:57:40.268775 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
17:57:40.269189 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
17:57:40.269571 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
17:57:40.275798 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
17:57:40.276752 [debug] [Thread-1  ]: finished collecting timing info
17:57:40.277130 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
17:57:40.350956 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
17:57:40.351632 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:57:40.351871 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
17:57:40.352066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:57:40.364294 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:57:40.364913 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:57:40.365291 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    DATE() AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= 
AND b.created_at <= 
AND c.created_at <= 
GROUP BY 1,2,3,4,5
  );
  
17:57:40.368552 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "AND"
LINE 23: AND b.created_at <= 
         ^

17:57:40.368967 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
17:57:40.372091 [debug] [Thread-1  ]: finished collecting timing info
17:57:40.372578 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
17:57:40.373475 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  syntax error at or near "AND"
  LINE 23: AND b.created_at <= 
           ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:57:40.374285 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35a0cc9a-2a63-4b40-b568-b240d4daac80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5ae0910>]}
17:57:40.375394 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.11s]
17:57:40.376561 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
17:57:40.470697 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:40.471274 [debug] [MainThread]: Using postgres connection "master"
17:57:40.471668 [debug] [MainThread]: On master: BEGIN
17:57:40.472032 [debug] [MainThread]: Opening a new connection, currently in state closed
17:57:40.486559 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:57:40.487102 [debug] [MainThread]: On master: COMMIT
17:57:40.487490 [debug] [MainThread]: Using postgres connection "master"
17:57:40.487850 [debug] [MainThread]: On master: COMMIT
17:57:40.490060 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:40.490455 [debug] [MainThread]: On master: Close
17:57:40.491192 [info ] [MainThread]: 
17:57:40.491861 [info ] [MainThread]: Finished running 1 incremental model in 0.40s.
17:57:40.493007 [debug] [MainThread]: Connection 'master' was properly closed.
17:57:40.493361 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
17:57:40.551097 [info ] [MainThread]: 
17:57:40.551769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:57:40.552509 [info ] [MainThread]: 
17:57:40.552974 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
17:57:40.553397 [error] [MainThread]:   syntax error at or near "AND"
17:57:40.553781 [error] [MainThread]:   LINE 23: AND b.created_at <= 
17:57:40.554272 [error] [MainThread]:            ^
17:57:40.554675 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:57:40.555084 [info ] [MainThread]: 
17:57:40.555485 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
17:57:40.556021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5771050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5771710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5771a50>]}


============================== 2021-12-26 17:59:49.359436 | 9a07a5bb-fe5d-4a55-be38-1a6be12e115e ==============================
17:59:49.359436 [info ] [MainThread]: Running with dbt=1.0.0
17:59:49.361042 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{ds: 2021-12-24}', version_check=None, warn_error=None, which='run', write_json=None)
17:59:49.361524 [debug] [MainThread]: Tracking: tracking
17:59:49.394187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cee7d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cee7d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cee7df90>]}
17:59:49.458511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:59:49.459244 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
17:59:49.476483 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
17:59:49.498049 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
17:59:49.540531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a07a5bb-fe5d-4a55-be38-1a6be12e115e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cf90d210>]}
17:59:49.547275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a07a5bb-fe5d-4a55-be38-1a6be12e115e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cf94a810>]}
17:59:49.547712 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:59:49.549223 [info ] [MainThread]: 
17:59:49.550329 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:49.551913 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:59:49.574943 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:59:49.575287 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:59:49.575542 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:59:49.629750 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
17:59:49.631869 [debug] [ThreadPool]: On list_dbt: Close
17:59:49.634626 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
17:59:49.646082 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:59:49.646524 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
17:59:49.646770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:59:49.662499 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
17:59:49.663306 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
17:59:49.663553 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
17:59:49.669100 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
17:59:49.671886 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
17:59:49.673598 [debug] [ThreadPool]: On list_dbt_dev: Close
17:59:49.680541 [debug] [MainThread]: Using postgres connection "master"
17:59:49.680870 [debug] [MainThread]: On master: BEGIN
17:59:49.681110 [debug] [MainThread]: Opening a new connection, currently in state init
17:59:49.695421 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:59:49.695863 [debug] [MainThread]: Using postgres connection "master"
17:59:49.696255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:59:49.704299 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:59:49.706463 [debug] [MainThread]: On master: ROLLBACK
17:59:49.708372 [debug] [MainThread]: Using postgres connection "master"
17:59:49.708730 [debug] [MainThread]: On master: BEGIN
17:59:49.711633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:49.712123 [debug] [MainThread]: On master: COMMIT
17:59:49.712478 [debug] [MainThread]: Using postgres connection "master"
17:59:49.712797 [debug] [MainThread]: On master: COMMIT
17:59:49.714542 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:49.714939 [debug] [MainThread]: On master: Close
17:59:49.715579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:59:49.716492 [info ] [MainThread]: 
17:59:49.721838 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
17:59:49.722584 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
17:59:49.723389 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
17:59:49.723664 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
17:59:49.723934 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
17:59:49.733037 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
17:59:49.734151 [debug] [Thread-1  ]: finished collecting timing info
17:59:49.734752 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
17:59:49.815322 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
17:59:49.816214 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:59:49.816541 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
17:59:49.816796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:59:49.829334 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:59:49.829853 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
17:59:49.830241 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    DATE('') AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= ''
AND b.created_at <= ''
AND c.created_at <= ''
GROUP BY 1,2,3,4,5
  );
  
17:59:49.836319 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type date: ""
LINE 10:     DATE('') AS dt
                  ^

17:59:49.836844 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
17:59:49.846378 [debug] [Thread-1  ]: finished collecting timing info
17:59:49.846914 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
17:59:49.848205 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  invalid input syntax for type date: ""
  LINE 10:     DATE('') AS dt
                    ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:59:49.849053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a07a5bb-fe5d-4a55-be38-1a6be12e115e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cf8c2a50>]}
17:59:49.849934 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.13s]
17:59:49.850908 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
17:59:49.921715 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:49.922072 [debug] [MainThread]: Using postgres connection "master"
17:59:49.922283 [debug] [MainThread]: On master: BEGIN
17:59:49.922480 [debug] [MainThread]: Opening a new connection, currently in state closed
17:59:49.946212 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:59:49.946819 [debug] [MainThread]: On master: COMMIT
17:59:49.947367 [debug] [MainThread]: Using postgres connection "master"
17:59:49.947735 [debug] [MainThread]: On master: COMMIT
17:59:49.949779 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:49.950208 [debug] [MainThread]: On master: Close
17:59:49.950900 [info ] [MainThread]: 
17:59:49.952010 [info ] [MainThread]: Finished running 1 incremental model in 0.40s.
17:59:49.952663 [debug] [MainThread]: Connection 'master' was properly closed.
17:59:49.953111 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
17:59:49.962683 [info ] [MainThread]: 
17:59:49.963487 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:59:49.965994 [info ] [MainThread]: 
17:59:49.968589 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
17:59:49.970500 [error] [MainThread]:   invalid input syntax for type date: ""
17:59:49.972486 [error] [MainThread]:   LINE 10:     DATE('') AS dt
17:59:49.974649 [error] [MainThread]:                     ^
17:59:49.976676 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
17:59:49.977638 [info ] [MainThread]: 
17:59:49.978682 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
17:59:49.979896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cf8d8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cf8c43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81cf8c4750>]}


============================== 2021-12-26 18:00:58.281803 | 8af64a5f-b9e0-4a95-ab50-0a7ed9fa2528 ==============================
18:00:58.281803 [info ] [MainThread]: Running with dbt=1.0.0
18:00:58.283769 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{ds: 2021-12-24}', version_check=None, warn_error=None, which='run', write_json=None)
18:00:58.284205 [debug] [MainThread]: Tracking: tracking
18:00:58.312461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2896bc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2896bc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2896bc290>]}
18:00:58.389203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:00:58.389911 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:00:58.408005 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:00:58.428154 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:00:58.483905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8af64a5f-b9e0-4a95-ab50-0a7ed9fa2528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28994fb50>]}
18:00:58.493484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8af64a5f-b9e0-4a95-ab50-0a7ed9fa2528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28998ab90>]}
18:00:58.494314 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:00:58.496399 [info ] [MainThread]: 
18:00:58.497764 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:58.499620 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:00:58.532611 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:00:58.533202 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:00:58.533794 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:58.605240 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.07 seconds
18:00:58.608888 [debug] [ThreadPool]: On list_dbt: Close
18:00:58.613500 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:00:58.625928 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:00:58.626268 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:00:58.626739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:00:58.643059 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:00:58.643741 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:00:58.644341 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:00:58.651817 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:00:58.654862 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:00:58.656960 [debug] [ThreadPool]: On list_dbt_dev: Close
18:00:58.667178 [debug] [MainThread]: Using postgres connection "master"
18:00:58.667513 [debug] [MainThread]: On master: BEGIN
18:00:58.667957 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:58.680018 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:58.680994 [debug] [MainThread]: Using postgres connection "master"
18:00:58.681509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:58.690901 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:00:58.692638 [debug] [MainThread]: On master: ROLLBACK
18:00:58.694489 [debug] [MainThread]: Using postgres connection "master"
18:00:58.694868 [debug] [MainThread]: On master: BEGIN
18:00:58.698788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:58.699366 [debug] [MainThread]: On master: COMMIT
18:00:58.699779 [debug] [MainThread]: Using postgres connection "master"
18:00:58.700079 [debug] [MainThread]: On master: COMMIT
18:00:58.702284 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:58.702719 [debug] [MainThread]: On master: Close
18:00:58.703495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:00:58.704144 [info ] [MainThread]: 
18:00:58.709096 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:00:58.709691 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:00:58.710646 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:00:58.711057 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:00:58.711444 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:00:58.719412 [debug] [Thread-1  ]: finished collecting timing info
18:00:58.720152 [error] [Thread-1  ]: [31mUnhandled error while executing model.bungie_dwh.agg_users[0m
Object of type date is not JSON serializable
18:00:58.720767 [debug] [Thread-1  ]: 
18:00:58.721098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8af64a5f-b9e0-4a95-ab50-0a7ed9fa2528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28995c610>]}
18:00:58.721548 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.01s]
18:00:58.722041 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:00:58.812259 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:58.812979 [debug] [MainThread]: Using postgres connection "master"
18:00:58.813395 [debug] [MainThread]: On master: BEGIN
18:00:58.813773 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:58.831283 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:00:58.831770 [debug] [MainThread]: On master: COMMIT
18:00:58.832070 [debug] [MainThread]: Using postgres connection "master"
18:00:58.832317 [debug] [MainThread]: On master: COMMIT
18:00:58.834271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:58.834741 [debug] [MainThread]: On master: Close
18:00:58.835492 [info ] [MainThread]: 
18:00:58.836455 [info ] [MainThread]: Finished running 1 incremental model in 0.34s.
18:00:58.837503 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:58.838186 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:00:58.847767 [info ] [MainThread]: 
18:00:58.848273 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:00:58.848827 [info ] [MainThread]: 
18:00:58.849365 [error] [MainThread]: [33mObject of type date is not JSON serializable[0m
18:00:58.849874 [info ] [MainThread]: 
18:00:58.850388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:00:58.851586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28998af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28961f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc28995ce50>]}


============================== 2021-12-26 18:02:38.509945 | d0c078d6-ceb5-45ef-a314-4be542c5ece0 ==============================
18:02:38.509945 [info ] [MainThread]: Running with dbt=1.0.0
18:02:38.511674 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:02:38.512061 [debug] [MainThread]: Tracking: tracking
18:02:38.536178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e97bcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e97bc390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e97bc490>]}
18:02:38.573165 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:02:38.574135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0c078d6-ceb5-45ef-a314-4be542c5ece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ea193fd0>]}
18:02:38.623839 [debug] [MainThread]: Parsing macros/catalog.sql
18:02:38.630702 [debug] [MainThread]: Parsing macros/relations.sql
18:02:38.632645 [debug] [MainThread]: Parsing macros/adapters.sql
18:02:38.665545 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:02:38.668118 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:02:38.673702 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:02:38.677344 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:02:38.679772 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:02:38.704820 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:02:38.721730 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:02:38.739031 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:02:38.745557 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:02:38.748249 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:02:38.750906 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:02:38.757577 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:02:38.774241 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:02:38.776561 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:02:38.791531 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:02:38.814404 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:02:38.825230 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:02:38.829527 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:02:38.839717 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:02:38.841696 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:02:38.845679 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:02:38.849039 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:02:38.858101 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:02:38.882442 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:02:38.885018 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:02:38.888558 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:02:38.890955 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:02:38.892289 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:02:38.893147 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:02:38.894175 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:02:38.896374 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:02:38.902931 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:02:38.915341 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:02:38.918562 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:02:38.922537 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:02:38.936257 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:02:38.941641 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:02:38.949847 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:02:38.960682 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:02:38.974935 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:02:39.231777 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:02:39.250265 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:02:39.345022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0c078d6-ceb5-45ef-a314-4be542c5ece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ea216450>]}
18:02:39.353194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0c078d6-ceb5-45ef-a314-4be542c5ece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ea1ca450>]}
18:02:39.353672 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:02:39.355006 [info ] [MainThread]: 
18:02:39.355821 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:39.357110 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:02:39.378516 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:02:39.378862 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:02:39.379112 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:02:39.430573 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
18:02:39.432805 [debug] [ThreadPool]: On list_dbt: Close
18:02:39.435570 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:02:39.448073 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:02:39.448445 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:02:39.448723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:02:39.463190 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:02:39.463664 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:02:39.463985 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:02:39.468511 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
18:02:39.470350 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:02:39.472249 [debug] [ThreadPool]: On list_dbt_dev: Close
18:02:39.479079 [debug] [MainThread]: Using postgres connection "master"
18:02:39.479438 [debug] [MainThread]: On master: BEGIN
18:02:39.479703 [debug] [MainThread]: Opening a new connection, currently in state init
18:02:39.491192 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:02:39.491674 [debug] [MainThread]: Using postgres connection "master"
18:02:39.492197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:02:39.501691 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:02:39.503550 [debug] [MainThread]: On master: ROLLBACK
18:02:39.505375 [debug] [MainThread]: Using postgres connection "master"
18:02:39.505742 [debug] [MainThread]: On master: BEGIN
18:02:39.508731 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:02:39.509180 [debug] [MainThread]: On master: COMMIT
18:02:39.509574 [debug] [MainThread]: Using postgres connection "master"
18:02:39.510060 [debug] [MainThread]: On master: COMMIT
18:02:39.512029 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:02:39.512475 [debug] [MainThread]: On master: Close
18:02:39.513206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:02:39.514228 [info ] [MainThread]: 
18:02:39.520771 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:02:39.521369 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:02:39.522172 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:02:39.522463 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:02:39.522749 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:02:39.534502 [debug] [Thread-1  ]: finished collecting timing info
18:02:39.536259 [debug] [Thread-1  ]: Compilation Error in model agg_users (models/example/agg_users.sql)
  Required var '' not found in config:
  Vars supplied to agg_users = {
      "ds": "2021-12-24"
  }
  
  > in model agg_users (models/example/agg_users.sql)
  > called by model agg_users (models/example/agg_users.sql)
18:02:39.537583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c078d6-ceb5-45ef-a314-4be542c5ece0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ea2b23d0>]}
18:02:39.540279 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.02s]
18:02:39.541424 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:02:39.624060 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:39.624421 [debug] [MainThread]: Using postgres connection "master"
18:02:39.624641 [debug] [MainThread]: On master: BEGIN
18:02:39.624842 [debug] [MainThread]: Opening a new connection, currently in state closed
18:02:39.640060 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:02:39.640723 [debug] [MainThread]: On master: COMMIT
18:02:39.641235 [debug] [MainThread]: Using postgres connection "master"
18:02:39.641524 [debug] [MainThread]: On master: COMMIT
18:02:39.645125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:02:39.645705 [debug] [MainThread]: On master: Close
18:02:39.646522 [info ] [MainThread]: 
18:02:39.647452 [info ] [MainThread]: Finished running 1 incremental model in 0.29s.
18:02:39.648561 [debug] [MainThread]: Connection 'master' was properly closed.
18:02:39.649151 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:02:39.659926 [info ] [MainThread]: 
18:02:39.661202 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:02:39.662226 [info ] [MainThread]: 
18:02:39.663531 [error] [MainThread]: [33mCompilation Error in model agg_users (models/example/agg_users.sql)[0m
18:02:39.664309 [error] [MainThread]:   Required var '' not found in config:
18:02:39.666014 [error] [MainThread]:   Vars supplied to agg_users = {
18:02:39.668304 [error] [MainThread]:       "ds": "2021-12-24"
18:02:39.669438 [error] [MainThread]:   }
18:02:39.669937 [error] [MainThread]:   
18:02:39.671841 [error] [MainThread]:   > in model agg_users (models/example/agg_users.sql)
18:02:39.675256 [error] [MainThread]:   > called by model agg_users (models/example/agg_users.sql)
18:02:39.675917 [info ] [MainThread]: 
18:02:39.676643 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:02:39.677773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2e97c6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ea2b41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ea2b4a90>]}


============================== 2021-12-26 18:04:04.440166 | 80fd97b8-9eb9-42d1-b6d9-d18cf311453f ==============================
18:04:04.440166 [info ] [MainThread]: Running with dbt=1.0.0
18:04:04.443282 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:04:04.444177 [debug] [MainThread]: Tracking: tracking
18:04:04.466339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c8e8e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c8e8ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c8e8e210>]}
18:04:04.548993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:04:04.549684 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:04:04.565292 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:04:04.586365 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:04:04.630290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80fd97b8-9eb9-42d1-b6d9-d18cf311453f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c994bb50>]}
18:04:04.637147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80fd97b8-9eb9-42d1-b6d9-d18cf311453f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c998bbd0>]}
18:04:04.637602 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:04:04.638961 [info ] [MainThread]: 
18:04:04.639754 [debug] [MainThread]: Acquiring new postgres connection "master"
18:04:04.641043 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:04:04.665688 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:04:04.666068 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:04:04.666339 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:04:04.719080 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
18:04:04.721710 [debug] [ThreadPool]: On list_dbt: Close
18:04:04.724747 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:04:04.735753 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:04:04.736424 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:04:04.736885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:04:04.750959 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:04:04.751514 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:04:04.751950 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:04:04.757137 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
18:04:04.758909 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:04:04.760564 [debug] [ThreadPool]: On list_dbt_dev: Close
18:04:04.767386 [debug] [MainThread]: Using postgres connection "master"
18:04:04.767856 [debug] [MainThread]: On master: BEGIN
18:04:04.768166 [debug] [MainThread]: Opening a new connection, currently in state init
18:04:04.779787 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:04:04.780347 [debug] [MainThread]: Using postgres connection "master"
18:04:04.780691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:04:04.790727 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:04:04.792506 [debug] [MainThread]: On master: ROLLBACK
18:04:04.794290 [debug] [MainThread]: Using postgres connection "master"
18:04:04.794678 [debug] [MainThread]: On master: BEGIN
18:04:04.797399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:04:04.797880 [debug] [MainThread]: On master: COMMIT
18:04:04.798242 [debug] [MainThread]: Using postgres connection "master"
18:04:04.798554 [debug] [MainThread]: On master: COMMIT
18:04:04.800729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:04:04.801248 [debug] [MainThread]: On master: Close
18:04:04.802118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:04:04.803288 [info ] [MainThread]: 
18:04:04.808981 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:04:04.809653 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:04:04.810371 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:04:04.811105 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:04:04.811441 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:04:04.825545 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:04:04.826960 [debug] [Thread-1  ]: finished collecting timing info
18:04:04.827471 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:04:04.908566 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:04:04.909291 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:04:04.909547 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:04:04.909753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:04.921998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:04:04.923287 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:04:04.923824 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    DATE(2021-12-24) AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= 2021-12-24
AND b.created_at <= 2021-12-24
AND c.created_at <= 2021-12-24
GROUP BY 1,2,3,4,5
  );
  
18:04:04.928070 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date(integer) does not exist
LINE 10:     DATE(2021-12-24) AS dt
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

18:04:04.928581 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
18:04:04.939336 [debug] [Thread-1  ]: finished collecting timing info
18:04:04.939769 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:04:04.942545 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  function date(integer) does not exist
  LINE 10:     DATE(2021-12-24) AS dt
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:04:04.943185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fd97b8-9eb9-42d1-b6d9-d18cf311453f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c9900b50>]}
18:04:04.944116 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.13s]
18:04:04.946042 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:04:05.010866 [debug] [MainThread]: Acquiring new postgres connection "master"
18:04:05.011477 [debug] [MainThread]: Using postgres connection "master"
18:04:05.011887 [debug] [MainThread]: On master: BEGIN
18:04:05.012113 [debug] [MainThread]: Opening a new connection, currently in state closed
18:04:05.029245 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:04:05.029680 [debug] [MainThread]: On master: COMMIT
18:04:05.029961 [debug] [MainThread]: Using postgres connection "master"
18:04:05.030205 [debug] [MainThread]: On master: COMMIT
18:04:05.032455 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:04:05.032860 [debug] [MainThread]: On master: Close
18:04:05.033484 [info ] [MainThread]: 
18:04:05.034194 [info ] [MainThread]: Finished running 1 incremental model in 0.39s.
18:04:05.034803 [debug] [MainThread]: Connection 'master' was properly closed.
18:04:05.035102 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:04:05.049931 [info ] [MainThread]: 
18:04:05.051253 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:04:05.052319 [info ] [MainThread]: 
18:04:05.053551 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
18:04:05.054406 [error] [MainThread]:   function date(integer) does not exist
18:04:05.055446 [error] [MainThread]:   LINE 10:     DATE(2021-12-24) AS dt
18:04:05.056391 [error] [MainThread]:                ^
18:04:05.056980 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
18:04:05.060678 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:04:05.061788 [info ] [MainThread]: 
18:04:05.063684 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:04:05.066270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c9911e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c9907cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c9907c50>]}


============================== 2021-12-26 18:04:32.752062 | f47da4ee-d58a-4815-8b3b-a744cc46ad3c ==============================
18:04:32.752062 [info ] [MainThread]: Running with dbt=1.0.0
18:04:32.753434 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:04:32.753823 [debug] [MainThread]: Tracking: tracking
18:04:32.777137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc66a3f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc6463290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc66a3210>]}
18:04:32.848606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:04:32.849604 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:04:32.869373 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:04:32.889414 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:04:32.931607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f47da4ee-d58a-4815-8b3b-a744cc46ad3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc7124f50>]}
18:04:32.938602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f47da4ee-d58a-4815-8b3b-a744cc46ad3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc718bb50>]}
18:04:32.939345 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:04:32.941458 [info ] [MainThread]: 
18:04:32.942960 [debug] [MainThread]: Acquiring new postgres connection "master"
18:04:32.945007 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:04:32.983225 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:04:32.983806 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:04:32.984240 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:04:33.043344 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
18:04:33.046308 [debug] [ThreadPool]: On list_dbt: Close
18:04:33.051756 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:04:33.066711 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:04:33.067338 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:04:33.067854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:04:33.080693 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:04:33.081576 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:04:33.081885 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:04:33.086747 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
18:04:33.089308 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:04:33.091238 [debug] [ThreadPool]: On list_dbt_dev: Close
18:04:33.099283 [debug] [MainThread]: Using postgres connection "master"
18:04:33.099759 [debug] [MainThread]: On master: BEGIN
18:04:33.100094 [debug] [MainThread]: Opening a new connection, currently in state init
18:04:33.111501 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:04:33.112152 [debug] [MainThread]: Using postgres connection "master"
18:04:33.112414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:04:33.120354 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:04:33.122101 [debug] [MainThread]: On master: ROLLBACK
18:04:33.123960 [debug] [MainThread]: Using postgres connection "master"
18:04:33.124503 [debug] [MainThread]: On master: BEGIN
18:04:33.128046 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:04:33.129152 [debug] [MainThread]: On master: COMMIT
18:04:33.129757 [debug] [MainThread]: Using postgres connection "master"
18:04:33.130372 [debug] [MainThread]: On master: COMMIT
18:04:33.132966 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:04:33.133631 [debug] [MainThread]: On master: Close
18:04:33.135134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:04:33.136410 [info ] [MainThread]: 
18:04:33.143786 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:04:33.144278 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:04:33.145460 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:04:33.145900 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:04:33.146365 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:04:33.153794 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:04:33.155518 [debug] [Thread-1  ]: finished collecting timing info
18:04:33.156172 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:04:33.237137 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:04:33.237837 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:04:33.238173 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:04:33.238378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:33.252096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:04:33.252732 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:04:33.253066 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    2021-12-24 AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= 2021-12-24
AND b.created_at <= 2021-12-24
AND c.created_at <= 2021-12-24
GROUP BY 1,2,3,4,5
  );
  
18:04:33.264245 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: timestamp without time zone <= integer
LINE 22: WHERE a.created_at <= 2021-12-24
                            ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

18:04:33.264648 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
18:04:33.268627 [debug] [Thread-1  ]: finished collecting timing info
18:04:33.269214 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:04:33.269963 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  operator does not exist: timestamp without time zone <= integer
  LINE 22: WHERE a.created_at <= 2021-12-24
                              ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:04:33.270687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f47da4ee-d58a-4815-8b3b-a744cc46ad3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc7107d10>]}
18:04:33.271318 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.13s]
18:04:33.272271 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:04:33.348899 [debug] [MainThread]: Acquiring new postgres connection "master"
18:04:33.349476 [debug] [MainThread]: Using postgres connection "master"
18:04:33.349874 [debug] [MainThread]: On master: BEGIN
18:04:33.350250 [debug] [MainThread]: Opening a new connection, currently in state closed
18:04:33.363472 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:04:33.363949 [debug] [MainThread]: On master: COMMIT
18:04:33.364295 [debug] [MainThread]: Using postgres connection "master"
18:04:33.364602 [debug] [MainThread]: On master: COMMIT
18:04:33.366687 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:04:33.367108 [debug] [MainThread]: On master: Close
18:04:33.367813 [info ] [MainThread]: 
18:04:33.368475 [info ] [MainThread]: Finished running 1 incremental model in 0.43s.
18:04:33.368922 [debug] [MainThread]: Connection 'master' was properly closed.
18:04:33.369165 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:04:33.377999 [info ] [MainThread]: 
18:04:33.378722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:04:33.379324 [info ] [MainThread]: 
18:04:33.379879 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
18:04:33.380371 [error] [MainThread]:   operator does not exist: timestamp without time zone <= integer
18:04:33.380850 [error] [MainThread]:   LINE 22: WHERE a.created_at <= 2021-12-24
18:04:33.381366 [error] [MainThread]:                               ^
18:04:33.381870 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
18:04:33.382329 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:04:33.382791 [info ] [MainThread]: 
18:04:33.383253 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:04:33.383837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc713a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc679c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc679c8d0>]}


============================== 2021-12-26 18:04:59.382011 | 19fb89ea-a225-40a8-bac8-47b3a8f245c1 ==============================
18:04:59.382011 [info ] [MainThread]: Running with dbt=1.0.0
18:04:59.383350 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:04:59.383748 [debug] [MainThread]: Tracking: tracking
18:04:59.410168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f4671ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f4671390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f4671290>]}
18:04:59.475050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:04:59.475728 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:04:59.491234 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:04:59.512481 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:04:59.558679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19fb89ea-a225-40a8-bac8-47b3a8f245c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f510f850>]}
18:04:59.565290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19fb89ea-a225-40a8-bac8-47b3a8f245c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f514bb90>]}
18:04:59.565796 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:04:59.567142 [info ] [MainThread]: 
18:04:59.567952 [debug] [MainThread]: Acquiring new postgres connection "master"
18:04:59.569260 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:04:59.590339 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:04:59.590654 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:04:59.590875 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:04:59.635305 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.04 seconds
18:04:59.638854 [debug] [ThreadPool]: On list_dbt: Close
18:04:59.642062 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:04:59.652171 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:04:59.652544 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:04:59.652954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:04:59.669374 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:04:59.669829 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:04:59.670054 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:04:59.675031 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
18:04:59.676802 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:04:59.678364 [debug] [ThreadPool]: On list_dbt_dev: Close
18:04:59.684816 [debug] [MainThread]: Using postgres connection "master"
18:04:59.685204 [debug] [MainThread]: On master: BEGIN
18:04:59.685420 [debug] [MainThread]: Opening a new connection, currently in state init
18:04:59.696590 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:04:59.697050 [debug] [MainThread]: Using postgres connection "master"
18:04:59.697429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:04:59.705818 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:04:59.707563 [debug] [MainThread]: On master: ROLLBACK
18:04:59.709397 [debug] [MainThread]: Using postgres connection "master"
18:04:59.709738 [debug] [MainThread]: On master: BEGIN
18:04:59.712466 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:04:59.713113 [debug] [MainThread]: On master: COMMIT
18:04:59.713506 [debug] [MainThread]: Using postgres connection "master"
18:04:59.713892 [debug] [MainThread]: On master: COMMIT
18:04:59.716077 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:04:59.716620 [debug] [MainThread]: On master: Close
18:04:59.717382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:04:59.718218 [info ] [MainThread]: 
18:04:59.723791 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:04:59.724396 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:04:59.725889 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:04:59.726233 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:04:59.726492 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:04:59.733825 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:04:59.734942 [debug] [Thread-1  ]: finished collecting timing info
18:04:59.735993 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:04:59.816391 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:04:59.817172 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:04:59.817479 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:04:59.817713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:04:59.830692 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:04:59.831721 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:04:59.832144 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    '2021-12-24' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= '2021-12-24'
AND b.created_at <= '2021-12-24'
AND c.created_at <= '2021-12-24'
GROUP BY 1,2,3,4,5
  );
  
18:04:59.843071 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
18:04:59.857039 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:04:59.857382 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:04:59.857675 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:04:59.860345 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:04:59.861174 [debug] [Thread-1  ]: finished collecting timing info
18:04:59.861476 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:04:59.862158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19fb89ea-a225-40a8-bac8-47b3a8f245c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f47d4950>]}
18:04:59.862770 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 0[0m in 0.14s]
18:04:59.863580 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:04:59.926168 [debug] [MainThread]: Acquiring new postgres connection "master"
18:04:59.926596 [debug] [MainThread]: Using postgres connection "master"
18:04:59.926838 [debug] [MainThread]: On master: BEGIN
18:04:59.927060 [debug] [MainThread]: Opening a new connection, currently in state closed
18:04:59.938385 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:04:59.939299 [debug] [MainThread]: On master: COMMIT
18:04:59.939780 [debug] [MainThread]: Using postgres connection "master"
18:04:59.940160 [debug] [MainThread]: On master: COMMIT
18:04:59.942086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:04:59.942541 [debug] [MainThread]: On master: Close
18:04:59.943271 [info ] [MainThread]: 
18:04:59.943888 [info ] [MainThread]: Finished running 1 incremental model in 0.38s.
18:04:59.944352 [debug] [MainThread]: Connection 'master' was properly closed.
18:04:59.944599 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:04:59.953196 [info ] [MainThread]: 
18:04:59.953725 [info ] [MainThread]: [32mCompleted successfully[0m
18:04:59.954681 [info ] [MainThread]: 
18:04:59.955638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:04:59.956281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f5118290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f47bc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88f47bccd0>]}


============================== 2021-12-26 18:07:40.299304 | 4fb55dbe-dda6-4da0-b838-b798c8b64212 ==============================
18:07:40.299304 [info ] [MainThread]: Running with dbt=1.0.0
18:07:40.301283 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:07:40.301739 [debug] [MainThread]: Tracking: tracking
18:07:40.325817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01eead2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01efca790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01eead1d0>]}
18:07:40.366633 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:07:40.367650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fb55dbe-dda6-4da0-b838-b798c8b64212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01f993fd0>]}
18:07:40.427394 [debug] [MainThread]: Parsing macros/catalog.sql
18:07:40.433735 [debug] [MainThread]: Parsing macros/relations.sql
18:07:40.435630 [debug] [MainThread]: Parsing macros/adapters.sql
18:07:40.468643 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:07:40.471139 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:07:40.477956 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:07:40.482235 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:07:40.484768 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:07:40.511445 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:07:40.532395 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:07:40.554846 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:07:40.563837 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:07:40.568856 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:07:40.571960 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:07:40.579405 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:07:40.600603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:07:40.603065 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:07:40.619085 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:07:40.644986 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:07:40.656481 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:07:40.661122 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:07:40.672714 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:07:40.674766 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:07:40.678983 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:07:40.682458 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:07:40.691457 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:07:40.716054 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:07:40.719005 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:07:40.723206 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:07:40.725865 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:07:40.727235 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:07:40.728089 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:07:40.729131 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:07:40.731322 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:07:40.737765 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:07:40.750842 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:07:40.754127 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:07:40.758760 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:07:40.773040 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:07:40.777458 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:07:40.784842 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:07:40.799411 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:07:40.817791 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:07:41.110413 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:07:41.129416 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:07:41.225633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb55dbe-dda6-4da0-b838-b798c8b64212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01f9e26d0>]}
18:07:41.232922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb55dbe-dda6-4da0-b838-b798c8b64212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01f9ca290>]}
18:07:41.233450 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:07:41.235138 [info ] [MainThread]: 
18:07:41.236045 [debug] [MainThread]: Acquiring new postgres connection "master"
18:07:41.237933 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:07:41.260877 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:07:41.261206 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:07:41.261426 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:07:41.312485 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.05 seconds
18:07:41.314918 [debug] [ThreadPool]: On list_dbt: Close
18:07:41.317920 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:07:41.330139 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:07:41.330494 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:07:41.330733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:07:41.343716 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:07:41.344161 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:07:41.344619 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:07:41.350064 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:07:41.351901 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:07:41.354087 [debug] [ThreadPool]: On list_dbt_dev: Close
18:07:41.361155 [debug] [MainThread]: Using postgres connection "master"
18:07:41.361610 [debug] [MainThread]: On master: BEGIN
18:07:41.361891 [debug] [MainThread]: Opening a new connection, currently in state init
18:07:41.373579 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:07:41.374037 [debug] [MainThread]: Using postgres connection "master"
18:07:41.374368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:07:41.384944 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:07:41.386566 [debug] [MainThread]: On master: ROLLBACK
18:07:41.388436 [debug] [MainThread]: Using postgres connection "master"
18:07:41.388788 [debug] [MainThread]: On master: BEGIN
18:07:41.391883 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:07:41.392528 [debug] [MainThread]: On master: COMMIT
18:07:41.393106 [debug] [MainThread]: Using postgres connection "master"
18:07:41.393458 [debug] [MainThread]: On master: COMMIT
18:07:41.395473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:07:41.395836 [debug] [MainThread]: On master: Close
18:07:41.396470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:07:41.397247 [info ] [MainThread]: 
18:07:41.402089 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:07:41.402860 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:07:41.403876 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:07:41.404267 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:07:41.404655 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:07:41.411272 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:07:41.412690 [debug] [Thread-1  ]: finished collecting timing info
18:07:41.413238 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:07:41.495189 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:07:41.495521 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp100741468899"
  as (
    

SELECT
    '2021-12-25' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= '2021-12-25'
AND b.created_at <= '2021-12-25'
AND c.created_at <= '2021-12-25'
GROUP BY 1,2,3,4,5
  );
  
18:07:41.495809 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:07:41.513296 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.02 seconds
18:07:41.569779 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:07:41.570102 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:07:41.572454 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:07:41.572904 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:07:41.573196 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp100741468899'
        
      order by ordinal_position

  
18:07:41.601693 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.03 seconds
18:07:41.607860 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:07:41.608166 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:07:41.613049 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
18:07:41.623194 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:07:41.623536 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:07:41.627840 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
18:07:41.639751 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:07:41.640498 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:07:41.640779 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp100741468899"
    )
  
18:07:41.642942 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
18:07:41.651923 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:07:41.652528 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:07:41.653078 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:07:41.657416 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:07:41.658901 [debug] [Thread-1  ]: finished collecting timing info
18:07:41.659595 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:07:41.660787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb55dbe-dda6-4da0-b838-b798c8b64212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01efb8e90>]}
18:07:41.661806 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 0[0m in 0.26s]
18:07:41.662822 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:07:41.706534 [debug] [MainThread]: Acquiring new postgres connection "master"
18:07:41.707123 [debug] [MainThread]: Using postgres connection "master"
18:07:41.708464 [debug] [MainThread]: On master: BEGIN
18:07:41.709466 [debug] [MainThread]: Opening a new connection, currently in state closed
18:07:41.746163 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
18:07:41.746732 [debug] [MainThread]: On master: COMMIT
18:07:41.747112 [debug] [MainThread]: Using postgres connection "master"
18:07:41.747467 [debug] [MainThread]: On master: COMMIT
18:07:41.752315 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:07:41.752921 [debug] [MainThread]: On master: Close
18:07:41.754322 [info ] [MainThread]: 
18:07:41.755986 [info ] [MainThread]: Finished running 1 incremental model in 0.52s.
18:07:41.757037 [debug] [MainThread]: Connection 'master' was properly closed.
18:07:41.757859 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:07:41.770552 [info ] [MainThread]: 
18:07:41.771508 [info ] [MainThread]: [32mCompleted successfully[0m
18:07:41.772758 [info ] [MainThread]: 
18:07:41.773877 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:07:41.775927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01ac5f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01ef62590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01ef620d0>]}


============================== 2021-12-26 18:15:09.954277 | 984871d0-4d8f-4f24-94f7-99ec22103eb0 ==============================
18:15:09.954277 [info ] [MainThread]: Running with dbt=1.0.0
18:15:09.956502 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:15:09.957126 [debug] [MainThread]: Tracking: tracking
18:15:09.987650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf671490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf671310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf671dd0>]}
18:15:10.062285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:15:10.062944 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:15:10.079732 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:15:10.099762 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:15:10.143041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '984871d0-4d8f-4f24-94f7-99ec22103eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf7d9e10>]}
18:15:10.150191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '984871d0-4d8f-4f24-94f7-99ec22103eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb014a7d0>]}
18:15:10.150662 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:15:10.152053 [info ] [MainThread]: 
18:15:10.152824 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:10.154145 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:15:10.175612 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:15:10.175950 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:15:10.176180 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:15:10.226617 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:15:10.228953 [debug] [ThreadPool]: On list_dbt: Close
18:15:10.231829 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:15:10.244110 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:15:10.244452 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:15:10.244695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:15:10.258839 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:15:10.259268 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:15:10.259713 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:15:10.264575 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:15:10.266776 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:15:10.268979 [debug] [ThreadPool]: On list_dbt_dev: Close
18:15:10.276275 [debug] [MainThread]: Using postgres connection "master"
18:15:10.276706 [debug] [MainThread]: On master: BEGIN
18:15:10.277007 [debug] [MainThread]: Opening a new connection, currently in state init
18:15:10.288409 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:15:10.289038 [debug] [MainThread]: Using postgres connection "master"
18:15:10.289483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:15:10.299472 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:15:10.301178 [debug] [MainThread]: On master: ROLLBACK
18:15:10.302655 [debug] [MainThread]: Using postgres connection "master"
18:15:10.302982 [debug] [MainThread]: On master: BEGIN
18:15:10.306227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:10.306829 [debug] [MainThread]: On master: COMMIT
18:15:10.307548 [debug] [MainThread]: Using postgres connection "master"
18:15:10.307862 [debug] [MainThread]: On master: COMMIT
18:15:10.309710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:10.310140 [debug] [MainThread]: On master: Close
18:15:10.310915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:15:10.311584 [info ] [MainThread]: 
18:15:10.317703 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:15:10.318335 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users.......................................... [RUN]
18:15:10.319196 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:15:10.319502 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:15:10.319780 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:15:10.331892 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:15:10.332883 [debug] [Thread-1  ]: finished collecting timing info
18:15:10.333228 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:15:10.386205 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:15:10.386971 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:15:10.387237 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:15:10.387440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:10.398618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:15:10.399790 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:15:10.400221 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */


  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    '2021-12-25' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= '2021-12-25'
AND b.created_at <= '2021-12-25'
AND c.created_at <= '2021-12-25'
GROUP BY 1,2,3,4,5
  );
18:15:10.411049 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
18:15:10.419781 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:15:10.420120 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
18:15:10.421863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:10.424669 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:15:10.424973 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
18:15:10.426968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:10.440190 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:15:10.440503 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:15:10.440714 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:15:10.444884 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:15:10.451336 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:15:10.451664 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
18:15:10.455611 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:15:10.458008 [debug] [Thread-1  ]: finished collecting timing info
18:15:10.458507 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:15:10.459456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '984871d0-4d8f-4f24-94f7-99ec22103eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb011c9d0>]}
18:15:10.460181 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users..................................... [[32mSELECT 0[0m in 0.14s]
18:15:10.463198 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:15:10.522457 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:10.523044 [debug] [MainThread]: Using postgres connection "master"
18:15:10.523448 [debug] [MainThread]: On master: BEGIN
18:15:10.523828 [debug] [MainThread]: Opening a new connection, currently in state closed
18:15:10.537083 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:15:10.537879 [debug] [MainThread]: On master: COMMIT
18:15:10.538308 [debug] [MainThread]: Using postgres connection "master"
18:15:10.538662 [debug] [MainThread]: On master: COMMIT
18:15:10.540978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:10.541372 [debug] [MainThread]: On master: Close
18:15:10.542032 [info ] [MainThread]: 
18:15:10.542729 [info ] [MainThread]: Finished running 1 table model in 0.39s.
18:15:10.543219 [debug] [MainThread]: Connection 'master' was properly closed.
18:15:10.543467 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:15:10.551871 [info ] [MainThread]: 
18:15:10.552511 [info ] [MainThread]: [32mCompleted successfully[0m
18:15:10.553701 [info ] [MainThread]: 
18:15:10.555600 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:15:10.556799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf7f2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb014ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbaf760150>]}


============================== 2021-12-26 18:23:06.826896 | ac65de5a-7e4f-4362-955a-dffbc744b6d4 ==============================
18:23:06.826896 [info ] [MainThread]: Running with dbt=1.0.0
18:23:06.828607 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:23:06.828993 [debug] [MainThread]: Tracking: tracking
18:23:06.847003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02e71810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02e71510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd02e71190>]}
18:23:06.888787 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:23:06.891792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac65de5a-7e4f-4362-955a-dffbc744b6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd03953fd0>]}
18:23:06.937730 [debug] [MainThread]: Parsing macros/catalog.sql
18:23:06.947795 [debug] [MainThread]: Parsing macros/relations.sql
18:23:06.950393 [debug] [MainThread]: Parsing macros/adapters.sql
18:23:06.981993 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:23:06.984753 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:23:06.990346 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:23:06.993695 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:23:06.996244 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:23:07.021258 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:23:07.037528 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:23:07.054529 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:23:07.061007 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:23:07.063618 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:23:07.066219 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:23:07.072506 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:23:07.088263 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:23:07.090483 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:23:07.105343 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:23:07.127606 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:23:07.138330 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:23:07.142997 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:23:07.153169 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:23:07.155156 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:23:07.159064 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:23:07.162387 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:23:07.171181 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:23:07.194934 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:23:07.197126 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:23:07.200610 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:23:07.202900 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:23:07.204197 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:23:07.205065 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:23:07.206114 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:23:07.208283 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:23:07.214622 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:23:07.226705 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:23:07.229846 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:23:07.233700 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:23:07.247228 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:23:07.251406 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:23:07.257693 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:23:07.267929 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:23:07.282017 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:23:07.538295 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:23:07.557234 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:23:07.638905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd03a3a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd03a3a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd03a3a310>]}


============================== 2021-12-26 18:26:05.728091 | a7c265b3-e84c-4de0-8606-adf64ca85911 ==============================
18:26:05.728091 [info ] [MainThread]: Running with dbt=1.0.0
18:26:05.729462 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:26:05.729874 [debug] [MainThread]: Tracking: tracking
18:26:05.752339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcadf7c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcadf7cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcadf7cb50>]}
18:26:05.788735 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:26:05.789358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7c265b3-e84c-4de0-8606-adf64ca85911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcae151fd0>]}
18:26:05.846432 [debug] [MainThread]: Parsing macros/catalog.sql
18:26:05.853204 [debug] [MainThread]: Parsing macros/relations.sql
18:26:05.855086 [debug] [MainThread]: Parsing macros/adapters.sql
18:26:05.887969 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:26:05.890369 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:26:05.895881 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:26:05.899273 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:26:05.901578 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:26:05.926357 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:26:05.942872 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:26:05.960402 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:26:05.967103 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:26:05.969810 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:26:05.972353 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:26:05.978902 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:26:05.995093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:26:05.997366 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:26:06.012727 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:26:06.035031 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:26:06.045897 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:26:06.050121 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:26:06.060330 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:26:06.062571 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:26:06.066430 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:26:06.069856 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:26:06.078813 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:26:06.102308 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:26:06.104500 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:26:06.109886 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:26:06.112704 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:26:06.114048 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:26:06.114848 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:26:06.115825 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:26:06.118106 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:26:06.124378 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:26:06.136405 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:26:06.139512 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:26:06.143429 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:26:06.157725 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:26:06.162084 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:26:06.168531 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:26:06.179035 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:26:06.193195 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:26:06.449919 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:26:06.454012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcae0e5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcae0c9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcae0c9b10>]}


============================== 2021-12-26 18:26:38.065613 | 164489b3-3f94-46b9-9837-54309abbe7f9 ==============================
18:26:38.065613 [info ] [MainThread]: Running with dbt=1.0.0
18:26:38.067151 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:26:38.068009 [debug] [MainThread]: Tracking: tracking
18:26:38.109996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8562ebc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8562ebce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8562ebcc10>]}
18:26:38.142370 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:26:38.143018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '164489b3-3f94-46b9-9837-54309abbe7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563092f90>]}
18:26:38.201363 [debug] [MainThread]: Parsing macros/catalog.sql
18:26:38.208259 [debug] [MainThread]: Parsing macros/relations.sql
18:26:38.211392 [debug] [MainThread]: Parsing macros/adapters.sql
18:26:38.246887 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:26:38.249310 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:26:38.255016 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:26:38.258779 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:26:38.261511 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:26:38.285967 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:26:38.302635 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:26:38.319624 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:26:38.326221 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:26:38.328752 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:26:38.331288 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:26:38.337650 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:26:38.353352 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:26:38.355657 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:26:38.370234 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:26:38.392650 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:26:38.403760 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:26:38.408068 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:26:38.418153 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:26:38.420266 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:26:38.424151 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:26:38.427447 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:26:38.436799 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:26:38.460410 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:26:38.462631 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:26:38.466105 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:26:38.468342 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:26:38.469588 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:26:38.470385 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:26:38.471368 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:26:38.473566 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:26:38.479992 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:26:38.491710 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:26:38.494921 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:26:38.498752 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:26:38.512116 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:26:38.516202 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:26:38.522425 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:26:38.532680 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:26:38.546717 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:26:38.798041 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:26:38.819085 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:26:38.907905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563168310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563168d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8563168110>]}


============================== 2021-12-26 18:27:30.564030 | 7facfd0a-2099-49c6-a6f1-6474abf35411 ==============================
18:27:30.564030 [info ] [MainThread]: Running with dbt=1.0.0
18:27:30.565924 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:27:30.566482 [debug] [MainThread]: Tracking: tracking
18:27:30.598701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b06f7cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b06f7ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b06f7c1d0>]}
18:27:30.629781 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:27:30.630639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7facfd0a-2099-49c6-a6f1-6474abf35411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07153fd0>]}
18:27:30.683259 [debug] [MainThread]: Parsing macros/catalog.sql
18:27:30.688301 [debug] [MainThread]: Parsing macros/relations.sql
18:27:30.690199 [debug] [MainThread]: Parsing macros/adapters.sql
18:27:30.723141 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:27:30.725544 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:27:30.731185 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:27:30.734597 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:27:30.736935 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:27:30.761583 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:27:30.777400 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:27:30.794426 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:27:30.800952 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:27:30.803464 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:27:30.806064 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:27:30.812453 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:27:30.828317 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:27:30.830551 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:27:30.846147 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:27:30.869528 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:27:30.880954 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:27:30.885137 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:27:30.895278 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:27:30.897254 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:27:30.901244 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:27:30.904623 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:27:30.913872 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:27:30.937230 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:27:30.939425 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:27:30.943047 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:27:30.945356 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:27:30.946735 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:27:30.947593 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:27:30.948621 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:27:30.950811 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:27:30.957141 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:27:30.969051 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:27:30.973085 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:27:30.977153 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:27:30.990747 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:27:30.994982 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:27:31.001282 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:27:31.011952 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:27:31.025841 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:27:31.279714 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:27:31.298831 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:27:31.396220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7facfd0a-2099-49c6-a6f1-6474abf35411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b071715d0>]}
18:27:31.404531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7facfd0a-2099-49c6-a6f1-6474abf35411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b071d8690>]}
18:27:31.405023 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:27:31.406639 [info ] [MainThread]: 
18:27:31.407560 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:31.409638 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:27:31.426970 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:27:31.427389 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:27:31.427652 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:27:31.480382 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:27:31.483302 [debug] [ThreadPool]: On list_dbt: Close
18:27:31.485938 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:27:31.496222 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:27:31.496540 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:27:31.496796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:27:31.509721 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:27:31.510111 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:27:31.510385 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:27:31.515378 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:27:31.517558 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:27:31.519216 [debug] [ThreadPool]: On list_dbt_dev: Close
18:27:31.526603 [debug] [MainThread]: Using postgres connection "master"
18:27:31.526952 [debug] [MainThread]: On master: BEGIN
18:27:31.527200 [debug] [MainThread]: Opening a new connection, currently in state init
18:27:31.539017 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:27:31.539440 [debug] [MainThread]: Using postgres connection "master"
18:27:31.539756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:27:31.549636 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:27:31.551337 [debug] [MainThread]: On master: ROLLBACK
18:27:31.552800 [debug] [MainThread]: Using postgres connection "master"
18:27:31.553121 [debug] [MainThread]: On master: BEGIN
18:27:31.557604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:31.558112 [debug] [MainThread]: On master: COMMIT
18:27:31.558472 [debug] [MainThread]: Using postgres connection "master"
18:27:31.558779 [debug] [MainThread]: On master: COMMIT
18:27:31.561654 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:31.562183 [debug] [MainThread]: On master: Close
18:27:31.562901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:27:31.563569 [info ] [MainThread]: 
18:27:31.568723 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:27:31.569657 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:27:31.570388 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:27:31.570634 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:27:31.570871 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:27:31.582659 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:27:31.584251 [debug] [Thread-1  ]: finished collecting timing info
18:27:31.584808 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:27:31.708525 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:27:31.708840 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp102731640913"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
{ % if is_incremental() % }
    WHERE a.created_at <= '2021-12-24'
    AND b.created_at <= '2021-12-24'
    AND c.created_at <= '2021-12-24'
{ % endif % }
GROUP BY 1,2,3,4,5
  );
  
18:27:31.709050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:27:31.722980 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 23: { % if is_incremental() % }
         ^

18:27:31.723536 [debug] [Thread-1  ]: finished collecting timing info
18:27:31.723862 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:27:31.724602 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  syntax error at or near "{"
  LINE 23: { % if is_incremental() % }
           ^
18:27:31.725579 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7facfd0a-2099-49c6-a6f1-6474abf35411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07031290>]}
18:27:31.726586 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.16s]
18:27:31.727723 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:27:31.799763 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:31.800366 [debug] [MainThread]: Using postgres connection "master"
18:27:31.800760 [debug] [MainThread]: On master: BEGIN
18:27:31.801073 [debug] [MainThread]: Opening a new connection, currently in state closed
18:27:31.812873 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:27:31.813413 [debug] [MainThread]: On master: COMMIT
18:27:31.813957 [debug] [MainThread]: Using postgres connection "master"
18:27:31.814295 [debug] [MainThread]: On master: COMMIT
18:27:31.816204 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:31.816625 [debug] [MainThread]: On master: Close
18:27:31.817299 [info ] [MainThread]: 
18:27:31.818130 [info ] [MainThread]: Finished running 1 incremental model in 0.41s.
18:27:31.819190 [debug] [MainThread]: Connection 'master' was properly closed.
18:27:31.819497 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:27:31.828379 [info ] [MainThread]: 
18:27:31.829144 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:27:31.829752 [info ] [MainThread]: 
18:27:31.830242 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
18:27:31.830686 [error] [MainThread]:   syntax error at or near "{"
18:27:31.831062 [error] [MainThread]:   LINE 23: { % if is_incremental() % }
18:27:31.831427 [error] [MainThread]:            ^
18:27:31.831780 [info ] [MainThread]: 
18:27:31.832138 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:27:31.832612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07282350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b070311d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b07031090>]}


============================== 2021-12-26 18:28:22.496155 | 3902679e-94fe-404b-96be-57599f691ce6 ==============================
18:28:22.496155 [info ] [MainThread]: Running with dbt=1.0.0
18:28:22.497852 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:28:22.498952 [debug] [MainThread]: Tracking: tracking
18:28:22.523144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63deadad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63deadc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63dead4d0>]}
18:28:22.585098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:28:22.585947 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:28:22.602889 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:28:22.630063 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:28:22.678249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3902679e-94fe-404b-96be-57599f691ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63e925d10>]}
18:28:22.686608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3902679e-94fe-404b-96be-57599f691ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63e924c10>]}
18:28:22.687390 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:28:22.689761 [info ] [MainThread]: 
18:28:22.691046 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:22.694838 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:28:22.721843 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:28:22.722729 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:28:22.724477 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:22.778851 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
18:28:22.782098 [debug] [ThreadPool]: On list_dbt: Close
18:28:22.784796 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:28:22.799420 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:28:22.799922 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:28:22.800348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:28:22.815934 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:28:22.816991 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:28:22.817420 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:28:22.823699 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
18:28:22.826753 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:28:22.828793 [debug] [ThreadPool]: On list_dbt_dev: Close
18:28:22.837374 [debug] [MainThread]: Using postgres connection "master"
18:28:22.837913 [debug] [MainThread]: On master: BEGIN
18:28:22.838252 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:22.855925 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:28:22.856572 [debug] [MainThread]: Using postgres connection "master"
18:28:22.857085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:22.871950 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:28:22.873695 [debug] [MainThread]: On master: ROLLBACK
18:28:22.875973 [debug] [MainThread]: Using postgres connection "master"
18:28:22.876321 [debug] [MainThread]: On master: BEGIN
18:28:22.880287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:22.880885 [debug] [MainThread]: On master: COMMIT
18:28:22.881374 [debug] [MainThread]: Using postgres connection "master"
18:28:22.881870 [debug] [MainThread]: On master: COMMIT
18:28:22.884798 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:22.885414 [debug] [MainThread]: On master: Close
18:28:22.886321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:28:22.887245 [info ] [MainThread]: 
18:28:22.896440 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:28:22.897340 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:28:22.899882 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:28:22.900612 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:28:22.901382 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:28:22.925451 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:28:22.926572 [debug] [Thread-1  ]: finished collecting timing info
18:28:22.927220 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:28:23.019632 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:28:23.020175 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp102822984795"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)

    WHERE a.created_at <= '2021-12-24'
    AND b.created_at <= '2021-12-24'
    AND c.created_at <= '2021-12-24'

GROUP BY 1,2,3,4,5
  );
  
18:28:23.020465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:23.038791 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "a.country_code" must appear in the GROUP BY clause or be used in an aggregate function
LINE 15:   , a.country_code
             ^

18:28:23.039457 [debug] [Thread-1  ]: finished collecting timing info
18:28:23.040037 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:28:23.040745 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  column "a.country_code" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15:   , a.country_code
               ^
18:28:23.041830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3902679e-94fe-404b-96be-57599f691ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63e911f10>]}
18:28:23.043162 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.14s]
18:28:23.043961 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:28:23.106621 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:23.107598 [debug] [MainThread]: Using postgres connection "master"
18:28:23.107980 [debug] [MainThread]: On master: BEGIN
18:28:23.108220 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:23.122346 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:23.123018 [debug] [MainThread]: On master: COMMIT
18:28:23.123669 [debug] [MainThread]: Using postgres connection "master"
18:28:23.124202 [debug] [MainThread]: On master: COMMIT
18:28:23.126296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:23.126655 [debug] [MainThread]: On master: Close
18:28:23.127410 [info ] [MainThread]: 
18:28:23.128402 [info ] [MainThread]: Finished running 1 incremental model in 0.44s.
18:28:23.129197 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:23.129620 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:28:23.139807 [info ] [MainThread]: 
18:28:23.140698 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:28:23.142000 [info ] [MainThread]: 
18:28:23.142764 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
18:28:23.143780 [error] [MainThread]:   column "a.country_code" must appear in the GROUP BY clause or be used in an aggregate function
18:28:23.144510 [error] [MainThread]:   LINE 15:   , a.country_code
18:28:23.145185 [error] [MainThread]:                ^
18:28:23.145864 [info ] [MainThread]: 
18:28:23.147349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:28:23.148585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63e93c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63e8a0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63e8a0510>]}


============================== 2021-12-26 18:28:36.080526 | 8d51c1aa-ecbd-4a21-b434-6ff59cd107be ==============================
18:28:36.080526 [info ] [MainThread]: Running with dbt=1.0.0
18:28:36.081694 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:28:36.082260 [debug] [MainThread]: Tracking: tracking
18:28:36.100708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b58f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b58fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b58f210>]}
18:28:36.164370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:28:36.165218 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:28:36.180841 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:28:36.205436 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:28:36.250004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d51c1aa-ecbd-4a21-b434-6ff59cd107be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b924f50>]}
18:28:36.256677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d51c1aa-ecbd-4a21-b434-6ff59cd107be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b923590>]}
18:28:36.257198 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:28:36.258634 [info ] [MainThread]: 
18:28:36.259412 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:36.262133 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:28:36.281360 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:28:36.281689 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:28:36.281915 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:36.298975 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.02 seconds
18:28:36.301220 [debug] [ThreadPool]: On list_dbt: Close
18:28:36.303253 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:28:36.312027 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:28:36.312334 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:28:36.312542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:28:36.325140 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:28:36.325595 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:28:36.325911 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:28:36.330899 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:28:36.332949 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:28:36.335002 [debug] [ThreadPool]: On list_dbt_dev: Close
18:28:36.341538 [debug] [MainThread]: Using postgres connection "master"
18:28:36.341877 [debug] [MainThread]: On master: BEGIN
18:28:36.342095 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:36.353629 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:36.354197 [debug] [MainThread]: Using postgres connection "master"
18:28:36.354530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:36.363854 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:28:36.365563 [debug] [MainThread]: On master: ROLLBACK
18:28:36.367288 [debug] [MainThread]: Using postgres connection "master"
18:28:36.367634 [debug] [MainThread]: On master: BEGIN
18:28:36.370947 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:36.371366 [debug] [MainThread]: On master: COMMIT
18:28:36.371668 [debug] [MainThread]: Using postgres connection "master"
18:28:36.371917 [debug] [MainThread]: On master: COMMIT
18:28:36.373558 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:36.374117 [debug] [MainThread]: On master: Close
18:28:36.374799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:28:36.375547 [info ] [MainThread]: 
18:28:36.379522 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:28:36.380048 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:28:36.381068 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:28:36.381485 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:28:36.381851 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:28:36.397369 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:28:36.398101 [debug] [Thread-1  ]: finished collecting timing info
18:28:36.398415 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:28:36.465273 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:28:36.465610 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp102836443351"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)

    WHERE a.created_at <= '2021-12-24'
    AND b.created_at <= '2021-12-24'
    AND c.created_at <= '2021-12-24'

GROUP BY 1,2,3,4,5,6
  );
  
18:28:36.465854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:36.480436 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
18:28:36.489913 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:28:36.490222 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:28:36.491993 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:28:36.492368 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:28:36.492645 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp102836443351'
        
      order by ordinal_position

  
18:28:36.502475 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.01 seconds
18:28:36.508870 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:28:36.509169 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:28:36.514027 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
18:28:36.523433 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:28:36.523735 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:28:36.528027 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
18:28:36.538751 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:28:36.539460 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:28:36.539704 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (unique_key) in (
        select (unique_key)
        from "agg_users__dbt_tmp102836443351"
    );
    

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp102836443351"
    )
  
18:28:36.544302 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "unique_key" does not exist
LINE 5:     where (unique_key) in (
                   ^

18:28:36.544757 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
18:28:36.548368 [debug] [Thread-1  ]: finished collecting timing info
18:28:36.548794 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:28:36.549530 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  column "unique_key" does not exist
  LINE 5:     where (unique_key) in (
                     ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:28:36.550529 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d51c1aa-ecbd-4a21-b434-6ff59cd107be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b70c810>]}
18:28:36.551152 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.17s]
18:28:36.552031 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:28:36.579991 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:36.580364 [debug] [MainThread]: Using postgres connection "master"
18:28:36.580591 [debug] [MainThread]: On master: BEGIN
18:28:36.580806 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:36.595601 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:36.596193 [debug] [MainThread]: On master: COMMIT
18:28:36.596574 [debug] [MainThread]: Using postgres connection "master"
18:28:36.596836 [debug] [MainThread]: On master: COMMIT
18:28:36.598502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:36.598885 [debug] [MainThread]: On master: Close
18:28:36.599505 [info ] [MainThread]: 
18:28:36.600039 [info ] [MainThread]: Finished running 1 incremental model in 0.34s.
18:28:36.600453 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:36.600661 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:28:36.612485 [info ] [MainThread]: 
18:28:36.613613 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:28:36.614199 [info ] [MainThread]: 
18:28:36.615007 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
18:28:36.617129 [error] [MainThread]:   column "unique_key" does not exist
18:28:36.617780 [error] [MainThread]:   LINE 5:     where (unique_key) in (
18:28:36.618203 [error] [MainThread]:                      ^
18:28:36.618757 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:28:36.619241 [info ] [MainThread]: 
18:28:36.620632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:28:36.622084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b56e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b965250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4b965a10>]}


============================== 2021-12-26 18:29:36.715628 | dfe47fa5-e1b0-489e-a6af-73cef37ff6cf ==============================
18:29:36.715628 [info ] [MainThread]: Running with dbt=1.0.0
18:29:36.717243 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:29:36.718085 [debug] [MainThread]: Tracking: tracking
18:29:36.747699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7868ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7868e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7868e610>]}
18:29:36.812797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:29:36.813160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:29:36.822244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfe47fa5-e1b0-489e-a6af-73cef37ff6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7917f910>]}
18:29:36.830992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfe47fa5-e1b0-489e-a6af-73cef37ff6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79191ad0>]}
18:29:36.831499 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:29:36.833207 [info ] [MainThread]: 
18:29:36.834192 [debug] [MainThread]: Acquiring new postgres connection "master"
18:29:36.836007 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:29:36.854731 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:29:36.855070 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:29:36.855311 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:29:36.910378 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
18:29:36.912839 [debug] [ThreadPool]: On list_dbt: Close
18:29:36.916259 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:29:36.928792 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:29:36.929167 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:29:36.929392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:29:36.943328 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:29:36.944145 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:29:36.944730 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:29:36.949683 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:29:36.951652 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:29:36.953840 [debug] [ThreadPool]: On list_dbt_dev: Close
18:29:36.961013 [debug] [MainThread]: Using postgres connection "master"
18:29:36.961344 [debug] [MainThread]: On master: BEGIN
18:29:36.961588 [debug] [MainThread]: Opening a new connection, currently in state init
18:29:36.973588 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:29:36.974058 [debug] [MainThread]: Using postgres connection "master"
18:29:36.974424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:29:36.983900 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:29:36.985474 [debug] [MainThread]: On master: ROLLBACK
18:29:36.987333 [debug] [MainThread]: Using postgres connection "master"
18:29:36.987738 [debug] [MainThread]: On master: BEGIN
18:29:36.991088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:29:36.991593 [debug] [MainThread]: On master: COMMIT
18:29:36.991974 [debug] [MainThread]: Using postgres connection "master"
18:29:36.992318 [debug] [MainThread]: On master: COMMIT
18:29:36.994072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:29:36.994494 [debug] [MainThread]: On master: Close
18:29:36.995263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:29:36.995854 [info ] [MainThread]: 
18:29:37.002326 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:29:37.003135 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:29:37.003986 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:29:37.004255 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:29:37.004522 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:29:37.027615 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:29:37.028696 [debug] [Thread-1  ]: finished collecting timing info
18:29:37.029163 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:29:37.093621 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:29:37.094331 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:29:37.094579 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:29:37.094783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:29:37.109199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:29:37.109648 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:29:37.109990 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)

GROUP BY 1,2,3,4,5,6
  );
  
18:29:37.119659 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:29:37.127506 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:29:37.127812 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
18:29:37.129788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:29:37.132811 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:29:37.133120 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
18:29:37.135109 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:29:37.151880 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:29:37.152224 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:29:37.152486 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:29:37.155910 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:29:37.162876 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:29:37.163338 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
18:29:37.167381 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:29:37.169946 [debug] [Thread-1  ]: finished collecting timing info
18:29:37.170550 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:29:37.171683 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfe47fa5-e1b0-489e-a6af-73cef37ff6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad791254d0>]}
18:29:37.173458 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 5[0m in 0.17s]
18:29:37.174816 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:29:37.223110 [debug] [MainThread]: Acquiring new postgres connection "master"
18:29:37.223656 [debug] [MainThread]: Using postgres connection "master"
18:29:37.224039 [debug] [MainThread]: On master: BEGIN
18:29:37.224416 [debug] [MainThread]: Opening a new connection, currently in state closed
18:29:37.247770 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:29:37.248195 [debug] [MainThread]: On master: COMMIT
18:29:37.248518 [debug] [MainThread]: Using postgres connection "master"
18:29:37.248765 [debug] [MainThread]: On master: COMMIT
18:29:37.250586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:29:37.251099 [debug] [MainThread]: On master: Close
18:29:37.251881 [info ] [MainThread]: 
18:29:37.252401 [info ] [MainThread]: Finished running 1 incremental model in 0.42s.
18:29:37.253143 [debug] [MainThread]: Connection 'master' was properly closed.
18:29:37.253497 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:29:37.262572 [info ] [MainThread]: 
18:29:37.263417 [info ] [MainThread]: [32mCompleted successfully[0m
18:29:37.266856 [info ] [MainThread]: 
18:29:37.268016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:29:37.272478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad79121350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7911ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad7911eb90>]}


============================== 2021-12-26 18:30:31.262714 | bf76cb4a-4402-4222-ba8f-4a73e86b8535 ==============================
18:30:31.262714 [info ] [MainThread]: Running with dbt=1.0.0
18:30:31.264689 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:30:31.265235 [debug] [MainThread]: Tracking: tracking
18:30:31.290996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf77de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf77de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf77d350>]}
18:30:31.366797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:30:31.368910 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:30:31.387029 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:30:31.411188 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:30:31.467379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf76cb4a-4402-4222-ba8f-4a73e86b8535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf8eb610>]}
18:30:31.474696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf76cb4a-4402-4222-ba8f-4a73e86b8535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf952c90>]}
18:30:31.475261 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:30:31.477803 [info ] [MainThread]: 
18:30:31.479054 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:31.483473 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:30:31.506385 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:30:31.506906 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:30:31.507749 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:30:31.588990 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.08 seconds
18:30:31.593099 [debug] [ThreadPool]: On list_dbt: Close
18:30:31.596267 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:30:31.607632 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:30:31.608143 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:30:31.608523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:30:31.625810 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:30:31.626177 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:30:31.626427 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:30:31.632313 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
18:30:31.634889 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:30:31.637318 [debug] [ThreadPool]: On list_dbt_dev: Close
18:30:31.646195 [debug] [MainThread]: Using postgres connection "master"
18:30:31.646563 [debug] [MainThread]: On master: BEGIN
18:30:31.646955 [debug] [MainThread]: Opening a new connection, currently in state init
18:30:31.668219 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:30:31.668845 [debug] [MainThread]: Using postgres connection "master"
18:30:31.669249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:30:31.680879 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:30:31.682452 [debug] [MainThread]: On master: ROLLBACK
18:30:31.684026 [debug] [MainThread]: Using postgres connection "master"
18:30:31.684420 [debug] [MainThread]: On master: BEGIN
18:30:31.687742 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:30:31.688347 [debug] [MainThread]: On master: COMMIT
18:30:31.688821 [debug] [MainThread]: Using postgres connection "master"
18:30:31.689265 [debug] [MainThread]: On master: COMMIT
18:30:31.691454 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:31.691879 [debug] [MainThread]: On master: Close
18:30:31.692659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:30:31.693558 [info ] [MainThread]: 
18:30:31.697754 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:30:31.698397 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:30:31.699048 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:30:31.699290 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:30:31.699536 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:30:31.709595 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:30:31.711038 [debug] [Thread-1  ]: finished collecting timing info
18:30:31.711906 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:30:31.805219 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:30:31.806338 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:30:31.806812 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:30:31.807201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:31.820008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:30:31.820640 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:30:31.820913 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= '2021-12-24'
AND b.created_at <= '2021-12-24'
AND c.created_at <= '2021-12-24'
GROUP BY 1,2,3,4,5,6
  );
  
18:30:31.830574 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
18:30:31.839251 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:30:31.839572 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
18:30:31.841729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:31.845030 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:30:31.845496 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
18:30:31.847698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:31.864912 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:30:31.865244 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:30:31.865482 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:30:31.868252 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:30:31.874292 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:30:31.874602 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
18:30:31.881157 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:30:31.883702 [debug] [Thread-1  ]: finished collecting timing info
18:30:31.884369 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:30:31.886147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf76cb4a-4402-4222-ba8f-4a73e86b8535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf8e8b50>]}
18:30:31.887521 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 0[0m in 0.19s]
18:30:31.888687 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:30:31.905058 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:31.905849 [debug] [MainThread]: Using postgres connection "master"
18:30:31.906310 [debug] [MainThread]: On master: BEGIN
18:30:31.906588 [debug] [MainThread]: Opening a new connection, currently in state closed
18:30:31.927378 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:30:31.927811 [debug] [MainThread]: On master: COMMIT
18:30:31.928371 [debug] [MainThread]: Using postgres connection "master"
18:30:31.928826 [debug] [MainThread]: On master: COMMIT
18:30:31.932508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:31.933081 [debug] [MainThread]: On master: Close
18:30:31.933995 [info ] [MainThread]: 
18:30:31.935032 [info ] [MainThread]: Finished running 1 incremental model in 0.46s.
18:30:31.935601 [debug] [MainThread]: Connection 'master' was properly closed.
18:30:31.935914 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:30:31.946922 [info ] [MainThread]: 
18:30:31.949871 [info ] [MainThread]: [32mCompleted successfully[0m
18:30:31.952052 [info ] [MainThread]: 
18:30:31.953445 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:30:31.955020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc97c63d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf873bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcf8e8e10>]}


============================== 2021-12-26 18:31:09.366943 | 2591b2f4-7d7d-4da7-b62e-03793287fd09 ==============================
18:31:09.366943 [info ] [MainThread]: Running with dbt=1.0.0
18:31:09.368430 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:31:09.368803 [debug] [MainThread]: Tracking: tracking
18:31:09.381664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccab6bdad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccab6bd390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccab6bd290>]}
18:31:09.422996 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:31:09.424559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2591b2f4-7d7d-4da7-b62e-03793287fd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccab999f90>]}
18:31:09.455683 [debug] [MainThread]: Parsing macros/catalog.sql
18:31:09.461322 [debug] [MainThread]: Parsing macros/relations.sql
18:31:09.463195 [debug] [MainThread]: Parsing macros/adapters.sql
18:31:09.507411 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:31:09.509852 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:31:09.515379 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:31:09.518896 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:31:09.521528 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:31:09.546284 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:31:09.562154 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:31:09.580442 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:31:09.588064 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:31:09.590736 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:31:09.593352 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:31:09.600684 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:31:09.617158 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:31:09.619517 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:31:09.634501 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:31:09.656670 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:31:09.667511 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:31:09.671820 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:31:09.682254 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:31:09.684273 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:31:09.688259 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:31:09.691588 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:31:09.700408 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:31:09.723568 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:31:09.725759 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:31:09.729245 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:31:09.731492 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:31:09.732767 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:31:09.733610 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:31:09.734678 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:31:09.736861 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:31:09.743615 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:31:09.755548 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:31:09.759000 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:31:09.762944 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:31:09.776475 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:31:09.780728 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:31:09.787162 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:31:09.797463 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:31:09.811331 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:31:10.067808 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:31:10.092005 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:31:10.188672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2591b2f4-7d7d-4da7-b62e-03793287fd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccaba27550>]}
18:31:10.195921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2591b2f4-7d7d-4da7-b62e-03793287fd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccab9c75d0>]}
18:31:10.196420 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:31:10.198048 [info ] [MainThread]: 
18:31:10.198938 [debug] [MainThread]: Acquiring new postgres connection "master"
18:31:10.200474 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:31:10.220005 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:31:10.220322 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:31:10.220542 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:31:10.266187 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:31:10.268044 [debug] [ThreadPool]: On list_dbt: Close
18:31:10.270967 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:31:10.282509 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:31:10.282864 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:31:10.283087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:31:10.298862 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:31:10.299335 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:31:10.299689 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:31:10.304570 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:31:10.306468 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:31:10.308306 [debug] [ThreadPool]: On list_dbt_dev: Close
18:31:10.316052 [debug] [MainThread]: Using postgres connection "master"
18:31:10.316411 [debug] [MainThread]: On master: BEGIN
18:31:10.316713 [debug] [MainThread]: Opening a new connection, currently in state init
18:31:10.327140 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:31:10.327577 [debug] [MainThread]: Using postgres connection "master"
18:31:10.328162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:31:10.339571 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:31:10.341319 [debug] [MainThread]: On master: ROLLBACK
18:31:10.342958 [debug] [MainThread]: Using postgres connection "master"
18:31:10.343327 [debug] [MainThread]: On master: BEGIN
18:31:10.346822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:31:10.347387 [debug] [MainThread]: On master: COMMIT
18:31:10.347809 [debug] [MainThread]: Using postgres connection "master"
18:31:10.348188 [debug] [MainThread]: On master: COMMIT
18:31:10.350096 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:10.350508 [debug] [MainThread]: On master: Close
18:31:10.351167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:31:10.351897 [info ] [MainThread]: 
18:31:10.356502 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:31:10.357064 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:31:10.358099 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:31:10.358695 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:31:10.359170 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:31:10.366068 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:31:10.366860 [debug] [Thread-1  ]: finished collecting timing info
18:31:10.367198 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:31:10.494401 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:31:10.494710 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp103110427409"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-25') AS unique_key
  , '2021-12-25' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= '2021-12-25'
AND b.created_at <= '2021-12-25'
AND c.created_at <= '2021-12-25'
GROUP BY 1,2,3,4,5,6
  );
  
18:31:10.494929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:31:10.508101 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
18:31:10.517398 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:31:10.517705 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:31:10.519503 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:31:10.519874 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:31:10.520135 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp103110427409'
        
      order by ordinal_position

  
18:31:10.530212 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.01 seconds
18:31:10.536497 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:31:10.536802 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:31:10.541443 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:31:10.550689 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:31:10.550995 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:31:10.555162 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:31:10.566035 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:31:10.566742 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:31:10.566987 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (unique_key) in (
        select (unique_key)
        from "agg_users__dbt_tmp103110427409"
    );
    

    insert into "dbt"."dev"."agg_users" ("unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp103110427409"
    )
  
18:31:10.569809 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
18:31:10.578678 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:31:10.579012 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:31:10.579258 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:31:10.582158 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:31:10.583000 [debug] [Thread-1  ]: finished collecting timing info
18:31:10.583322 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:31:10.584093 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2591b2f4-7d7d-4da7-b62e-03793287fd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccabab2a10>]}
18:31:10.584743 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 0[0m in 0.23s]
18:31:10.585366 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:31:10.688246 [debug] [MainThread]: Acquiring new postgres connection "master"
18:31:10.688739 [debug] [MainThread]: Using postgres connection "master"
18:31:10.689029 [debug] [MainThread]: On master: BEGIN
18:31:10.689242 [debug] [MainThread]: Opening a new connection, currently in state closed
18:31:10.716274 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
18:31:10.716887 [debug] [MainThread]: On master: COMMIT
18:31:10.717458 [debug] [MainThread]: Using postgres connection "master"
18:31:10.718007 [debug] [MainThread]: On master: COMMIT
18:31:10.720132 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:31:10.720607 [debug] [MainThread]: On master: Close
18:31:10.721554 [info ] [MainThread]: 
18:31:10.722788 [info ] [MainThread]: Finished running 1 incremental model in 0.52s.
18:31:10.723771 [debug] [MainThread]: Connection 'master' was properly closed.
18:31:10.724200 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:31:10.737295 [info ] [MainThread]: 
18:31:10.738222 [info ] [MainThread]: [32mCompleted successfully[0m
18:31:10.739611 [info ] [MainThread]: 
18:31:10.740458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:31:10.741979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccabac2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccab772d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccabab2b10>]}


============================== 2021-12-26 18:38:33.611659 | 121cb75d-d8bf-49ab-a583-17cffba6f147 ==============================
18:38:33.611659 [info ] [MainThread]: Running with dbt=1.0.0
18:38:33.613252 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:38:33.613703 [debug] [MainThread]: Tracking: tracking
18:38:33.632352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0671850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0671ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb0671110>]}
18:38:33.702726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:38:33.703445 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:38:33.718935 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:38:33.748024 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:38:33.796519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '121cb75d-d8bf-49ab-a583-17cffba6f147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb10e7d50>]}
18:38:33.804506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '121cb75d-d8bf-49ab-a583-17cffba6f147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb1152e10>]}
18:38:33.805002 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:38:33.806636 [info ] [MainThread]: 
18:38:33.807587 [debug] [MainThread]: Acquiring new postgres connection "master"
18:38:33.810200 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:38:33.827294 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:38:33.827629 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:38:33.827984 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:38:33.879105 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:38:33.881271 [debug] [ThreadPool]: On list_dbt: Close
18:38:33.884449 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:38:33.895326 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:38:33.895756 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:38:33.896303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:38:33.910127 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:38:33.910817 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:38:33.911312 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:38:33.916617 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:38:33.918536 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:38:33.920114 [debug] [ThreadPool]: On list_dbt_dev: Close
18:38:33.927293 [debug] [MainThread]: Using postgres connection "master"
18:38:33.927615 [debug] [MainThread]: On master: BEGIN
18:38:33.927820 [debug] [MainThread]: Opening a new connection, currently in state init
18:38:33.939587 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:38:33.940033 [debug] [MainThread]: Using postgres connection "master"
18:38:33.940436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:38:33.950479 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:38:33.952243 [debug] [MainThread]: On master: ROLLBACK
18:38:33.954069 [debug] [MainThread]: Using postgres connection "master"
18:38:33.954437 [debug] [MainThread]: On master: BEGIN
18:38:33.959041 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:38:33.959469 [debug] [MainThread]: On master: COMMIT
18:38:33.959747 [debug] [MainThread]: Using postgres connection "master"
18:38:33.959985 [debug] [MainThread]: On master: COMMIT
18:38:33.961615 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:38:33.962036 [debug] [MainThread]: On master: Close
18:38:33.962770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:38:33.963504 [info ] [MainThread]: 
18:38:33.968305 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:38:33.968774 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:38:33.969647 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:38:33.970028 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:38:33.970446 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:38:33.987118 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:38:33.989148 [debug] [Thread-1  ]: finished collecting timing info
18:38:33.989547 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:38:34.064600 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:38:34.066699 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:38:34.067038 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:38:34.067247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:38:34.079915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:38:34.080979 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:38:34.081376 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-25') AS unique_key
  , '2021-12-25' AS dt
  , user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    USING(user_id)
LEFT JOIN "dbt"."dev"."payments" c
    USING(user_id)
WHERE a.created_at <= '2021-12-25'
AND b.created_at <= '2021-12-25'
AND c.created_at <= '2021-12-25'

GROUP BY 1,2,3,4,5,6
  );
  
18:38:34.090089 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
18:38:34.098239 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:38:34.098558 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
18:38:34.100601 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:38:34.104802 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:38:34.105232 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
18:38:34.107129 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:38:34.120981 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:38:34.121311 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:38:34.121555 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:38:34.124760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:38:34.130846 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:38:34.131156 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
18:38:34.136026 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:38:34.138175 [debug] [Thread-1  ]: finished collecting timing info
18:38:34.139189 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:38:34.140346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '121cb75d-d8bf-49ab-a583-17cffba6f147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb10c07d0>]}
18:38:34.141150 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 0[0m in 0.17s]
18:38:34.142252 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:38:34.170071 [debug] [MainThread]: Acquiring new postgres connection "master"
18:38:34.170410 [debug] [MainThread]: Using postgres connection "master"
18:38:34.170620 [debug] [MainThread]: On master: BEGIN
18:38:34.170814 [debug] [MainThread]: Opening a new connection, currently in state closed
18:38:34.193864 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:38:34.194400 [debug] [MainThread]: On master: COMMIT
18:38:34.194691 [debug] [MainThread]: Using postgres connection "master"
18:38:34.195017 [debug] [MainThread]: On master: COMMIT
18:38:34.199388 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:38:34.200146 [debug] [MainThread]: On master: Close
18:38:34.201341 [info ] [MainThread]: 
18:38:34.202019 [info ] [MainThread]: Finished running 1 incremental model in 0.39s.
18:38:34.202853 [debug] [MainThread]: Connection 'master' was properly closed.
18:38:34.203325 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:38:34.211833 [info ] [MainThread]: 
18:38:34.212618 [info ] [MainThread]: [32mCompleted successfully[0m
18:38:34.213145 [info ] [MainThread]: 
18:38:34.215661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:38:34.216507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cafde3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb1074cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb1074c50>]}


============================== 2021-12-26 18:49:13.901617 | 20645bab-1cc6-4ad2-81be-476a5fa80a98 ==============================
18:49:13.901617 [info ] [MainThread]: Running with dbt=1.0.0
18:49:13.903401 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:49:13.903893 [debug] [MainThread]: Tracking: tracking
18:49:13.925246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc119e8ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc119e8eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc119e8e2d0>]}
18:49:13.994407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:49:13.995160 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:49:14.010693 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:49:14.037141 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:49:14.082635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20645bab-1cc6-4ad2-81be-476a5fa80a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11aa25e90>]}
18:49:14.089489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20645bab-1cc6-4ad2-81be-476a5fa80a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11aa24490>]}
18:49:14.089959 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:49:14.091427 [info ] [MainThread]: 
18:49:14.092230 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:14.095420 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:49:14.116195 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:49:14.116524 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:49:14.116753 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:49:14.166731 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:49:14.169377 [debug] [ThreadPool]: On list_dbt: Close
18:49:14.172077 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:49:14.183405 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:49:14.183911 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:49:14.184382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:49:14.197267 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:49:14.197631 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:49:14.197923 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:49:14.203109 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:49:14.205259 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:49:14.207457 [debug] [ThreadPool]: On list_dbt_dev: Close
18:49:14.222253 [debug] [MainThread]: Using postgres connection "master"
18:49:14.222769 [debug] [MainThread]: On master: BEGIN
18:49:14.223181 [debug] [MainThread]: Opening a new connection, currently in state init
18:49:14.312663 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
18:49:14.313245 [debug] [MainThread]: Using postgres connection "master"
18:49:14.313686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:49:14.326902 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:49:14.328636 [debug] [MainThread]: On master: ROLLBACK
18:49:14.330284 [debug] [MainThread]: Using postgres connection "master"
18:49:14.330613 [debug] [MainThread]: On master: BEGIN
18:49:14.334216 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:49:14.334621 [debug] [MainThread]: On master: COMMIT
18:49:14.334904 [debug] [MainThread]: Using postgres connection "master"
18:49:14.335193 [debug] [MainThread]: On master: COMMIT
18:49:14.336901 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:14.337302 [debug] [MainThread]: On master: Close
18:49:14.337897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:49:14.338610 [info ] [MainThread]: 
18:49:14.343779 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:49:14.344488 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:49:14.345471 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:49:14.345777 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:49:14.346044 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:49:14.365170 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:49:14.368567 [debug] [Thread-1  ]: finished collecting timing info
18:49:14.369287 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:49:14.445517 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:49:14.447478 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:49:14.447784 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:49:14.448000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:14.459247 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:14.459610 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:49:14.459997 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-25') AS unique_key
  , '2021-12-25' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at < ='2021-12-25'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND b.created_at < ='2021-12-25'
WHERE a.created_at <= '2021-12-25'

GROUP BY 1,2,3,4,5,6
  );
  
18:49:14.463358 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "="
LINE 21:     AND b.created_at < ='2021-12-25'
                                ^

18:49:14.464038 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
18:49:14.469730 [debug] [Thread-1  ]: finished collecting timing info
18:49:14.470288 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:49:14.471090 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  syntax error at or near "="
  LINE 21:     AND b.created_at < ='2021-12-25'
                                  ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:49:14.471930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20645bab-1cc6-4ad2-81be-476a5fa80a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11aa05c50>]}
18:49:14.472951 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.13s]
18:49:14.474990 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:49:14.547203 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:14.547742 [debug] [MainThread]: Using postgres connection "master"
18:49:14.548326 [debug] [MainThread]: On master: BEGIN
18:49:14.548695 [debug] [MainThread]: Opening a new connection, currently in state closed
18:49:14.564161 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:49:14.564835 [debug] [MainThread]: On master: COMMIT
18:49:14.565286 [debug] [MainThread]: Using postgres connection "master"
18:49:14.565615 [debug] [MainThread]: On master: COMMIT
18:49:14.567978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:14.568405 [debug] [MainThread]: On master: Close
18:49:14.569276 [info ] [MainThread]: 
18:49:14.570392 [info ] [MainThread]: Finished running 1 incremental model in 0.48s.
18:49:14.570995 [debug] [MainThread]: Connection 'master' was properly closed.
18:49:14.571323 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:49:14.581759 [info ] [MainThread]: 
18:49:14.583222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:49:14.585532 [info ] [MainThread]: 
18:49:14.586255 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
18:49:14.587238 [error] [MainThread]:   syntax error at or near "="
18:49:14.588543 [error] [MainThread]:   LINE 21:     AND b.created_at < ='2021-12-25'
18:49:14.589115 [error] [MainThread]:                                   ^
18:49:14.589926 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:49:14.590951 [info ] [MainThread]: 
18:49:14.593700 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:49:14.594295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11aa98150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11aa12650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11aa12610>]}


============================== 2021-12-26 18:49:44.228053 | 37e9a298-7496-45fe-aef7-1659993da746 ==============================
18:49:44.228053 [info ] [MainThread]: Running with dbt=1.0.0
18:49:44.230251 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:49:44.230719 [debug] [MainThread]: Tracking: tracking
18:49:44.244013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a06bc4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a06bc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a06bcc90>]}
18:49:44.301318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:49:44.302084 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:49:44.319364 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:49:44.347452 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:49:44.393469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37e9a298-7496-45fe-aef7-1659993da746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a0959e10>]}
18:49:44.400953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37e9a298-7496-45fe-aef7-1659993da746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a0925150>]}
18:49:44.401415 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:49:44.402911 [info ] [MainThread]: 
18:49:44.404001 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:44.407355 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:49:44.428094 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:49:44.428791 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:49:44.429413 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:49:44.479960 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:49:44.481785 [debug] [ThreadPool]: On list_dbt: Close
18:49:44.484372 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:49:44.496042 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:49:44.496376 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:49:44.496604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:49:44.509283 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:49:44.509742 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:49:44.510088 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:49:44.514730 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:49:44.516930 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:49:44.518706 [debug] [ThreadPool]: On list_dbt_dev: Close
18:49:44.525214 [debug] [MainThread]: Using postgres connection "master"
18:49:44.525548 [debug] [MainThread]: On master: BEGIN
18:49:44.525761 [debug] [MainThread]: Opening a new connection, currently in state init
18:49:44.537831 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:49:44.538410 [debug] [MainThread]: Using postgres connection "master"
18:49:44.538726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:49:44.549771 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:49:44.551351 [debug] [MainThread]: On master: ROLLBACK
18:49:44.552922 [debug] [MainThread]: Using postgres connection "master"
18:49:44.553250 [debug] [MainThread]: On master: BEGIN
18:49:44.556190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:49:44.556712 [debug] [MainThread]: On master: COMMIT
18:49:44.557042 [debug] [MainThread]: Using postgres connection "master"
18:49:44.557343 [debug] [MainThread]: On master: COMMIT
18:49:44.559503 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:44.559988 [debug] [MainThread]: On master: Close
18:49:44.561109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:49:44.561861 [info ] [MainThread]: 
18:49:44.565358 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:49:44.566065 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:49:44.567318 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:49:44.567740 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:49:44.568067 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:49:44.578571 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:49:44.579343 [debug] [Thread-1  ]: finished collecting timing info
18:49:44.579677 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:49:44.658649 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:49:44.659583 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:49:44.659845 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:49:44.660050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:49:44.671738 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:49:44.672253 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:49:44.672571 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(user_id, ':', '2021-12-25') AS unique_key
  , '2021-12-25' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-25'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-25'
WHERE a.created_at <= '2021-12-25'

GROUP BY 1,2,3,4,5,6
  );
  
18:49:44.675565 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column reference "user_id" is ambiguous
LINE 10:     CONCAT(user_id, ':', '2021-12-25') AS unique_key
                    ^

18:49:44.675917 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
18:49:44.678609 [debug] [Thread-1  ]: finished collecting timing info
18:49:44.678990 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:49:44.679763 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  column reference "user_id" is ambiguous
  LINE 10:     CONCAT(user_id, ':', '2021-12-25') AS unique_key
                      ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:49:44.680414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e9a298-7496-45fe-aef7-1659993da746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a0909fd0>]}
18:49:44.681118 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.11s]
18:49:44.682184 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:49:44.770590 [debug] [MainThread]: Acquiring new postgres connection "master"
18:49:44.771226 [debug] [MainThread]: Using postgres connection "master"
18:49:44.771631 [debug] [MainThread]: On master: BEGIN
18:49:44.772012 [debug] [MainThread]: Opening a new connection, currently in state closed
18:49:44.784659 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:49:44.785145 [debug] [MainThread]: On master: COMMIT
18:49:44.785436 [debug] [MainThread]: Using postgres connection "master"
18:49:44.785688 [debug] [MainThread]: On master: COMMIT
18:49:44.788021 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:49:44.788668 [debug] [MainThread]: On master: Close
18:49:44.789703 [info ] [MainThread]: 
18:49:44.790297 [info ] [MainThread]: Finished running 1 incremental model in 0.39s.
18:49:44.790739 [debug] [MainThread]: Connection 'master' was properly closed.
18:49:44.791468 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:49:44.798470 [info ] [MainThread]: 
18:49:44.798979 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:49:44.800139 [info ] [MainThread]: 
18:49:44.800963 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
18:49:44.801595 [error] [MainThread]:   column reference "user_id" is ambiguous
18:49:44.802353 [error] [MainThread]:   LINE 10:     CONCAT(user_id, ':', '2021-12-25') AS unique_key
18:49:44.803259 [error] [MainThread]:                       ^
18:49:44.804159 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
18:49:44.805027 [info ] [MainThread]: 
18:49:44.805771 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
18:49:44.806605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a0935090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a090ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87a090ec90>]}


============================== 2021-12-26 18:50:00.310963 | 98cb566e-ad8d-4b15-bf5e-2ba4a88f5eba ==============================
18:50:00.310963 [info ] [MainThread]: Running with dbt=1.0.0
18:50:00.312255 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:50:00.313069 [debug] [MainThread]: Tracking: tracking
18:50:00.338020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe377c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe377ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe377cdd0>]}
18:50:00.402130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:50:00.402815 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:50:00.420899 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:50:00.446064 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:50:00.495438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98cb566e-ad8d-4b15-bf5e-2ba4a88f5eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe3918710>]}
18:50:00.503302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98cb566e-ad8d-4b15-bf5e-2ba4a88f5eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe38e7b10>]}
18:50:00.503790 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:50:00.505228 [info ] [MainThread]: 
18:50:00.506006 [debug] [MainThread]: Acquiring new postgres connection "master"
18:50:00.508869 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:50:00.526362 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:50:00.526997 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:50:00.527719 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:50:00.579616 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:50:00.581509 [debug] [ThreadPool]: On list_dbt: Close
18:50:00.584527 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:50:00.597970 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:50:00.598306 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:50:00.598538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:50:00.611642 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:50:00.612219 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:50:00.612590 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:50:00.617248 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:50:00.619036 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:50:00.621090 [debug] [ThreadPool]: On list_dbt_dev: Close
18:50:00.628025 [debug] [MainThread]: Using postgres connection "master"
18:50:00.628363 [debug] [MainThread]: On master: BEGIN
18:50:00.628671 [debug] [MainThread]: Opening a new connection, currently in state init
18:50:00.640625 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:50:00.641291 [debug] [MainThread]: Using postgres connection "master"
18:50:00.641662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:50:00.651868 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:50:00.653653 [debug] [MainThread]: On master: ROLLBACK
18:50:00.655972 [debug] [MainThread]: Using postgres connection "master"
18:50:00.656346 [debug] [MainThread]: On master: BEGIN
18:50:00.659818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:50:00.660353 [debug] [MainThread]: On master: COMMIT
18:50:00.660690 [debug] [MainThread]: Using postgres connection "master"
18:50:00.660948 [debug] [MainThread]: On master: COMMIT
18:50:00.662870 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:50:00.663274 [debug] [MainThread]: On master: Close
18:50:00.664002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:50:00.664695 [info ] [MainThread]: 
18:50:00.669540 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:50:00.670035 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:50:00.671017 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:50:00.671458 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:50:00.671794 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:50:00.686166 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:50:00.687320 [debug] [Thread-1  ]: finished collecting timing info
18:50:00.688023 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:50:00.760420 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:50:00.761169 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:00.761426 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:50:00.761633 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:00.775023 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:00.775497 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:00.775779 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-25') AS unique_key
  , '2021-12-25' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-25'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-25'
WHERE a.created_at <= '2021-12-25'

GROUP BY 1,2,3,4,5,6
  );
  
18:50:00.783576 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
18:50:00.792369 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:00.792722 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
18:50:00.794716 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:00.797352 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:00.797647 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
18:50:00.800000 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:00.813934 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:50:00.814279 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:00.814526 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:50:00.817311 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:00.823615 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:00.823944 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
18:50:00.827905 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:50:00.829552 [debug] [Thread-1  ]: finished collecting timing info
18:50:00.829883 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:50:00.830614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98cb566e-ad8d-4b15-bf5e-2ba4a88f5eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe391fb50>]}
18:50:00.831481 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 3[0m in 0.16s]
18:50:00.832090 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:50:00.875590 [debug] [MainThread]: Acquiring new postgres connection "master"
18:50:00.876008 [debug] [MainThread]: Using postgres connection "master"
18:50:00.877015 [debug] [MainThread]: On master: BEGIN
18:50:00.877438 [debug] [MainThread]: Opening a new connection, currently in state closed
18:50:00.891679 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:50:00.892241 [debug] [MainThread]: On master: COMMIT
18:50:00.892586 [debug] [MainThread]: Using postgres connection "master"
18:50:00.892862 [debug] [MainThread]: On master: COMMIT
18:50:00.894976 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:50:00.895421 [debug] [MainThread]: On master: Close
18:50:00.896075 [info ] [MainThread]: 
18:50:00.896705 [info ] [MainThread]: Finished running 1 incremental model in 0.39s.
18:50:00.897162 [debug] [MainThread]: Connection 'master' was properly closed.
18:50:00.897389 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:50:00.904832 [info ] [MainThread]: 
18:50:00.905523 [info ] [MainThread]: [32mCompleted successfully[0m
18:50:00.906052 [info ] [MainThread]: 
18:50:00.906431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:50:00.906901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe3918710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe3900090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe3900410>]}


============================== 2021-12-26 18:50:52.271141 | 7ee83dd1-a04c-431a-aea6-4614de818ee4 ==============================
18:50:52.271141 [info ] [MainThread]: Running with dbt=1.0.0
18:50:52.272660 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:50:52.273689 [debug] [MainThread]: Tracking: tracking
18:50:52.297816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88e6a3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88e6a38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88e6a3150>]}
18:50:52.329079 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:50:52.329667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ee83dd1-a04c-431a-aea6-4614de818ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f198fd0>]}
18:50:52.379790 [debug] [MainThread]: Parsing macros/catalog.sql
18:50:52.385098 [debug] [MainThread]: Parsing macros/relations.sql
18:50:52.386982 [debug] [MainThread]: Parsing macros/adapters.sql
18:50:52.419651 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:50:52.422146 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:50:52.427703 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:50:52.431395 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:50:52.433762 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:50:52.458687 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:50:52.474634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:50:52.492270 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:50:52.498769 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:50:52.501303 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:50:52.504177 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:50:52.511062 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:50:52.526915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:50:52.529275 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:50:52.544091 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:50:52.566071 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:50:52.576911 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:50:52.581143 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:50:52.591330 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:50:52.593242 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:50:52.597068 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:50:52.600344 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:50:52.609135 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:50:52.632865 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:50:52.635040 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:50:52.638512 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:50:52.640752 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:50:52.642048 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:50:52.642879 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:50:52.643897 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:50:52.646257 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:50:52.652898 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:50:52.664817 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:50:52.668220 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:50:52.672403 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:50:52.685822 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:50:52.689953 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:50:52.696295 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:50:52.706470 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:50:52.720627 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:50:52.980874 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:50:53.005193 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:50:53.099661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ee83dd1-a04c-431a-aea6-4614de818ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f1bead0>]}
18:50:53.106745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ee83dd1-a04c-431a-aea6-4614de818ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f17a3d0>]}
18:50:53.107225 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:50:53.108695 [info ] [MainThread]: 
18:50:53.109501 [debug] [MainThread]: Acquiring new postgres connection "master"
18:50:53.111043 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:50:53.132945 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:50:53.133681 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:50:53.134075 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:50:53.192662 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
18:50:53.195629 [debug] [ThreadPool]: On list_dbt: Close
18:50:53.198576 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:50:53.208059 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:50:53.208394 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:50:53.208610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:50:53.220437 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:50:53.220917 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:50:53.221262 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:50:53.226175 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:50:53.227945 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:50:53.229750 [debug] [ThreadPool]: On list_dbt_dev: Close
18:50:53.236788 [debug] [MainThread]: Using postgres connection "master"
18:50:53.237111 [debug] [MainThread]: On master: BEGIN
18:50:53.237360 [debug] [MainThread]: Opening a new connection, currently in state init
18:50:53.248499 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:50:53.248947 [debug] [MainThread]: Using postgres connection "master"
18:50:53.249289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:50:53.258422 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:50:53.260227 [debug] [MainThread]: On master: ROLLBACK
18:50:53.261729 [debug] [MainThread]: Using postgres connection "master"
18:50:53.262053 [debug] [MainThread]: On master: BEGIN
18:50:53.265227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:50:53.265734 [debug] [MainThread]: On master: COMMIT
18:50:53.266147 [debug] [MainThread]: Using postgres connection "master"
18:50:53.266590 [debug] [MainThread]: On master: COMMIT
18:50:53.268228 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:50:53.268588 [debug] [MainThread]: On master: Close
18:50:53.269233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:50:53.270134 [info ] [MainThread]: 
18:50:53.274803 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:50:53.275274 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:50:53.275963 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:50:53.276334 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:50:53.276671 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:50:53.286986 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:50:53.287719 [debug] [Thread-1  ]: finished collecting timing info
18:50:53.288057 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:50:53.412987 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:50:53.413705 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:53.413952 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:50:53.414158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:50:53.424838 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:50:53.425448 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:53.425809 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-24'
WHERE a.created_at <= '2021-12-24'

GROUP BY 1,2,3,4,5,6
  );
  
18:50:53.436536 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:50:53.444072 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:53.444377 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
18:50:53.446104 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:53.449277 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:53.449585 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
18:50:53.451237 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:50:53.465022 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:50:53.465329 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:53.465542 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:50:53.467945 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:50:53.473622 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:50:53.473920 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
18:50:53.477327 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:50:53.478803 [debug] [Thread-1  ]: finished collecting timing info
18:50:53.479116 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:50:53.479703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee83dd1-a04c-431a-aea6-4614de818ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f29afd0>]}
18:50:53.480447 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 2[0m in 0.20s]
18:50:53.481294 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:50:53.515156 [debug] [MainThread]: Acquiring new postgres connection "master"
18:50:53.515982 [debug] [MainThread]: Using postgres connection "master"
18:50:53.516553 [debug] [MainThread]: On master: BEGIN
18:50:53.517030 [debug] [MainThread]: Opening a new connection, currently in state closed
18:50:53.534095 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:50:53.534530 [debug] [MainThread]: On master: COMMIT
18:50:53.534844 [debug] [MainThread]: Using postgres connection "master"
18:50:53.535259 [debug] [MainThread]: On master: COMMIT
18:50:53.540781 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
18:50:53.541702 [debug] [MainThread]: On master: Close
18:50:53.542794 [info ] [MainThread]: 
18:50:53.543780 [info ] [MainThread]: Finished running 1 incremental model in 0.43s.
18:50:53.544649 [debug] [MainThread]: Connection 'master' was properly closed.
18:50:53.544893 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:50:53.552684 [info ] [MainThread]: 
18:50:53.553536 [info ] [MainThread]: [32mCompleted successfully[0m
18:50:53.554047 [info ] [MainThread]: 
18:50:53.554426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:50:53.554875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f0df210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f1a28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88f1a2090>]}


============================== 2021-12-26 18:51:29.581154 | cdf92d55-4f3d-49e3-ac65-3963603874b0 ==============================
18:51:29.581154 [info ] [MainThread]: Running with dbt=1.0.0
18:51:29.582576 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
18:51:29.583531 [debug] [MainThread]: Tracking: tracking
18:51:29.602246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec02e7c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec02e7c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec02e7c190>]}
18:51:29.673630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:51:29.674291 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
18:51:29.690112 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:51:29.709924 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:51:29.756903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf92d55-4f3d-49e3-ac65-3963603874b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0320ff10>]}
18:51:29.764188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf92d55-4f3d-49e3-ac65-3963603874b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec03252c50>]}
18:51:29.764636 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:51:29.766057 [info ] [MainThread]: 
18:51:29.766848 [debug] [MainThread]: Acquiring new postgres connection "master"
18:51:29.769080 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:51:29.787617 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:51:29.787929 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:51:29.788146 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:51:29.835038 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:51:29.837551 [debug] [ThreadPool]: On list_dbt: Close
18:51:29.840925 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:51:29.851487 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:51:29.851856 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:51:29.852129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:51:29.865967 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:51:29.866490 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:51:29.866828 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:51:29.870981 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:51:29.872782 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:51:29.874886 [debug] [ThreadPool]: On list_dbt_dev: Close
18:51:29.881246 [debug] [MainThread]: Using postgres connection "master"
18:51:29.881574 [debug] [MainThread]: On master: BEGIN
18:51:29.881826 [debug] [MainThread]: Opening a new connection, currently in state init
18:51:29.893027 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:51:29.893497 [debug] [MainThread]: Using postgres connection "master"
18:51:29.893845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:51:29.902971 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:51:29.904751 [debug] [MainThread]: On master: ROLLBACK
18:51:29.906334 [debug] [MainThread]: Using postgres connection "master"
18:51:29.906757 [debug] [MainThread]: On master: BEGIN
18:51:29.910058 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:51:29.910556 [debug] [MainThread]: On master: COMMIT
18:51:29.910920 [debug] [MainThread]: Using postgres connection "master"
18:51:29.911223 [debug] [MainThread]: On master: COMMIT
18:51:29.913312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:51:29.913754 [debug] [MainThread]: On master: Close
18:51:29.914588 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:51:29.915360 [info ] [MainThread]: 
18:51:29.920716 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:51:29.921420 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:51:29.922472 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:51:29.922935 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:51:29.923417 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:51:29.930241 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:51:29.933351 [debug] [Thread-1  ]: finished collecting timing info
18:51:29.934388 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:51:30.002105 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:51:30.004112 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:30.004430 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:51:30.004644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:51:30.017206 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:51:30.017776 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:30.018167 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-24'
WHERE a.created_at <= '2021-12-24'
GROUP BY 1,2,3,4,5,6
  );
  
18:51:30.027277 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:51:30.034908 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:30.035227 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
18:51:30.036958 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:51:30.039658 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:30.039967 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
18:51:30.041877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:51:30.055125 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:51:30.055435 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:30.055650 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:51:30.057912 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:51:30.063627 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:30.063932 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
18:51:30.067282 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:51:30.068823 [debug] [Thread-1  ]: finished collecting timing info
18:51:30.069145 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:51:30.069852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf92d55-4f3d-49e3-ac65-3963603874b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec02fe8250>]}
18:51:30.070511 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 2[0m in 0.15s]
18:51:30.071393 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:51:30.125946 [debug] [MainThread]: Acquiring new postgres connection "master"
18:51:30.126464 [debug] [MainThread]: Using postgres connection "master"
18:51:30.126708 [debug] [MainThread]: On master: BEGIN
18:51:30.126930 [debug] [MainThread]: Opening a new connection, currently in state closed
18:51:30.139757 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:51:30.140346 [debug] [MainThread]: On master: COMMIT
18:51:30.140838 [debug] [MainThread]: Using postgres connection "master"
18:51:30.141405 [debug] [MainThread]: On master: COMMIT
18:51:30.143329 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:51:30.143755 [debug] [MainThread]: On master: Close
18:51:30.144376 [info ] [MainThread]: 
18:51:30.145146 [info ] [MainThread]: Finished running 1 incremental model in 0.38s.
18:51:30.145606 [debug] [MainThread]: Connection 'master' was properly closed.
18:51:30.145821 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:51:30.153587 [info ] [MainThread]: 
18:51:30.154153 [info ] [MainThread]: [32mCompleted successfully[0m
18:51:30.154763 [info ] [MainThread]: 
18:51:30.155342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:51:30.155969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec032a6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec02f67950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec02f67ed0>]}


============================== 2021-12-26 18:51:49.876577 | 939dc832-f970-4041-a1d9-2f820e739097 ==============================
18:51:49.876577 [info ] [MainThread]: Running with dbt=1.0.0
18:51:49.877735 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
18:51:49.878097 [debug] [MainThread]: Tracking: tracking
18:51:49.896175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea65ebc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea65ebc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea65ebc390>]}
18:51:49.938203 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:51:49.939154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '939dc832-f970-4041-a1d9-2f820e739097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea66098fd0>]}
18:51:49.980683 [debug] [MainThread]: Parsing macros/catalog.sql
18:51:49.986316 [debug] [MainThread]: Parsing macros/relations.sql
18:51:49.988292 [debug] [MainThread]: Parsing macros/adapters.sql
18:51:50.022558 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:51:50.024969 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:51:50.031039 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:51:50.034791 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:51:50.037191 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:51:50.062445 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:51:50.083700 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:51:50.101382 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:51:50.107898 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:51:50.110560 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:51:50.113169 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:51:50.119594 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:51:50.135483 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:51:50.137728 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:51:50.152858 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:51:50.175283 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:51:50.186002 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:51:50.190176 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:51:50.200314 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:51:50.202224 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:51:50.206132 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:51:50.209551 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:51:50.218435 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:51:50.242067 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:51:50.244228 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:51:50.247841 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:51:50.250093 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:51:50.251350 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:51:50.252162 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:51:50.253279 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:51:50.255452 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:51:50.261849 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:51:50.273925 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:51:50.277370 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:51:50.281247 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:51:50.295203 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:51:50.299327 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:51:50.305784 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:51:50.316109 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:51:50.331592 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:51:50.592248 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:51:50.611312 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:51:50.706474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '939dc832-f970-4041-a1d9-2f820e739097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea660fab90>]}
18:51:50.713227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '939dc832-f970-4041-a1d9-2f820e739097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea661278d0>]}
18:51:50.713748 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:51:50.715185 [info ] [MainThread]: 
18:51:50.716029 [debug] [MainThread]: Acquiring new postgres connection "master"
18:51:50.717681 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:51:50.735147 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:51:50.735466 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:51:50.735696 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:51:50.773275 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
18:51:50.775419 [debug] [ThreadPool]: On list_dbt: Close
18:51:50.778179 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:51:50.789545 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:51:50.789879 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:51:50.790101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:51:50.804545 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:51:50.805242 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:51:50.805570 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:51:50.810139 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:51:50.812281 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:51:50.814196 [debug] [ThreadPool]: On list_dbt_dev: Close
18:51:50.821563 [debug] [MainThread]: Using postgres connection "master"
18:51:50.821874 [debug] [MainThread]: On master: BEGIN
18:51:50.822085 [debug] [MainThread]: Opening a new connection, currently in state init
18:51:50.834498 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:51:50.834872 [debug] [MainThread]: Using postgres connection "master"
18:51:50.835110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:51:50.844494 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:51:50.846045 [debug] [MainThread]: On master: ROLLBACK
18:51:50.847716 [debug] [MainThread]: Using postgres connection "master"
18:51:50.848072 [debug] [MainThread]: On master: BEGIN
18:51:50.852650 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:51:50.853275 [debug] [MainThread]: On master: COMMIT
18:51:50.853561 [debug] [MainThread]: Using postgres connection "master"
18:51:50.853790 [debug] [MainThread]: On master: COMMIT
18:51:50.856425 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:51:50.856809 [debug] [MainThread]: On master: Close
18:51:50.857855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:51:50.858490 [info ] [MainThread]: 
18:51:50.861893 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:51:50.862715 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:51:50.863630 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:51:50.864004 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:51:50.864506 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:51:50.874235 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:51:50.875583 [debug] [Thread-1  ]: finished collecting timing info
18:51:50.876185 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:51:50.996165 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:50.996477 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp105150928855"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-25') AS unique_key
  , '2021-12-25' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-25'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-25'
WHERE a.created_at <= '2021-12-25'
GROUP BY 1,2,3,4,5,6
  );
  
18:51:50.996702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:51:51.010228 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
18:51:51.019913 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:51.020228 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:51:51.022156 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:51:51.022530 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:51.022790 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp105150928855'
        
      order by ordinal_position

  
18:51:51.033534 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.01 seconds
18:51:51.039964 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:51.040327 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:51:51.045447 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:51:51.055710 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:51.056219 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:51:51.060738 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:51:51.072655 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:51:51.073779 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:51.074097 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (unique_key) in (
        select (unique_key)
        from "agg_users__dbt_tmp105150928855"
    );
    

    insert into "dbt"."dev"."agg_users" ("unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp105150928855"
    )
  
18:51:51.077187 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
18:51:51.088878 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:51:51.089292 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:51:51.089568 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:51:51.092016 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:51:51.092842 [debug] [Thread-1  ]: finished collecting timing info
18:51:51.093152 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:51:51.093944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939dc832-f970-4041-a1d9-2f820e739097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea661887d0>]}
18:51:51.094705 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 3[0m in 0.23s]
18:51:51.096154 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:51:51.191743 [debug] [MainThread]: Acquiring new postgres connection "master"
18:51:51.192368 [debug] [MainThread]: Using postgres connection "master"
18:51:51.192644 [debug] [MainThread]: On master: BEGIN
18:51:51.192876 [debug] [MainThread]: Opening a new connection, currently in state closed
18:51:51.206039 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:51:51.206719 [debug] [MainThread]: On master: COMMIT
18:51:51.207320 [debug] [MainThread]: Using postgres connection "master"
18:51:51.207930 [debug] [MainThread]: On master: COMMIT
18:51:51.209553 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:51:51.209932 [debug] [MainThread]: On master: Close
18:51:51.210649 [info ] [MainThread]: 
18:51:51.211338 [info ] [MainThread]: Finished running 1 incremental model in 0.49s.
18:51:51.212488 [debug] [MainThread]: Connection 'master' was properly closed.
18:51:51.212813 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:51:51.221400 [info ] [MainThread]: 
18:51:51.222113 [info ] [MainThread]: [32mCompleted successfully[0m
18:51:51.223479 [info ] [MainThread]: 
18:51:51.224193 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:51:51.225025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea66191c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea66175410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea66175590>]}


============================== 2021-12-26 18:52:51.265921 | b67efa22-11f8-4207-bb4a-4a38ec9384f7 ==============================
18:52:51.265921 [info ] [MainThread]: Running with dbt=1.0.0
18:52:51.267696 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-26"}', version_check=None, warn_error=None, which='run', write_json=None)
18:52:51.268417 [debug] [MainThread]: Tracking: tracking
18:52:51.319710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa870eac090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa870eacf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa870eac450>]}
18:52:51.354874 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:52:51.355774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b67efa22-11f8-4207-bb4a-4a38ec9384f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa871999fd0>]}
18:52:51.408371 [debug] [MainThread]: Parsing macros/catalog.sql
18:52:51.414203 [debug] [MainThread]: Parsing macros/relations.sql
18:52:51.416146 [debug] [MainThread]: Parsing macros/adapters.sql
18:52:51.448461 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:52:51.450875 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:52:51.456596 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:52:51.459954 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:52:51.462408 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:52:51.487679 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:52:51.503634 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:52:51.521167 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:52:51.527763 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:52:51.530388 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:52:51.533009 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:52:51.540293 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:52:51.556527 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:52:51.558781 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:52:51.573809 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:52:51.596220 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:52:51.607050 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:52:51.611185 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:52:51.621362 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:52:51.623252 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:52:51.627105 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:52:51.630459 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:52:51.639355 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:52:51.663044 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:52:51.665265 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:52:51.668781 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:52:51.671093 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:52:51.672422 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:52:51.673237 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:52:51.674251 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:52:51.676403 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:52:51.682758 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:52:51.694766 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:52:51.697909 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:52:51.701907 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:52:51.715486 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:52:51.719638 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:52:51.725973 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:52:51.736225 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:52:51.750239 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:52:52.006582 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:52:52.025246 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:52:52.122984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67efa22-11f8-4207-bb4a-4a38ec9384f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa871a18390>]}
18:52:52.130032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67efa22-11f8-4207-bb4a-4a38ec9384f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa871a1ca50>]}
18:52:52.130520 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:52:52.132120 [info ] [MainThread]: 
18:52:52.133019 [debug] [MainThread]: Acquiring new postgres connection "master"
18:52:52.134663 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:52:52.155702 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:52:52.156099 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:52:52.156526 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:52:52.213248 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
18:52:52.215493 [debug] [ThreadPool]: On list_dbt: Close
18:52:52.217983 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:52:52.229286 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:52:52.229611 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:52:52.229831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:52:52.242489 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:52:52.243466 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:52:52.243835 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:52:52.248408 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:52:52.250460 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:52:52.252342 [debug] [ThreadPool]: On list_dbt_dev: Close
18:52:52.259731 [debug] [MainThread]: Using postgres connection "master"
18:52:52.260109 [debug] [MainThread]: On master: BEGIN
18:52:52.260320 [debug] [MainThread]: Opening a new connection, currently in state init
18:52:52.271428 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:52:52.272082 [debug] [MainThread]: Using postgres connection "master"
18:52:52.272436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:52:52.281720 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:52:52.283325 [debug] [MainThread]: On master: ROLLBACK
18:52:52.284801 [debug] [MainThread]: Using postgres connection "master"
18:52:52.285173 [debug] [MainThread]: On master: BEGIN
18:52:52.288325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:52:52.288812 [debug] [MainThread]: On master: COMMIT
18:52:52.289204 [debug] [MainThread]: Using postgres connection "master"
18:52:52.289517 [debug] [MainThread]: On master: COMMIT
18:52:52.291268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:52:52.291661 [debug] [MainThread]: On master: Close
18:52:52.292524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:52:52.293361 [info ] [MainThread]: 
18:52:52.297849 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:52:52.298447 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:52:52.299099 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:52:52.299347 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:52:52.299603 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:52:52.310612 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:52:52.311310 [debug] [Thread-1  ]: finished collecting timing info
18:52:52.311841 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:52:52.428956 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:52:52.429303 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp105252362924"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-26') AS unique_key
  , '2021-12-26' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-26'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-26'
WHERE a.created_at <= '2021-12-26'
GROUP BY 1,2,3,4,5,6
  );
  
18:52:52.429552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:52:52.446166 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.02 seconds
18:52:52.455258 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:52:52.455566 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:52:52.457554 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:52:52.457916 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:52:52.458203 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp105252362924'
        
      order by ordinal_position

  
18:52:52.468632 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.01 seconds
18:52:52.474807 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:52:52.475107 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:52:52.479911 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:52:52.489196 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:52:52.489496 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:52:52.493930 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:52:52.504696 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:52:52.505419 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:52:52.505671 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (unique_key) in (
        select (unique_key)
        from "agg_users__dbt_tmp105252362924"
    );
    

    insert into "dbt"."dev"."agg_users" ("unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp105252362924"
    )
  
18:52:52.508235 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
18:52:52.517704 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:52:52.518243 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:52:52.518711 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:52:52.522340 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:52:52.523667 [debug] [Thread-1  ]: finished collecting timing info
18:52:52.524381 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:52:52.525562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67efa22-11f8-4207-bb4a-4a38ec9384f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa871aa25d0>]}
18:52:52.526380 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 4[0m in 0.23s]
18:52:52.527288 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:52:52.621824 [debug] [MainThread]: Acquiring new postgres connection "master"
18:52:52.622340 [debug] [MainThread]: Using postgres connection "master"
18:52:52.622702 [debug] [MainThread]: On master: BEGIN
18:52:52.623038 [debug] [MainThread]: Opening a new connection, currently in state closed
18:52:52.640188 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:52:52.640747 [debug] [MainThread]: On master: COMMIT
18:52:52.641142 [debug] [MainThread]: Using postgres connection "master"
18:52:52.641468 [debug] [MainThread]: On master: COMMIT
18:52:52.643750 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:52:52.644311 [debug] [MainThread]: On master: Close
18:52:52.645227 [info ] [MainThread]: 
18:52:52.646117 [info ] [MainThread]: Finished running 1 incremental model in 0.51s.
18:52:52.646563 [debug] [MainThread]: Connection 'master' was properly closed.
18:52:52.647084 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:52:52.655255 [info ] [MainThread]: 
18:52:52.656183 [info ] [MainThread]: [32mCompleted successfully[0m
18:52:52.656966 [info ] [MainThread]: 
18:52:52.657749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:52:52.659283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa871adf090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa871a78a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa871a78690>]}


============================== 2021-12-26 18:55:37.403194 | 490c15d3-178f-4369-a4c5-d2605f4cd818 ==============================
18:55:37.403194 [info ] [MainThread]: Running with dbt=1.0.0
18:55:37.405057 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-27"}', version_check=None, warn_error=None, which='run', write_json=None)
18:55:37.405901 [debug] [MainThread]: Tracking: tracking
18:55:37.435093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54ff7d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550099a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54ff7db90>]}
18:55:37.473911 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:55:37.475091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '490c15d3-178f-4369-a4c5-d2605f4cd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550158fd0>]}
18:55:37.530295 [debug] [MainThread]: Parsing macros/catalog.sql
18:55:37.536979 [debug] [MainThread]: Parsing macros/relations.sql
18:55:37.538939 [debug] [MainThread]: Parsing macros/adapters.sql
18:55:37.570821 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:55:37.573921 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:55:37.579969 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:55:37.583771 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:55:37.586634 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:55:37.614106 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:55:37.631106 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:55:37.652134 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:55:37.660467 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:55:37.663476 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:55:37.666598 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:55:37.674160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:55:37.692008 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:55:37.694423 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:55:37.710567 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:55:37.733683 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:55:37.745043 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:55:37.750034 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:55:37.760938 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:55:37.763233 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:55:37.767307 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:55:37.771099 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:55:37.780863 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:55:37.807678 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:55:37.809866 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:55:37.813312 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:55:37.815964 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:55:37.817471 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:55:37.818476 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:55:37.819693 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:55:37.821993 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:55:37.828506 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:55:37.841690 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:55:37.845010 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:55:37.848920 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:55:37.862925 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:55:37.867544 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:55:37.877701 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:55:37.890667 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:55:37.905816 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:55:38.194218 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:55:38.213846 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:55:38.333100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '490c15d3-178f-4369-a4c5-d2605f4cd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550137f10>]}
18:55:38.341186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '490c15d3-178f-4369-a4c5-d2605f4cd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501e7f90>]}
18:55:38.341670 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:55:38.343053 [info ] [MainThread]: 
18:55:38.343779 [debug] [MainThread]: Acquiring new postgres connection "master"
18:55:38.346064 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:55:38.369644 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:55:38.370020 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:55:38.370276 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:55:38.423835 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
18:55:38.425876 [debug] [ThreadPool]: On list_dbt: Close
18:55:38.428457 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:55:38.438181 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:55:38.438516 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:55:38.438745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:55:38.451308 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:55:38.451908 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:55:38.452330 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:55:38.458500 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
18:55:38.460394 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:55:38.462147 [debug] [ThreadPool]: On list_dbt_dev: Close
18:55:38.468491 [debug] [MainThread]: Using postgres connection "master"
18:55:38.468800 [debug] [MainThread]: On master: BEGIN
18:55:38.469030 [debug] [MainThread]: Opening a new connection, currently in state init
18:55:38.481364 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:55:38.481845 [debug] [MainThread]: Using postgres connection "master"
18:55:38.482309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:55:38.492853 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:55:38.494524 [debug] [MainThread]: On master: ROLLBACK
18:55:38.496018 [debug] [MainThread]: Using postgres connection "master"
18:55:38.496373 [debug] [MainThread]: On master: BEGIN
18:55:38.499404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:55:38.500094 [debug] [MainThread]: On master: COMMIT
18:55:38.500428 [debug] [MainThread]: Using postgres connection "master"
18:55:38.500703 [debug] [MainThread]: On master: COMMIT
18:55:38.502372 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:55:38.502758 [debug] [MainThread]: On master: Close
18:55:38.503501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:55:38.504204 [info ] [MainThread]: 
18:55:38.509253 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
18:55:38.509748 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
18:55:38.510398 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
18:55:38.510645 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
18:55:38.510895 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
18:55:38.525918 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
18:55:38.527534 [debug] [Thread-1  ]: finished collecting timing info
18:55:38.527997 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
18:55:38.656576 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:55:38.656883 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp105538589784"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-27') AS unique_key
  , '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-27'
WHERE a.created_at <= '2021-12-27'
GROUP BY 1,2,3,4,5,6
  );
  
18:55:38.657097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:55:38.671385 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:55:38.680817 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:55:38.681123 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
18:55:38.683214 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:55:38.683600 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:55:38.683868 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp105538589784'
        
      order by ordinal_position

  
18:55:38.693126 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.01 seconds
18:55:38.699321 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:55:38.699623 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:55:38.704389 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:55:38.713880 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:55:38.714273 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
18:55:38.718751 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
18:55:38.729675 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
18:55:38.730427 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:55:38.730696 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (unique_key) in (
        select (unique_key)
        from "agg_users__dbt_tmp105538589784"
    );
    

    insert into "dbt"."dev"."agg_users" ("unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp105538589784"
    )
  
18:55:38.732929 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
18:55:38.742141 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:55:38.742623 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
18:55:38.743142 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
18:55:38.747830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:55:38.749273 [debug] [Thread-1  ]: finished collecting timing info
18:55:38.749925 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
18:55:38.750912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '490c15d3-178f-4369-a4c5-d2605f4cd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55002d850>]}
18:55:38.751739 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 5[0m in 0.24s]
18:55:38.752973 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
18:55:38.873011 [debug] [MainThread]: Acquiring new postgres connection "master"
18:55:38.873516 [debug] [MainThread]: Using postgres connection "master"
18:55:38.873862 [debug] [MainThread]: On master: BEGIN
18:55:38.874170 [debug] [MainThread]: Opening a new connection, currently in state closed
18:55:38.888141 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:55:38.888510 [debug] [MainThread]: On master: COMMIT
18:55:38.888742 [debug] [MainThread]: Using postgres connection "master"
18:55:38.888995 [debug] [MainThread]: On master: COMMIT
18:55:38.890942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:55:38.891603 [debug] [MainThread]: On master: Close
18:55:38.892555 [info ] [MainThread]: 
18:55:38.895438 [info ] [MainThread]: Finished running 1 incremental model in 0.55s.
18:55:38.896672 [debug] [MainThread]: Connection 'master' was properly closed.
18:55:38.897495 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
18:55:38.907250 [info ] [MainThread]: 
18:55:38.908012 [info ] [MainThread]: [32mCompleted successfully[0m
18:55:38.909220 [info ] [MainThread]: 
18:55:38.910219 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
18:55:38.911352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550029890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55026ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55026a750>]}


============================== 2021-12-26 18:58:48.885497 | f68d3882-2867-412c-8598-2c1b7e398e43 ==============================
18:58:48.885497 [info ] [MainThread]: Running with dbt=1.0.0
18:58:48.887446 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
18:58:48.888114 [debug] [MainThread]: Tracking: tracking
18:58:48.910865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c496bd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c496bd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c496bda10>]}
18:58:48.973893 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:58:48.975352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f68d3882-2867-412c-8598-2c1b7e398e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c499dafd0>]}
18:58:49.033624 [debug] [MainThread]: Parsing macros/catalog.sql
18:58:49.040631 [debug] [MainThread]: Parsing macros/relations.sql
18:58:49.042866 [debug] [MainThread]: Parsing macros/adapters.sql
18:58:49.080111 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:58:49.084507 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:58:49.091396 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:58:49.095038 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:58:49.097967 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:58:49.129231 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:58:49.150472 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:58:49.168561 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:58:49.176519 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:58:49.180252 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:58:49.183464 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:58:49.190800 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:58:49.230016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:58:49.235628 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:58:49.260898 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:58:49.295545 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:58:49.311146 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:58:49.317791 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:58:49.331336 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:58:49.333415 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:58:49.339213 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:58:49.343625 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:58:49.358658 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:58:49.400288 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:58:49.404470 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:58:49.410213 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:58:49.413397 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:58:49.415314 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:58:49.417560 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:58:49.419669 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:58:49.422391 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:58:49.431543 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:58:49.453391 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:58:49.459597 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:58:49.464438 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:58:49.479795 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:58:49.485216 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:58:49.492976 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:58:49.504290 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:58:49.523217 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:58:49.789010 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
18:58:49.808494 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
18:58:49.903369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f68d3882-2867-412c-8598-2c1b7e398e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49a173d0>]}
18:58:49.911237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f68d3882-2867-412c-8598-2c1b7e398e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49a04910>]}
18:58:49.911714 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:58:49.913424 [info ] [MainThread]: 
18:58:49.914207 [debug] [MainThread]: Acquiring new postgres connection "master"
18:58:49.916038 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:58:49.933481 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:58:49.934040 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:58:49.934570 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:58:49.993631 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
18:58:49.994133 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:58:49.994500 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:58:49.999623 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
18:58:50.001779 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:58:50.004531 [debug] [ThreadPool]: On list_dbt_dev: Close
18:58:50.014320 [debug] [MainThread]: Using postgres connection "master"
18:58:50.014635 [debug] [MainThread]: On master: BEGIN
18:58:50.014846 [debug] [MainThread]: Opening a new connection, currently in state init
18:58:50.027028 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:58:50.027515 [debug] [MainThread]: Using postgres connection "master"
18:58:50.027836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:58:50.037353 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:58:50.038799 [debug] [MainThread]: On master: ROLLBACK
18:58:50.040377 [debug] [MainThread]: Using postgres connection "master"
18:58:50.040722 [debug] [MainThread]: On master: BEGIN
18:58:50.043631 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:58:50.044132 [debug] [MainThread]: On master: COMMIT
18:58:50.044442 [debug] [MainThread]: Using postgres connection "master"
18:58:50.044698 [debug] [MainThread]: On master: COMMIT
18:58:50.046592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:58:50.047072 [debug] [MainThread]: On master: Close
18:58:50.047670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:58:50.048367 [info ] [MainThread]: 
18:58:50.053344 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:58:50.053854 [info ] [Thread-1  ]: 1 of 4 START test not_null_agg_users_dt......................................... [RUN]
18:58:50.054685 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:58:50.055105 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:58:50.055544 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:58:50.069788 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:58:50.072114 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.073080 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:58:50.101502 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:58:50.102610 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:58:50.102874 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: BEGIN
18:58:50.103079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:58:50.116669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:58:50.117184 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:58:50.117554 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users"
where dt is null



      
    ) dbt_internal_test
18:58:50.120292 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:58:50.122898 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.123231 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: ROLLBACK
18:58:50.125324 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: Close
18:58:50.126354 [info ] [Thread-1  ]: 1 of 4 PASS not_null_agg_users_dt............................................... [[32mPASS[0m in 0.07s]
18:58:50.127208 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:58:50.127602 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:58:50.128271 [info ] [Thread-1  ]: 2 of 4 START test not_null_agg_users_unique_key................................. [RUN]
18:58:50.130221 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:58:50.130871 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:58:50.131543 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:58:50.137748 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:58:50.138589 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.138934 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:58:50.195298 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:58:50.196027 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:58:50.196284 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: BEGIN
18:58:50.196485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:58:50.207784 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:58:50.208360 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:58:50.208693 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users"
where unique_key is null



      
    ) dbt_internal_test
18:58:50.211185 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:58:50.212896 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.213310 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: ROLLBACK
18:58:50.214931 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: Close
18:58:50.215676 [info ] [Thread-1  ]: 2 of 4 PASS not_null_agg_users_unique_key....................................... [[32mPASS[0m in 0.09s]
18:58:50.216239 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:58:50.216670 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:58:50.217254 [info ] [Thread-1  ]: 3 of 4 START test not_null_agg_users_user_id.................................... [RUN]
18:58:50.218303 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:58:50.218748 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:58:50.219354 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:58:50.226439 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:58:50.227279 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.227738 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:58:50.230157 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:58:50.231125 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:58:50.231608 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: BEGIN
18:58:50.232094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:58:50.258885 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:58:50.259442 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:58:50.259869 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users"
where user_id is null



      
    ) dbt_internal_test
18:58:50.266039 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:58:50.270119 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.270670 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: ROLLBACK
18:58:50.272681 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: Close
18:58:50.273739 [info ] [Thread-1  ]: 3 of 4 PASS not_null_agg_users_user_id.......................................... [[32mPASS[0m in 0.06s]
18:58:50.275141 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:58:50.276795 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:58:50.277699 [info ] [Thread-1  ]: 4 of 4 START test unique_agg_users_unique_key................................... [RUN]
18:58:50.278900 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:58:50.279510 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:58:50.279937 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:58:50.292839 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:58:50.294673 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.295389 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:58:50.299446 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:58:50.301052 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:58:50.301463 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: BEGIN
18:58:50.301816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:58:50.326463 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:58:50.326989 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:58:50.327236 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    unique_key as unique_field,
    count(*) as n_records

from "dbt"."dev"."agg_users"
where unique_key is not null
group by unique_key
having count(*) > 1



      
    ) dbt_internal_test
18:58:50.333698 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:58:50.336160 [debug] [Thread-1  ]: finished collecting timing info
18:58:50.336527 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: ROLLBACK
18:58:50.338531 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: Close
18:58:50.339482 [info ] [Thread-1  ]: 4 of 4 PASS unique_agg_users_unique_key......................................... [[32mPASS[0m in 0.06s]
18:58:50.340573 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:58:50.408732 [debug] [MainThread]: Acquiring new postgres connection "master"
18:58:50.409321 [debug] [MainThread]: Using postgres connection "master"
18:58:50.409729 [debug] [MainThread]: On master: BEGIN
18:58:50.410111 [debug] [MainThread]: Opening a new connection, currently in state closed
18:58:50.423909 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:58:50.424340 [debug] [MainThread]: On master: COMMIT
18:58:50.424703 [debug] [MainThread]: Using postgres connection "master"
18:58:50.424939 [debug] [MainThread]: On master: COMMIT
18:58:50.426489 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:58:50.426867 [debug] [MainThread]: On master: Close
18:58:50.427540 [info ] [MainThread]: 
18:58:50.428116 [info ] [MainThread]: Finished running 4 tests in 0.51s.
18:58:50.428525 [debug] [MainThread]: Connection 'master' was properly closed.
18:58:50.429014 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b' was properly closed.
18:58:50.437295 [info ] [MainThread]: 
18:58:50.437852 [info ] [MainThread]: [32mCompleted successfully[0m
18:58:50.438963 [info ] [MainThread]: 
18:58:50.439972 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
18:58:50.441095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49b11c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49b13e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4976e690>]}


============================== 2021-12-26 18:59:21.574659 | 1ea56f90-f038-4c51-806f-9a17c726c743 ==============================
18:59:21.574659 [info ] [MainThread]: Running with dbt=1.0.0
18:59:21.575961 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, indirect_selection='eager', log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, store_failures=False, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='test', write_json=None)
18:59:21.576431 [debug] [MainThread]: Tracking: tracking
18:59:21.593496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92826bdf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9282914750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92826bd450>]}
18:59:21.652188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:59:21.652529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:59:21.660978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ea56f90-f038-4c51-806f-9a17c726c743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92829bfd90>]}
18:59:21.668789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ea56f90-f038-4c51-806f-9a17c726c743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92829d2290>]}
18:59:21.669297 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:59:21.670874 [info ] [MainThread]: 
18:59:21.671568 [debug] [MainThread]: Acquiring new postgres connection "master"
18:59:21.673687 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
18:59:21.696165 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:59:21.696504 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
18:59:21.696757 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:59:21.734391 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
18:59:21.735022 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
18:59:21.735367 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
18:59:21.741287 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
18:59:21.744316 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
18:59:21.745951 [debug] [ThreadPool]: On list_dbt_dev: Close
18:59:21.754647 [debug] [MainThread]: Using postgres connection "master"
18:59:21.755089 [debug] [MainThread]: On master: BEGIN
18:59:21.755390 [debug] [MainThread]: Opening a new connection, currently in state init
18:59:21.771198 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:59:21.771806 [debug] [MainThread]: Using postgres connection "master"
18:59:21.772108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:59:21.784065 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:59:21.785532 [debug] [MainThread]: On master: ROLLBACK
18:59:21.787196 [debug] [MainThread]: Using postgres connection "master"
18:59:21.787553 [debug] [MainThread]: On master: BEGIN
18:59:21.790785 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:59:21.791351 [debug] [MainThread]: On master: COMMIT
18:59:21.791865 [debug] [MainThread]: Using postgres connection "master"
18:59:21.792429 [debug] [MainThread]: On master: COMMIT
18:59:21.796126 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:59:21.796773 [debug] [MainThread]: On master: Close
18:59:21.797880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
18:59:21.799304 [info ] [MainThread]: 
18:59:21.804202 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:59:21.805137 [info ] [Thread-1  ]: 1 of 4 START test not_null_agg_users_dt......................................... [RUN]
18:59:21.806067 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:59:21.806684 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:59:21.806972 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:59:21.839817 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:59:21.840955 [debug] [Thread-1  ]: finished collecting timing info
18:59:21.841393 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:59:21.869197 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:59:21.869967 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:59:21.870260 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: BEGIN
18:59:21.870488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:21.884513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:59:21.884879 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
18:59:21.885356 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users"
where dt is null



      
    ) dbt_internal_test
18:59:21.887818 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:59:21.890585 [debug] [Thread-1  ]: finished collecting timing info
18:59:21.890954 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: ROLLBACK
18:59:21.893044 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393: Close
18:59:21.894211 [info ] [Thread-1  ]: 1 of 4 PASS not_null_agg_users_dt............................................... [[32mPASS[0m in 0.09s]
18:59:21.895472 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
18:59:21.896392 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:59:21.897628 [info ] [Thread-1  ]: 2 of 4 START test not_null_agg_users_unique_key................................. [RUN]
18:59:21.899752 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:59:21.900137 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:59:21.900489 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:59:21.906223 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:59:21.906937 [debug] [Thread-1  ]: finished collecting timing info
18:59:21.907243 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:59:21.909446 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:59:21.910123 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:59:21.910390 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: BEGIN
18:59:21.910605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:21.928000 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:59:21.930038 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
18:59:21.930516 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users"
where unique_key is null



      
    ) dbt_internal_test
18:59:21.934763 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:59:21.937491 [debug] [Thread-1  ]: finished collecting timing info
18:59:21.939333 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: ROLLBACK
18:59:21.941607 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d: Close
18:59:21.942373 [info ] [Thread-1  ]: 2 of 4 PASS not_null_agg_users_unique_key....................................... [[32mPASS[0m in 0.04s]
18:59:21.943367 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
18:59:21.944376 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:59:21.945100 [info ] [Thread-1  ]: 3 of 4 START test not_null_agg_users_user_id.................................... [RUN]
18:59:21.946492 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:59:21.950664 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:59:21.951127 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:59:21.956286 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:59:21.959063 [debug] [Thread-1  ]: finished collecting timing info
18:59:21.961260 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:59:21.965041 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:59:21.965817 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:59:21.966098 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: BEGIN
18:59:21.966299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:21.992135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:59:21.993145 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
18:59:21.993692 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users"
where user_id is null



      
    ) dbt_internal_test
18:59:21.996659 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:59:22.003494 [debug] [Thread-1  ]: finished collecting timing info
18:59:22.003821 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: ROLLBACK
18:59:22.005373 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_user_id.9c24a32429: Close
18:59:22.006118 [info ] [Thread-1  ]: 3 of 4 PASS not_null_agg_users_user_id.......................................... [[32mPASS[0m in 0.06s]
18:59:22.006995 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
18:59:22.008132 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:59:22.008648 [info ] [Thread-1  ]: 4 of 4 START test unique_agg_users_unique_key................................... [RUN]
18:59:22.011213 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:59:22.011531 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:59:22.011779 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:59:22.027989 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:59:22.029577 [debug] [Thread-1  ]: finished collecting timing info
18:59:22.030059 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:59:22.034622 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:59:22.035402 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:59:22.035672 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: BEGIN
18:59:22.035873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:59:22.057304 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:59:22.057897 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
18:59:22.058656 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    unique_key as unique_field,
    count(*) as n_records

from "dbt"."dev"."agg_users"
where unique_key is not null
group by unique_key
having count(*) > 1



      
    ) dbt_internal_test
18:59:22.061752 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:59:22.068636 [debug] [Thread-1  ]: finished collecting timing info
18:59:22.068975 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: ROLLBACK
18:59:22.070527 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b: Close
18:59:22.071321 [info ] [Thread-1  ]: 4 of 4 PASS unique_agg_users_unique_key......................................... [[32mPASS[0m in 0.06s]
18:59:22.072043 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
18:59:22.114958 [debug] [MainThread]: Acquiring new postgres connection "master"
18:59:22.116431 [debug] [MainThread]: Using postgres connection "master"
18:59:22.117890 [debug] [MainThread]: On master: BEGIN
18:59:22.118820 [debug] [MainThread]: Opening a new connection, currently in state closed
18:59:22.133396 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:59:22.133821 [debug] [MainThread]: On master: COMMIT
18:59:22.134107 [debug] [MainThread]: Using postgres connection "master"
18:59:22.134361 [debug] [MainThread]: On master: COMMIT
18:59:22.136604 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:59:22.136951 [debug] [MainThread]: On master: Close
18:59:22.137488 [info ] [MainThread]: 
18:59:22.138074 [info ] [MainThread]: Finished running 4 tests in 0.47s.
18:59:22.139068 [debug] [MainThread]: Connection 'master' was properly closed.
18:59:22.139643 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b' was properly closed.
18:59:22.148119 [info ] [MainThread]: 
18:59:22.149054 [info ] [MainThread]: [32mCompleted successfully[0m
18:59:22.149581 [info ] [MainThread]: 
18:59:22.149964 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
18:59:22.150418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f928294cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92829508d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9282950850>]}


============================== 2021-12-26 19:03:22.303722 | 7d44e7f1-f4ec-422f-a6ad-4da8909af5d4 ==============================
19:03:22.303722 [info ] [MainThread]: Running with dbt=1.0.0
19:03:22.306696 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
19:03:22.307391 [debug] [MainThread]: Tracking: tracking
19:03:22.323467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856bebc090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8568c76e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856bebc210>]}
19:03:22.389170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:03:22.389752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:03:22.402714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d44e7f1-f4ec-422f-a6ad-4da8909af5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856b228350>]}
19:03:22.412528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d44e7f1-f4ec-422f-a6ad-4da8909af5d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856c090390>]}
19:03:22.413075 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:03:22.415199 [info ] [MainThread]: 
19:03:22.416140 [debug] [MainThread]: Acquiring new postgres connection "master"
19:03:22.418101 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:03:22.432133 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:03:22.432507 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:03:22.432765 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:03:22.478712 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
19:03:22.479679 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:03:22.480109 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:03:22.487343 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
19:03:22.490281 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:03:22.492463 [debug] [ThreadPool]: On list_dbt_dev: Close
19:03:22.501816 [debug] [MainThread]: Using postgres connection "master"
19:03:22.502213 [debug] [MainThread]: On master: BEGIN
19:03:22.502545 [debug] [MainThread]: Opening a new connection, currently in state init
19:03:22.515727 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:03:22.516332 [debug] [MainThread]: Using postgres connection "master"
19:03:22.516871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:03:22.526794 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:03:22.528307 [debug] [MainThread]: On master: ROLLBACK
19:03:22.529833 [debug] [MainThread]: On master: Close
19:03:22.530609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:03:22.531506 [info ] [MainThread]: 
19:03:22.539374 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
19:03:22.540125 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
19:03:22.540469 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
19:03:22.540920 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.payments
19:03:22.543718 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.payments"
19:03:22.544317 [debug] [Thread-1  ]: finished collecting timing info
19:03:22.544986 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
19:03:22.546027 [debug] [Thread-1  ]: finished collecting timing info
19:03:22.546874 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
19:03:22.547222 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
19:03:22.547908 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
19:03:22.548173 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
19:03:22.548440 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.sessions
19:03:22.550361 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.sessions"
19:03:22.550660 [debug] [Thread-1  ]: finished collecting timing info
19:03:22.550897 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
19:03:22.551137 [debug] [Thread-1  ]: finished collecting timing info
19:03:22.551610 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
19:03:22.551883 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
19:03:22.552367 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
19:03:22.552737 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
19:03:22.553042 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
19:03:22.554885 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
19:03:22.555160 [debug] [Thread-1  ]: finished collecting timing info
19:03:22.555390 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
19:03:22.555653 [debug] [Thread-1  ]: finished collecting timing info
19:03:22.556133 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
19:03:22.556635 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
19:03:22.557073 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
19:03:22.557302 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
19:03:22.557520 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
19:03:22.564683 [debug] [Thread-1  ]: finished collecting timing info
19:03:22.565326 [debug] [Thread-1  ]: Compilation Error in model agg_users (models/example/agg_users.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users = {}
  
  > in model agg_users (models/example/agg_users.sql)
  > called by model agg_users (models/example/agg_users.sql)
19:03:22.565784 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
19:03:22.566321 [debug] [MainThread]: Connection 'master' was properly closed.
19:03:22.566572 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
19:03:22.566898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856c03c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856c090a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f856c090d90>]}


============================== 2021-12-26 19:05:24.095112 | 252744e6-4381-4253-bfb5-5eaf15aaa285 ==============================
19:05:24.095112 [info ] [MainThread]: Running with dbt=1.0.0
19:05:24.096518 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-25"}', version_check=None, warn_error=None, which='generate', write_json=None)
19:05:24.097279 [debug] [MainThread]: Tracking: tracking
19:05:24.117576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b77fc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b8119810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b77fcdd0>]}
19:05:24.151820 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
19:05:24.152438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '252744e6-4381-4253-bfb5-5eaf15aaa285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b81d7fd0>]}
19:05:24.194679 [debug] [MainThread]: Parsing macros/catalog.sql
19:05:24.200256 [debug] [MainThread]: Parsing macros/relations.sql
19:05:24.202357 [debug] [MainThread]: Parsing macros/adapters.sql
19:05:24.236399 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:05:24.239174 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:05:24.244801 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:05:24.248251 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:05:24.250553 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:05:24.275032 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:05:24.290733 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:05:24.307526 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:05:24.313901 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:05:24.316387 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:05:24.318961 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:05:24.325248 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:05:24.341146 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:05:24.343348 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:05:24.358052 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:05:24.380063 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:05:24.391071 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:05:24.395221 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:05:24.405217 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:05:24.407093 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:05:24.410850 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:05:24.414090 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:05:24.422840 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:05:24.446863 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:05:24.449092 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:05:24.452668 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:05:24.454933 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:05:24.456223 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:05:24.457018 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:05:24.457996 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:05:24.460078 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:05:24.466251 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:05:24.477794 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:05:24.480817 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:05:24.484584 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:05:24.498345 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:05:24.502556 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:05:24.508792 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:05:24.518842 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:05:24.533257 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:05:24.784002 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:05:24.802575 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:05:24.909457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '252744e6-4381-4253-bfb5-5eaf15aaa285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b82c8d90>]}
19:05:24.916737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '252744e6-4381-4253-bfb5-5eaf15aaa285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b8258810>]}
19:05:24.917178 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:05:24.919067 [info ] [MainThread]: 
19:05:24.920064 [debug] [MainThread]: Acquiring new postgres connection "master"
19:05:24.921751 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:05:24.940193 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:05:24.940511 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:05:24.940733 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:05:24.982871 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
19:05:24.983605 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:05:24.984020 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:05:24.993756 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
19:05:24.995938 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:05:24.998224 [debug] [ThreadPool]: On list_dbt_dev: Close
19:05:25.006297 [debug] [MainThread]: Using postgres connection "master"
19:05:25.006817 [debug] [MainThread]: On master: BEGIN
19:05:25.007235 [debug] [MainThread]: Opening a new connection, currently in state init
19:05:25.020840 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:05:25.021348 [debug] [MainThread]: Using postgres connection "master"
19:05:25.021725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:05:25.032412 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:05:25.033939 [debug] [MainThread]: On master: ROLLBACK
19:05:25.036160 [debug] [MainThread]: On master: Close
19:05:25.037133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:05:25.037974 [info ] [MainThread]: 
19:05:25.041049 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
19:05:25.041952 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
19:05:25.042501 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
19:05:25.042944 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.payments
19:05:25.046279 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.payments"
19:05:25.046929 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.047978 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
19:05:25.048892 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.049686 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
19:05:25.050423 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
19:05:25.051105 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
19:05:25.051383 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
19:05:25.051620 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.sessions
19:05:25.053393 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.sessions"
19:05:25.053685 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.053900 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
19:05:25.054116 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.054541 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
19:05:25.054799 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
19:05:25.055253 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
19:05:25.055485 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
19:05:25.055698 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
19:05:25.057203 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
19:05:25.057455 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.057668 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
19:05:25.057881 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.058286 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
19:05:25.058853 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
19:05:25.059640 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
19:05:25.060169 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
19:05:25.060956 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
19:05:25.067596 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
19:05:25.069122 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.069539 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
19:05:25.069885 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.070491 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
19:05:25.071051 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
19:05:25.071461 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
19:05:25.071683 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
19:05:25.071896 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
19:05:25.125025 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
19:05:25.126919 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.127241 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
19:05:25.127483 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.127956 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
19:05:25.128236 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
19:05:25.128718 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
19:05:25.128948 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
19:05:25.129161 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
19:05:25.132967 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
19:05:25.133602 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.133856 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
19:05:25.134079 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.134515 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
19:05:25.134780 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
19:05:25.135227 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
19:05:25.135455 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
19:05:25.135670 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
19:05:25.140433 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
19:05:25.141106 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.141370 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
19:05:25.141596 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.142039 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
19:05:25.142452 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
19:05:25.142948 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
19:05:25.143176 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
19:05:25.143389 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
19:05:25.152422 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
19:05:25.153055 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.153311 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
19:05:25.153537 [debug] [Thread-1  ]: finished collecting timing info
19:05:25.153977 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
19:05:25.254240 [debug] [MainThread]: Connection 'master' was properly closed.
19:05:25.254858 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b' was properly closed.
19:05:25.262186 [info ] [MainThread]: Done.
19:05:25.270301 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:05:25.270883 [info ] [MainThread]: Building catalog
19:05:25.274989 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
19:05:25.290902 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
19:05:25.291237 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
19:05:25.291451 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:05:25.310014 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
19:05:25.310619 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
19:05:25.311208 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:05:25.328736 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.02 seconds
19:05:25.338894 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
19:05:25.342024 [debug] [ThreadPool]: On dbt.information_schema: Close
19:05:25.354579 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dairflow/bungie_dwh/target/catalog.json
19:05:25.355234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b8307210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b8307e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b83073d0>]}
19:05:25.849686 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:05:25.850017 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-26 19:05:36.606040 | dbcb905a-ce30-4cb1-b093-6d0333cfb343 ==============================
19:05:36.606040 [info ] [MainThread]: Running with dbt=1.0.0
19:05:36.607209 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
19:05:36.607537 [debug] [MainThread]: Tracking: tracking
19:05:36.621452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93a671690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93a671450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93a671410>]}
19:05:36.627407 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:05:36.628319 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:05:36.636078 [info ] [MainThread]: 
19:05:36.636738 [info ] [MainThread]: 
19:05:36.637417 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 19:18:41.264833 | c54655a3-436b-458e-8fee-b2ec18f7220d ==============================
19:18:41.264833 [info ] [MainThread]: Running with dbt=1.0.0
19:18:41.266736 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
19:18:41.267714 [debug] [MainThread]: Tracking: tracking
19:18:41.303293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8076712d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb807671190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb807671210>]}
19:18:41.312705 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:18:41.313349 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:18:41.314055 [info ] [MainThread]: 
19:18:41.314910 [info ] [MainThread]: 
19:18:41.315787 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 19:47:25.954181 | 632d7655-0da6-4951-ae29-d43d56d8745d ==============================
19:47:25.954181 [info ] [MainThread]: Running with dbt=1.0.0
19:47:25.956434 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
19:47:25.957179 [debug] [MainThread]: Tracking: tracking
19:47:26.004816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bb77c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bb77c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bb77c4d0>]}
19:47:26.037247 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
19:47:26.037992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '632d7655-0da6-4951-ae29-d43d56d8745d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bba58f90>]}
19:47:26.119868 [debug] [MainThread]: Parsing macros/catalog.sql
19:47:26.126862 [debug] [MainThread]: Parsing macros/relations.sql
19:47:26.129178 [debug] [MainThread]: Parsing macros/adapters.sql
19:47:26.161315 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:47:26.163748 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:47:26.169289 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:47:26.172662 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:47:26.174995 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:47:26.200021 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:47:26.217212 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:47:26.234309 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:47:26.241036 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:47:26.243680 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:47:26.246339 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:47:26.252724 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:47:26.269346 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:47:26.271710 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:47:26.286684 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:47:26.308848 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:47:26.319577 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:47:26.323752 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:47:26.333900 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:47:26.335854 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:47:26.339707 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:47:26.343574 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:47:26.352597 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:47:26.375855 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:47:26.378052 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:47:26.381572 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:47:26.383840 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:47:26.385116 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:47:26.385939 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:47:26.386960 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:47:26.389106 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:47:26.395576 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:47:26.407515 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:47:26.410667 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:47:26.414510 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:47:26.428164 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:47:26.432347 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:47:26.438630 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:47:26.448921 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:47:26.464879 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:47:26.722404 [debug] [MainThread]: 1603: static parser failed on staging/agg_users.sql
19:47:26.740948 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users.sql
19:47:26.742844 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:47:26.749527 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:47:26.750060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bb8ede10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bb8c6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bba225d0>]}


============================== 2021-12-26 19:49:20.096324 | b838045b-aace-416b-90a9-59a7825861e3 ==============================
19:49:20.096324 [info ] [MainThread]: Running with dbt=1.0.0
19:49:20.098056 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
19:49:20.098478 [debug] [MainThread]: Tracking: tracking
19:49:20.144652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01c7bc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01c7bc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01c7bc850>]}
19:49:20.209911 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
19:49:20.211628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b838045b-aace-416b-90a9-59a7825861e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01d198fd0>]}
19:49:20.244002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01d1a3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01d1a3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01d1a3f90>]}


============================== 2021-12-26 19:49:40.854855 | b6683327-f51b-4b1c-88fd-3b273e270c36 ==============================
19:49:40.854855 [info ] [MainThread]: Running with dbt=1.0.0
19:49:40.856076 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
19:49:40.856448 [debug] [MainThread]: Tracking: tracking
19:49:40.872933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a6bc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a6bc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a8d6b50>]}
19:49:40.914614 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
19:49:40.915261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6683327-f51b-4b1c-88fd-3b273e270c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a998f90>]}
19:49:40.963645 [debug] [MainThread]: Parsing macros/catalog.sql
19:49:40.970578 [debug] [MainThread]: Parsing macros/relations.sql
19:49:40.972517 [debug] [MainThread]: Parsing macros/adapters.sql
19:49:41.005220 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:49:41.007646 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:49:41.013385 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:49:41.016812 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:49:41.019522 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:49:41.045493 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:49:41.061849 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:49:41.079082 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:49:41.085650 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:49:41.088225 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:49:41.090952 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:49:41.097582 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:49:41.119147 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:49:41.122548 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:49:41.139548 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:49:41.163547 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:49:41.174732 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:49:41.179125 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:49:41.189346 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:49:41.191312 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:49:41.195319 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:49:41.198709 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:49:41.207838 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:49:41.231532 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:49:41.233887 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:49:41.237461 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:49:41.239732 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:49:41.241152 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:49:41.242032 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:49:41.243067 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:49:41.245238 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:49:41.252131 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:49:41.264472 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:49:41.267692 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:49:41.271572 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:49:41.286808 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:49:41.291149 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:49:41.297602 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:49:41.308291 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:49:41.322802 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:49:41.584305 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:49:41.603289 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:49:41.708649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6683327-f51b-4b1c-88fd-3b273e270c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce79d38c90>]}
19:49:41.716343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6683327-f51b-4b1c-88fd-3b273e270c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a9aa050>]}
19:49:41.716803 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:49:41.719080 [info ] [MainThread]: 
19:49:41.720067 [debug] [MainThread]: Acquiring new postgres connection "master"
19:49:41.724038 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
19:49:41.747519 [debug] [ThreadPool]: Using postgres connection "list_dbt"
19:49:41.748106 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
19:49:41.748730 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:49:41.822372 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.07 seconds
19:49:41.825526 [debug] [ThreadPool]: On list_dbt: Close
19:49:41.827311 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
19:49:41.828161 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
19:49:41.828919 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev', identifier=None)"
19:49:41.840190 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
19:49:41.840582 [debug] [ThreadPool]: On create_dbt_dev: BEGIN
19:49:41.840913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:49:41.853737 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:49:41.854356 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
19:49:41.854888 [debug] [ThreadPool]: On create_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "create_dbt_dev"} */
create schema if not exists "dev"
19:49:41.858116 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
19:49:41.859605 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
19:49:41.860108 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
19:49:41.860901 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
19:49:41.865697 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
19:49:41.866145 [debug] [ThreadPool]: On create_dbt_dev: Close
19:49:41.868514 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:49:41.876973 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:49:41.877299 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:49:41.877505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:49:41.889788 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:49:41.890326 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:49:41.890741 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:49:41.897724 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
19:49:41.899384 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:49:41.901269 [debug] [ThreadPool]: On list_dbt_dev: Close
19:49:41.908203 [debug] [MainThread]: Using postgres connection "master"
19:49:41.908543 [debug] [MainThread]: On master: BEGIN
19:49:41.908789 [debug] [MainThread]: Opening a new connection, currently in state init
19:49:41.921276 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:49:41.921886 [debug] [MainThread]: Using postgres connection "master"
19:49:41.922257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:49:41.928428 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:49:41.930560 [debug] [MainThread]: On master: ROLLBACK
19:49:41.932684 [debug] [MainThread]: Using postgres connection "master"
19:49:41.933060 [debug] [MainThread]: On master: BEGIN
19:49:41.936773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:49:41.937290 [debug] [MainThread]: On master: COMMIT
19:49:41.937658 [debug] [MainThread]: Using postgres connection "master"
19:49:41.938036 [debug] [MainThread]: On master: COMMIT
19:49:41.940303 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:49:41.940702 [debug] [MainThread]: On master: Close
19:49:41.941414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:49:41.942003 [info ] [MainThread]: 
19:49:41.949130 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
19:49:41.949624 [info ] [Thread-1  ]: 1 of 3 START seed file dev.payments............................................. [RUN]
19:49:41.950514 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
19:49:41.950833 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
19:49:41.951103 [debug] [Thread-1  ]: finished collecting timing info
19:49:41.951326 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
19:49:42.066244 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
19:49:42.066537 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: BEGIN
19:49:42.066739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:49:42.078763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:49:42.080116 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
19:49:42.080582 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */

    create table "dbt"."dev"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
19:49:42.087281 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
19:49:42.113653 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
19:49:42.113977 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: 
          insert into "dbt"."dev"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
19:49:42.116523 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
19:49:42.122114 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.payments"
19:49:42.139191 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
19:49:42.139776 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
19:49:42.140211 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
19:49:42.143552 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:49:42.144439 [debug] [Thread-1  ]: finished collecting timing info
19:49:42.144805 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: Close
19:49:42.145816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6683327-f51b-4b1c-88fd-3b273e270c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7aa9fc90>]}
19:49:42.146546 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.payments......................................... [[32mINSERT 3[0m in 0.20s]
19:49:42.147705 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
19:49:42.148376 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
19:49:42.149240 [info ] [Thread-1  ]: 2 of 3 START seed file dev.sessions............................................. [RUN]
19:49:42.150964 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
19:49:42.151369 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
19:49:42.151764 [debug] [Thread-1  ]: finished collecting timing info
19:49:42.152344 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
19:49:42.165694 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
19:49:42.166284 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: BEGIN
19:49:42.167076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:49:42.205827 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
19:49:42.206441 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
19:49:42.206746 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */

    create table "dbt"."dev"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
19:49:42.212508 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
19:49:42.219170 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
19:49:42.219701 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: 
          insert into "dbt"."dev"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
19:49:42.224624 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
19:49:42.225772 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.sessions"
19:49:42.231198 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
19:49:42.231725 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
19:49:42.232165 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
19:49:42.235505 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:49:42.236450 [debug] [Thread-1  ]: finished collecting timing info
19:49:42.236797 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: Close
19:49:42.237705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6683327-f51b-4b1c-88fd-3b273e270c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7aaf0890>]}
19:49:42.238620 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.sessions......................................... [[32mINSERT 4[0m in 0.09s]
19:49:42.240047 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
19:49:42.240478 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
19:49:42.240919 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
19:49:42.241627 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
19:49:42.241888 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
19:49:42.242123 [debug] [Thread-1  ]: finished collecting timing info
19:49:42.242332 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
19:49:42.253337 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
19:49:42.254198 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
19:49:42.254768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:49:42.285468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
19:49:42.286147 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
19:49:42.286592 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text,"created_at" timestamp without time zone)
  
19:49:42.301557 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
19:49:42.312970 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
19:49:42.313279 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
19:49:42.315452 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
19:49:42.316204 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
19:49:42.319625 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
19:49:42.320109 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
19:49:42.320453 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
19:49:42.323451 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:49:42.324575 [debug] [Thread-1  ]: finished collecting timing info
19:49:42.324913 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
19:49:42.326256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6683327-f51b-4b1c-88fd-3b273e270c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a8ca690>]}
19:49:42.326778 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mINSERT 5[0m in 0.08s]
19:49:42.327375 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
19:49:42.366424 [debug] [MainThread]: Acquiring new postgres connection "master"
19:49:42.366985 [debug] [MainThread]: Using postgres connection "master"
19:49:42.367477 [debug] [MainThread]: On master: BEGIN
19:49:42.367719 [debug] [MainThread]: Opening a new connection, currently in state closed
19:49:42.384632 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
19:49:42.385257 [debug] [MainThread]: On master: COMMIT
19:49:42.385746 [debug] [MainThread]: Using postgres connection "master"
19:49:42.386105 [debug] [MainThread]: On master: COMMIT
19:49:42.388318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:49:42.390037 [debug] [MainThread]: On master: Close
19:49:42.392283 [info ] [MainThread]: 
19:49:42.392942 [info ] [MainThread]: Finished running 3 seeds in 0.67s.
19:49:42.393649 [debug] [MainThread]: Connection 'master' was properly closed.
19:49:42.393909 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
19:49:42.400079 [info ] [MainThread]: 
19:49:42.400695 [info ] [MainThread]: [32mCompleted successfully[0m
19:49:42.401149 [info ] [MainThread]: 
19:49:42.401518 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
19:49:42.401966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a8ce590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7a87d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7aaa2d90>]}


============================== 2021-12-26 19:50:10.679535 | 10ce5592-be4a-42db-8106-959331fb4055 ==============================
19:50:10.679535 [info ] [MainThread]: Running with dbt=1.0.0
19:50:10.681052 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
19:50:10.681683 [debug] [MainThread]: Tracking: tracking
19:50:10.711341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeafbc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeafbcb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeafbc290>]}
19:50:10.748404 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
19:50:10.749208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '10ce5592-be4a-42db-8106-959331fb4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb198f90>]}
19:50:10.819570 [debug] [MainThread]: Parsing macros/catalog.sql
19:50:10.826655 [debug] [MainThread]: Parsing macros/relations.sql
19:50:10.828695 [debug] [MainThread]: Parsing macros/adapters.sql
19:50:10.860017 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:50:10.862469 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:50:10.868002 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:50:10.871599 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:50:10.874045 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:50:10.899157 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:50:10.915416 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:50:10.933032 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:50:10.939851 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:50:10.942620 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:50:10.945396 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:50:10.951949 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:50:10.968421 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:50:10.970716 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:50:10.985527 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:50:11.007984 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:50:11.018901 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:50:11.023255 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:50:11.033500 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:50:11.035478 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:50:11.039455 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:50:11.042857 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:50:11.051831 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:50:11.075244 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:50:11.077717 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:50:11.081325 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:50:11.083578 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:50:11.084876 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:50:11.086075 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:50:11.087197 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:50:11.089399 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:50:11.095867 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:50:11.107979 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:50:11.112477 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:50:11.119483 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:50:11.142117 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:50:11.146571 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:50:11.153461 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:50:11.164860 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:50:11.179575 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:50:11.449445 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:50:11.469252 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:50:11.586299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10ce5592-be4a-42db-8106-959331fb4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb2265d0>]}
19:50:11.594657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10ce5592-be4a-42db-8106-959331fb4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb24a710>]}
19:50:11.595482 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:50:11.597891 [info ] [MainThread]: 
19:50:11.598739 [debug] [MainThread]: Acquiring new postgres connection "master"
19:50:11.600675 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
19:50:11.632269 [debug] [ThreadPool]: Using postgres connection "list_dbt"
19:50:11.632649 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
19:50:11.632919 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:50:11.692809 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
19:50:11.696277 [debug] [ThreadPool]: On list_dbt: Close
19:50:11.701316 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:50:11.717063 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:50:11.717601 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:50:11.718028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:50:11.736216 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
19:50:11.737015 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:50:11.737588 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:50:11.743661 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
19:50:11.746721 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:50:11.749347 [debug] [ThreadPool]: On list_dbt_dev: Close
19:50:11.756403 [debug] [MainThread]: Using postgres connection "master"
19:50:11.757074 [debug] [MainThread]: On master: BEGIN
19:50:11.757596 [debug] [MainThread]: Opening a new connection, currently in state init
19:50:11.775178 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
19:50:11.775626 [debug] [MainThread]: Using postgres connection "master"
19:50:11.775901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:50:11.783949 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:50:11.786563 [debug] [MainThread]: On master: ROLLBACK
19:50:11.789555 [debug] [MainThread]: Using postgres connection "master"
19:50:11.789927 [debug] [MainThread]: On master: BEGIN
19:50:11.794152 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:50:11.794817 [debug] [MainThread]: On master: COMMIT
19:50:11.795362 [debug] [MainThread]: Using postgres connection "master"
19:50:11.795812 [debug] [MainThread]: On master: COMMIT
19:50:11.798025 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:50:11.798586 [debug] [MainThread]: On master: Close
19:50:11.799374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:50:11.800003 [info ] [MainThread]: 
19:50:11.806899 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
19:50:11.807512 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
19:50:11.808729 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
19:50:11.809292 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
19:50:11.809853 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
19:50:11.820634 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
19:50:11.823367 [debug] [Thread-1  ]: finished collecting timing info
19:50:11.825010 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
19:50:12.029040 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
19:50:12.030248 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:50:12.030547 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
19:50:12.030824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:50:12.047429 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
19:50:12.048114 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:50:12.048723 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND b.created_at <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND c.created_at <= '2021-12-24'
WHERE a.created_at <= '2021-12-24'
GROUP BY 1,2,3,4,5,6
  );
  
19:50:12.061249 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
19:50:12.076883 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
19:50:12.077199 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:50:12.077642 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
19:50:12.080493 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:50:12.081456 [debug] [Thread-1  ]: finished collecting timing info
19:50:12.081817 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
19:50:12.083064 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10ce5592-be4a-42db-8106-959331fb4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb2a8090>]}
19:50:12.084498 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 2[0m in 0.27s]
19:50:12.087811 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
19:50:12.121875 [debug] [MainThread]: Acquiring new postgres connection "master"
19:50:12.122661 [debug] [MainThread]: Using postgres connection "master"
19:50:12.123374 [debug] [MainThread]: On master: BEGIN
19:50:12.124067 [debug] [MainThread]: Opening a new connection, currently in state closed
19:50:12.174832 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
19:50:12.175716 [debug] [MainThread]: On master: COMMIT
19:50:12.176495 [debug] [MainThread]: Using postgres connection "master"
19:50:12.177327 [debug] [MainThread]: On master: COMMIT
19:50:12.182652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:50:12.183851 [debug] [MainThread]: On master: Close
19:50:12.185570 [info ] [MainThread]: 
19:50:12.187541 [info ] [MainThread]: Finished running 1 incremental model in 0.59s.
19:50:12.188729 [debug] [MainThread]: Connection 'master' was properly closed.
19:50:12.189647 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
19:50:12.207253 [info ] [MainThread]: 
19:50:12.208198 [info ] [MainThread]: [32mCompleted successfully[0m
19:50:12.209367 [info ] [MainThread]: 
19:50:12.210552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:50:12.211900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb2e1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb0e0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadeb0e01d0>]}


============================== 2021-12-26 19:53:09.285963 | dc978448-4d05-42af-8b7c-9cb3f2334a98 ==============================
19:53:09.285963 [info ] [MainThread]: Running with dbt=1.0.0
19:53:09.287758 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
19:53:09.288145 [debug] [MainThread]: Tracking: tracking
19:53:09.329571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa27febc2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa27febce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa27febca10>]}
19:53:09.394808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:53:09.395574 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
19:53:09.411801 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:53:09.432371 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:53:09.483462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc978448-4d05-42af-8b7c-9cb3f2334a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28012c950>]}
19:53:09.492001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc978448-4d05-42af-8b7c-9cb3f2334a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa280191e10>]}
19:53:09.492616 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:53:09.494166 [info ] [MainThread]: 
19:53:09.495041 [debug] [MainThread]: Acquiring new postgres connection "master"
19:53:09.497583 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
19:53:09.517398 [debug] [ThreadPool]: Using postgres connection "list_dbt"
19:53:09.517726 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
19:53:09.517949 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:53:09.575853 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
19:53:09.577846 [debug] [ThreadPool]: On list_dbt: Close
19:53:09.580627 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:53:09.594613 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:53:09.595024 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:53:09.595305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:53:09.608200 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:53:09.608763 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:53:09.609191 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:53:09.614471 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
19:53:09.616255 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:53:09.618546 [debug] [ThreadPool]: On list_dbt_dev: Close
19:53:09.629049 [debug] [MainThread]: Using postgres connection "master"
19:53:09.629409 [debug] [MainThread]: On master: BEGIN
19:53:09.629785 [debug] [MainThread]: Opening a new connection, currently in state init
19:53:09.640688 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:53:09.641724 [debug] [MainThread]: Using postgres connection "master"
19:53:09.642100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:53:09.649810 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:53:09.651992 [debug] [MainThread]: On master: ROLLBACK
19:53:09.653655 [debug] [MainThread]: Using postgres connection "master"
19:53:09.654022 [debug] [MainThread]: On master: BEGIN
19:53:09.657354 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:53:09.658203 [debug] [MainThread]: On master: COMMIT
19:53:09.658584 [debug] [MainThread]: Using postgres connection "master"
19:53:09.658848 [debug] [MainThread]: On master: COMMIT
19:53:09.660630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:09.661317 [debug] [MainThread]: On master: Close
19:53:09.662285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:53:09.664604 [info ] [MainThread]: 
19:53:09.671671 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
19:53:09.672147 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
19:53:09.673086 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
19:53:09.673455 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
19:53:09.673865 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
19:53:09.680141 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
19:53:09.682828 [debug] [Thread-1  ]: finished collecting timing info
19:53:09.684426 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
19:53:09.763516 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
19:53:09.764208 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:53:09.764457 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
19:53:09.764660 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:53:09.778453 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:53:09.778934 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:53:09.779283 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND TO_DATE(b.created_at) <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND TO_DATE(c.created_at) <= '2021-12-24'
WHERE TO_DATE(a.created_at) <= '2021-12-24'
GROUP BY 1,2,3,4,5,6
  );
  
19:53:09.783460 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function to_date(timestamp without time zone) does not exist
LINE 21:     AND TO_DATE(b.created_at) <= '2021-12-24'
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

19:53:09.783846 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
19:53:09.787596 [debug] [Thread-1  ]: finished collecting timing info
19:53:09.788049 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
19:53:09.788983 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  function to_date(timestamp without time zone) does not exist
  LINE 21:     AND TO_DATE(b.created_at) <= '2021-12-24'
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
19:53:09.789566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc978448-4d05-42af-8b7c-9cb3f2334a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa280128190>]}
19:53:09.790517 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.12s]
19:53:09.792152 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
19:53:09.874906 [debug] [MainThread]: Acquiring new postgres connection "master"
19:53:09.875727 [debug] [MainThread]: Using postgres connection "master"
19:53:09.876049 [debug] [MainThread]: On master: BEGIN
19:53:09.876341 [debug] [MainThread]: Opening a new connection, currently in state closed
19:53:09.891507 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
19:53:09.891897 [debug] [MainThread]: On master: COMMIT
19:53:09.892210 [debug] [MainThread]: Using postgres connection "master"
19:53:09.893095 [debug] [MainThread]: On master: COMMIT
19:53:09.895581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:53:09.896023 [debug] [MainThread]: On master: Close
19:53:09.897067 [info ] [MainThread]: 
19:53:09.898093 [info ] [MainThread]: Finished running 1 incremental model in 0.40s.
19:53:09.906294 [debug] [MainThread]: Connection 'master' was properly closed.
19:53:09.906862 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
19:53:09.918409 [info ] [MainThread]: 
19:53:09.919177 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:53:09.920508 [info ] [MainThread]: 
19:53:09.921877 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
19:53:09.922682 [error] [MainThread]:   function to_date(timestamp without time zone) does not exist
19:53:09.923746 [error] [MainThread]:   LINE 21:     AND TO_DATE(b.created_at) <= '2021-12-24'
19:53:09.924459 [error] [MainThread]:                    ^
19:53:09.925379 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
19:53:09.926173 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
19:53:09.928196 [info ] [MainThread]: 
19:53:09.929127 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
19:53:09.932552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2801e5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28010a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28010ab10>]}


============================== 2021-12-26 19:54:52.655871 | c3893d01-7956-46c8-a90b-c7cfb065ebe9 ==============================
19:54:52.655871 [info ] [MainThread]: Running with dbt=1.0.0
19:54:52.657670 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
19:54:52.658135 [debug] [MainThread]: Tracking: tracking
19:54:52.675959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd9671c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd9671a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd9671150>]}
19:54:52.752735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:54:52.753521 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
19:54:52.770617 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:54:52.792673 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:54:52.840045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3893d01-7956-46c8-a90b-c7cfb065ebe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd97e0650>]}
19:54:52.847237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3893d01-7956-46c8-a90b-c7cfb065ebe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd9950c50>]}
19:54:52.847721 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:54:52.849546 [info ] [MainThread]: 
19:54:52.850625 [debug] [MainThread]: Acquiring new postgres connection "master"
19:54:52.853867 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
19:54:52.880315 [debug] [ThreadPool]: Using postgres connection "list_dbt"
19:54:52.881176 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
19:54:52.881997 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:54:52.960591 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.08 seconds
19:54:52.963907 [debug] [ThreadPool]: On list_dbt: Close
19:54:52.967505 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:54:52.977629 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:54:52.977964 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:54:52.978202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:54:52.990566 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:54:52.991069 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:54:52.991483 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:54:52.997119 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
19:54:52.998898 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:54:53.001542 [debug] [ThreadPool]: On list_dbt_dev: Close
19:54:53.015726 [debug] [MainThread]: Using postgres connection "master"
19:54:53.016086 [debug] [MainThread]: On master: BEGIN
19:54:53.016354 [debug] [MainThread]: Opening a new connection, currently in state init
19:54:53.028070 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:53.028628 [debug] [MainThread]: Using postgres connection "master"
19:54:53.028985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:54:53.036796 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:54:53.038848 [debug] [MainThread]: On master: ROLLBACK
19:54:53.040437 [debug] [MainThread]: Using postgres connection "master"
19:54:53.040841 [debug] [MainThread]: On master: BEGIN
19:54:53.043671 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:54:53.044168 [debug] [MainThread]: On master: COMMIT
19:54:53.044527 [debug] [MainThread]: Using postgres connection "master"
19:54:53.044963 [debug] [MainThread]: On master: COMMIT
19:54:53.046784 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:53.047182 [debug] [MainThread]: On master: Close
19:54:53.047854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:54:53.048697 [info ] [MainThread]: 
19:54:53.053390 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
19:54:53.054301 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
19:54:53.055255 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
19:54:53.055667 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
19:54:53.056084 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
19:54:53.064124 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
19:54:53.065202 [debug] [Thread-1  ]: finished collecting timing info
19:54:53.065549 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
19:54:53.141115 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
19:54:53.142520 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:54:53.142938 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
19:54:53.143263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:54:53.157222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:54:53.158024 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:54:53.158377 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', (c.created_at) <= '2021-12-24'
WHERE DATE_TRUNC('day', (a.created_at) <= '2021-12-24'
GROUP BY 1,2,3,4,5,6
  );
  
19:54:53.163107 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 25: WHERE DATE_TRUNC('day', (a.created_at) <= '2021-12-24'
         ^

19:54:53.163586 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
19:54:53.167688 [debug] [Thread-1  ]: finished collecting timing info
19:54:53.168429 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
19:54:53.169507 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  syntax error at or near "WHERE"
  LINE 25: WHERE DATE_TRUNC('day', (a.created_at) <= '2021-12-24'
           ^
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
19:54:53.170401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3893d01-7956-46c8-a90b-c7cfb065ebe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd97dcf50>]}
19:54:53.171651 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.12s]
19:54:53.172644 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
19:54:53.258676 [debug] [MainThread]: Acquiring new postgres connection "master"
19:54:53.259375 [debug] [MainThread]: Using postgres connection "master"
19:54:53.259790 [debug] [MainThread]: On master: BEGIN
19:54:53.260172 [debug] [MainThread]: Opening a new connection, currently in state closed
19:54:53.274852 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:54:53.275409 [debug] [MainThread]: On master: COMMIT
19:54:53.275855 [debug] [MainThread]: Using postgres connection "master"
19:54:53.276285 [debug] [MainThread]: On master: COMMIT
19:54:53.278266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:54:53.278811 [debug] [MainThread]: On master: Close
19:54:53.279535 [info ] [MainThread]: 
19:54:53.280161 [info ] [MainThread]: Finished running 1 incremental model in 0.43s.
19:54:53.280643 [debug] [MainThread]: Connection 'master' was properly closed.
19:54:53.280896 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
19:54:53.289125 [info ] [MainThread]: 
19:54:53.289763 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:54:53.290477 [info ] [MainThread]: 
19:54:53.291101 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
19:54:53.291627 [error] [MainThread]:   syntax error at or near "WHERE"
19:54:53.292204 [error] [MainThread]:   LINE 25: WHERE DATE_TRUNC('day', (a.created_at) <= '2021-12-24'
19:54:53.292680 [error] [MainThread]:            ^
19:54:53.293170 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
19:54:53.293718 [info ] [MainThread]: 
19:54:53.294197 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
19:54:53.294798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd9297290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd97cc2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd97ccd10>]}


============================== 2021-12-26 19:55:17.447998 | 58047155-116e-4b47-a1b7-d7f6c002ec86 ==============================
19:55:17.447998 [info ] [MainThread]: Running with dbt=1.0.0
19:55:17.449513 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=True, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
19:55:17.450157 [debug] [MainThread]: Tracking: tracking
19:55:17.488054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc04ffdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc04ffd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc04ffd110>]}
19:55:17.551329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:55:17.552059 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
19:55:17.568014 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:55:17.589773 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:55:17.637030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58047155-116e-4b47-a1b7-d7f6c002ec86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc05168c90>]}
19:55:17.644891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58047155-116e-4b47-a1b7-d7f6c002ec86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc051d4550>]}
19:55:17.645411 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:55:17.648058 [info ] [MainThread]: 
19:55:17.649037 [debug] [MainThread]: Acquiring new postgres connection "master"
19:55:17.652295 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
19:55:17.679563 [debug] [ThreadPool]: Using postgres connection "list_dbt"
19:55:17.680418 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
19:55:17.680975 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:55:17.737555 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
19:55:17.741376 [debug] [ThreadPool]: On list_dbt: Close
19:55:17.744223 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:55:17.755705 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:55:17.756064 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:55:17.756279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:55:17.768950 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:55:17.770229 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:55:17.770580 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:55:17.777372 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
19:55:17.779036 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:55:17.780722 [debug] [ThreadPool]: On list_dbt_dev: Close
19:55:17.787597 [debug] [MainThread]: Using postgres connection "master"
19:55:17.787930 [debug] [MainThread]: On master: BEGIN
19:55:17.788181 [debug] [MainThread]: Opening a new connection, currently in state init
19:55:17.801238 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:55:17.801701 [debug] [MainThread]: Using postgres connection "master"
19:55:17.802150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:55:17.812326 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:55:17.814104 [debug] [MainThread]: On master: ROLLBACK
19:55:17.816308 [debug] [MainThread]: Using postgres connection "master"
19:55:17.816669 [debug] [MainThread]: On master: BEGIN
19:55:17.821309 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:55:17.821883 [debug] [MainThread]: On master: COMMIT
19:55:17.822178 [debug] [MainThread]: Using postgres connection "master"
19:55:17.822420 [debug] [MainThread]: On master: COMMIT
19:55:17.824713 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:17.825151 [debug] [MainThread]: On master: Close
19:55:17.825834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:55:17.826849 [info ] [MainThread]: 
19:55:17.830174 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
19:55:17.831070 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
19:55:17.832479 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
19:55:17.832919 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
19:55:17.833433 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
19:55:17.840975 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
19:55:17.846704 [debug] [Thread-1  ]: finished collecting timing info
19:55:17.847215 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
19:55:17.945384 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
19:55:17.946105 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:55:17.946419 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
19:55:17.946639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:55:17.967618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
19:55:17.968273 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:55:17.969037 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users__dbt_tmp"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-24') AS unique_key
  , '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-24'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-24'
GROUP BY 1,2,3,4,5,6
  );
  
19:55:17.981997 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
19:55:17.990699 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:55:17.991005 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users" rename to "agg_users__dbt_backup"
19:55:17.994507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:55:17.998573 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:55:17.998957 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
alter table "dbt"."dev"."agg_users__dbt_tmp" rename to "agg_users"
19:55:18.001635 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:55:18.016148 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
19:55:18.016483 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:55:18.016728 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
19:55:18.020571 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:55:18.026644 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:55:18.026972 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */
drop table if exists "dbt"."dev"."agg_users__dbt_backup" cascade
19:55:18.034065 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
19:55:18.036404 [debug] [Thread-1  ]: finished collecting timing info
19:55:18.036910 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
19:55:18.037942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58047155-116e-4b47-a1b7-d7f6c002ec86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc05175bd0>]}
19:55:18.038780 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 2[0m in 0.21s]
19:55:18.039351 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
19:55:18.143007 [debug] [MainThread]: Acquiring new postgres connection "master"
19:55:18.143584 [debug] [MainThread]: Using postgres connection "master"
19:55:18.143986 [debug] [MainThread]: On master: BEGIN
19:55:18.144360 [debug] [MainThread]: Opening a new connection, currently in state closed
19:55:18.160224 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
19:55:18.160763 [debug] [MainThread]: On master: COMMIT
19:55:18.161112 [debug] [MainThread]: Using postgres connection "master"
19:55:18.161459 [debug] [MainThread]: On master: COMMIT
19:55:18.163568 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:55:18.164322 [debug] [MainThread]: On master: Close
19:55:18.165512 [info ] [MainThread]: 
19:55:18.166361 [info ] [MainThread]: Finished running 1 incremental model in 0.52s.
19:55:18.166854 [debug] [MainThread]: Connection 'master' was properly closed.
19:55:18.167574 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
19:55:18.177571 [info ] [MainThread]: 
19:55:18.178680 [info ] [MainThread]: [32mCompleted successfully[0m
19:55:18.179223 [info ] [MainThread]: 
19:55:18.179914 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:55:18.180715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc051b38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc0518ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc0515f210>]}


============================== 2021-12-26 19:58:51.341654 | 832951ae-d6ac-47fa-a15b-7282915da78a ==============================
19:58:51.341654 [info ] [MainThread]: Running with dbt=1.0.0
19:58:51.343368 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['agg_users'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
19:58:51.344439 [debug] [MainThread]: Tracking: tracking
19:58:51.364730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8debcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8debc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8debc090>]}
19:58:51.403669 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
19:58:51.404253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '832951ae-d6ac-47fa-a15b-7282915da78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8e198f90>]}
19:58:51.459544 [debug] [MainThread]: Parsing macros/catalog.sql
19:58:51.464152 [debug] [MainThread]: Parsing macros/relations.sql
19:58:51.467802 [debug] [MainThread]: Parsing macros/adapters.sql
19:58:51.500725 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:58:51.503204 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:58:51.508776 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:58:51.512181 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:58:51.514545 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:58:51.539103 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:58:51.554947 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:58:51.571829 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:58:51.578235 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:58:51.580744 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:58:51.583266 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:58:51.589519 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:58:51.605170 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:58:51.607363 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:58:51.621892 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:58:51.643937 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:58:51.654598 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:58:51.658653 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:58:51.668649 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:58:51.670504 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:58:51.674321 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:58:51.677574 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:58:51.686546 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:58:51.709658 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:58:51.711826 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:58:51.715282 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:58:51.717506 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:58:51.718754 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:58:51.719555 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:58:51.720555 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:58:51.722659 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:58:51.728928 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:58:51.740616 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:58:51.743694 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:58:51.747495 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:58:51.760855 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:58:51.764957 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:58:51.771342 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:58:51.782142 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:58:51.796509 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:58:52.049742 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
19:58:52.068697 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
19:58:52.165651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '832951ae-d6ac-47fa-a15b-7282915da78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8e2272d0>]}
19:58:52.172775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '832951ae-d6ac-47fa-a15b-7282915da78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8e218850>]}
19:58:52.173242 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
19:58:52.174727 [info ] [MainThread]: 
19:58:52.175519 [debug] [MainThread]: Acquiring new postgres connection "master"
19:58:52.177017 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
19:58:52.196070 [debug] [ThreadPool]: Using postgres connection "list_dbt"
19:58:52.196382 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
19:58:52.196600 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:58:52.240956 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.04 seconds
19:58:52.244218 [debug] [ThreadPool]: On list_dbt: Close
19:58:52.247851 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
19:58:52.262188 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:58:52.262767 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
19:58:52.263193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:58:52.286962 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
19:58:52.287429 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
19:58:52.287874 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
19:58:52.293944 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
19:58:52.296336 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
19:58:52.298315 [debug] [ThreadPool]: On list_dbt_dev: Close
19:58:52.305410 [debug] [MainThread]: Using postgres connection "master"
19:58:52.305771 [debug] [MainThread]: On master: BEGIN
19:58:52.305980 [debug] [MainThread]: Opening a new connection, currently in state init
19:58:52.319661 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:58:52.320316 [debug] [MainThread]: Using postgres connection "master"
19:58:52.320763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:58:52.328645 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
19:58:52.330701 [debug] [MainThread]: On master: ROLLBACK
19:58:52.332499 [debug] [MainThread]: Using postgres connection "master"
19:58:52.332863 [debug] [MainThread]: On master: BEGIN
19:58:52.336202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:58:52.336731 [debug] [MainThread]: On master: COMMIT
19:58:52.337108 [debug] [MainThread]: Using postgres connection "master"
19:58:52.337424 [debug] [MainThread]: On master: COMMIT
19:58:52.339093 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:52.339586 [debug] [MainThread]: On master: Close
19:58:52.340421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:58:52.341065 [info ] [MainThread]: 
19:58:52.344832 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
19:58:52.345373 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
19:58:52.346187 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
19:58:52.346573 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
19:58:52.347069 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
19:58:52.355253 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
19:58:52.356020 [debug] [Thread-1  ]: finished collecting timing info
19:58:52.356366 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
19:58:52.493987 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:58:52.494393 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp115852421863"
  as (
    

SELECT
    CONCAT(a.user_id, ':', '2021-12-25') AS unique_key
  , '2021-12-25' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-25'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-25'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-25'
GROUP BY 1,2,3,4,5,6
  );
  
19:58:52.494732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:52.514092 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.02 seconds
19:58:52.523710 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:58:52.524036 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
19:58:52.526579 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
19:58:52.527034 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:58:52.527359 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp115852421863'
        
      order by ordinal_position

  
19:58:52.538702 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.01 seconds
19:58:52.545210 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:58:52.545541 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
19:58:52.550696 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
19:58:52.560539 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:58:52.560869 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
19:58:52.565520 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
19:58:52.576689 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
19:58:52.577367 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:58:52.577609 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (unique_key) in (
        select (unique_key)
        from "agg_users__dbt_tmp115852421863"
    );
    

    insert into "dbt"."dev"."agg_users" ("unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp115852421863"
    )
  
19:58:52.579967 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
19:58:52.589387 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
19:58:52.589871 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
19:58:52.590257 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
19:58:52.594421 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:58:52.595847 [debug] [Thread-1  ]: finished collecting timing info
19:58:52.596533 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
19:58:52.597719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '832951ae-d6ac-47fa-a15b-7282915da78a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8e2a8fd0>]}
19:58:52.598717 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 3[0m in 0.25s]
19:58:52.599853 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
19:58:52.681213 [debug] [MainThread]: Acquiring new postgres connection "master"
19:58:52.681815 [debug] [MainThread]: Using postgres connection "master"
19:58:52.682255 [debug] [MainThread]: On master: BEGIN
19:58:52.682677 [debug] [MainThread]: Opening a new connection, currently in state closed
19:58:52.700069 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
19:58:52.700654 [debug] [MainThread]: On master: COMMIT
19:58:52.701159 [debug] [MainThread]: Using postgres connection "master"
19:58:52.701673 [debug] [MainThread]: On master: COMMIT
19:58:52.704235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:52.704725 [debug] [MainThread]: On master: Close
19:58:52.705650 [info ] [MainThread]: 
19:58:52.706494 [info ] [MainThread]: Finished running 1 incremental model in 0.53s.
19:58:52.707270 [debug] [MainThread]: Connection 'master' was properly closed.
19:58:52.707504 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
19:58:52.716367 [info ] [MainThread]: 
19:58:52.716876 [info ] [MainThread]: [32mCompleted successfully[0m
19:58:52.717468 [info ] [MainThread]: 
19:58:52.718053 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:58:52.718955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8e0af450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8deee5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb8deee910>]}


============================== 2021-12-26 20:00:52.496614 | 5f5a5fa2-4d14-4bc4-b746-c53b7fb84af6 ==============================
20:00:52.496614 [info ] [MainThread]: Running with dbt=1.0.0
20:00:52.499112 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
20:00:52.499549 [debug] [MainThread]: Tracking: tracking
20:00:52.517597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce86711d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8671b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8671110>]}
20:00:52.553641 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
20:00:52.554426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f5a5fa2-4d14-4bc4-b746-c53b7fb84af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8957fd0>]}
20:00:52.619952 [debug] [MainThread]: Parsing macros/catalog.sql
20:00:52.627144 [debug] [MainThread]: Parsing macros/relations.sql
20:00:52.629236 [debug] [MainThread]: Parsing macros/adapters.sql
20:00:52.663544 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:00:52.666622 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:00:52.673371 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:00:52.677026 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:00:52.679817 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:00:52.705339 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:00:52.721825 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:00:52.739225 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:00:52.745934 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:00:52.748605 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:00:52.751384 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:00:52.758775 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:00:52.775506 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:00:52.777942 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:00:52.792988 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:00:52.815946 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:00:52.827022 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:00:52.831485 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:00:52.841877 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:00:52.843894 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:00:52.848022 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:00:52.851462 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:00:52.860516 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:00:52.885427 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:00:52.887988 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:00:52.891789 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:00:52.894274 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:00:52.895685 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:00:52.896572 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:00:52.897623 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:00:52.899820 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:00:52.906367 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:00:52.918438 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:00:52.921790 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:00:52.925865 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:00:52.939799 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:00:52.944192 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:00:52.950787 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:00:52.961599 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:00:52.976149 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:00:53.244178 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
20:00:53.263674 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
20:00:53.361670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f5a5fa2-4d14-4bc4-b746-c53b7fb84af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8863310>]}
20:00:53.368945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f5a5fa2-4d14-4bc4-b746-c53b7fb84af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce88d46d0>]}
20:00:53.369428 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
20:00:53.371518 [info ] [MainThread]: 
20:00:53.372812 [debug] [MainThread]: Acquiring new postgres connection "master"
20:00:53.374789 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
20:00:53.401955 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
20:00:53.402393 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
20:00:53.402698 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:00:53.501074 [debug] [ThreadPool]: SQL status: BEGIN in 0.1 seconds
20:00:53.501727 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
20:00:53.502477 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
20:00:53.509608 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:00:53.513205 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
20:00:53.515577 [debug] [ThreadPool]: On list_dbt_dev: Close
20:00:53.531331 [debug] [MainThread]: Using postgres connection "master"
20:00:53.532076 [debug] [MainThread]: On master: BEGIN
20:00:53.533052 [debug] [MainThread]: Opening a new connection, currently in state init
20:00:53.550403 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
20:00:53.551154 [debug] [MainThread]: Using postgres connection "master"
20:00:53.551549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:00:53.562693 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:00:53.565261 [debug] [MainThread]: On master: ROLLBACK
20:00:53.567226 [debug] [MainThread]: On master: Close
20:00:53.568680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:00:53.571373 [info ] [MainThread]: 
20:00:53.579882 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
20:00:53.580725 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
20:00:53.581197 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
20:00:53.582348 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.payments
20:00:53.587255 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.payments"
20:00:53.587937 [debug] [Thread-1  ]: finished collecting timing info
20:00:53.588248 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
20:00:53.588613 [debug] [Thread-1  ]: finished collecting timing info
20:00:53.590953 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
20:00:53.591725 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
20:00:53.592809 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
20:00:53.593115 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
20:00:53.593335 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.sessions
20:00:53.596174 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.sessions"
20:00:53.596912 [debug] [Thread-1  ]: finished collecting timing info
20:00:53.597716 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
20:00:53.598572 [debug] [Thread-1  ]: finished collecting timing info
20:00:53.599839 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
20:00:53.601464 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
20:00:53.603084 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
20:00:53.603568 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
20:00:53.603822 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
20:00:53.606193 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
20:00:53.606677 [debug] [Thread-1  ]: finished collecting timing info
20:00:53.606922 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
20:00:53.607145 [debug] [Thread-1  ]: finished collecting timing info
20:00:53.607596 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
20:00:53.608092 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
20:00:53.608515 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
20:00:53.608740 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
20:00:53.608955 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
20:00:53.620197 [debug] [Thread-1  ]: finished collecting timing info
20:00:53.626876 [debug] [Thread-1  ]: Compilation Error in model agg_users (models/example/agg_users.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users = {}
  
  > in model agg_users (models/example/agg_users.sql)
  > called by model agg_users (models/example/agg_users.sql)
20:00:53.628651 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
20:00:53.630071 [debug] [MainThread]: Connection 'master' was properly closed.
20:00:53.630576 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
20:00:53.631135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8aaf190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8aaf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8aafd50>]}


============================== 2021-12-26 20:01:25.042569 | e1b46e7b-d810-495c-838f-04c060811b75 ==============================
20:01:25.042569 [info ] [MainThread]: Running with dbt=1.0.0
20:01:25.043886 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds": "2021-12-25"}', version_check=None, warn_error=None, which='generate', write_json=None)
20:01:25.044721 [debug] [MainThread]: Tracking: tracking
20:01:25.067747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbbebed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc119a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbbebead0>]}
20:01:25.110296 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
20:01:25.110969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1b46e7b-d810-495c-838f-04c060811b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc1d7fd0>]}
20:01:25.167127 [debug] [MainThread]: Parsing macros/catalog.sql
20:01:25.172557 [debug] [MainThread]: Parsing macros/relations.sql
20:01:25.174522 [debug] [MainThread]: Parsing macros/adapters.sql
20:01:25.205554 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:01:25.207944 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:01:25.213347 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:01:25.216633 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:01:25.218940 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:01:25.245229 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:01:25.262736 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:01:25.281762 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:01:25.289148 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:01:25.292052 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:01:25.294882 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:01:25.302593 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:01:25.319576 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:01:25.321923 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:01:25.339582 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:01:25.366203 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:01:25.377041 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:01:25.381334 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:01:25.392292 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:01:25.394953 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:01:25.399916 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:01:25.404276 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:01:25.414929 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:01:25.440279 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:01:25.442986 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:01:25.447288 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:01:25.450171 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:01:25.451706 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:01:25.452676 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:01:25.453976 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:01:25.456227 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:01:25.462890 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:01:25.475121 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:01:25.478432 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:01:25.482723 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:01:25.496984 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:01:25.501168 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:01:25.507799 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:01:25.519665 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:01:25.534863 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:01:25.937406 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
20:01:26.004670 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
20:01:26.147554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1b46e7b-d810-495c-838f-04c060811b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc201910>]}
20:01:26.156173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1b46e7b-d810-495c-838f-04c060811b75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc258f10>]}
20:01:26.156631 [info ] [MainThread]: Found 1 model, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
20:01:26.158432 [info ] [MainThread]: 
20:01:26.159155 [debug] [MainThread]: Acquiring new postgres connection "master"
20:01:26.160930 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
20:01:26.181534 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
20:01:26.183859 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
20:01:26.185600 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:01:26.255240 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
20:01:26.255907 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
20:01:26.256502 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
20:01:26.262035 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:01:26.265115 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
20:01:26.267801 [debug] [ThreadPool]: On list_dbt_dev: Close
20:01:26.281407 [debug] [MainThread]: Using postgres connection "master"
20:01:26.282035 [debug] [MainThread]: On master: BEGIN
20:01:26.282570 [debug] [MainThread]: Opening a new connection, currently in state init
20:01:26.297170 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:01:26.298535 [debug] [MainThread]: Using postgres connection "master"
20:01:26.298871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:01:26.306741 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
20:01:26.308663 [debug] [MainThread]: On master: ROLLBACK
20:01:26.310330 [debug] [MainThread]: On master: Close
20:01:26.311198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
20:01:26.312060 [info ] [MainThread]: 
20:01:26.322614 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
20:01:26.323374 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
20:01:26.323707 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
20:01:26.324245 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.payments
20:01:26.326654 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.payments"
20:01:26.327042 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.327342 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
20:01:26.327622 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.328185 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
20:01:26.328495 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
20:01:26.329024 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
20:01:26.329278 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
20:01:26.329510 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.sessions
20:01:26.331402 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.sessions"
20:01:26.331822 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.332483 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
20:01:26.332814 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.333382 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
20:01:26.333720 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
20:01:26.334628 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
20:01:26.334931 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
20:01:26.335270 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
20:01:26.337496 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
20:01:26.338144 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.339663 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
20:01:26.341935 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.342844 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
20:01:26.343972 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
20:01:26.344555 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
20:01:26.344822 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
20:01:26.345067 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
20:01:26.352974 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
20:01:26.353910 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.354282 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
20:01:26.354542 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.355153 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
20:01:26.356355 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
20:01:26.357645 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
20:01:26.358181 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
20:01:26.358489 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
20:01:26.417632 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
20:01:26.418750 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.419039 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
20:01:26.419272 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.419743 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
20:01:26.420010 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
20:01:26.420483 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
20:01:26.420724 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
20:01:26.420943 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
20:01:26.424890 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d"
20:01:26.425582 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.425886 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
20:01:26.426125 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.426569 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_unique_key.40ac88a67d
20:01:26.426832 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
20:01:26.427287 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
20:01:26.427518 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
20:01:26.427736 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
20:01:26.432416 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
20:01:26.433232 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.433745 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
20:01:26.434216 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.435070 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
20:01:26.435434 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
20:01:26.435864 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
20:01:26.436102 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
20:01:26.436327 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
20:01:26.445422 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b"
20:01:26.446117 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.446395 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
20:01:26.446626 [debug] [Thread-1  ]: finished collecting timing info
20:01:26.447074 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b
20:01:26.526218 [debug] [MainThread]: Connection 'master' was properly closed.
20:01:26.526560 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_agg_users_unique_key.0e490c4d9b' was properly closed.
20:01:26.533287 [info ] [MainThread]: Done.
20:01:26.541170 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
20:01:26.541683 [info ] [MainThread]: Building catalog
20:01:26.547811 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
20:01:26.567510 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
20:01:26.567845 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
20:01:26.568063 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:01:26.594995 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
20:01:26.595634 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
20:01:26.596041 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
20:01:26.610638 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.01 seconds
20:01:26.621530 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
20:01:26.623597 [debug] [ThreadPool]: On dbt.information_schema: Close
20:01:26.635657 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dbt-airflow/bungie_dwh/target/catalog.json
20:01:26.636293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc121850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc118e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfbc118d10>]}
20:01:27.013111 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:01:27.013453 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-26 20:01:36.761385 | 1b8bdfb3-9995-408a-a71a-a5c4c49d901f ==============================
20:01:36.761385 [info ] [MainThread]: Running with dbt=1.0.0
20:01:36.762435 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
20:01:36.762863 [debug] [MainThread]: Tracking: tracking
20:01:36.789903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918debc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918debc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918debc3d0>]}
20:01:36.804126 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:01:36.805962 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:01:36.806969 [info ] [MainThread]: 
20:01:36.807763 [info ] [MainThread]: 
20:01:36.809933 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-26 22:36:24.774761 | d4d3dd40-868d-4d12-92c6-9776ffe2be06 ==============================
22:36:24.774761 [info ] [MainThread]: Running with dbt=1.0.0
22:36:24.776575 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.debug.DebugTask'>, config_dir=False, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='debug', write_json=None)
22:36:24.777524 [debug] [MainThread]: Tracking: tracking
22:36:24.793538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c75c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c75c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c75cb50>]}
22:36:24.924102 [debug] [MainThread]: Executing "git --help"
22:36:24.991650 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:36:24.992571 [debug] [MainThread]: STDERR: "b''"
22:36:25.000404 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:36:25.005685 [debug] [MainThread]: Using postgres connection "debug"
22:36:25.006242 [debug] [MainThread]: On debug: select 1 as id
22:36:25.006837 [debug] [MainThread]: Opening a new connection, currently in state init
22:36:25.083898 [debug] [MainThread]: SQL status: SELECT 1 in 0.08 seconds
22:36:25.088770 [debug] [MainThread]: On debug: Close
22:36:25.090051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c8708d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72bb24290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c776590>]}
22:36:25.586128 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2021-12-26 22:36:31.898117 | 1356d8ca-2678-424b-8f00-e82a47ccd400 ==============================
22:36:31.898117 [info ] [MainThread]: Running with dbt=1.0.0
22:36:31.899300 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, parse_only=False, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='compile', write_json=None)
22:36:31.899753 [debug] [MainThread]: Tracking: tracking
22:36:31.921951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1eebcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1eebce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1eebc290>]}
22:36:31.955730 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:36:31.956388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1356d8ca-2678-424b-8f00-e82a47ccd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1f096fd0>]}
22:36:32.012162 [debug] [MainThread]: Parsing macros/catalog.sql
22:36:32.018935 [debug] [MainThread]: Parsing macros/relations.sql
22:36:32.021410 [debug] [MainThread]: Parsing macros/adapters.sql
22:36:32.053930 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:36:32.056333 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:36:32.061887 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:36:32.065280 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:36:32.067626 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:36:32.092043 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:36:32.107783 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:36:32.124752 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:36:32.131177 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:36:32.133711 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:36:32.136278 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:36:32.142540 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:36:32.158832 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:36:32.161081 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:36:32.176108 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:36:32.198270 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:36:32.209251 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:36:32.213476 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:36:32.223638 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:36:32.225577 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:36:32.229433 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:36:32.232757 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:36:32.241498 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:36:32.264807 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:36:32.267025 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:36:32.270630 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:36:32.272889 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:36:32.274157 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:36:32.274996 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:36:32.276017 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:36:32.278156 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:36:32.284353 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:36:32.295932 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:36:32.298981 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:36:32.302756 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:36:32.316444 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:36:32.320588 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:36:32.326803 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:36:32.337021 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:36:32.350751 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:36:32.603816 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:36:32.622455 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:36:32.624186 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
22:36:32.628401 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
22:36:32.693246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1f14ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1f17b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1f17b890>]}


============================== 2021-12-26 22:36:58.909553 | 6f47963f-8658-49c9-a9df-76ab0d732c28 ==============================
22:36:58.909553 [info ] [MainThread]: Running with dbt=1.0.0
22:36:58.911245 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, parse_only=False, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='compile', write_json=None)
22:36:58.918272 [debug] [MainThread]: Tracking: tracking
22:36:58.943838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6cfbc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6cfbcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6cfbc510>]}
22:36:58.981375 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:36:58.982000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f47963f-8658-49c9-a9df-76ab0d732c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6d197fd0>]}
22:36:59.038774 [debug] [MainThread]: Parsing macros/catalog.sql
22:36:59.043692 [debug] [MainThread]: Parsing macros/relations.sql
22:36:59.045644 [debug] [MainThread]: Parsing macros/adapters.sql
22:36:59.076889 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:36:59.079303 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:36:59.084747 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:36:59.088031 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:36:59.090383 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:36:59.114477 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:36:59.131016 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:36:59.147920 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:36:59.154307 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:36:59.156853 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:36:59.159428 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:36:59.165684 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:36:59.181723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:36:59.183968 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:36:59.198829 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:36:59.221284 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:36:59.232272 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:36:59.236486 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:36:59.246592 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:36:59.248556 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:36:59.252352 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:36:59.255656 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:36:59.264339 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:36:59.287246 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:36:59.289619 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:36:59.293153 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:36:59.295413 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:36:59.296673 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:36:59.297488 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:36:59.298504 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:36:59.300634 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:36:59.306817 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:36:59.318461 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:36:59.321571 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:36:59.325416 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:36:59.339118 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:36:59.343242 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:36:59.349459 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:36:59.359887 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:36:59.373905 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:36:59.624762 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:36:59.644291 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:36:59.645886 [debug] [MainThread]: 1603: static parser failed on example/agg_users.sql
22:36:59.650000 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/agg_users.sql
22:36:59.748192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f47963f-8658-49c9-a9df-76ab0d732c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6d21e190>]}
22:36:59.756087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f47963f-8658-49c9-a9df-76ab0d732c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6d229210>]}
22:36:59.756634 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:36:59.759140 [info ] [MainThread]: 
22:36:59.760481 [debug] [MainThread]: Acquiring new postgres connection "master"
22:36:59.762456 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:36:59.786887 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:36:59.787627 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:36:59.788455 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:36:59.869867 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
22:36:59.870276 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:36:59.870597 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:36:59.877830 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:36:59.880643 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:36:59.882562 [debug] [ThreadPool]: On list_dbt_dev: Close
22:36:59.890220 [debug] [MainThread]: Using postgres connection "master"
22:36:59.890817 [debug] [MainThread]: On master: BEGIN
22:36:59.891103 [debug] [MainThread]: Opening a new connection, currently in state init
22:36:59.905631 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:36:59.906324 [debug] [MainThread]: Using postgres connection "master"
22:36:59.906864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:36:59.915989 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:36:59.917799 [debug] [MainThread]: On master: ROLLBACK
22:36:59.920119 [debug] [MainThread]: On master: Close
22:36:59.920882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:36:59.921457 [info ] [MainThread]: 
22:36:59.927490 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:36:59.928929 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
22:36:59.929609 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
22:36:59.929983 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
22:36:59.940689 [debug] [Thread-1  ]: finished collecting timing info
22:36:59.941391 [debug] [Thread-1  ]: Compilation Error in model agg_users (models/example/agg_users.sql)
  Required var 'agg_users_stage' not found in config:
  Vars supplied to agg_users = {}
  
  > in model agg_users (models/example/agg_users.sql)
  > called by model agg_users (models/example/agg_users.sql)
22:36:59.941871 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:36:59.942201 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
22:36:59.942833 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
22:36:59.943202 [debug] [MainThread]: Connection 'master' was properly closed.
22:36:59.943594 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
22:36:59.944701 [debug] [MainThread]: Connection 'seed.bungie_dwh.payments' was properly closed.
22:36:59.945248 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.payments
22:36:59.945879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6d24e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6d219990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6d209d50>]}
22:36:59.948012 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.payments"
22:36:59.950457 [debug] [Thread-1  ]: finished collecting timing info
22:36:59.950847 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
22:36:59.951212 [debug] [Thread-1  ]: finished collecting timing info
22:36:59.952148 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
22:36:59.952727 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
22:36:59.953566 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
22:36:59.954945 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
22:36:59.955531 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.sessions
22:37:00.005078 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.sessions"
22:37:00.005489 [debug] [Thread-1  ]: finished collecting timing info
22:37:00.005797 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
22:37:00.006456 [debug] [Thread-1  ]: finished collecting timing info
22:37:00.007368 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
22:37:00.008085 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
22:37:00.008812 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
22:37:00.009116 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
22:37:00.009360 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
22:37:00.011329 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
22:37:00.012647 [debug] [Thread-1  ]: finished collecting timing info
22:37:00.013050 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
22:37:00.013852 [debug] [Thread-1  ]: finished collecting timing info
22:37:00.014879 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
22:37:00.386722 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.


============================== 2021-12-26 22:37:58.216968 | b1a92d9b-9695-4a33-846c-5db85de79899 ==============================
22:37:58.216968 [info ] [MainThread]: Running with dbt=1.0.0
22:37:58.218239 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, parse_only=False, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='compile', write_json=None)
22:37:58.219773 [debug] [MainThread]: Tracking: tracking
22:37:58.245877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8677d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc854b9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc86535350>]}
22:37:58.316623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:37:58.317389 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
22:37:58.335483 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:37:58.395316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1a92d9b-9695-4a33-846c-5db85de79899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8691fd10>]}
22:37:58.402832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1a92d9b-9695-4a33-846c-5db85de79899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc86959310>]}
22:37:58.403322 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:37:58.405047 [info ] [MainThread]: 
22:37:58.406087 [debug] [MainThread]: Acquiring new postgres connection "master"
22:37:58.408449 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:37:58.430133 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:37:58.430545 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:37:58.430820 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:37:58.508666 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
22:37:58.509518 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:37:58.510126 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:37:58.517722 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:37:58.521600 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:37:58.524270 [debug] [ThreadPool]: On list_dbt_dev: Close
22:37:58.535684 [debug] [MainThread]: Using postgres connection "master"
22:37:58.536046 [debug] [MainThread]: On master: BEGIN
22:37:58.536408 [debug] [MainThread]: Opening a new connection, currently in state init
22:37:58.552915 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:37:58.553695 [debug] [MainThread]: Using postgres connection "master"
22:37:58.554033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:37:58.561858 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:37:58.563537 [debug] [MainThread]: On master: ROLLBACK
22:37:58.565769 [debug] [MainThread]: On master: Close
22:37:58.566761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:37:58.567674 [info ] [MainThread]: 
22:37:58.576477 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
22:37:58.577188 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
22:37:58.577631 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
22:37:58.577949 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.payments
22:37:58.580440 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.payments"
22:37:58.581032 [debug] [Thread-1  ]: finished collecting timing info
22:37:58.581415 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
22:37:58.582023 [debug] [Thread-1  ]: finished collecting timing info
22:37:58.582710 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
22:37:58.583058 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
22:37:58.583641 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
22:37:58.584016 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
22:37:58.585617 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.sessions
22:37:58.591151 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.sessions"
22:37:58.591532 [debug] [Thread-1  ]: finished collecting timing info
22:37:58.591808 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
22:37:58.592075 [debug] [Thread-1  ]: finished collecting timing info
22:37:58.592618 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
22:37:58.592963 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
22:37:58.593550 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
22:37:58.593832 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
22:37:58.594101 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
22:37:58.597727 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
22:37:58.598073 [debug] [Thread-1  ]: finished collecting timing info
22:37:58.598311 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
22:37:58.598532 [debug] [Thread-1  ]: finished collecting timing info
22:37:58.598972 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
22:37:58.599468 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:37:58.599877 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:37:58.600107 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:37:58.600327 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:37:58.608127 [debug] [Thread-1  ]: finished collecting timing info
22:37:58.608823 [debug] [Thread-1  ]: Compilation Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {}
  
  > in model agg_users_stage (models/staging/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/agg_users_stage.sql)
22:37:58.609408 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:37:58.610914 [debug] [MainThread]: Connection 'master' was properly closed.
22:37:58.611462 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
22:37:58.612410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc868e7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc86959c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc868d3a90>]}


============================== 2021-12-26 22:38:58.993423 | 55068625-b966-4a8d-86a8-ac3ccb99a13e ==============================
22:38:58.993423 [info ] [MainThread]: Running with dbt=1.0.0
22:38:58.994670 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, parse_only=False, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-24"}', version_check=None, warn_error=None, which='compile', write_json=None)
22:38:58.995074 [debug] [MainThread]: Tracking: tracking
22:38:59.015234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44977c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44977cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44977c050>]}
22:38:59.048171 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:38:59.049362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55068625-b966-4a8d-86a8-ac3ccb99a13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff44995ffd0>]}
22:38:59.082307 [debug] [MainThread]: Parsing macros/catalog.sql
22:38:59.093137 [debug] [MainThread]: Parsing macros/relations.sql
22:38:59.098028 [debug] [MainThread]: Parsing macros/adapters.sql
22:38:59.133298 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:38:59.135804 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:38:59.141264 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:38:59.144585 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:38:59.147030 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:38:59.171457 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:38:59.187329 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:38:59.204098 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:38:59.210484 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:38:59.213321 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:38:59.216020 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:38:59.222347 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:38:59.239024 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:38:59.241674 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:38:59.257611 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:38:59.279715 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:38:59.290350 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:38:59.294500 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:38:59.304599 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:38:59.306612 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:38:59.310576 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:38:59.314008 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:38:59.322903 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:38:59.346097 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:38:59.348258 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:38:59.351712 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:38:59.353945 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:38:59.355208 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:38:59.356026 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:38:59.357043 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:38:59.359166 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:38:59.365405 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:38:59.377187 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:38:59.380401 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:38:59.384270 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:38:59.398199 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:38:59.402477 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:38:59.408804 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:38:59.419367 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:38:59.433367 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:38:59.682096 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:38:59.704597 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:38:59.706486 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:38:59.806199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55068625-b966-4a8d-86a8-ac3ccb99a13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449a27210>]}
22:38:59.813184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55068625-b966-4a8d-86a8-ac3ccb99a13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4499ff410>]}
22:38:59.813646 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:38:59.815501 [info ] [MainThread]: 
22:38:59.816498 [debug] [MainThread]: Acquiring new postgres connection "master"
22:38:59.818409 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:38:59.840130 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:38:59.841747 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:38:59.842659 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:38:59.891432 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
22:38:59.891911 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:38:59.892198 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:38:59.905409 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:38:59.908156 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:38:59.911631 [debug] [ThreadPool]: On list_dbt_dev: Close
22:38:59.922186 [debug] [MainThread]: Using postgres connection "master"
22:38:59.922551 [debug] [MainThread]: On master: BEGIN
22:38:59.922814 [debug] [MainThread]: Opening a new connection, currently in state init
22:38:59.938391 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:38:59.939063 [debug] [MainThread]: Using postgres connection "master"
22:38:59.939400 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:38:59.948433 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:38:59.949964 [debug] [MainThread]: On master: ROLLBACK
22:38:59.951884 [debug] [MainThread]: On master: Close
22:38:59.952731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:38:59.953331 [info ] [MainThread]: 
22:38:59.957352 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
22:38:59.958831 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
22:38:59.959564 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
22:38:59.960230 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.payments
22:38:59.963341 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.payments"
22:38:59.963769 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.964070 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
22:38:59.964387 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.965362 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
22:38:59.966074 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
22:38:59.966798 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
22:38:59.967064 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
22:38:59.967595 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.sessions
22:38:59.970789 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.sessions"
22:38:59.971949 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.973485 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
22:38:59.974677 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.975609 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
22:38:59.976297 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
22:38:59.977521 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
22:38:59.978049 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
22:38:59.978590 [debug] [Thread-1  ]: Compiling seed.bungie_dwh.users
22:38:59.983018 [debug] [Thread-1  ]: Writing injected SQL for node "seed.bungie_dwh.users"
22:38:59.983554 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.983876 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
22:38:59.984152 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.984698 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
22:38:59.985265 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:38:59.985745 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:38:59.985983 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:38:59.986207 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:38:59.992406 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
22:38:59.993192 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.993473 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
22:38:59.993766 [debug] [Thread-1  ]: finished collecting timing info
22:38:59.994617 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:38:59.996890 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:38:59.998114 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
22:38:59.998445 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
22:38:59.998716 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
22:39:00.002034 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
22:39:00.003322 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.003877 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
22:39:00.004290 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.005054 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:39:00.005398 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
22:39:00.005967 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
22:39:00.006345 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
22:39:00.006606 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
22:39:00.062611 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
22:39:00.063427 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.063719 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
22:39:00.063988 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.064516 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
22:39:00.064818 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
22:39:00.065353 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
22:39:00.065622 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
22:39:00.065894 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
22:39:00.071120 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
22:39:00.071918 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.072235 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
22:39:00.072507 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.073023 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
22:39:00.073327 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
22:39:00.073857 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
22:39:00.074100 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
22:39:00.074555 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
22:39:00.078960 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393"
22:39:00.079816 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.080104 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
22:39:00.080338 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.080791 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_dt.4fcdbb6393
22:39:00.081079 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
22:39:00.081580 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
22:39:00.081817 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
22:39:00.082033 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
22:39:00.086804 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_user_id.9c24a32429"
22:39:00.087974 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.088275 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
22:39:00.088513 [debug] [Thread-1  ]: finished collecting timing info
22:39:00.088975 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_user_id.9c24a32429
22:39:00.168023 [debug] [MainThread]: Connection 'master' was properly closed.
22:39:00.168628 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_user_id.9c24a32429' was properly closed.
22:39:00.176510 [info ] [MainThread]: Done.
22:39:00.177107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449a43450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449a43610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff449a43990>]}


============================== 2021-12-26 22:47:46.732564 | 71fc116b-7246-4b41-8a18-730a74060d6f ==============================
22:47:46.732564 [info ] [MainThread]: Running with dbt=1.0.0
22:47:46.734471 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
22:47:46.734862 [debug] [MainThread]: Tracking: tracking
22:47:46.755743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8ceade50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8cead650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8cead110>]}
22:47:46.829836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:47:46.830625 [debug] [MainThread]: Partial parsing: update schema file: bungie_dwh://models/example/schema.yml
22:47:46.846446 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:47:46.886306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71fc116b-7246-4b41-8a18-730a74060d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8d13fd90>]}
22:47:46.893632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71fc116b-7246-4b41-8a18-730a74060d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8d19abd0>]}
22:47:46.894118 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:47:46.895726 [info ] [MainThread]: 
22:47:46.896515 [debug] [MainThread]: Acquiring new postgres connection "master"
22:47:46.898236 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
22:47:46.916089 [debug] [ThreadPool]: Using postgres connection "list_dbt"
22:47:46.916478 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
22:47:46.916752 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:47:46.975403 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
22:47:46.979664 [debug] [ThreadPool]: On list_dbt: Close
22:47:46.983433 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:47:46.996968 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:47:46.997345 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:47:46.997626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:47:47.011593 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:47:47.012102 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:47:47.012456 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:47:47.020109 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:47:47.023671 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:47:47.025877 [debug] [ThreadPool]: On list_dbt_dev: Close
22:47:47.034217 [debug] [MainThread]: Using postgres connection "master"
22:47:47.034602 [debug] [MainThread]: On master: BEGIN
22:47:47.034874 [debug] [MainThread]: Opening a new connection, currently in state init
22:47:47.047760 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:47:47.048442 [debug] [MainThread]: Using postgres connection "master"
22:47:47.048843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:47:47.057668 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:47:47.059564 [debug] [MainThread]: On master: ROLLBACK
22:47:47.061637 [debug] [MainThread]: Using postgres connection "master"
22:47:47.062001 [debug] [MainThread]: On master: BEGIN
22:47:47.066219 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:47:47.066760 [debug] [MainThread]: On master: COMMIT
22:47:47.067147 [debug] [MainThread]: Using postgres connection "master"
22:47:47.067522 [debug] [MainThread]: On master: COMMIT
22:47:47.069925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:47:47.070334 [debug] [MainThread]: On master: Close
22:47:47.070990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:47:47.071887 [info ] [MainThread]: 
22:47:47.077273 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:47:47.078001 [info ] [Thread-1  ]: 1 of 2 START table model dev.agg_users_stage.................................... [RUN]
22:47:47.079070 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:47:47.079732 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:47:47.080162 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:47:47.094119 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
22:47:47.095020 [debug] [Thread-1  ]: finished collecting timing info
22:47:47.095330 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
22:47:47.146043 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
22:47:47.148137 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:47:47.148502 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
22:47:47.148773 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:47:47.163648 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:47:47.164421 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:47:47.164858 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-24'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-24'
GROUP BY 1,2,3,4,5,6
  );
22:47:47.171775 [debug] [Thread-1  ]: Postgres adapter: Postgres error: aggregate functions are not allowed in GROUP BY
LINE 14:   , COUNT(b.*) AS session_count
             ^

22:47:47.172512 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: ROLLBACK
22:47:47.176265 [debug] [Thread-1  ]: finished collecting timing info
22:47:47.176709 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
22:47:47.177488 [debug] [Thread-1  ]: Database Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 14:   , COUNT(b.*) AS session_count
               ^
  compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
22:47:47.178059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fc116b-7246-4b41-8a18-730a74060d6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8d168210>]}
22:47:47.178917 [error] [Thread-1  ]: 1 of 2 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.10s]
22:47:47.180350 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:47:47.183592 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:47:47.184539 [info ] [Thread-1  ]: 2 of 2 SKIP relation dev.agg_users.............................................. [[33mSKIP[0m]
22:47:47.186172 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:47:47.287491 [debug] [MainThread]: Acquiring new postgres connection "master"
22:47:47.288112 [debug] [MainThread]: Using postgres connection "master"
22:47:47.288518 [debug] [MainThread]: On master: BEGIN
22:47:47.288896 [debug] [MainThread]: Opening a new connection, currently in state closed
22:47:47.303384 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:47:47.304212 [debug] [MainThread]: On master: COMMIT
22:47:47.304612 [debug] [MainThread]: Using postgres connection "master"
22:47:47.304959 [debug] [MainThread]: On master: COMMIT
22:47:47.307475 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:47:47.307909 [debug] [MainThread]: On master: Close
22:47:47.308668 [info ] [MainThread]: 
22:47:47.309286 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0.41s.
22:47:47.309874 [debug] [MainThread]: Connection 'master' was properly closed.
22:47:47.310147 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
22:47:47.321156 [info ] [MainThread]: 
22:47:47.321934 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:47:47.322587 [info ] [MainThread]: 
22:47:47.323092 [error] [MainThread]: [33mDatabase Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
22:47:47.323649 [error] [MainThread]:   aggregate functions are not allowed in GROUP BY
22:47:47.324434 [error] [MainThread]:   LINE 14:   , COUNT(b.*) AS session_count
22:47:47.324916 [error] [MainThread]:                ^
22:47:47.325566 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
22:47:47.326158 [info ] [MainThread]: 
22:47:47.328586 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
22:47:47.332097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8d1681d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8d127650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffc8d137fd0>]}


============================== 2021-12-26 22:48:20.478858 | 0a5c2a75-a908-4621-820e-4d06c4ff2972 ==============================
22:48:20.478858 [info ] [MainThread]: Running with dbt=1.0.0
22:48:20.480641 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
22:48:20.481678 [debug] [MainThread]: Tracking: tracking
22:48:20.513852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9ffc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9ffc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9ffc1d0>]}
22:48:20.585578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:48:20.586325 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/staging/agg_users_stage.sql
22:48:20.602568 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:48:20.623228 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:48:20.668044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a5c2a75-a908-4621-820e-4d06c4ff2972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea190550>]}
22:48:20.675043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a5c2a75-a908-4621-820e-4d06c4ff2972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea1d09d0>]}
22:48:20.675525 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:48:20.677363 [info ] [MainThread]: 
22:48:20.678291 [debug] [MainThread]: Acquiring new postgres connection "master"
22:48:20.679990 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
22:48:20.705243 [debug] [ThreadPool]: Using postgres connection "list_dbt"
22:48:20.705997 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
22:48:20.706291 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:48:20.757545 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
22:48:20.761319 [debug] [ThreadPool]: On list_dbt: Close
22:48:20.764382 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:48:20.779304 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:48:20.779647 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:48:20.779892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:48:20.794544 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:48:20.795900 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:48:20.796401 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:48:20.802780 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:48:20.804776 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:48:20.806795 [debug] [ThreadPool]: On list_dbt_dev: Close
22:48:20.814282 [debug] [MainThread]: Using postgres connection "master"
22:48:20.814688 [debug] [MainThread]: On master: BEGIN
22:48:20.814944 [debug] [MainThread]: Opening a new connection, currently in state init
22:48:20.830956 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:48:20.831678 [debug] [MainThread]: Using postgres connection "master"
22:48:20.832054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:48:20.841198 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:48:20.842801 [debug] [MainThread]: On master: ROLLBACK
22:48:20.844965 [debug] [MainThread]: Using postgres connection "master"
22:48:20.845335 [debug] [MainThread]: On master: BEGIN
22:48:20.849703 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:48:20.850193 [debug] [MainThread]: On master: COMMIT
22:48:20.850816 [debug] [MainThread]: Using postgres connection "master"
22:48:20.851204 [debug] [MainThread]: On master: COMMIT
22:48:20.853348 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:48:20.853810 [debug] [MainThread]: On master: Close
22:48:20.854477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:48:20.855258 [info ] [MainThread]: 
22:48:20.860150 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:48:20.860996 [info ] [Thread-1  ]: 1 of 2 START table model dev.agg_users_stage.................................... [RUN]
22:48:20.862578 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:48:20.863054 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:48:20.863481 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:48:20.871986 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
22:48:20.872959 [debug] [Thread-1  ]: finished collecting timing info
22:48:20.873308 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
22:48:20.929060 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
22:48:20.929776 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:48:20.930025 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
22:48:20.930223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:48:20.944655 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:48:20.945359 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:48:20.945829 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-24'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-24'
GROUP BY 1,2,3,4,5
  );
22:48:20.959668 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
22:48:20.967539 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:48:20.967898 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
22:48:20.970500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:48:20.985680 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:48:20.986009 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:48:20.986235 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:48:20.989805 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:48:20.996054 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:48:20.996363 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
22:48:21.000557 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:48:21.002081 [debug] [Thread-1  ]: finished collecting timing info
22:48:21.002371 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
22:48:21.003112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a5c2a75-a908-4621-820e-4d06c4ff2972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea190050>]}
22:48:21.003766 [info ] [Thread-1  ]: 1 of 2 OK created table model dev.agg_users_stage............................... [[32mSELECT 2[0m in 0.14s]
22:48:21.004325 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:48:21.006188 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:48:21.007011 [info ] [Thread-1  ]: 2 of 2 START incremental model dev.agg_users.................................... [RUN]
22:48:21.008807 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
22:48:21.009430 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
22:48:21.009938 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
22:48:21.014612 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
22:48:21.015676 [debug] [Thread-1  ]: finished collecting timing info
22:48:21.016304 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
22:48:21.096664 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:48:21.097160 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp144821085350"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
22:48:21.097431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:48:21.113302 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
22:48:21.124503 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:48:21.124828 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
22:48:21.129831 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
22:48:21.130265 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:48:21.130811 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp144821085350'
        
      order by ordinal_position

  
22:48:21.144658 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
22:48:21.152975 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:48:21.153303 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
22:48:21.163290 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.01 seconds
22:48:21.173762 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:48:21.174100 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
22:48:21.179195 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
22:48:21.190835 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
22:48:21.191561 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:48:21.191812 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

    insert into "dbt"."dev"."agg_users" ("unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "unique_key", "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp144821085350"
    )
  
22:48:21.195690 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "unique_key" does not exist
LINE 7:         select "unique_key", "dt", "user_id", "first_name", ...
                       ^
HINT:  There is a column named "unique_key" in table "agg_users", but it cannot be referenced from this part of the query.

22:48:21.196170 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: ROLLBACK
22:48:21.199587 [debug] [Thread-1  ]: finished collecting timing info
22:48:21.200043 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
22:48:21.201094 [debug] [Thread-1  ]: Database Error in model agg_users (models/example/agg_users.sql)
  column "unique_key" does not exist
  LINE 7:         select "unique_key", "dt", "user_id", "first_name", ...
                         ^
  HINT:  There is a column named "unique_key" in table "agg_users", but it cannot be referenced from this part of the query.
  compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
22:48:21.201779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a5c2a75-a908-4621-820e-4d06c4ff2972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea145310>]}
22:48:21.202741 [error] [Thread-1  ]: 2 of 2 ERROR creating incremental model dev.agg_users........................... [[31mERROR[0m in 0.19s]
22:48:21.203667 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:48:21.280374 [debug] [MainThread]: Acquiring new postgres connection "master"
22:48:21.280992 [debug] [MainThread]: Using postgres connection "master"
22:48:21.281400 [debug] [MainThread]: On master: BEGIN
22:48:21.281777 [debug] [MainThread]: Opening a new connection, currently in state closed
22:48:21.297999 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:48:21.298568 [debug] [MainThread]: On master: COMMIT
22:48:21.298904 [debug] [MainThread]: Using postgres connection "master"
22:48:21.299160 [debug] [MainThread]: On master: COMMIT
22:48:21.302283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:48:21.302680 [debug] [MainThread]: On master: Close
22:48:21.303380 [info ] [MainThread]: 
22:48:21.304140 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0.63s.
22:48:21.304827 [debug] [MainThread]: Connection 'master' was properly closed.
22:48:21.305458 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
22:48:21.314132 [info ] [MainThread]: 
22:48:21.314773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:48:21.315472 [info ] [MainThread]: 
22:48:21.316021 [error] [MainThread]: [33mDatabase Error in model agg_users (models/example/agg_users.sql)[0m
22:48:21.317215 [error] [MainThread]:   column "unique_key" does not exist
22:48:21.318182 [error] [MainThread]:   LINE 7:         select "unique_key", "dt", "user_id", "first_name", ...
22:48:21.318978 [error] [MainThread]:                          ^
22:48:21.319513 [error] [MainThread]:   HINT:  There is a column named "unique_key" in table "agg_users", but it cannot be referenced from this part of the query.
22:48:21.320246 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/example/agg_users.sql
22:48:21.320700 [info ] [MainThread]: 
22:48:21.321139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
22:48:21.321642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9ffccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea0f0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea143150>]}


============================== 2021-12-26 22:50:21.662759 | 1e308a61-871e-473e-9323-8dbb68da7f74 ==============================
22:50:21.662759 [info ] [MainThread]: Running with dbt=1.0.0
22:50:21.664277 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-23"}', version_check=None, warn_error=None, which='run', write_json=None)
22:50:21.665145 [debug] [MainThread]: Tracking: tracking
22:50:21.694008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2507bc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2507bcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2507bc690>]}
22:50:21.726608 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:50:21.727265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e308a61-871e-473e-9323-8dbb68da7f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd25099afd0>]}
22:50:21.788479 [debug] [MainThread]: Parsing macros/catalog.sql
22:50:21.793493 [debug] [MainThread]: Parsing macros/relations.sql
22:50:21.796990 [debug] [MainThread]: Parsing macros/adapters.sql
22:50:21.831479 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:50:21.833897 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:50:21.839322 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:50:21.842625 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:50:21.844946 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:50:21.869159 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:50:21.885138 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:50:21.901974 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:50:21.908874 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:50:21.911514 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:50:21.914143 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:50:21.920484 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:50:21.939220 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:50:21.941465 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:50:21.956358 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:50:21.979197 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:50:21.989854 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:50:21.993926 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:50:22.003990 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:50:22.005900 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:50:22.009749 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:50:22.013061 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:50:22.021819 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:50:22.044795 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:50:22.046961 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:50:22.050396 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:50:22.052609 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:50:22.053849 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:50:22.054641 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:50:22.055623 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:50:22.057716 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:50:22.064066 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:50:22.075966 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:50:22.079094 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:50:22.082921 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:50:22.096252 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:50:22.100347 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:50:22.106534 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:50:22.117082 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:50:22.131536 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:50:22.380855 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:50:22.400490 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:50:22.402278 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:50:22.501445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e308a61-871e-473e-9323-8dbb68da7f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2509f0ed0>]}
22:50:22.508744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e308a61-871e-473e-9323-8dbb68da7f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd250a16d90>]}
22:50:22.509256 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:50:22.511279 [info ] [MainThread]: 
22:50:22.512329 [debug] [MainThread]: Acquiring new postgres connection "master"
22:50:22.513988 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
22:50:22.538438 [debug] [ThreadPool]: Using postgres connection "list_dbt"
22:50:22.538870 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
22:50:22.539189 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:22.624606 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.09 seconds
22:50:22.627006 [debug] [ThreadPool]: On list_dbt: Close
22:50:22.628421 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
22:50:22.629457 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
22:50:22.630239 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev', identifier=None)"
22:50:22.640745 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
22:50:22.641081 [debug] [ThreadPool]: On create_dbt_dev: BEGIN
22:50:22.641325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:50:22.654922 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:50:22.655450 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
22:50:22.655829 [debug] [ThreadPool]: On create_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "create_dbt_dev"} */
create schema if not exists "dev"
22:50:22.659528 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
22:50:22.660743 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
22:50:22.661041 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
22:50:22.661279 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
22:50:22.665970 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
22:50:22.666356 [debug] [ThreadPool]: On create_dbt_dev: Close
22:50:22.668595 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:50:22.678454 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:50:22.678766 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:50:22.678977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:50:22.693785 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:50:22.694169 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:50:22.694511 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:50:22.699905 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
22:50:22.702074 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:50:22.704408 [debug] [ThreadPool]: On list_dbt_dev: Close
22:50:22.711183 [debug] [MainThread]: Using postgres connection "master"
22:50:22.711667 [debug] [MainThread]: On master: BEGIN
22:50:22.711936 [debug] [MainThread]: Opening a new connection, currently in state init
22:50:22.725773 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:50:22.726209 [debug] [MainThread]: Using postgres connection "master"
22:50:22.726566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:50:22.733049 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:50:22.734869 [debug] [MainThread]: On master: ROLLBACK
22:50:22.737163 [debug] [MainThread]: Using postgres connection "master"
22:50:22.737599 [debug] [MainThread]: On master: BEGIN
22:50:22.742420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:50:22.742872 [debug] [MainThread]: On master: COMMIT
22:50:22.743152 [debug] [MainThread]: Using postgres connection "master"
22:50:22.743396 [debug] [MainThread]: On master: COMMIT
22:50:22.745966 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:50:22.746462 [debug] [MainThread]: On master: Close
22:50:22.747937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:50:22.748931 [info ] [MainThread]: 
22:50:22.755514 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:50:22.756393 [info ] [Thread-1  ]: 1 of 2 START table model dev.agg_users_stage.................................... [RUN]
22:50:22.757841 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:50:22.758471 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:50:22.758974 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:50:22.764564 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
22:50:22.766023 [debug] [Thread-1  ]: finished collecting timing info
22:50:22.766651 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
22:50:22.844401 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
22:50:22.846345 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:50:22.846667 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
22:50:22.846878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:50:22.869571 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
22:50:22.870201 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:50:22.870663 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-23' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-23'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-23'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-23'
GROUP BY 1,2,3,4,5
  );
22:50:22.883653 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dev.users" does not exist
LINE 16: FROM "dbt"."dev"."users" a
              ^

22:50:22.884161 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: ROLLBACK
22:50:22.889799 [debug] [Thread-1  ]: finished collecting timing info
22:50:22.890754 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
22:50:22.892204 [debug] [Thread-1  ]: Database Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  relation "dev.users" does not exist
  LINE 16: FROM "dbt"."dev"."users" a
                ^
  compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
22:50:22.893661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e308a61-871e-473e-9323-8dbb68da7f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd250a9e710>]}
22:50:22.894768 [error] [Thread-1  ]: 1 of 2 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.14s]
22:50:22.896009 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:50:22.899259 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:50:22.900265 [info ] [Thread-1  ]: 2 of 2 SKIP relation dev.agg_users.............................................. [[33mSKIP[0m]
22:50:22.901376 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:50:22.958998 [debug] [MainThread]: Acquiring new postgres connection "master"
22:50:22.961206 [debug] [MainThread]: Using postgres connection "master"
22:50:22.961869 [debug] [MainThread]: On master: BEGIN
22:50:22.962526 [debug] [MainThread]: Opening a new connection, currently in state closed
22:50:22.988628 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
22:50:22.989130 [debug] [MainThread]: On master: COMMIT
22:50:22.989476 [debug] [MainThread]: Using postgres connection "master"
22:50:22.989729 [debug] [MainThread]: On master: COMMIT
22:50:22.991991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:50:22.992443 [debug] [MainThread]: On master: Close
22:50:22.993183 [info ] [MainThread]: 
22:50:22.993844 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0.48s.
22:50:22.995112 [debug] [MainThread]: Connection 'master' was properly closed.
22:50:22.995780 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
22:50:23.059896 [info ] [MainThread]: 
22:50:23.060391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
22:50:23.062593 [info ] [MainThread]: 
22:50:23.063954 [error] [MainThread]: [33mDatabase Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
22:50:23.065150 [error] [MainThread]:   relation "dev.users" does not exist
22:50:23.066533 [error] [MainThread]:   LINE 16: FROM "dbt"."dev"."users" a
22:50:23.067584 [error] [MainThread]:                 ^
22:50:23.068852 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
22:50:23.070050 [info ] [MainThread]: 
22:50:23.071289 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
22:50:23.072657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd250860450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd250871450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd250871910>]}


============================== 2021-12-26 22:52:42.223638 | d7e3bd57-4976-4ec5-8e82-9b78cef85636 ==============================
22:52:42.223638 [info ] [MainThread]: Running with dbt=1.0.0
22:52:42.225165 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
22:52:42.225572 [debug] [MainThread]: Tracking: tracking
22:52:42.249872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f867c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f867c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f867c810>]}
22:52:42.287384 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:52:42.288337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7e3bd57-4976-4ec5-8e82-9b78cef85636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f8959fd0>]}
22:52:42.365905 [debug] [MainThread]: Parsing macros/catalog.sql
22:52:42.373107 [debug] [MainThread]: Parsing macros/relations.sql
22:52:42.375130 [debug] [MainThread]: Parsing macros/adapters.sql
22:52:42.410816 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:52:42.413416 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:52:42.419006 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:52:42.422326 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:52:42.424746 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:52:42.449051 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:52:42.464870 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:52:42.481587 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:52:42.487976 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:52:42.490629 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:52:42.493239 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:52:42.499501 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:52:42.515377 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:52:42.517587 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:52:42.532438 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:52:42.554545 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:52:42.565094 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:52:42.569249 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:52:42.579293 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:52:42.581204 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:52:42.584993 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:52:42.588286 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:52:42.601863 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:52:42.624868 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:52:42.627017 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:52:42.630581 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:52:42.632815 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:52:42.634053 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:52:42.634854 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:52:42.635892 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:52:42.638092 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:52:42.644323 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:52:42.656122 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:52:42.659419 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:52:42.663260 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:52:42.676452 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:52:42.680516 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:52:42.686666 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:52:42.696995 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:52:42.710701 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:52:42.963285 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:52:42.981076 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:52:42.982760 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:52:43.127789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7e3bd57-4976-4ec5-8e82-9b78cef85636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f894e250>]}
22:52:43.135161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7e3bd57-4976-4ec5-8e82-9b78cef85636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f89aa750>]}
22:52:43.135627 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:52:43.137253 [info ] [MainThread]: 
22:52:43.138109 [debug] [MainThread]: Acquiring new postgres connection "master"
22:52:43.140122 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
22:52:43.161932 [debug] [ThreadPool]: Using postgres connection "list_dbt"
22:52:43.162376 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
22:52:43.162928 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:52:43.223581 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
22:52:43.225640 [debug] [ThreadPool]: On list_dbt: Close
22:52:43.228563 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:52:43.243916 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:52:43.244275 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:52:43.244547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:52:43.259680 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:52:43.260184 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:52:43.260565 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:52:43.266185 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
22:52:43.268549 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:52:43.271129 [debug] [ThreadPool]: On list_dbt_dev: Close
22:52:43.277927 [debug] [MainThread]: Using postgres connection "master"
22:52:43.278520 [debug] [MainThread]: On master: BEGIN
22:52:43.279025 [debug] [MainThread]: Opening a new connection, currently in state init
22:52:43.294958 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:52:43.295648 [debug] [MainThread]: Using postgres connection "master"
22:52:43.296283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:52:43.302885 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:52:43.304594 [debug] [MainThread]: On master: ROLLBACK
22:52:43.306464 [debug] [MainThread]: Using postgres connection "master"
22:52:43.306843 [debug] [MainThread]: On master: BEGIN
22:52:43.311204 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:52:43.311723 [debug] [MainThread]: On master: COMMIT
22:52:43.312202 [debug] [MainThread]: Using postgres connection "master"
22:52:43.312548 [debug] [MainThread]: On master: COMMIT
22:52:43.314874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:52:43.315313 [debug] [MainThread]: On master: Close
22:52:43.316063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:52:43.316619 [info ] [MainThread]: 
22:52:43.322866 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
22:52:43.323415 [info ] [Thread-1  ]: 1 of 3 START seed file dev.payments............................................. [RUN]
22:52:43.324283 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
22:52:43.324867 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
22:52:43.325495 [debug] [Thread-1  ]: finished collecting timing info
22:52:43.325831 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
22:52:43.380606 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
22:52:43.380883 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: BEGIN
22:52:43.381105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:43.395258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:52:43.395724 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
22:52:43.395997 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */

    create table "dbt"."dev"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
22:52:43.400477 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
22:52:43.426368 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
22:52:43.426727 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: 
          insert into "dbt"."dev"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
22:52:43.429387 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
22:52:43.436932 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.payments"
22:52:43.452909 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
22:52:43.453375 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
22:52:43.453673 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
22:52:43.457237 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:52:43.458318 [debug] [Thread-1  ]: finished collecting timing info
22:52:43.458745 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: Close
22:52:43.459633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e3bd57-4976-4ec5-8e82-9b78cef85636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f8ba5310>]}
22:52:43.460440 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.payments......................................... [[32mINSERT 3[0m in 0.14s]
22:52:43.462118 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
22:52:43.463008 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
22:52:43.466338 [info ] [Thread-1  ]: 2 of 3 START seed file dev.sessions............................................. [RUN]
22:52:43.486453 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
22:52:43.487542 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
22:52:43.488674 [debug] [Thread-1  ]: finished collecting timing info
22:52:43.489010 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
22:52:43.557317 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
22:52:43.557585 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: BEGIN
22:52:43.557790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:43.572208 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:52:43.572753 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
22:52:43.573497 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */

    create table "dbt"."dev"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
22:52:43.578226 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
22:52:43.584341 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
22:52:43.584656 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: 
          insert into "dbt"."dev"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
22:52:43.587108 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
22:52:43.587747 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.sessions"
22:52:43.589851 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
22:52:43.590152 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
22:52:43.590388 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
22:52:43.594131 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:52:43.595062 [debug] [Thread-1  ]: finished collecting timing info
22:52:43.595398 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: Close
22:52:43.596108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e3bd57-4976-4ec5-8e82-9b78cef85636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f8784cd0>]}
22:52:43.596600 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.sessions......................................... [[32mINSERT 4[0m in 0.11s]
22:52:43.597192 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
22:52:43.597542 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
22:52:43.598643 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
22:52:43.600146 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
22:52:43.600791 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
22:52:43.601451 [debug] [Thread-1  ]: finished collecting timing info
22:52:43.602156 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
22:52:43.619484 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
22:52:43.620372 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
22:52:43.621203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:43.646357 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
22:52:43.647700 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
22:52:43.648685 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text,"created_at" timestamp without time zone)
  
22:52:43.659094 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
22:52:43.667983 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
22:52:43.669325 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
22:52:43.672544 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
22:52:43.673248 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
22:52:43.676095 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
22:52:43.676447 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
22:52:43.676722 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
22:52:43.680368 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:52:43.681225 [debug] [Thread-1  ]: finished collecting timing info
22:52:43.681526 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
22:52:43.682343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e3bd57-4976-4ec5-8e82-9b78cef85636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f873db50>]}
22:52:43.683003 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mINSERT 5[0m in 0.08s]
22:52:43.683846 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
22:52:43.755660 [debug] [MainThread]: Acquiring new postgres connection "master"
22:52:43.756295 [debug] [MainThread]: Using postgres connection "master"
22:52:43.756846 [debug] [MainThread]: On master: BEGIN
22:52:43.757227 [debug] [MainThread]: Opening a new connection, currently in state closed
22:52:43.772521 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:52:43.773097 [debug] [MainThread]: On master: COMMIT
22:52:43.773411 [debug] [MainThread]: Using postgres connection "master"
22:52:43.773667 [debug] [MainThread]: On master: COMMIT
22:52:43.775912 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:52:43.776331 [debug] [MainThread]: On master: Close
22:52:43.777139 [info ] [MainThread]: 
22:52:43.777989 [info ] [MainThread]: Finished running 3 seeds in 0.64s.
22:52:43.778745 [debug] [MainThread]: Connection 'master' was properly closed.
22:52:43.779047 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
22:52:43.789425 [info ] [MainThread]: 
22:52:43.790230 [info ] [MainThread]: [32mCompleted successfully[0m
22:52:43.791051 [info ] [MainThread]: 
22:52:43.791662 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
22:52:43.792511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f8b02a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f878c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f878c9d0>]}


============================== 2021-12-26 22:52:52.481815 | 9533b394-5265-49f4-957d-1bd408125f9e ==============================
22:52:52.481815 [info ] [MainThread]: Running with dbt=1.0.0
22:52:52.482959 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-23"}', version_check=None, warn_error=None, which='run', write_json=None)
22:52:52.483346 [debug] [MainThread]: Tracking: tracking
22:52:52.505400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9744ebde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9744ebd890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9744ebdf50>]}
22:52:52.554500 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:52:52.555157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9533b394-5265-49f4-957d-1bd408125f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f974519afd0>]}
22:52:52.605714 [debug] [MainThread]: Parsing macros/catalog.sql
22:52:52.610907 [debug] [MainThread]: Parsing macros/relations.sql
22:52:52.612951 [debug] [MainThread]: Parsing macros/adapters.sql
22:52:52.646146 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:52:52.648766 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:52:52.654343 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:52:52.657669 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:52:52.660009 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:52:52.685647 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:52:52.702503 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:52:52.719795 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:52:52.726227 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:52:52.728785 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:52:52.731356 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:52:52.738097 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:52:52.753919 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:52:52.756160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:52:52.771236 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:52:52.793285 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:52:52.803955 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:52:52.808260 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:52:52.818316 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:52:52.820247 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:52:52.824118 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:52:52.827481 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:52:52.836401 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:52:52.871407 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:52:52.873866 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:52:52.878571 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:52:52.884937 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:52:52.887452 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:52:52.889305 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:52:52.892223 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:52:52.899210 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:52:52.913256 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:52:52.927849 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:52:52.931431 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:52:52.937479 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:52:52.954097 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:52:52.959199 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:52:52.965490 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:52:52.975729 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:52:52.989816 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:52:53.242996 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:52:53.261804 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:52:53.264022 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:52:53.355777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9533b394-5265-49f4-957d-1bd408125f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9745217dd0>]}
22:52:53.364686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9533b394-5265-49f4-957d-1bd408125f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9745136610>]}
22:52:53.365266 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:52:53.367563 [info ] [MainThread]: 
22:52:53.368631 [debug] [MainThread]: Acquiring new postgres connection "master"
22:52:53.370447 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
22:52:53.389589 [debug] [ThreadPool]: Using postgres connection "list_dbt"
22:52:53.389948 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
22:52:53.390243 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:52:53.416634 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
22:52:53.418792 [debug] [ThreadPool]: On list_dbt: Close
22:52:53.423960 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:52:53.434754 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:52:53.435099 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:52:53.435344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:52:53.452610 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
22:52:53.453144 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:52:53.453642 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:52:53.458780 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
22:52:53.461194 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:52:53.463473 [debug] [ThreadPool]: On list_dbt_dev: Close
22:52:53.470596 [debug] [MainThread]: Using postgres connection "master"
22:52:53.471031 [debug] [MainThread]: On master: BEGIN
22:52:53.471293 [debug] [MainThread]: Opening a new connection, currently in state init
22:52:53.486837 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:52:53.487544 [debug] [MainThread]: Using postgres connection "master"
22:52:53.488036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:52:53.496596 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:52:53.499138 [debug] [MainThread]: On master: ROLLBACK
22:52:53.501752 [debug] [MainThread]: Using postgres connection "master"
22:52:53.502157 [debug] [MainThread]: On master: BEGIN
22:52:53.507330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:52:53.508149 [debug] [MainThread]: On master: COMMIT
22:52:53.508558 [debug] [MainThread]: Using postgres connection "master"
22:52:53.508854 [debug] [MainThread]: On master: COMMIT
22:52:53.513007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:52:53.513514 [debug] [MainThread]: On master: Close
22:52:53.514498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:52:53.515642 [info ] [MainThread]: 
22:52:53.523480 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:52:53.524385 [info ] [Thread-1  ]: 1 of 2 START table model dev.agg_users_stage.................................... [RUN]
22:52:53.525823 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:52:53.526524 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:52:53.527074 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:52:53.541680 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
22:52:53.544311 [debug] [Thread-1  ]: finished collecting timing info
22:52:53.545015 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
22:52:53.605444 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
22:52:53.606318 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:52:53.606684 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
22:52:53.606964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:53.625016 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
22:52:53.625607 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:52:53.625994 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-23' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-23'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-23'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-23'
GROUP BY 1,2,3,4,5
  );
22:52:53.636383 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
22:52:53.645307 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:52:53.645660 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
22:52:53.648300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:52:53.662270 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:52:53.662632 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:52:53.662893 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:52:53.666318 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:52:53.717730 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:52:53.718060 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
22:52:53.720166 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:52:53.721741 [debug] [Thread-1  ]: finished collecting timing info
22:52:53.722056 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
22:52:53.722733 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9533b394-5265-49f4-957d-1bd408125f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97452b8bd0>]}
22:52:53.723670 [info ] [Thread-1  ]: 1 of 2 OK created table model dev.agg_users_stage............................... [[32mSELECT 0[0m in 0.20s]
22:52:53.724675 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:52:53.726541 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:52:53.727576 [info ] [Thread-1  ]: 2 of 2 START incremental model dev.agg_users.................................... [RUN]
22:52:53.728987 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
22:52:53.729360 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
22:52:53.729670 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
22:52:53.733450 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
22:52:53.735618 [debug] [Thread-1  ]: finished collecting timing info
22:52:53.736290 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
22:52:53.822962 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
22:52:53.823917 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:52:53.824329 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
22:52:53.824594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:52:53.841330 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
22:52:53.842127 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:52:53.843004 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
22:52:53.852116 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.01 seconds
22:52:53.855627 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
22:52:53.856030 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:52:53.856327 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
22:52:53.860141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:52:53.861376 [debug] [Thread-1  ]: finished collecting timing info
22:52:53.861953 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
22:52:53.862779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9533b394-5265-49f4-957d-1bd408125f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9740a38ad0>]}
22:52:53.863405 [info ] [Thread-1  ]: 2 of 2 OK created incremental model dev.agg_users............................... [[32mSELECT 0[0m in 0.13s]
22:52:53.864565 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:52:53.927894 [debug] [MainThread]: Acquiring new postgres connection "master"
22:52:53.928743 [debug] [MainThread]: Using postgres connection "master"
22:52:53.929168 [debug] [MainThread]: On master: BEGIN
22:52:53.929550 [debug] [MainThread]: Opening a new connection, currently in state closed
22:52:53.946532 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:52:53.947125 [debug] [MainThread]: On master: COMMIT
22:52:53.947419 [debug] [MainThread]: Using postgres connection "master"
22:52:53.947665 [debug] [MainThread]: On master: COMMIT
22:52:53.950174 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:52:53.950586 [debug] [MainThread]: On master: Close
22:52:53.951359 [info ] [MainThread]: 
22:52:53.952000 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0.58s.
22:52:53.952829 [debug] [MainThread]: Connection 'master' was properly closed.
22:52:53.953444 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
22:52:53.962643 [info ] [MainThread]: 
22:52:53.963566 [info ] [MainThread]: [32mCompleted successfully[0m
22:52:53.964473 [info ] [MainThread]: 
22:52:53.965269 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
22:52:53.966002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97451a1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9744ffe750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9744ffe7d0>]}


============================== 2021-12-26 22:53:18.494082 | 1aa0ddab-2bfe-47b1-89c8-9f60ee6aaed0 ==============================
22:53:18.494082 [info ] [MainThread]: Running with dbt=1.0.0
22:53:18.495357 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-24"}', version_check=None, warn_error=None, which='run', write_json=None)
22:53:18.495717 [debug] [MainThread]: Tracking: tracking
22:53:18.518357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6d967c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6d8631650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6d967c410>]}
22:53:18.560919 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:53:18.561606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1aa0ddab-2bfe-47b1-89c8-9f60ee6aaed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da158fd0>]}
22:53:18.616527 [debug] [MainThread]: Parsing macros/catalog.sql
22:53:18.621134 [debug] [MainThread]: Parsing macros/relations.sql
22:53:18.623232 [debug] [MainThread]: Parsing macros/adapters.sql
22:53:18.655088 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:53:18.657516 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:53:18.663319 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:53:18.667681 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:53:18.671060 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:53:18.696363 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:53:18.712449 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:53:18.729538 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:53:18.736088 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:53:18.738718 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:53:18.741325 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:53:18.747894 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:53:18.763759 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:53:18.765975 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:53:18.781238 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:53:18.803806 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:53:18.814527 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:53:18.818679 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:53:18.828890 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:53:18.830850 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:53:18.834675 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:53:18.838014 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:53:18.847410 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:53:18.872087 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:53:18.874525 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:53:18.878166 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:53:18.880620 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:53:18.881947 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:53:18.882800 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:53:18.883837 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:53:18.886033 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:53:18.892379 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:53:18.904831 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:53:18.908023 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:53:18.911905 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:53:18.925410 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:53:18.929567 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:53:18.935954 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:53:18.946278 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:53:18.960496 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:53:19.221835 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:53:19.240631 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:53:19.242477 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:53:19.341366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aa0ddab-2bfe-47b1-89c8-9f60ee6aaed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da12b190>]}
22:53:19.348265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aa0ddab-2bfe-47b1-89c8-9f60ee6aaed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da1f5890>]}
22:53:19.348748 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:53:19.350574 [info ] [MainThread]: 
22:53:19.351513 [debug] [MainThread]: Acquiring new postgres connection "master"
22:53:19.353289 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
22:53:19.371685 [debug] [ThreadPool]: Using postgres connection "list_dbt"
22:53:19.372265 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
22:53:19.372716 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:53:19.433980 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
22:53:19.435973 [debug] [ThreadPool]: On list_dbt: Close
22:53:19.439082 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:53:19.451888 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:53:19.452322 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:53:19.452611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:53:19.468201 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
22:53:19.468723 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:53:19.469414 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:53:19.476798 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
22:53:19.480008 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:53:19.482556 [debug] [ThreadPool]: On list_dbt_dev: Close
22:53:19.490233 [debug] [MainThread]: Using postgres connection "master"
22:53:19.490596 [debug] [MainThread]: On master: BEGIN
22:53:19.490977 [debug] [MainThread]: Opening a new connection, currently in state init
22:53:19.505244 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:53:19.505776 [debug] [MainThread]: Using postgres connection "master"
22:53:19.506212 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:53:19.516646 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:53:19.518421 [debug] [MainThread]: On master: ROLLBACK
22:53:19.520544 [debug] [MainThread]: Using postgres connection "master"
22:53:19.520905 [debug] [MainThread]: On master: BEGIN
22:53:19.526311 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:53:19.526861 [debug] [MainThread]: On master: COMMIT
22:53:19.527388 [debug] [MainThread]: Using postgres connection "master"
22:53:19.527661 [debug] [MainThread]: On master: COMMIT
22:53:19.529951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:53:19.530359 [debug] [MainThread]: On master: Close
22:53:19.531084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:53:19.531644 [info ] [MainThread]: 
22:53:19.537607 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:53:19.538256 [info ] [Thread-1  ]: 1 of 2 START table model dev.agg_users_stage.................................... [RUN]
22:53:19.539196 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:53:19.539626 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:53:19.540154 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:53:19.547007 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
22:53:19.548490 [debug] [Thread-1  ]: finished collecting timing info
22:53:19.548998 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
22:53:19.597551 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
22:53:19.598305 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:53:19.598588 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
22:53:19.598912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:19.613624 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:53:19.614295 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:53:19.614580 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-24' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-24'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-24'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-24'
GROUP BY 1,2,3,4,5
  );
22:53:19.625894 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
22:53:19.635244 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:53:19.635568 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
22:53:19.637909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:53:19.684069 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:53:19.684372 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
22:53:19.686826 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:53:19.700713 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:53:19.701049 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:53:19.701298 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:53:19.705562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:53:19.712064 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:53:19.712397 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
22:53:19.717239 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:53:19.719234 [debug] [Thread-1  ]: finished collecting timing info
22:53:19.719617 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
22:53:19.720441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa0ddab-2bfe-47b1-89c8-9f60ee6aaed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da084990>]}
22:53:19.721428 [info ] [Thread-1  ]: 1 of 2 OK created table model dev.agg_users_stage............................... [[32mSELECT 2[0m in 0.18s]
22:53:19.722525 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:53:19.724215 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:53:19.724784 [info ] [Thread-1  ]: 2 of 2 START incremental model dev.agg_users.................................... [RUN]
22:53:19.726576 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
22:53:19.726979 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
22:53:19.727292 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
22:53:19.731823 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
22:53:19.732781 [debug] [Thread-1  ]: finished collecting timing info
22:53:19.733601 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
22:53:19.820184 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:53:19.820516 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp145319805196"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
22:53:19.820767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:53:19.839078 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
22:53:19.850202 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:53:19.850540 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
22:53:19.853232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
22:53:19.853908 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:53:19.854291 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp145319805196'
        
      order by ordinal_position

  
22:53:19.867256 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
22:53:19.873862 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:53:19.874184 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
22:53:19.886850 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
22:53:19.896599 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:53:19.896951 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
22:53:19.902541 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
22:53:19.913899 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
22:53:19.914632 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:53:19.914917 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp145319805196"
    )
  
22:53:19.918771 [debug] [Thread-1  ]: SQL status: INSERT 0 2 in 0.0 seconds
22:53:19.920534 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
22:53:19.920840 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:53:19.921080 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
22:53:19.924155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:53:19.925407 [debug] [Thread-1  ]: finished collecting timing info
22:53:19.925960 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
22:53:19.927098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa0ddab-2bfe-47b1-89c8-9f60ee6aaed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da09a650>]}
22:53:19.928170 [info ] [Thread-1  ]: 2 of 2 OK created incremental model dev.agg_users............................... [[32mINSERT 0 2[0m in 0.20s]
22:53:19.929116 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:53:19.951916 [debug] [MainThread]: Acquiring new postgres connection "master"
22:53:19.952479 [debug] [MainThread]: Using postgres connection "master"
22:53:19.952887 [debug] [MainThread]: On master: BEGIN
22:53:19.953253 [debug] [MainThread]: Opening a new connection, currently in state closed
22:53:19.980183 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
22:53:19.980881 [debug] [MainThread]: On master: COMMIT
22:53:19.981434 [debug] [MainThread]: Using postgres connection "master"
22:53:19.982014 [debug] [MainThread]: On master: COMMIT
22:53:19.985029 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:53:19.985678 [debug] [MainThread]: On master: Close
22:53:19.986841 [info ] [MainThread]: 
22:53:19.987634 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0.64s.
22:53:19.988513 [debug] [MainThread]: Connection 'master' was properly closed.
22:53:19.988787 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
22:53:19.998612 [info ] [MainThread]: 
22:53:19.999622 [info ] [MainThread]: [32mCompleted successfully[0m
22:53:20.000240 [info ] [MainThread]: 
22:53:20.000698 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
22:53:20.001242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da26ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da12e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6da12ed90>]}


============================== 2021-12-26 22:54:01.405176 | 9a307cff-7152-4862-b0b4-8db37a0787c7 ==============================
22:54:01.405176 [info ] [MainThread]: Running with dbt=1.0.0
22:54:01.406231 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{"ds":"2021-12-25"}', version_check=None, warn_error=None, which='run', write_json=None)
22:54:01.406592 [debug] [MainThread]: Tracking: tracking
22:54:01.423597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa444e72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa444e72ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa444e72450>]}
22:54:01.464063 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
22:54:01.464784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a307cff-7152-4862-b0b4-8db37a0787c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa445159fd0>]}
22:54:01.498647 [debug] [MainThread]: Parsing macros/catalog.sql
22:54:01.504473 [debug] [MainThread]: Parsing macros/relations.sql
22:54:01.506445 [debug] [MainThread]: Parsing macros/adapters.sql
22:54:01.545163 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:54:01.547656 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:54:01.553083 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:54:01.556372 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:54:01.558699 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:54:01.583295 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:54:01.599096 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:54:01.616232 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:54:01.622643 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:54:01.625152 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:54:01.627687 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:54:01.634016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:54:01.649763 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:54:01.651940 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:54:01.666585 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:54:01.688461 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:54:01.699076 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:54:01.703154 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:54:01.714069 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:54:01.716056 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:54:01.719881 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:54:01.723181 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:54:01.731938 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:54:01.755953 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:54:01.758311 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:54:01.761933 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:54:01.764357 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:54:01.765653 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:54:01.766447 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:54:01.767441 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:54:01.769579 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:54:01.776549 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:54:01.788640 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:54:01.791763 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:54:01.795743 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:54:01.809381 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:54:01.813698 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:54:01.820580 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:54:01.831600 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:54:01.846704 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:54:02.166874 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
22:54:02.189377 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
22:54:02.191125 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
22:54:02.298283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a307cff-7152-4862-b0b4-8db37a0787c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa445106e10>]}
22:54:02.305839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a307cff-7152-4862-b0b4-8db37a0787c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa445129410>]}
22:54:02.306310 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
22:54:02.307906 [info ] [MainThread]: 
22:54:02.308704 [debug] [MainThread]: Acquiring new postgres connection "master"
22:54:02.310217 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
22:54:02.334672 [debug] [ThreadPool]: Using postgres connection "list_dbt"
22:54:02.335322 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
22:54:02.335863 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:54:02.386023 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
22:54:02.389849 [debug] [ThreadPool]: On list_dbt: Close
22:54:02.393457 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
22:54:02.405434 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:54:02.405780 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
22:54:02.406031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:54:02.424847 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
22:54:02.425217 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
22:54:02.425476 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
22:54:02.430848 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
22:54:02.433180 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
22:54:02.435875 [debug] [ThreadPool]: On list_dbt_dev: Close
22:54:02.442662 [debug] [MainThread]: Using postgres connection "master"
22:54:02.443036 [debug] [MainThread]: On master: BEGIN
22:54:02.443851 [debug] [MainThread]: Opening a new connection, currently in state init
22:54:02.460446 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:54:02.460867 [debug] [MainThread]: Using postgres connection "master"
22:54:02.461131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:54:02.471423 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
22:54:02.473634 [debug] [MainThread]: On master: ROLLBACK
22:54:02.475931 [debug] [MainThread]: Using postgres connection "master"
22:54:02.476298 [debug] [MainThread]: On master: BEGIN
22:54:02.482429 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:54:02.482922 [debug] [MainThread]: On master: COMMIT
22:54:02.483249 [debug] [MainThread]: Using postgres connection "master"
22:54:02.483504 [debug] [MainThread]: On master: COMMIT
22:54:02.485788 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:54:02.486256 [debug] [MainThread]: On master: Close
22:54:02.486934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
22:54:02.487485 [info ] [MainThread]: 
22:54:02.493485 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
22:54:02.494446 [info ] [Thread-1  ]: 1 of 2 START table model dev.agg_users_stage.................................... [RUN]
22:54:02.495318 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
22:54:02.495698 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
22:54:02.496037 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
22:54:02.502503 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
22:54:02.503338 [debug] [Thread-1  ]: finished collecting timing info
22:54:02.503643 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
22:54:02.554179 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
22:54:02.555072 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:54:02.555445 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
22:54:02.555713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:02.570089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:54:02.570645 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:54:02.571086 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-25' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-25'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-25'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-25'
GROUP BY 1,2,3,4,5
  );
22:54:02.581515 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.01 seconds
22:54:02.590731 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:54:02.591033 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
22:54:02.593027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:54:02.639231 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:54:02.639585 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
22:54:02.642646 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:54:02.656889 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:54:02.657203 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:54:02.657412 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
22:54:02.660309 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:54:02.666764 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
22:54:02.667094 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
22:54:02.671176 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:54:02.672807 [debug] [Thread-1  ]: finished collecting timing info
22:54:02.673125 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
22:54:02.673732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a307cff-7152-4862-b0b4-8db37a0787c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4450aa550>]}
22:54:02.674311 [info ] [Thread-1  ]: 1 of 2 OK created table model dev.agg_users_stage............................... [[32mSELECT 3[0m in 0.18s]
22:54:02.674831 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
22:54:02.676449 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
22:54:02.676898 [info ] [Thread-1  ]: 2 of 2 START incremental model dev.agg_users.................................... [RUN]
22:54:02.677990 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
22:54:02.678565 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
22:54:02.679033 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
22:54:02.683218 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
22:54:02.684040 [debug] [Thread-1  ]: finished collecting timing info
22:54:02.684647 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
22:54:02.778374 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:54:02.778718 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp145402767280"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
22:54:02.778943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:54:02.795348 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.02 seconds
22:54:02.804856 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:54:02.805315 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
22:54:02.808098 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
22:54:02.808693 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:54:02.808967 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp145402767280'
        
      order by ordinal_position

  
22:54:02.820175 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
22:54:02.826391 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:54:02.826698 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
22:54:02.831872 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
22:54:02.841140 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:54:02.841441 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
22:54:02.846265 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
22:54:02.857030 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
22:54:02.857724 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:54:02.857969 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp145402767280"
    )
  
22:54:02.860146 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
22:54:02.861646 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
22:54:02.861917 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
22:54:02.862124 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
22:54:02.865140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:54:02.865943 [debug] [Thread-1  ]: finished collecting timing info
22:54:02.866242 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
22:54:02.866930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a307cff-7152-4862-b0b4-8db37a0787c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4450aa210>]}
22:54:02.867496 [info ] [Thread-1  ]: 2 of 2 OK created incremental model dev.agg_users............................... [[32mINSERT 0 3[0m in 0.19s]
22:54:02.868579 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
22:54:02.907402 [debug] [MainThread]: Acquiring new postgres connection "master"
22:54:02.909109 [debug] [MainThread]: Using postgres connection "master"
22:54:02.910910 [debug] [MainThread]: On master: BEGIN
22:54:02.911762 [debug] [MainThread]: Opening a new connection, currently in state closed
22:54:02.932042 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
22:54:02.932775 [debug] [MainThread]: On master: COMMIT
22:54:02.933106 [debug] [MainThread]: Using postgres connection "master"
22:54:02.933417 [debug] [MainThread]: On master: COMMIT
22:54:02.936268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:54:02.936691 [debug] [MainThread]: On master: Close
22:54:02.937371 [info ] [MainThread]: 
22:54:02.938515 [info ] [MainThread]: Finished running 1 table model, 1 incremental model in 0.63s.
22:54:02.939010 [debug] [MainThread]: Connection 'master' was properly closed.
22:54:02.939270 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
22:54:02.949998 [info ] [MainThread]: 
22:54:02.950758 [info ] [MainThread]: [32mCompleted successfully[0m
22:54:02.951394 [info ] [MainThread]: 
22:54:02.951886 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
22:54:02.952857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4450d6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4451302d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa445130350>]}


============================== 2021-12-26 23:51:30.810127 | 62cf2710-3c4c-4093-9910-563e3c9cd24c ==============================
23:51:30.810127 [info ] [MainThread]: Running with dbt=1.0.0
23:51:30.813281 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
23:51:30.816243 [debug] [MainThread]: Tracking: do not track
23:51:30.879642 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
23:51:30.883991 [info ] [MainThread]: Unable to do partial parsing because profile has changed
23:51:31.042742 [debug] [MainThread]: Parsing macros/catalog.sql
23:51:31.063002 [debug] [MainThread]: Parsing macros/adapters.sql
23:51:31.124491 [debug] [MainThread]: Parsing macros/relations.sql
23:51:31.131984 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:51:31.138736 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:51:31.143770 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:51:31.149300 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:51:31.155695 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:51:31.163374 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:51:31.177910 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:51:31.191715 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:51:31.218789 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:51:31.224553 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:51:31.247494 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:51:31.258819 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:51:31.294415 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:51:31.303088 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:51:31.320310 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:51:31.328588 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:51:31.345939 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:51:31.351682 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:51:31.367604 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:51:31.385794 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:51:31.392059 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:51:31.399758 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:51:31.416183 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:51:31.453317 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:51:31.493920 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:51:31.525465 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:51:31.564811 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:51:31.574053 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:51:31.580294 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:51:31.588198 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:51:31.593933 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:51:31.602720 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:51:31.610576 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:51:31.619322 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:51:31.631152 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:51:31.649725 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:51:31.673430 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:51:31.696135 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:51:31.715660 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:51:31.730046 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:51:32.095329 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
23:51:32.118772 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
23:51:32.129370 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
23:51:32.308972 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
23:51:32.316064 [info ] [MainThread]: 
23:51:32.321020 [debug] [MainThread]: Acquiring new postgres connection "master"
23:51:32.326401 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
23:51:32.345793 [debug] [ThreadPool]: Using postgres connection "list_dbt"
23:51:32.348687 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
23:51:32.351741 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:51:32.365260 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
23:51:32.372277 [debug] [ThreadPool]: On list_dbt: Close
23:51:32.382403 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
23:51:32.395221 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
23:51:32.398019 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
23:51:32.400878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:51:32.414782 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:51:32.418991 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
23:51:32.422083 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
23:51:32.428997 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
23:51:32.443132 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
23:51:32.447287 [debug] [ThreadPool]: On list_dbt_dev: Close
23:51:32.461388 [debug] [MainThread]: Using postgres connection "master"
23:51:32.464587 [debug] [MainThread]: On master: BEGIN
23:51:32.467296 [debug] [MainThread]: Opening a new connection, currently in state init
23:51:32.478839 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:51:32.482636 [debug] [MainThread]: Using postgres connection "master"
23:51:32.486816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:51:32.498072 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
23:51:32.502646 [debug] [MainThread]: On master: ROLLBACK
23:51:32.506571 [debug] [MainThread]: Using postgres connection "master"
23:51:32.509202 [debug] [MainThread]: On master: BEGIN
23:51:32.512921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:51:32.517844 [debug] [MainThread]: On master: COMMIT
23:51:32.520430 [debug] [MainThread]: Using postgres connection "master"
23:51:32.523744 [debug] [MainThread]: On master: COMMIT
23:51:32.526413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:51:32.529271 [debug] [MainThread]: On master: Close
23:51:32.534852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
23:51:32.538003 [info ] [MainThread]: 
23:51:32.564683 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
23:51:32.567162 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
23:51:32.570712 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
23:51:32.573742 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
23:51:32.576091 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
23:51:32.585961 [debug] [Thread-1  ]: finished collecting timing info
23:51:32.589324 [debug] [Thread-1  ]: Compilation Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {}
  
  > in model agg_users_stage (models/staging/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/agg_users_stage.sql)
23:51:32.592364 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.02s]
23:51:32.597839 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
23:51:32.602691 [debug] [MainThread]: Acquiring new postgres connection "master"
23:51:32.605064 [debug] [MainThread]: Using postgres connection "master"
23:51:32.607788 [debug] [MainThread]: On master: BEGIN
23:51:32.610520 [debug] [MainThread]: Opening a new connection, currently in state closed
23:51:32.619574 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:51:32.623838 [debug] [MainThread]: On master: COMMIT
23:51:32.626897 [debug] [MainThread]: Using postgres connection "master"
23:51:32.632000 [debug] [MainThread]: On master: COMMIT
23:51:32.635353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:51:32.637917 [debug] [MainThread]: On master: Close
23:51:32.643151 [info ] [MainThread]: 
23:51:32.646249 [info ] [MainThread]: Finished running 1 table model in 0.32s.
23:51:32.649244 [debug] [MainThread]: Connection 'master' was properly closed.
23:51:32.652671 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
23:51:32.681697 [info ] [MainThread]: 
23:51:32.686367 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
23:51:32.690736 [info ] [MainThread]: 
23:51:32.694282 [error] [MainThread]: [33mCompilation Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
23:51:32.698360 [error] [MainThread]:   Required var 'ds' not found in config:
23:51:32.702054 [error] [MainThread]:   Vars supplied to agg_users_stage = {}
23:51:32.706198 [error] [MainThread]:   
23:51:32.709951 [error] [MainThread]:   > in model agg_users_stage (models/staging/agg_users_stage.sql)
23:51:32.713697 [error] [MainThread]:   > called by model agg_users_stage (models/staging/agg_users_stage.sql)
23:51:32.716612 [info ] [MainThread]: 
23:51:32.722235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 00:00:27.530993 | 228ab50f-cb90-425f-aa8d-e27e91838271 ==============================
00:00:27.530993 [info ] [MainThread]: Running with dbt=1.0.0
00:00:27.535694 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"{ds}"}', log_cache_events=False, threads=None, select=['{dag_name}_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:00:27.539630 [debug] [MainThread]: Tracking: do not track
00:00:27.614787 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:00:27.689873 [debug] [MainThread]: Parsing macros/catalog.sql
00:00:27.706800 [debug] [MainThread]: Parsing macros/adapters.sql
00:00:27.757395 [debug] [MainThread]: Parsing macros/relations.sql
00:00:27.762980 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:00:27.768808 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:00:27.774381 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:00:27.780365 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:00:27.784506 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:00:27.788530 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:00:27.796583 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:00:27.821881 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:00:27.880483 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:00:27.907077 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:00:27.946254 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:00:27.966334 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:00:28.017738 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:00:28.034676 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:00:28.052444 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:00:28.060263 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:00:28.079400 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:00:28.085615 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:00:28.093423 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:00:28.105452 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:00:28.112089 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:00:28.118292 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:00:28.133006 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:00:28.185148 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:00:28.233696 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:00:28.274530 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:00:28.300367 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:00:28.307824 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:00:28.317113 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:00:28.328002 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:00:28.337227 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:00:28.345973 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:00:28.357322 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:00:28.365643 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:00:28.378103 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:00:28.397514 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:00:28.418585 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:00:28.441036 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:00:28.461348 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:00:28.480576 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:00:28.888098 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:00:28.915966 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:00:28.931693 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:00:29.201545 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:00:29.207989 [warn ] [MainThread]: The selection criterion '{dag_name}_stage' does not match any nodes
00:00:29.213970 [info ] [MainThread]: 
00:00:29.218038 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args


============================== 2021-12-27 00:00:35.534194 | 8c6375a9-9b2c-4737-b303-edc3c03834cf ==============================
00:00:35.534194 [info ] [MainThread]: Running with dbt=1.0.0
00:00:35.536438 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:00:35.540704 [debug] [MainThread]: Tracking: do not track
00:00:35.596963 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:00:35.752601 [debug] [MainThread]: Parsing macros/catalog.sql
00:00:35.762616 [debug] [MainThread]: Parsing macros/adapters.sql
00:00:35.830834 [debug] [MainThread]: Parsing macros/relations.sql
00:00:35.841336 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:00:35.858821 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:00:35.866916 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:00:35.874694 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:00:35.878600 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:00:35.882388 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:00:35.890292 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:00:35.900349 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:00:35.927736 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:00:35.934920 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:00:35.958180 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:00:35.969945 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:00:36.010641 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:00:36.018759 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:00:36.035646 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:00:36.050406 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:00:36.071930 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:00:36.077155 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:00:36.084543 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:00:36.096361 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:00:36.102921 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:00:36.112204 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:00:36.130899 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:00:36.168813 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:00:36.208241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:00:36.241619 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:00:36.271975 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:00:36.278421 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:00:36.284890 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:00:36.292689 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:00:36.298544 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:00:36.314372 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:00:36.321640 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:00:36.329746 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:00:36.345584 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:00:36.367863 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:00:36.389851 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:00:36.418566 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:00:36.446730 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:00:36.464240 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:00:36.823826 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:00:36.854259 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:00:36.865573 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:00:37.055861 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:00:37.062864 [info ] [MainThread]: 
00:00:37.067786 [debug] [MainThread]: Acquiring new postgres connection "master"
00:00:37.074135 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:00:37.094724 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:00:37.098526 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:00:37.101300 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:00:37.116349 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:00:37.123486 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:00:37.130414 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:00:37.143793 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
00:00:37.149363 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:00:37.153255 [debug] [ThreadPool]: On list_dbt_dev: Close
00:00:37.170437 [debug] [MainThread]: Using postgres connection "master"
00:00:37.173646 [debug] [MainThread]: On master: BEGIN
00:00:37.177398 [debug] [MainThread]: Opening a new connection, currently in state init
00:00:37.190727 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:00:37.196560 [debug] [MainThread]: Using postgres connection "master"
00:00:37.207563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:00:37.230873 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
00:00:37.241837 [debug] [MainThread]: On master: ROLLBACK
00:00:37.248300 [debug] [MainThread]: Using postgres connection "master"
00:00:37.252465 [debug] [MainThread]: On master: BEGIN
00:00:37.259652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:00:37.264238 [debug] [MainThread]: On master: COMMIT
00:00:37.273937 [debug] [MainThread]: Using postgres connection "master"
00:00:37.279770 [debug] [MainThread]: On master: COMMIT
00:00:37.284350 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:00:37.289111 [debug] [MainThread]: On master: Close
00:00:37.297317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:00:37.303855 [info ] [MainThread]: 
00:00:37.351715 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:00:37.354761 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
00:00:37.359123 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:00:37.366397 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:00:37.372238 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:00:37.415527 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:00:37.483932 [debug] [Thread-1  ]: finished collecting timing info
00:00:37.487819 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:00:37.580858 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:00:37.630766 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:00:37.636529 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:00:37.648564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:00:37.668491 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:00:37.681651 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:00:37.686644 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:00:37.716537 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
00:00:37.731128 [debug] [Thread-1  ]: finished collecting timing info
00:00:37.733896 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:00:37.737674 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:00:37.750769 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.39s]
00:00:37.764663 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:00:37.767524 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:00:37.771169 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:00:37.784190 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:00:37.787919 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:00:37.798455 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:00:37.817102 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:00:37.837163 [debug] [Thread-1  ]: finished collecting timing info
00:00:37.850676 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:00:37.866224 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:00:37.886941 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:00:37.898834 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:00:37.903017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:00:37.930841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
00:00:37.933952 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:00:37.936914 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:00:37.952575 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:00:37.969308 [debug] [Thread-1  ]: finished collecting timing info
00:00:37.979491 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:00:37.985262 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:00:37.990568 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.21s]
00:00:38.001761 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:00:38.015442 [debug] [MainThread]: Acquiring new postgres connection "master"
00:00:38.018629 [debug] [MainThread]: Using postgres connection "master"
00:00:38.022924 [debug] [MainThread]: On master: BEGIN
00:00:38.036466 [debug] [MainThread]: Opening a new connection, currently in state closed
00:00:38.064997 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
00:00:38.069138 [debug] [MainThread]: On master: COMMIT
00:00:38.081519 [debug] [MainThread]: Using postgres connection "master"
00:00:38.086848 [debug] [MainThread]: On master: COMMIT
00:00:38.102435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:00:38.110568 [debug] [MainThread]: On master: Close
00:00:38.125520 [info ] [MainThread]: 
00:00:38.135995 [info ] [MainThread]: Finished running 2 tests in 1.06s.
00:00:38.148800 [debug] [MainThread]: Connection 'master' was properly closed.
00:00:38.152093 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
00:00:38.264990 [info ] [MainThread]: 
00:00:38.387426 [info ] [MainThread]: [32mCompleted successfully[0m
00:00:38.413797 [info ] [MainThread]: 
00:00:38.435826 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 00:00:48.722724 | 74a4447a-eda9-45e7-9257-c61a5f67ae67 ==============================
00:00:48.722724 [info ] [MainThread]: Running with dbt=1.0.0
00:00:48.726795 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-26"}', log_cache_events=False, threads=None, select=['{dag_name}'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:00:48.731810 [debug] [MainThread]: Tracking: do not track
00:00:48.791477 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:00:48.859385 [debug] [MainThread]: Parsing macros/catalog.sql
00:00:48.874749 [debug] [MainThread]: Parsing macros/adapters.sql
00:00:48.945718 [debug] [MainThread]: Parsing macros/relations.sql
00:00:48.953051 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:00:48.967770 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:00:48.976121 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:00:48.987137 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:00:48.994600 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:00:49.001808 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:00:49.010091 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:00:49.019785 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:00:49.046378 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:00:49.053200 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:00:49.079870 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:00:49.094239 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:00:49.129627 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:00:49.137812 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:00:49.155564 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:00:49.164131 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:00:49.180079 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:00:49.185063 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:00:49.195564 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:00:49.207688 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:00:49.213872 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:00:49.219958 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:00:49.235806 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:00:49.273713 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:00:49.310729 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:00:49.342004 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:00:49.375862 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:00:49.389454 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:00:49.412685 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:00:49.430624 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:00:49.437892 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:00:49.446393 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:00:49.461222 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:00:49.483417 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:00:49.504051 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:00:49.526493 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:00:49.557224 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:00:49.591865 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:00:49.612273 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:00:49.623619 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:00:49.993169 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:00:50.025384 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:00:50.036571 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:00:50.230397 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:00:50.235157 [warn ] [MainThread]: The selection criterion '{dag_name}' does not match any nodes
00:00:50.240409 [info ] [MainThread]: 
00:00:50.244293 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args


============================== 2021-12-27 00:08:47.298813 | 2a2906ca-c2bc-4e24-bb41-6a1c6f7841dc ==============================
00:08:47.298813 [info ] [MainThread]: Running with dbt=1.0.0
00:08:47.301775 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{ds:2021-12-26}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:08:47.304330 [debug] [MainThread]: Tracking: do not track
00:08:47.368174 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:08:47.419026 [debug] [MainThread]: Parsing macros/catalog.sql
00:08:47.427482 [debug] [MainThread]: Parsing macros/adapters.sql
00:08:47.473935 [debug] [MainThread]: Parsing macros/relations.sql
00:08:47.478932 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:08:47.484394 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:08:47.491961 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:08:47.501496 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:08:47.507328 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:08:47.512086 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:08:47.521856 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:08:47.532667 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:08:47.588792 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:08:47.609068 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:08:47.652580 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:08:47.678371 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:08:47.726594 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:08:47.736686 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:08:47.755329 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:08:47.765074 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:08:47.785108 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:08:47.790163 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:08:47.801092 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:08:47.815014 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:08:47.822984 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:08:47.831274 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:08:47.848497 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:08:47.890106 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:08:47.949683 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:08:47.990062 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:08:48.030089 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:08:48.044199 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:08:48.062716 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:08:48.072110 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:08:48.079150 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:08:48.089391 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:08:48.097685 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:08:48.108641 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:08:48.123280 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:08:48.142837 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:08:48.163938 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:08:48.184940 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:08:48.203876 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:08:48.214973 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:08:48.572041 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:08:48.602532 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:08:48.622438 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:08:48.813684 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:08:48.823027 [info ] [MainThread]: 
00:08:48.828390 [debug] [MainThread]: Acquiring new postgres connection "master"
00:08:48.833417 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:08:48.852362 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:08:48.855469 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:08:48.857925 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:08:48.870731 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
00:08:48.875449 [debug] [ThreadPool]: On list_dbt: Close
00:08:48.881945 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:08:48.894412 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:08:48.897191 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:08:48.899771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:08:48.913149 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:08:48.917488 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:08:48.921035 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:08:48.929281 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:08:48.934622 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:08:48.937852 [debug] [ThreadPool]: On list_dbt_dev: Close
00:08:48.951288 [debug] [MainThread]: Using postgres connection "master"
00:08:48.954295 [debug] [MainThread]: On master: BEGIN
00:08:48.957228 [debug] [MainThread]: Opening a new connection, currently in state init
00:08:48.968991 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:08:48.973258 [debug] [MainThread]: Using postgres connection "master"
00:08:48.977258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:08:48.987752 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:08:48.994171 [debug] [MainThread]: On master: ROLLBACK
00:08:48.997179 [debug] [MainThread]: Using postgres connection "master"
00:08:48.999473 [debug] [MainThread]: On master: BEGIN
00:08:49.003230 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:08:49.006441 [debug] [MainThread]: On master: COMMIT
00:08:49.009106 [debug] [MainThread]: Using postgres connection "master"
00:08:49.011809 [debug] [MainThread]: On master: COMMIT
00:08:49.014690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:08:49.019875 [debug] [MainThread]: On master: Close
00:08:49.025977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:08:49.029944 [info ] [MainThread]: 
00:08:49.057914 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:08:49.061779 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:08:49.066007 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:08:49.069410 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:08:49.072429 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:08:49.082238 [debug] [Thread-1  ]: finished collecting timing info
00:08:49.085480 [debug] [Thread-1  ]: Compilation Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {
      "ds:2021-12-26": null
  }
  
  > in model agg_users_stage (models/staging/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/agg_users_stage.sql)
00:08:49.088721 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.02s]
00:08:49.091893 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:08:49.096790 [debug] [MainThread]: Acquiring new postgres connection "master"
00:08:49.099368 [debug] [MainThread]: Using postgres connection "master"
00:08:49.102343 [debug] [MainThread]: On master: BEGIN
00:08:49.105171 [debug] [MainThread]: Opening a new connection, currently in state closed
00:08:49.119297 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:08:49.126034 [debug] [MainThread]: On master: COMMIT
00:08:49.129155 [debug] [MainThread]: Using postgres connection "master"
00:08:49.132218 [debug] [MainThread]: On master: COMMIT
00:08:49.135337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:08:49.138192 [debug] [MainThread]: On master: Close
00:08:49.145835 [info ] [MainThread]: 
00:08:49.149827 [info ] [MainThread]: Finished running 1 table model in 0.32s.
00:08:49.153756 [debug] [MainThread]: Connection 'master' was properly closed.
00:08:49.156297 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:08:49.175387 [info ] [MainThread]: 
00:08:49.179984 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:08:49.184158 [info ] [MainThread]: 
00:08:49.188275 [error] [MainThread]: [33mCompilation Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
00:08:49.191397 [error] [MainThread]:   Required var 'ds' not found in config:
00:08:49.195289 [error] [MainThread]:   Vars supplied to agg_users_stage = {
00:08:49.199112 [error] [MainThread]:       "ds:2021-12-26": null
00:08:49.202648 [error] [MainThread]:   }
00:08:49.206039 [error] [MainThread]:   
00:08:49.209259 [error] [MainThread]:   > in model agg_users_stage (models/staging/agg_users_stage.sql)
00:08:49.212923 [error] [MainThread]:   > called by model agg_users_stage (models/staging/agg_users_stage.sql)
00:08:49.216084 [info ] [MainThread]: 
00:08:49.219001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 00:09:58.789575 | 73f8492a-3dc4-4599-a555-64f89932886f ==============================
00:09:58.789575 [info ] [MainThread]: Running with dbt=1.0.0
00:09:58.793945 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{ds:2021-12-26}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:09:58.798102 [debug] [MainThread]: Tracking: do not track
00:09:58.915599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:09:58.918632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:09:58.957469 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:09:58.963469 [info ] [MainThread]: 
00:09:58.967489 [debug] [MainThread]: Acquiring new postgres connection "master"
00:09:58.973186 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:09:58.999283 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:09:59.001816 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:09:59.004574 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:09:59.014837 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
00:09:59.020169 [debug] [ThreadPool]: On list_dbt: Close
00:09:59.032448 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:09:59.046061 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:09:59.048840 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:09:59.051233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:09:59.066934 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:09:59.070014 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:09:59.072927 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:09:59.078801 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:09:59.083196 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:09:59.086867 [debug] [ThreadPool]: On list_dbt_dev: Close
00:09:59.098951 [debug] [MainThread]: Using postgres connection "master"
00:09:59.101877 [debug] [MainThread]: On master: BEGIN
00:09:59.104971 [debug] [MainThread]: Opening a new connection, currently in state init
00:09:59.119958 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:09:59.123891 [debug] [MainThread]: Using postgres connection "master"
00:09:59.128424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:09:59.140212 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:09:59.145835 [debug] [MainThread]: On master: ROLLBACK
00:09:59.149055 [debug] [MainThread]: Using postgres connection "master"
00:09:59.151555 [debug] [MainThread]: On master: BEGIN
00:09:59.155648 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:09:59.159051 [debug] [MainThread]: On master: COMMIT
00:09:59.161545 [debug] [MainThread]: Using postgres connection "master"
00:09:59.163948 [debug] [MainThread]: On master: COMMIT
00:09:59.167353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:09:59.170053 [debug] [MainThread]: On master: Close
00:09:59.176007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:09:59.179175 [info ] [MainThread]: 
00:09:59.209549 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:09:59.212186 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:09:59.215413 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:09:59.218495 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:09:59.221426 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:09:59.230895 [debug] [Thread-1  ]: finished collecting timing info
00:09:59.234393 [debug] [Thread-1  ]: Compilation Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {
      "ds:2021-12-26": null
  }
  
  > in model agg_users_stage (models/staging/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/agg_users_stage.sql)
00:09:59.237942 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.02s]
00:09:59.241714 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:09:59.246507 [debug] [MainThread]: Acquiring new postgres connection "master"
00:09:59.249058 [debug] [MainThread]: Using postgres connection "master"
00:09:59.251714 [debug] [MainThread]: On master: BEGIN
00:09:59.254054 [debug] [MainThread]: Opening a new connection, currently in state closed
00:09:59.266469 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:09:59.270149 [debug] [MainThread]: On master: COMMIT
00:09:59.272973 [debug] [MainThread]: Using postgres connection "master"
00:09:59.276557 [debug] [MainThread]: On master: COMMIT
00:09:59.279521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:09:59.282549 [debug] [MainThread]: On master: Close
00:09:59.288162 [info ] [MainThread]: 
00:09:59.291030 [info ] [MainThread]: Finished running 1 table model in 0.32s.
00:09:59.294099 [debug] [MainThread]: Connection 'master' was properly closed.
00:09:59.296744 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:09:59.321277 [info ] [MainThread]: 
00:09:59.325563 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:09:59.328842 [info ] [MainThread]: 
00:09:59.332082 [error] [MainThread]: [33mCompilation Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
00:09:59.335163 [error] [MainThread]:   Required var 'ds' not found in config:
00:09:59.338247 [error] [MainThread]:   Vars supplied to agg_users_stage = {
00:09:59.344903 [error] [MainThread]:       "ds:2021-12-26": null
00:09:59.348640 [error] [MainThread]:   }
00:09:59.352407 [error] [MainThread]:   
00:09:59.356052 [error] [MainThread]:   > in model agg_users_stage (models/staging/agg_users_stage.sql)
00:09:59.359089 [error] [MainThread]:   > called by model agg_users_stage (models/staging/agg_users_stage.sql)
00:09:59.363482 [info ] [MainThread]: 
00:09:59.366536 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 00:11:01.063438 | 0637a1a5-1097-45ce-bfb0-a234acb1e314 ==============================
00:11:01.063438 [info ] [MainThread]: Running with dbt=1.0.0
00:11:01.075841 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-26"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:11:01.082566 [debug] [MainThread]: Tracking: do not track
00:11:01.190766 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:11:01.257465 [debug] [MainThread]: Parsing macros/catalog.sql
00:11:01.266548 [debug] [MainThread]: Parsing macros/adapters.sql
00:11:01.341750 [debug] [MainThread]: Parsing macros/relations.sql
00:11:01.350304 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:11:01.363722 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:11:01.379217 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:11:01.399248 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:11:01.408212 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:11:01.416700 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:11:01.433006 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:11:01.454747 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:11:01.494172 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:11:01.508679 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:11:01.540184 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:11:01.559333 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:11:01.612161 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:11:01.630797 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:11:01.660579 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:11:01.677801 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:11:01.727105 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:11:01.743026 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:11:01.759650 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:11:01.778867 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:11:01.786259 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:11:01.794119 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:11:01.812233 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:11:01.854510 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:11:01.897109 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:11:01.926449 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:11:01.952240 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:11:01.957915 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:11:01.964054 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:11:01.971372 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:11:01.977229 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:11:01.986881 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:11:01.994195 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:11:02.002258 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:11:02.014810 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:11:02.037772 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:11:02.064353 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:11:02.091641 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:11:02.116594 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:11:02.129206 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:11:02.491479 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:11:02.514879 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:11:02.531043 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:11:02.684698 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:11:02.690196 [info ] [MainThread]: 
00:11:02.693471 [debug] [MainThread]: Acquiring new postgres connection "master"
00:11:02.697934 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:11:02.716334 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:11:02.719658 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:11:02.723234 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:11:02.740609 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.02 seconds
00:11:02.748108 [debug] [ThreadPool]: On list_dbt: Close
00:11:02.764096 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:11:02.784357 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:11:02.788571 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:11:02.792122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:11:02.804417 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:11:02.810473 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:11:02.813215 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:11:02.829222 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:11:02.835417 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:11:02.843208 [debug] [ThreadPool]: On list_dbt_dev: Close
00:11:02.868993 [debug] [MainThread]: Using postgres connection "master"
00:11:02.873870 [debug] [MainThread]: On master: BEGIN
00:11:02.880189 [debug] [MainThread]: Opening a new connection, currently in state init
00:11:02.898195 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:11:02.901655 [debug] [MainThread]: Using postgres connection "master"
00:11:02.905480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:11:02.922908 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:11:02.928317 [debug] [MainThread]: On master: ROLLBACK
00:11:02.932590 [debug] [MainThread]: Using postgres connection "master"
00:11:02.936350 [debug] [MainThread]: On master: BEGIN
00:11:02.946416 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:11:02.950201 [debug] [MainThread]: On master: COMMIT
00:11:02.953908 [debug] [MainThread]: Using postgres connection "master"
00:11:02.957566 [debug] [MainThread]: On master: COMMIT
00:11:02.962408 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:11:02.966433 [debug] [MainThread]: On master: Close
00:11:02.972246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:11:02.978517 [info ] [MainThread]: 
00:11:03.004160 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:11:03.008148 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:11:03.011872 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:11:03.014723 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:11:03.017600 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:11:03.026972 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:11:03.036477 [debug] [Thread-1  ]: finished collecting timing info
00:11:03.039241 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:11:03.098556 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:11:03.117971 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:11:03.121203 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:11:03.125006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:11:03.138702 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:11:03.144038 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:11:03.147236 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-26' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-26'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-26'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-26'
GROUP BY 1,2,3,4,5
  );
00:11:03.164045 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.01 seconds
00:11:03.180735 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:11:03.184260 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
00:11:03.190917 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:11:03.203273 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:11:03.207169 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
00:11:03.211496 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:11:03.232191 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:11:03.234692 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:11:03.237507 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:11:03.243444 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:11:03.252600 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:11:03.255370 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
00:11:03.261435 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:11:03.265824 [debug] [Thread-1  ]: finished collecting timing info
00:11:03.268635 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:11:03.273689 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 4[0m in 0.26s]
00:11:03.277224 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:11:03.284309 [debug] [MainThread]: Acquiring new postgres connection "master"
00:11:03.287273 [debug] [MainThread]: Using postgres connection "master"
00:11:03.289456 [debug] [MainThread]: On master: BEGIN
00:11:03.291914 [debug] [MainThread]: Opening a new connection, currently in state closed
00:11:03.305231 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:11:03.308935 [debug] [MainThread]: On master: COMMIT
00:11:03.311639 [debug] [MainThread]: Using postgres connection "master"
00:11:03.314703 [debug] [MainThread]: On master: COMMIT
00:11:03.319072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:11:03.321412 [debug] [MainThread]: On master: Close
00:11:03.328514 [info ] [MainThread]: 
00:11:03.332893 [info ] [MainThread]: Finished running 1 table model in 0.64s.
00:11:03.335969 [debug] [MainThread]: Connection 'master' was properly closed.
00:11:03.338412 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:11:03.361668 [info ] [MainThread]: 
00:11:03.367305 [info ] [MainThread]: [32mCompleted successfully[0m
00:11:03.372397 [info ] [MainThread]: 
00:11:03.376931 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:11:09.121229 | 8b42bb42-b1d9-453f-8ba9-92fcb1765eb9 ==============================
00:11:09.121229 [info ] [MainThread]: Running with dbt=1.0.0
00:11:09.124182 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:11:09.127672 [debug] [MainThread]: Tracking: do not track
00:11:09.195194 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:11:09.254849 [debug] [MainThread]: Parsing macros/catalog.sql
00:11:09.263738 [debug] [MainThread]: Parsing macros/adapters.sql
00:11:09.311985 [debug] [MainThread]: Parsing macros/relations.sql
00:11:09.317476 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:11:09.323193 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:11:09.327958 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:11:09.333341 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:11:09.337695 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:11:09.342999 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:11:09.351064 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:11:09.362050 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:11:09.388289 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:11:09.393509 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:11:09.415644 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:11:09.427627 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:11:09.461332 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:11:09.469857 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:11:09.492170 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:11:09.509123 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:11:09.529394 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:11:09.535468 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:11:09.543040 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:11:09.558075 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:11:09.564366 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:11:09.571227 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:11:09.586332 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:11:09.621445 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:11:09.655089 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:11:09.680201 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:11:09.705352 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:11:09.717526 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:11:09.725726 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:11:09.734192 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:11:09.742647 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:11:09.758615 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:11:09.766713 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:11:09.775144 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:11:09.788622 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:11:09.806718 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:11:09.828616 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:11:09.851113 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:11:09.869566 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:11:09.882272 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:11:10.230970 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:11:10.259655 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:11:10.274301 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:11:10.505380 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:11:10.513057 [info ] [MainThread]: 
00:11:10.517227 [debug] [MainThread]: Acquiring new postgres connection "master"
00:11:10.523721 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:11:10.546141 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:11:10.548669 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:11:10.554710 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:11:10.573601 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:11:10.580704 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:11:10.583527 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:11:10.592583 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:11:10.600977 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:11:10.606624 [debug] [ThreadPool]: On list_dbt_dev: Close
00:11:10.629522 [debug] [MainThread]: Using postgres connection "master"
00:11:10.632310 [debug] [MainThread]: On master: BEGIN
00:11:10.637474 [debug] [MainThread]: Opening a new connection, currently in state init
00:11:10.654251 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:11:10.660525 [debug] [MainThread]: Using postgres connection "master"
00:11:10.668155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:11:10.689458 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:11:10.697267 [debug] [MainThread]: On master: ROLLBACK
00:11:10.701115 [debug] [MainThread]: Using postgres connection "master"
00:11:10.707545 [debug] [MainThread]: On master: BEGIN
00:11:10.722366 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:11:10.731095 [debug] [MainThread]: On master: COMMIT
00:11:10.736325 [debug] [MainThread]: Using postgres connection "master"
00:11:10.741578 [debug] [MainThread]: On master: COMMIT
00:11:10.749371 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:11:10.770970 [debug] [MainThread]: On master: Close
00:11:10.789530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:11:10.798968 [info ] [MainThread]: 
00:11:10.892419 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:11:10.901241 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
00:11:10.907061 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:11:10.913574 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:11:10.920753 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:11:10.966670 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:11:10.985735 [debug] [Thread-1  ]: finished collecting timing info
00:11:10.993744 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:11:11.041890 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:11:11.054664 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:11:11.059273 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:11:11.065509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:11:11.077991 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:11:11.083130 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:11:11.087547 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:11:11.091697 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:11:11.099013 [debug] [Thread-1  ]: finished collecting timing info
00:11:11.106145 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:11:11.112375 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:11:11.121878 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.21s]
00:11:11.130201 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:11:11.138692 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:11:11.144917 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:11:11.152126 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:11:11.156500 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:11:11.168827 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:11:11.199058 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:11:11.226358 [debug] [Thread-1  ]: finished collecting timing info
00:11:11.248216 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:11:11.267696 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:11:11.290524 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:11:11.299416 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:11:11.329049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:11:11.388689 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
00:11:11.399043 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:11:11.402944 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:11:11.418147 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:11:11.429965 [debug] [Thread-1  ]: finished collecting timing info
00:11:11.436185 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:11:11.445935 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:11:11.451161 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.30s]
00:11:11.465569 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:11:11.473532 [debug] [MainThread]: Acquiring new postgres connection "master"
00:11:11.477203 [debug] [MainThread]: Using postgres connection "master"
00:11:11.480674 [debug] [MainThread]: On master: BEGIN
00:11:11.483844 [debug] [MainThread]: Opening a new connection, currently in state closed
00:11:11.511122 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
00:11:11.515518 [debug] [MainThread]: On master: COMMIT
00:11:11.519002 [debug] [MainThread]: Using postgres connection "master"
00:11:11.522069 [debug] [MainThread]: On master: COMMIT
00:11:11.527221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:11:11.530103 [debug] [MainThread]: On master: Close
00:11:11.536283 [info ] [MainThread]: 
00:11:11.540582 [info ] [MainThread]: Finished running 2 tests in 1.02s.
00:11:11.553673 [debug] [MainThread]: Connection 'master' was properly closed.
00:11:11.562618 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
00:11:11.620899 [info ] [MainThread]: 
00:11:11.634997 [info ] [MainThread]: [32mCompleted successfully[0m
00:11:11.649406 [info ] [MainThread]: 
00:11:11.674717 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 00:11:20.297715 | 47112a5d-cf00-4f1a-8483-e66869ec607b ==============================
00:11:20.297715 [info ] [MainThread]: Running with dbt=1.0.0
00:11:20.300515 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-26"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:11:20.303263 [debug] [MainThread]: Tracking: do not track
00:11:20.353615 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:11:20.405021 [debug] [MainThread]: Parsing macros/catalog.sql
00:11:20.414169 [debug] [MainThread]: Parsing macros/adapters.sql
00:11:20.468160 [debug] [MainThread]: Parsing macros/relations.sql
00:11:20.473880 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:11:20.479723 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:11:20.484949 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:11:20.490442 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:11:20.494332 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:11:20.499270 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:11:20.507156 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:11:20.517568 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:11:20.543767 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:11:20.552891 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:11:20.580121 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:11:20.602323 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:11:20.640518 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:11:20.649091 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:11:20.666891 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:11:20.679312 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:11:20.695809 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:11:20.711028 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:11:20.721593 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:11:20.735560 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:11:20.744437 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:11:20.751178 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:11:20.788399 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:11:20.824071 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:11:20.858601 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:11:20.884055 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:11:20.909898 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:11:20.917056 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:11:20.922522 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:11:20.930101 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:11:20.935213 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:11:20.943322 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:11:20.950051 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:11:20.958097 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:11:20.970610 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:11:20.986692 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:11:21.014098 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:11:21.036463 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:11:21.055919 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:11:21.067554 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:11:21.508015 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:11:21.538515 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:11:21.557171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:11:21.734454 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:11:21.740542 [info ] [MainThread]: 
00:11:21.744632 [debug] [MainThread]: Acquiring new postgres connection "master"
00:11:21.750021 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:11:21.768396 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:11:21.771578 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:11:21.774622 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:11:21.785842 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
00:11:21.790143 [debug] [ThreadPool]: On list_dbt: Close
00:11:21.798548 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:11:21.820347 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:11:21.824343 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:11:21.827969 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:11:21.847112 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:11:21.850416 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:11:21.853379 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:11:21.862555 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
00:11:21.867430 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:11:21.870969 [debug] [ThreadPool]: On list_dbt_dev: Close
00:11:21.881486 [debug] [MainThread]: Using postgres connection "master"
00:11:21.888594 [debug] [MainThread]: On master: BEGIN
00:11:21.891678 [debug] [MainThread]: Opening a new connection, currently in state init
00:11:21.904392 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:11:21.908761 [debug] [MainThread]: Using postgres connection "master"
00:11:21.911536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:11:21.930764 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:11:21.943055 [debug] [MainThread]: On master: ROLLBACK
00:11:21.956730 [debug] [MainThread]: Using postgres connection "master"
00:11:21.963115 [debug] [MainThread]: On master: BEGIN
00:11:21.977670 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:11:21.980873 [debug] [MainThread]: On master: COMMIT
00:11:21.984579 [debug] [MainThread]: Using postgres connection "master"
00:11:21.988502 [debug] [MainThread]: On master: COMMIT
00:11:21.998101 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:11:22.001274 [debug] [MainThread]: On master: Close
00:11:22.009914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:11:22.015285 [info ] [MainThread]: 
00:11:22.046732 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
00:11:22.051631 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
00:11:22.061243 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
00:11:22.067503 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
00:11:22.071282 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
00:11:22.086837 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
00:11:22.103351 [debug] [Thread-1  ]: finished collecting timing info
00:11:22.109686 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
00:11:22.236407 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:11:22.242951 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp001122193730"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
00:11:22.248873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:11:22.268509 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.02 seconds
00:11:22.295598 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:11:22.299629 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
00:11:22.304904 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
00:11:22.314151 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:11:22.317994 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp001122193730'
        
      order by ordinal_position

  
00:11:22.340096 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.02 seconds
00:11:22.357010 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:11:22.362399 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:11:22.371592 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:11:22.411205 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:11:22.417152 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:11:22.434446 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
00:11:22.492185 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
00:11:22.515871 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:11:22.522925 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp001122193730"
    )
  
00:11:22.530655 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
00:11:22.572282 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:11:22.577299 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:11:22.585332 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:11:22.603572 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:11:22.618736 [debug] [Thread-1  ]: finished collecting timing info
00:11:22.628884 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
00:11:22.650209 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 4[0m in 0.59s]
00:11:22.669594 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
00:11:22.689052 [debug] [MainThread]: Acquiring new postgres connection "master"
00:11:22.698548 [debug] [MainThread]: Using postgres connection "master"
00:11:22.704360 [debug] [MainThread]: On master: BEGIN
00:11:22.711553 [debug] [MainThread]: Opening a new connection, currently in state closed
00:11:22.745987 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
00:11:22.752614 [debug] [MainThread]: On master: COMMIT
00:11:22.760138 [debug] [MainThread]: Using postgres connection "master"
00:11:22.767166 [debug] [MainThread]: On master: COMMIT
00:11:22.770419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:11:22.779214 [debug] [MainThread]: On master: Close
00:11:22.786654 [info ] [MainThread]: 
00:11:22.793867 [info ] [MainThread]: Finished running 1 incremental model in 1.04s.
00:11:22.799876 [debug] [MainThread]: Connection 'master' was properly closed.
00:11:22.802560 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
00:11:22.807785 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
00:11:22.852997 [info ] [MainThread]: 
00:11:22.857997 [info ] [MainThread]: [32mCompleted successfully[0m
00:11:22.869480 [info ] [MainThread]: 
00:11:22.877957 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:16:39.670224 | 81a74486-da2f-4026-99e1-0f8ac199c3ce ==============================
00:16:39.670224 [info ] [MainThread]: Running with dbt=1.0.0
00:16:39.673235 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"{ ds }"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:16:39.676206 [debug] [MainThread]: Tracking: do not track
00:16:39.742036 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:16:39.890155 [debug] [MainThread]: Parsing macros/catalog.sql
00:16:39.904865 [debug] [MainThread]: Parsing macros/adapters.sql
00:16:39.952326 [debug] [MainThread]: Parsing macros/relations.sql
00:16:39.958384 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:16:39.964831 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:16:39.969485 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:16:39.975450 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:16:39.981123 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:16:39.987474 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:16:39.997454 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:16:40.007842 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:16:40.033911 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:16:40.044740 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:16:40.078995 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:16:40.113951 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:16:40.164190 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:16:40.178435 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:16:40.195785 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:16:40.203386 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:16:40.218922 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:16:40.228239 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:16:40.235999 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:16:40.248499 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:16:40.256957 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:16:40.262994 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:16:40.284222 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:16:40.319720 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:16:40.361063 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:16:40.386257 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:16:40.411071 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:16:40.416912 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:16:40.422568 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:16:40.430091 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:16:40.435778 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:16:40.443432 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:16:40.450271 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:16:40.459069 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:16:40.469545 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:16:40.486050 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:16:40.506804 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:16:40.528687 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:16:40.547803 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:16:40.560081 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:16:40.894271 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:16:40.916967 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:16:40.927804 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:16:41.129094 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:16:41.134509 [info ] [MainThread]: 
00:16:41.138141 [debug] [MainThread]: Acquiring new postgres connection "master"
00:16:41.143062 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:16:41.162237 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:16:41.171756 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:16:41.174738 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:16:41.193004 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.02 seconds
00:16:41.200267 [debug] [ThreadPool]: On list_dbt: Close
00:16:41.209621 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:16:41.221009 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:16:41.223654 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:16:41.226265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:16:41.236456 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:16:41.240512 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:16:41.245075 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:16:41.255462 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
00:16:41.259773 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:16:41.263256 [debug] [ThreadPool]: On list_dbt_dev: Close
00:16:41.282371 [debug] [MainThread]: Using postgres connection "master"
00:16:41.286528 [debug] [MainThread]: On master: BEGIN
00:16:41.289694 [debug] [MainThread]: Opening a new connection, currently in state init
00:16:41.303728 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:16:41.307191 [debug] [MainThread]: Using postgres connection "master"
00:16:41.310234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:16:41.320106 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:16:41.325018 [debug] [MainThread]: On master: ROLLBACK
00:16:41.328621 [debug] [MainThread]: Using postgres connection "master"
00:16:41.332193 [debug] [MainThread]: On master: BEGIN
00:16:41.337196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:16:41.340931 [debug] [MainThread]: On master: COMMIT
00:16:41.343816 [debug] [MainThread]: Using postgres connection "master"
00:16:41.346848 [debug] [MainThread]: On master: COMMIT
00:16:41.350452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:16:41.353759 [debug] [MainThread]: On master: Close
00:16:41.359495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:16:41.363150 [info ] [MainThread]: 
00:16:41.391273 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:16:41.395125 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:16:41.398776 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:16:41.401518 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:16:41.404160 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:16:41.414065 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:16:41.422622 [debug] [Thread-1  ]: finished collecting timing info
00:16:41.425832 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:16:41.476802 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:16:41.487283 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:16:41.491590 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:16:41.495521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:16:41.509706 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:16:41.513707 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:16:41.516908 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '{ ds }' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '{ ds }'
WHERE DATE_TRUNC('day', a.created_at) <= '{ ds }'
GROUP BY 1,2,3,4,5
  );
00:16:41.523153 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: "{ ds }"
LINE 19:     AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
                                                    ^

00:16:41.528619 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: ROLLBACK
00:16:41.533216 [debug] [Thread-1  ]: finished collecting timing info
00:16:41.537247 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:16:41.542095 [debug] [Thread-1  ]: Database Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  invalid input syntax for type timestamp: "{ ds }"
  LINE 19:     AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
                                                      ^
  compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
00:16:41.548928 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.15s]
00:16:41.553612 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:16:41.560887 [debug] [MainThread]: Acquiring new postgres connection "master"
00:16:41.564520 [debug] [MainThread]: Using postgres connection "master"
00:16:41.567789 [debug] [MainThread]: On master: BEGIN
00:16:41.570926 [debug] [MainThread]: Opening a new connection, currently in state closed
00:16:41.582367 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:16:41.586674 [debug] [MainThread]: On master: COMMIT
00:16:41.589594 [debug] [MainThread]: Using postgres connection "master"
00:16:41.592996 [debug] [MainThread]: On master: COMMIT
00:16:41.596389 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:16:41.599242 [debug] [MainThread]: On master: Close
00:16:41.604950 [info ] [MainThread]: 
00:16:41.608780 [info ] [MainThread]: Finished running 1 table model in 0.47s.
00:16:41.614254 [debug] [MainThread]: Connection 'master' was properly closed.
00:16:41.618316 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:16:41.643840 [info ] [MainThread]: 
00:16:41.648210 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:16:41.652572 [info ] [MainThread]: 
00:16:41.656953 [error] [MainThread]: [33mDatabase Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
00:16:41.662009 [error] [MainThread]:   invalid input syntax for type timestamp: "{ ds }"
00:16:41.665756 [error] [MainThread]:   LINE 19:     AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
00:16:41.668983 [error] [MainThread]:                                                       ^
00:16:41.674367 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
00:16:41.678004 [info ] [MainThread]: 
00:16:41.681631 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 00:20:39.660114 | ca9cd579-be72-4753-86f2-51f00d9ad9f7 ==============================
00:20:39.660114 [info ] [MainThread]: Running with dbt=1.0.0
00:20:39.666268 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"{ ds }"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:20:39.670535 [debug] [MainThread]: Tracking: do not track
00:20:39.809027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:20:39.812880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:20:39.855512 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:20:39.862707 [info ] [MainThread]: 
00:20:39.869251 [debug] [MainThread]: Acquiring new postgres connection "master"
00:20:39.876405 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:20:39.895128 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:20:39.898006 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:20:39.900961 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:20:39.913524 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.01 seconds
00:20:39.917775 [debug] [ThreadPool]: On list_dbt: Close
00:20:39.925028 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:20:39.939934 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:20:39.942940 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:20:39.945984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:20:39.956925 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:20:39.961157 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:20:39.964024 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:20:39.969699 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:20:39.974509 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:20:39.977836 [debug] [ThreadPool]: On list_dbt_dev: Close
00:20:39.991077 [debug] [MainThread]: Using postgres connection "master"
00:20:39.994067 [debug] [MainThread]: On master: BEGIN
00:20:39.996702 [debug] [MainThread]: Opening a new connection, currently in state init
00:20:40.008451 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:20:40.014054 [debug] [MainThread]: Using postgres connection "master"
00:20:40.017835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:20:40.029871 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:20:40.037001 [debug] [MainThread]: On master: ROLLBACK
00:20:40.041032 [debug] [MainThread]: Using postgres connection "master"
00:20:40.043667 [debug] [MainThread]: On master: BEGIN
00:20:40.048113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:20:40.051309 [debug] [MainThread]: On master: COMMIT
00:20:40.053973 [debug] [MainThread]: Using postgres connection "master"
00:20:40.057809 [debug] [MainThread]: On master: COMMIT
00:20:40.061331 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:20:40.064474 [debug] [MainThread]: On master: Close
00:20:40.070699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:20:40.074482 [info ] [MainThread]: 
00:20:40.099844 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:20:40.103398 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:20:40.106672 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:20:40.109287 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:20:40.112246 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:20:40.122103 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:20:40.131042 [debug] [Thread-1  ]: finished collecting timing info
00:20:40.134095 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:20:40.194337 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:20:40.217453 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:20:40.221709 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:20:40.236092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:20:40.260788 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
00:20:40.294479 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:20:40.357084 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '{ ds }' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '{ ds }'
WHERE DATE_TRUNC('day', a.created_at) <= '{ ds }'
GROUP BY 1,2,3,4,5
  );
00:20:40.400366 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: "{ ds }"
LINE 19:     AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
                                                    ^

00:20:40.409295 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: ROLLBACK
00:20:40.414162 [debug] [Thread-1  ]: finished collecting timing info
00:20:40.418329 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:20:40.424224 [debug] [Thread-1  ]: Database Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  invalid input syntax for type timestamp: "{ ds }"
  LINE 19:     AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
                                                      ^
  compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
00:20:40.433847 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.33s]
00:20:40.441914 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:20:40.450808 [debug] [MainThread]: Acquiring new postgres connection "master"
00:20:40.456111 [debug] [MainThread]: Using postgres connection "master"
00:20:40.460244 [debug] [MainThread]: On master: BEGIN
00:20:40.475044 [debug] [MainThread]: Opening a new connection, currently in state closed
00:20:40.497543 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:20:40.506225 [debug] [MainThread]: On master: COMMIT
00:20:40.509938 [debug] [MainThread]: Using postgres connection "master"
00:20:40.513598 [debug] [MainThread]: On master: COMMIT
00:20:40.517541 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:20:40.521918 [debug] [MainThread]: On master: Close
00:20:40.526950 [info ] [MainThread]: 
00:20:40.534352 [info ] [MainThread]: Finished running 1 table model in 0.66s.
00:20:40.538972 [debug] [MainThread]: Connection 'master' was properly closed.
00:20:40.543184 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:20:40.578156 [info ] [MainThread]: 
00:20:40.583213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:20:40.588406 [info ] [MainThread]: 
00:20:40.592940 [error] [MainThread]: [33mDatabase Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
00:20:40.598703 [error] [MainThread]:   invalid input syntax for type timestamp: "{ ds }"
00:20:40.603551 [error] [MainThread]:   LINE 19:     AND DATE_TRUNC('day', b.created_at) <= '{ ds }'
00:20:40.606903 [error] [MainThread]:                                                       ^
00:20:40.610432 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
00:20:40.613658 [info ] [MainThread]: 
00:20:40.617417 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 00:21:54.137622 | 31d1ac07-1b34-4f82-a14f-11bece9296b6 ==============================
00:21:54.137622 [info ] [MainThread]: Running with dbt=1.0.0
00:21:54.141097 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:21:54.145124 [debug] [MainThread]: Tracking: do not track
00:21:54.189580 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:21:54.311808 [debug] [MainThread]: Parsing macros/catalog.sql
00:21:54.322951 [debug] [MainThread]: Parsing macros/adapters.sql
00:21:54.385838 [debug] [MainThread]: Parsing macros/relations.sql
00:21:54.400637 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:21:54.415153 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:21:54.422703 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:21:54.427722 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:21:54.433069 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:21:54.437300 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:21:54.445146 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:21:54.465951 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:21:54.495335 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:21:54.502548 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:21:54.527274 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:21:54.541374 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:21:54.583321 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:21:54.599323 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:21:54.619294 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:21:54.628215 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:21:54.651685 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:21:54.659590 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:21:54.672630 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:21:54.692510 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:21:54.707178 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:21:54.714198 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:21:54.735322 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:21:54.777393 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:21:54.844559 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:21:54.880104 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:21:54.905397 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:21:54.916746 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:21:54.923231 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:21:54.930394 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:21:54.935936 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:21:54.943877 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:21:54.950390 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:21:54.960293 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:21:54.972264 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:21:54.991543 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:21:55.012776 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:21:55.033791 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:21:55.053478 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:21:55.065307 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:21:55.434318 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:21:55.456656 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:21:55.467209 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:21:55.630276 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:21:55.635231 [info ] [MainThread]: 
00:21:55.638997 [debug] [MainThread]: Acquiring new postgres connection "master"
00:21:55.643893 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:21:55.663791 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:21:55.666843 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:21:55.670055 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:21:55.687506 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.02 seconds
00:21:55.696840 [debug] [ThreadPool]: On list_dbt: Close
00:21:55.708873 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:21:55.726490 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:21:55.730253 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:21:55.735670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:21:55.751894 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:21:55.758546 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:21:55.762370 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:21:55.773798 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
00:21:55.783332 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:21:55.787268 [debug] [ThreadPool]: On list_dbt_dev: Close
00:21:55.804906 [debug] [MainThread]: Using postgres connection "master"
00:21:55.808241 [debug] [MainThread]: On master: BEGIN
00:21:55.811936 [debug] [MainThread]: Opening a new connection, currently in state init
00:21:55.828966 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:21:55.833011 [debug] [MainThread]: Using postgres connection "master"
00:21:55.837082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:21:55.853750 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:21:55.862558 [debug] [MainThread]: On master: ROLLBACK
00:21:55.873099 [debug] [MainThread]: Using postgres connection "master"
00:21:55.880003 [debug] [MainThread]: On master: BEGIN
00:21:55.891129 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:21:55.896076 [debug] [MainThread]: On master: COMMIT
00:21:55.901508 [debug] [MainThread]: Using postgres connection "master"
00:21:55.904935 [debug] [MainThread]: On master: COMMIT
00:21:55.908569 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:21:55.911689 [debug] [MainThread]: On master: Close
00:21:55.916329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:21:55.919973 [info ] [MainThread]: 
00:21:55.960397 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:21:55.965071 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:21:55.970744 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:21:55.974520 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:21:55.978631 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:21:55.993898 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:21:56.005340 [debug] [Thread-1  ]: finished collecting timing info
00:21:56.009836 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:21:56.099725 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:21:56.113021 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:21:56.117932 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:21:56.122571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:21:56.145011 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:21:56.149996 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:21:56.154273 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
00:21:56.173506 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
00:21:56.197426 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:21:56.200815 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
00:21:56.205207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:21:56.214055 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:21:56.218529 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
00:21:56.223004 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:21:56.254308 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:21:56.258083 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:21:56.261663 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:21:56.267920 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:21:56.278792 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:21:56.283655 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
00:21:56.290153 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:21:56.297168 [debug] [Thread-1  ]: finished collecting timing info
00:21:56.301353 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:21:56.311162 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 5[0m in 0.34s]
00:21:56.315057 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:21:56.320549 [debug] [MainThread]: Acquiring new postgres connection "master"
00:21:56.323821 [debug] [MainThread]: Using postgres connection "master"
00:21:56.327033 [debug] [MainThread]: On master: BEGIN
00:21:56.330157 [debug] [MainThread]: Opening a new connection, currently in state closed
00:21:56.347298 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:21:56.351917 [debug] [MainThread]: On master: COMMIT
00:21:56.356283 [debug] [MainThread]: Using postgres connection "master"
00:21:56.362730 [debug] [MainThread]: On master: COMMIT
00:21:56.368898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:21:56.373354 [debug] [MainThread]: On master: Close
00:21:56.377915 [info ] [MainThread]: 
00:21:56.383513 [info ] [MainThread]: Finished running 1 table model in 0.74s.
00:21:56.387790 [debug] [MainThread]: Connection 'master' was properly closed.
00:21:56.392363 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:21:56.430894 [info ] [MainThread]: 
00:21:56.438665 [info ] [MainThread]: [32mCompleted successfully[0m
00:21:56.445611 [info ] [MainThread]: 
00:21:56.450608 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:22:02.434944 | 1386f54f-ba84-4daa-89f1-c78bb10282e0 ==============================
00:22:02.434944 [info ] [MainThread]: Running with dbt=1.0.0
00:22:02.441769 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:22:02.448085 [debug] [MainThread]: Tracking: do not track
00:22:02.538553 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:22:02.642264 [debug] [MainThread]: Parsing macros/catalog.sql
00:22:02.657982 [debug] [MainThread]: Parsing macros/adapters.sql
00:22:02.722314 [debug] [MainThread]: Parsing macros/relations.sql
00:22:02.739048 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:22:02.746963 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:22:02.767219 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:22:02.791417 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:22:02.809344 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:22:02.816240 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:22:02.850758 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:22:02.868103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:22:02.958246 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:22:02.967918 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:22:03.030075 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:22:03.051083 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:22:03.097043 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:22:03.112107 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:22:03.137060 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:22:03.161147 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:22:03.218805 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:22:03.234950 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:22:03.303217 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:22:03.355011 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:22:03.373792 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:22:03.404057 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:22:03.450337 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:22:03.677768 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:22:03.772862 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:22:03.818906 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:22:03.878687 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:22:03.924608 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:22:03.949541 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:22:03.978639 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:22:03.995676 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:22:04.007157 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:22:04.014624 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:22:04.023927 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:22:04.038907 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:22:04.062743 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:22:04.083910 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:22:04.106478 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:22:04.126527 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:22:04.138605 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:22:04.491142 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:22:04.519025 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:22:04.535561 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:22:04.720366 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:22:04.725857 [info ] [MainThread]: 
00:22:04.729685 [debug] [MainThread]: Acquiring new postgres connection "master"
00:22:04.734980 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:22:04.753113 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:22:04.755821 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:22:04.758477 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:22:04.768282 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:22:04.771295 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:22:04.773879 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:22:04.779946 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:22:04.784705 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:22:04.788393 [debug] [ThreadPool]: On list_dbt_dev: Close
00:22:04.802580 [debug] [MainThread]: Using postgres connection "master"
00:22:04.805473 [debug] [MainThread]: On master: BEGIN
00:22:04.808224 [debug] [MainThread]: Opening a new connection, currently in state init
00:22:04.821815 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:22:04.825458 [debug] [MainThread]: Using postgres connection "master"
00:22:04.828638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:22:04.839787 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:22:04.843966 [debug] [MainThread]: On master: ROLLBACK
00:22:04.847679 [debug] [MainThread]: Using postgres connection "master"
00:22:04.850302 [debug] [MainThread]: On master: BEGIN
00:22:04.853179 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:22:04.856813 [debug] [MainThread]: On master: COMMIT
00:22:04.859466 [debug] [MainThread]: Using postgres connection "master"
00:22:04.861639 [debug] [MainThread]: On master: COMMIT
00:22:04.864491 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:22:04.867245 [debug] [MainThread]: On master: Close
00:22:04.875017 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:22:04.880369 [info ] [MainThread]: 
00:22:04.906892 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:22:04.910050 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
00:22:04.912988 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:22:04.916815 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:22:04.919790 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:22:04.940137 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:22:04.947506 [debug] [Thread-1  ]: finished collecting timing info
00:22:04.949906 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:22:04.978370 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:22:04.988017 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:22:04.992718 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:22:04.996740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:22:05.012688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:22:05.016030 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:22:05.019277 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:22:05.024112 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:22:05.034399 [debug] [Thread-1  ]: finished collecting timing info
00:22:05.037876 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:22:05.042293 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:22:05.047355 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.13s]
00:22:05.052605 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:22:05.055930 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:22:05.060661 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:22:05.065021 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:22:05.067801 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:22:05.071751 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:22:05.080293 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:22:05.088347 [debug] [Thread-1  ]: finished collecting timing info
00:22:05.092411 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:22:05.098380 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:22:05.107701 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:22:05.110705 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:22:05.113835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:22:05.139807 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
00:22:05.143219 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:22:05.145774 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:22:05.150203 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:22:05.155034 [debug] [Thread-1  ]: finished collecting timing info
00:22:05.159030 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:22:05.163207 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:22:05.166685 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.10s]
00:22:05.173840 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:22:05.181482 [debug] [MainThread]: Acquiring new postgres connection "master"
00:22:05.186381 [debug] [MainThread]: Using postgres connection "master"
00:22:05.190587 [debug] [MainThread]: On master: BEGIN
00:22:05.194603 [debug] [MainThread]: Opening a new connection, currently in state closed
00:22:05.212421 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:22:05.218577 [debug] [MainThread]: On master: COMMIT
00:22:05.222144 [debug] [MainThread]: Using postgres connection "master"
00:22:05.224677 [debug] [MainThread]: On master: COMMIT
00:22:05.227737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:22:05.230730 [debug] [MainThread]: On master: Close
00:22:05.235628 [info ] [MainThread]: 
00:22:05.240933 [info ] [MainThread]: Finished running 2 tests in 0.51s.
00:22:05.246300 [debug] [MainThread]: Connection 'master' was properly closed.
00:22:05.248850 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
00:22:05.269824 [info ] [MainThread]: 
00:22:05.273750 [info ] [MainThread]: [32mCompleted successfully[0m
00:22:05.277297 [info ] [MainThread]: 
00:22:05.282558 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 00:22:10.982398 | 0e84017a-970a-4ad8-99e7-d6fefecc6ba0 ==============================
00:22:10.982398 [info ] [MainThread]: Running with dbt=1.0.0
00:22:10.984505 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:22:10.988362 [debug] [MainThread]: Tracking: do not track
00:22:11.052658 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:22:11.123412 [debug] [MainThread]: Parsing macros/catalog.sql
00:22:11.132611 [debug] [MainThread]: Parsing macros/adapters.sql
00:22:11.181677 [debug] [MainThread]: Parsing macros/relations.sql
00:22:11.187269 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:22:11.193294 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:22:11.199347 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:22:11.206597 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:22:11.214711 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:22:11.219935 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:22:11.229705 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:22:11.244902 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:22:11.270871 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:22:11.276358 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:22:11.297978 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:22:11.309215 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:22:11.345033 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:22:11.355048 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:22:11.373770 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:22:11.385049 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:22:11.418869 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:22:11.430363 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:22:11.443989 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:22:11.456416 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:22:11.462384 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:22:11.467867 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:22:11.482656 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:22:11.518661 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:22:11.558757 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:22:11.586523 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:22:11.617190 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:22:11.623505 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:22:11.629188 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:22:11.636606 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:22:11.641917 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:22:11.649748 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:22:11.662480 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:22:11.670685 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:22:11.683485 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:22:11.705908 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:22:11.728059 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:22:11.749362 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:22:11.767910 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:22:11.778550 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:22:12.138889 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:22:12.160347 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:22:12.170408 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:22:12.365424 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:22:12.373914 [info ] [MainThread]: 
00:22:12.379035 [debug] [MainThread]: Acquiring new postgres connection "master"
00:22:12.385245 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:22:12.402903 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:22:12.405771 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:22:12.408448 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:22:12.419795 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.01 seconds
00:22:12.428411 [debug] [ThreadPool]: On list_dbt: Close
00:22:12.437866 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:22:12.458782 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:22:12.462538 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:22:12.466555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:22:12.480482 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:22:12.486736 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:22:12.490046 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:22:12.497254 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:22:12.505200 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:22:12.509608 [debug] [ThreadPool]: On list_dbt_dev: Close
00:22:12.522900 [debug] [MainThread]: Using postgres connection "master"
00:22:12.525932 [debug] [MainThread]: On master: BEGIN
00:22:12.528462 [debug] [MainThread]: Opening a new connection, currently in state init
00:22:12.547077 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:22:12.549975 [debug] [MainThread]: Using postgres connection "master"
00:22:12.553529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:22:12.568967 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:22:12.573667 [debug] [MainThread]: On master: ROLLBACK
00:22:12.577062 [debug] [MainThread]: Using postgres connection "master"
00:22:12.579726 [debug] [MainThread]: On master: BEGIN
00:22:12.584524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:22:12.588716 [debug] [MainThread]: On master: COMMIT
00:22:12.592395 [debug] [MainThread]: Using postgres connection "master"
00:22:12.596090 [debug] [MainThread]: On master: COMMIT
00:22:12.600201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:22:12.602601 [debug] [MainThread]: On master: Close
00:22:12.609788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:22:12.612932 [info ] [MainThread]: 
00:22:12.637849 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
00:22:12.641646 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
00:22:12.646939 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
00:22:12.650282 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
00:22:12.653917 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
00:22:12.660497 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
00:22:12.669777 [debug] [Thread-1  ]: finished collecting timing info
00:22:12.672687 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
00:22:12.762028 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:22:12.764712 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp002212732161"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
00:22:12.768003 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:22:12.785017 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
00:22:12.804717 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:22:12.807790 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
00:22:12.811518 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
00:22:12.815561 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:22:12.819014 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp002212732161'
        
      order by ordinal_position

  
00:22:12.836253 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
00:22:12.846736 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:22:12.849542 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:22:12.856396 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:22:12.877763 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:22:12.880670 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:22:12.886886 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:22:12.903900 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
00:22:12.913732 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:22:12.918272 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp002212732161"
    )
  
00:22:12.925660 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
00:22:12.947171 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:22:12.950820 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:22:12.954257 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:22:12.960347 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:22:12.963925 [debug] [Thread-1  ]: finished collecting timing info
00:22:12.967055 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
00:22:12.975437 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 5[0m in 0.33s]
00:22:12.979181 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
00:22:12.985987 [debug] [MainThread]: Acquiring new postgres connection "master"
00:22:12.989383 [debug] [MainThread]: Using postgres connection "master"
00:22:12.992894 [debug] [MainThread]: On master: BEGIN
00:22:12.996712 [debug] [MainThread]: Opening a new connection, currently in state closed
00:22:13.012895 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:22:13.016638 [debug] [MainThread]: On master: COMMIT
00:22:13.019299 [debug] [MainThread]: Using postgres connection "master"
00:22:13.021975 [debug] [MainThread]: On master: COMMIT
00:22:13.024972 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:22:13.027918 [debug] [MainThread]: On master: Close
00:22:13.032250 [info ] [MainThread]: 
00:22:13.036837 [info ] [MainThread]: Finished running 1 incremental model in 0.65s.
00:22:13.040658 [debug] [MainThread]: Connection 'master' was properly closed.
00:22:13.045325 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
00:22:13.066314 [info ] [MainThread]: 
00:22:13.071373 [info ] [MainThread]: [32mCompleted successfully[0m
00:22:13.075338 [info ] [MainThread]: 
00:22:13.078967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:27:40.367926 | 3f496b94-6ab2-44f4-b2cf-10bd6ca08b48 ==============================
00:27:40.367926 [info ] [MainThread]: Running with dbt=1.0.0
00:27:40.370292 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8000, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
00:27:40.371221 [debug] [MainThread]: Tracking: tracking
00:27:40.404344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60ff7c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60ff7c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff60ff7ca90>]}
00:27:40.419908 [info ] [MainThread]: Serving docs at 0.0.0.0:8000
00:27:40.421477 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8000
00:27:40.422753 [info ] [MainThread]: 
00:27:40.423315 [info ] [MainThread]: 
00:27:40.423719 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-27 00:31:16.960248 | b5443409-506d-4f14-a08c-46186bc80e48 ==============================
00:31:16.960248 [info ] [MainThread]: Running with dbt=1.0.0
00:31:16.966422 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:31:16.972685 [debug] [MainThread]: Tracking: do not track
00:31:17.125394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:31:17.127996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:31:17.177195 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:31:17.185761 [info ] [MainThread]: 
00:31:17.191044 [debug] [MainThread]: Acquiring new postgres connection "master"
00:31:17.195948 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:31:17.216535 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:31:17.226001 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:31:17.233506 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:31:17.260830 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.03 seconds
00:31:17.265348 [debug] [ThreadPool]: On list_dbt: Close
00:31:17.275942 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:31:17.290578 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:31:17.294067 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:31:17.296926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:31:17.306631 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:31:17.310873 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:31:17.313861 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:31:17.321333 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:31:17.326243 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:31:17.329468 [debug] [ThreadPool]: On list_dbt_dev: Close
00:31:17.341750 [debug] [MainThread]: Using postgres connection "master"
00:31:17.344683 [debug] [MainThread]: On master: BEGIN
00:31:17.348020 [debug] [MainThread]: Opening a new connection, currently in state init
00:31:17.360352 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:31:17.365349 [debug] [MainThread]: Using postgres connection "master"
00:31:17.371092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:31:17.394811 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:31:17.399303 [debug] [MainThread]: On master: ROLLBACK
00:31:17.402850 [debug] [MainThread]: Using postgres connection "master"
00:31:17.407515 [debug] [MainThread]: On master: BEGIN
00:31:17.415077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:31:17.419547 [debug] [MainThread]: On master: COMMIT
00:31:17.422895 [debug] [MainThread]: Using postgres connection "master"
00:31:17.429447 [debug] [MainThread]: On master: COMMIT
00:31:17.432865 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:31:17.435922 [debug] [MainThread]: On master: Close
00:31:17.448913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:31:17.453250 [info ] [MainThread]: 
00:31:17.482356 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:31:17.485213 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:31:17.497542 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:31:17.504896 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:31:17.509814 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:31:17.525248 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:31:17.572081 [debug] [Thread-1  ]: finished collecting timing info
00:31:17.582312 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:31:17.675385 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:31:17.688277 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:31:17.692224 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:31:17.696060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:31:17.718932 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:31:17.725218 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:31:17.729885 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
00:31:17.748284 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
00:31:17.766812 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:31:17.769922 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
00:31:17.774964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:31:17.783756 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:31:17.786454 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
00:31:17.789649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:31:17.809791 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:31:17.812896 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:31:17.815530 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:31:17.821226 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:31:17.837467 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:31:17.840767 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
00:31:17.850469 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
00:31:17.855687 [debug] [Thread-1  ]: finished collecting timing info
00:31:17.859390 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:31:17.864637 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 5[0m in 0.37s]
00:31:17.869341 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:31:17.876357 [debug] [MainThread]: Acquiring new postgres connection "master"
00:31:17.880623 [debug] [MainThread]: Using postgres connection "master"
00:31:17.884639 [debug] [MainThread]: On master: BEGIN
00:31:17.887484 [debug] [MainThread]: Opening a new connection, currently in state closed
00:31:17.902930 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:31:17.906971 [debug] [MainThread]: On master: COMMIT
00:31:17.910699 [debug] [MainThread]: Using postgres connection "master"
00:31:17.914921 [debug] [MainThread]: On master: COMMIT
00:31:17.918834 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:31:17.931610 [debug] [MainThread]: On master: Close
00:31:17.948330 [info ] [MainThread]: 
00:31:17.954121 [info ] [MainThread]: Finished running 1 table model in 0.76s.
00:31:17.960451 [debug] [MainThread]: Connection 'master' was properly closed.
00:31:17.963044 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:31:18.032441 [info ] [MainThread]: 
00:31:18.037099 [info ] [MainThread]: [32mCompleted successfully[0m
00:31:18.041367 [info ] [MainThread]: 
00:31:18.045459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:31:24.797718 | 2d3268d5-b27f-4a7c-898f-feef1265ca50 ==============================
00:31:24.797718 [info ] [MainThread]: Running with dbt=1.0.0
00:31:24.813245 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:31:24.844806 [debug] [MainThread]: Tracking: do not track
00:31:25.025021 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:31:25.097349 [debug] [MainThread]: Parsing macros/catalog.sql
00:31:25.105798 [debug] [MainThread]: Parsing macros/adapters.sql
00:31:25.158475 [debug] [MainThread]: Parsing macros/relations.sql
00:31:25.164064 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:31:25.170558 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:31:25.174962 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:31:25.180897 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:31:25.185064 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:31:25.189288 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:31:25.197213 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:31:25.208709 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:31:25.241826 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:31:25.248934 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:31:25.279830 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:31:25.300371 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:31:25.343882 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:31:25.353129 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:31:25.373985 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:31:25.393349 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:31:25.431165 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:31:25.446852 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:31:25.465629 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:31:25.519936 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:31:25.535118 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:31:25.552114 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:31:25.579519 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:31:25.639125 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:31:25.706437 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:31:25.747442 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:31:25.789341 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:31:25.798290 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:31:25.816412 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:31:25.828233 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:31:25.836023 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:31:25.847122 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:31:25.856875 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:31:25.867993 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:31:25.883072 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:31:25.904551 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:31:25.931601 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:31:25.958230 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:31:25.982564 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:31:26.001242 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:31:26.434715 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:31:26.459125 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:31:26.469746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:31:26.747060 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:31:26.754429 [info ] [MainThread]: 
00:31:26.758730 [debug] [MainThread]: Acquiring new postgres connection "master"
00:31:26.766318 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:31:26.795088 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:31:26.799126 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:31:26.816909 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:31:26.832884 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:31:26.836320 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:31:26.839171 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:31:26.846270 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:31:26.851067 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:31:26.854522 [debug] [ThreadPool]: On list_dbt_dev: Close
00:31:26.864863 [debug] [MainThread]: Using postgres connection "master"
00:31:26.867864 [debug] [MainThread]: On master: BEGIN
00:31:26.870393 [debug] [MainThread]: Opening a new connection, currently in state init
00:31:26.882869 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:31:26.886007 [debug] [MainThread]: Using postgres connection "master"
00:31:26.889287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:31:26.904947 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:31:26.908864 [debug] [MainThread]: On master: ROLLBACK
00:31:26.911838 [debug] [MainThread]: Using postgres connection "master"
00:31:26.914208 [debug] [MainThread]: On master: BEGIN
00:31:26.918358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:31:26.921831 [debug] [MainThread]: On master: COMMIT
00:31:26.924194 [debug] [MainThread]: Using postgres connection "master"
00:31:26.926918 [debug] [MainThread]: On master: COMMIT
00:31:26.930275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:31:26.933276 [debug] [MainThread]: On master: Close
00:31:26.936379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:31:26.939592 [info ] [MainThread]: 
00:31:26.963967 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:31:26.966626 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
00:31:26.970023 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:31:26.973896 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:31:26.977046 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:31:26.996151 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:31:27.004371 [debug] [Thread-1  ]: finished collecting timing info
00:31:27.008730 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:31:27.039102 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:31:27.046964 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:31:27.050000 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:31:27.052250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:31:27.067840 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:31:27.075028 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:31:27.079967 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:31:27.085265 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:31:27.097142 [debug] [Thread-1  ]: finished collecting timing info
00:31:27.100975 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:31:27.105329 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:31:27.110606 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.14s]
00:31:27.115056 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:31:27.119129 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:31:27.122148 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:31:27.125719 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:31:27.128733 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:31:27.131428 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:31:27.146146 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:31:27.164071 [debug] [Thread-1  ]: finished collecting timing info
00:31:27.168543 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:31:27.182838 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:31:27.193825 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:31:27.196880 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:31:27.199918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:31:27.213120 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:31:27.217395 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:31:27.222303 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:31:27.229205 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:31:27.240798 [debug] [Thread-1  ]: finished collecting timing info
00:31:27.245287 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:31:27.253106 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:31:27.257997 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.13s]
00:31:27.263420 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:31:27.325924 [debug] [MainThread]: Acquiring new postgres connection "master"
00:31:27.349507 [debug] [MainThread]: Using postgres connection "master"
00:31:27.354866 [debug] [MainThread]: On master: BEGIN
00:31:27.371013 [debug] [MainThread]: Opening a new connection, currently in state closed
00:31:27.386803 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:31:27.392950 [debug] [MainThread]: On master: COMMIT
00:31:27.396104 [debug] [MainThread]: Using postgres connection "master"
00:31:27.399392 [debug] [MainThread]: On master: COMMIT
00:31:27.404100 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:31:27.407667 [debug] [MainThread]: On master: Close
00:31:27.413905 [info ] [MainThread]: 
00:31:27.418778 [info ] [MainThread]: Finished running 2 tests in 0.66s.
00:31:27.423932 [debug] [MainThread]: Connection 'master' was properly closed.
00:31:27.427754 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
00:31:27.452903 [info ] [MainThread]: 
00:31:27.458063 [info ] [MainThread]: [32mCompleted successfully[0m
00:31:27.465651 [info ] [MainThread]: 
00:31:27.472189 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 00:31:33.397045 | ade5de1e-1baf-4b9a-8edc-c25520bcc8bb ==============================
00:31:33.397045 [info ] [MainThread]: Running with dbt=1.0.0
00:31:33.399140 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:31:33.402211 [debug] [MainThread]: Tracking: do not track
00:31:33.454840 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:31:33.533221 [debug] [MainThread]: Parsing macros/catalog.sql
00:31:33.549153 [debug] [MainThread]: Parsing macros/adapters.sql
00:31:33.598149 [debug] [MainThread]: Parsing macros/relations.sql
00:31:33.603817 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:31:33.609200 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:31:33.613452 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:31:33.618548 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:31:33.622052 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:31:33.628607 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:31:33.637703 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:31:33.648003 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:31:33.674638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:31:33.679712 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:31:33.701810 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:31:33.714271 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:31:33.753072 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:31:33.767586 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:31:33.787071 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:31:33.797389 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:31:33.817354 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:31:33.826534 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:31:33.844255 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:31:33.870436 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:31:33.877053 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:31:33.883519 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:31:33.917415 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:31:34.028028 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:31:34.061442 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:31:34.086375 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:31:34.118133 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:31:34.123809 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:31:34.129042 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:31:34.136390 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:31:34.141926 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:31:34.149515 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:31:34.157177 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:31:34.165349 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:31:34.177198 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:31:34.194383 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:31:34.216002 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:31:34.237780 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:31:34.256792 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:31:34.268656 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:31:34.671849 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:31:34.698323 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:31:34.710871 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:31:34.912860 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:31:34.919729 [info ] [MainThread]: 
00:31:34.924945 [debug] [MainThread]: Acquiring new postgres connection "master"
00:31:34.930365 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:31:34.953346 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:31:34.956786 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:31:34.960055 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:31:34.975908 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.02 seconds
00:31:34.980408 [debug] [ThreadPool]: On list_dbt: Close
00:31:34.991621 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:31:35.004682 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:31:35.008367 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:31:35.012718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:31:35.033792 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:31:35.037992 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:31:35.041810 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:31:35.051012 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
00:31:35.057640 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:31:35.061740 [debug] [ThreadPool]: On list_dbt_dev: Close
00:31:35.077082 [debug] [MainThread]: Using postgres connection "master"
00:31:35.080639 [debug] [MainThread]: On master: BEGIN
00:31:35.087278 [debug] [MainThread]: Opening a new connection, currently in state init
00:31:35.106820 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:31:35.111578 [debug] [MainThread]: Using postgres connection "master"
00:31:35.115809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:31:35.127444 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:31:35.136186 [debug] [MainThread]: On master: ROLLBACK
00:31:35.141322 [debug] [MainThread]: Using postgres connection "master"
00:31:35.146228 [debug] [MainThread]: On master: BEGIN
00:31:35.152204 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:31:35.156680 [debug] [MainThread]: On master: COMMIT
00:31:35.160486 [debug] [MainThread]: Using postgres connection "master"
00:31:35.164467 [debug] [MainThread]: On master: COMMIT
00:31:35.172561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:31:35.175514 [debug] [MainThread]: On master: Close
00:31:35.178948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:31:35.184982 [info ] [MainThread]: 
00:31:35.217091 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
00:31:35.220805 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
00:31:35.226775 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
00:31:35.230456 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
00:31:35.234167 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
00:31:35.241104 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
00:31:35.249898 [debug] [Thread-1  ]: finished collecting timing info
00:31:35.252668 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
00:31:35.335035 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:31:35.337752 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp003135306026"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
00:31:35.340191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:31:35.354483 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
00:31:35.369297 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:31:35.373229 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
00:31:35.378750 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
00:31:35.384123 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:31:35.388160 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp003135306026'
        
      order by ordinal_position

  
00:31:35.410411 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.02 seconds
00:31:35.429633 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:31:35.435172 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:31:35.446000 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
00:31:35.460138 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:31:35.464724 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:31:35.471851 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:31:35.487997 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
00:31:35.496068 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:31:35.498813 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp003135306026"
    )
  
00:31:35.502263 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
00:31:35.517741 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:31:35.521115 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:31:35.523667 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:31:35.528173 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:31:35.531582 [debug] [Thread-1  ]: finished collecting timing info
00:31:35.534590 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
00:31:35.538045 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 5[0m in 0.31s]
00:31:35.547449 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
00:31:35.553143 [debug] [MainThread]: Acquiring new postgres connection "master"
00:31:35.555606 [debug] [MainThread]: Using postgres connection "master"
00:31:35.559094 [debug] [MainThread]: On master: BEGIN
00:31:35.561980 [debug] [MainThread]: Opening a new connection, currently in state closed
00:31:35.577003 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:31:35.580391 [debug] [MainThread]: On master: COMMIT
00:31:35.582978 [debug] [MainThread]: Using postgres connection "master"
00:31:35.585843 [debug] [MainThread]: On master: COMMIT
00:31:35.589695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:31:35.592396 [debug] [MainThread]: On master: Close
00:31:35.596065 [info ] [MainThread]: 
00:31:35.600568 [info ] [MainThread]: Finished running 1 incremental model in 0.67s.
00:31:35.604137 [debug] [MainThread]: Connection 'master' was properly closed.
00:31:35.607049 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
00:31:35.628701 [info ] [MainThread]: 
00:31:35.632937 [info ] [MainThread]: [32mCompleted successfully[0m
00:31:35.636617 [info ] [MainThread]: 
00:31:35.640237 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:34:45.665135 | 7c0449ba-c1f7-4e49-8929-0ac44be9433a ==============================
00:34:45.665135 [info ] [MainThread]: Running with dbt=1.0.0
00:34:45.668559 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:34:45.671361 [debug] [MainThread]: Tracking: do not track
00:34:45.801248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:34:45.804543 [debug] [MainThread]: Partial parsing: updated file: bungie_dwh://models/example/agg_users.sql
00:34:45.826689 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:34:45.912878 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:34:45.919904 [info ] [MainThread]: 
00:34:45.924133 [debug] [MainThread]: Acquiring new postgres connection "master"
00:34:45.928488 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:34:45.948145 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:34:45.951149 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:34:45.953799 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:34:45.965399 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.01 seconds
00:34:45.970230 [debug] [ThreadPool]: On list_dbt: Close
00:34:45.978271 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:34:45.997974 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:34:46.004404 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:34:46.008649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:34:46.025964 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:34:46.029323 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:34:46.032323 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:34:46.038544 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:34:46.043454 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:34:46.046977 [debug] [ThreadPool]: On list_dbt_dev: Close
00:34:46.093280 [debug] [MainThread]: Using postgres connection "master"
00:34:46.096032 [debug] [MainThread]: On master: BEGIN
00:34:46.098663 [debug] [MainThread]: Opening a new connection, currently in state init
00:34:46.114086 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:34:46.118080 [debug] [MainThread]: Using postgres connection "master"
00:34:46.120456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:34:46.130814 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:34:46.134939 [debug] [MainThread]: On master: ROLLBACK
00:34:46.144831 [debug] [MainThread]: Using postgres connection "master"
00:34:46.149476 [debug] [MainThread]: On master: BEGIN
00:34:46.156028 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:34:46.160330 [debug] [MainThread]: On master: COMMIT
00:34:46.167563 [debug] [MainThread]: Using postgres connection "master"
00:34:46.171036 [debug] [MainThread]: On master: COMMIT
00:34:46.176051 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:34:46.182750 [debug] [MainThread]: On master: Close
00:34:46.191848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:34:46.200842 [info ] [MainThread]: 
00:34:46.230579 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:34:46.233961 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:34:46.237438 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:34:46.240312 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:34:46.243406 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:34:46.253245 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:34:46.263176 [debug] [Thread-1  ]: finished collecting timing info
00:34:46.266969 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:34:46.319427 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:34:46.334210 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:34:46.338901 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:34:46.341924 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:34:46.353799 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:34:46.357007 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:34:46.359969 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
00:34:46.371989 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
00:34:46.389479 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:34:46.393002 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
00:34:46.396689 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:34:46.403543 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:34:46.407551 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
00:34:46.411559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:34:46.432326 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:34:46.435389 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:34:46.438274 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:34:46.443442 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:34:46.453806 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:34:46.456895 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
00:34:46.462416 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:34:46.467573 [debug] [Thread-1  ]: finished collecting timing info
00:34:46.470807 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:34:46.476963 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 5[0m in 0.24s]
00:34:46.483275 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:34:46.494589 [debug] [MainThread]: Acquiring new postgres connection "master"
00:34:46.498857 [debug] [MainThread]: Using postgres connection "master"
00:34:46.502809 [debug] [MainThread]: On master: BEGIN
00:34:46.506321 [debug] [MainThread]: Opening a new connection, currently in state closed
00:34:46.521228 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:34:46.526992 [debug] [MainThread]: On master: COMMIT
00:34:46.532182 [debug] [MainThread]: Using postgres connection "master"
00:34:46.535588 [debug] [MainThread]: On master: COMMIT
00:34:46.539764 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:34:46.543386 [debug] [MainThread]: On master: Close
00:34:46.547277 [info ] [MainThread]: 
00:34:46.553729 [info ] [MainThread]: Finished running 1 table model in 0.62s.
00:34:46.557346 [debug] [MainThread]: Connection 'master' was properly closed.
00:34:46.559971 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:34:46.584200 [info ] [MainThread]: 
00:34:46.588253 [info ] [MainThread]: [32mCompleted successfully[0m
00:34:46.592503 [info ] [MainThread]: 
00:34:46.597320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:34:52.038321 | 31ede62d-001f-4409-99eb-f7dbf8dca52e ==============================
00:34:52.038321 [info ] [MainThread]: Running with dbt=1.0.0
00:34:52.040820 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:34:52.044001 [debug] [MainThread]: Tracking: do not track
00:34:52.102084 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:34:52.203607 [debug] [MainThread]: Parsing macros/catalog.sql
00:34:52.219562 [debug] [MainThread]: Parsing macros/adapters.sql
00:34:52.274858 [debug] [MainThread]: Parsing macros/relations.sql
00:34:52.283026 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:34:52.295774 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:34:52.302253 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:34:52.311433 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:34:52.317148 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:34:52.324910 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:34:52.336541 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:34:52.354562 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:34:52.380654 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:34:52.386235 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:34:52.408997 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:34:52.419401 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:34:52.454988 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:34:52.463062 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:34:52.480174 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:34:52.492938 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:34:52.514954 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:34:52.520575 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:34:52.528469 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:34:52.541002 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:34:52.547192 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:34:52.563914 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:34:52.586776 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:34:52.632066 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:34:52.685311 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:34:52.724470 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:34:52.749647 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:34:52.755148 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:34:52.760326 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:34:52.767920 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:34:52.778422 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:34:52.793094 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:34:52.805858 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:34:52.813473 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:34:52.825164 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:34:52.841561 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:34:52.862712 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:34:52.883148 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:34:52.905011 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:34:52.915884 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:34:53.283586 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:34:53.308966 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:34:53.325028 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:34:53.487427 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:34:53.493419 [info ] [MainThread]: 
00:34:53.499182 [debug] [MainThread]: Acquiring new postgres connection "master"
00:34:53.504667 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:34:53.522661 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:34:53.526308 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:34:53.529503 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:34:53.542063 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:34:53.546743 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:34:53.551242 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:34:53.561019 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
00:34:53.565888 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:34:53.568775 [debug] [ThreadPool]: On list_dbt_dev: Close
00:34:53.596064 [debug] [MainThread]: Using postgres connection "master"
00:34:53.600780 [debug] [MainThread]: On master: BEGIN
00:34:53.603322 [debug] [MainThread]: Opening a new connection, currently in state init
00:34:53.631441 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
00:34:53.635044 [debug] [MainThread]: Using postgres connection "master"
00:34:53.638748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:34:53.673026 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
00:34:53.678794 [debug] [MainThread]: On master: ROLLBACK
00:34:53.690705 [debug] [MainThread]: Using postgres connection "master"
00:34:53.693200 [debug] [MainThread]: On master: BEGIN
00:34:53.708851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:34:53.712459 [debug] [MainThread]: On master: COMMIT
00:34:53.715940 [debug] [MainThread]: Using postgres connection "master"
00:34:53.720109 [debug] [MainThread]: On master: COMMIT
00:34:53.723312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:34:53.727172 [debug] [MainThread]: On master: Close
00:34:53.731331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:34:53.737145 [info ] [MainThread]: 
00:34:53.785903 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:34:53.791098 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
00:34:53.796367 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:34:53.801990 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:34:53.811931 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:34:53.860636 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:34:53.879202 [debug] [Thread-1  ]: finished collecting timing info
00:34:53.886968 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:34:53.930637 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:34:53.951249 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:34:53.958016 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:34:53.962785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:34:53.986915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:34:53.992041 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:34:53.996263 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:34:54.005164 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:34:54.013776 [debug] [Thread-1  ]: finished collecting timing info
00:34:54.027302 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:34:54.037966 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:34:54.044414 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.25s]
00:34:54.060677 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:34:54.068857 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:34:54.075412 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:34:54.079896 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:34:54.085303 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:34:54.089262 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:34:54.108385 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:34:54.121578 [debug] [Thread-1  ]: finished collecting timing info
00:34:54.128537 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:34:54.136901 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:34:54.149019 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:34:54.155451 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:34:54.159966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:34:54.176433 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:34:54.182365 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:34:54.187543 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:34:54.194218 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:34:54.201849 [debug] [Thread-1  ]: finished collecting timing info
00:34:54.205141 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:34:54.209180 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:34:54.214480 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.13s]
00:34:54.222136 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:34:54.227495 [debug] [MainThread]: Acquiring new postgres connection "master"
00:34:54.230852 [debug] [MainThread]: Using postgres connection "master"
00:34:54.234963 [debug] [MainThread]: On master: BEGIN
00:34:54.238400 [debug] [MainThread]: Opening a new connection, currently in state closed
00:34:54.258834 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:34:54.263075 [debug] [MainThread]: On master: COMMIT
00:34:54.267283 [debug] [MainThread]: Using postgres connection "master"
00:34:54.271605 [debug] [MainThread]: On master: COMMIT
00:34:54.276163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:34:54.280274 [debug] [MainThread]: On master: Close
00:34:54.287381 [info ] [MainThread]: 
00:34:54.292293 [info ] [MainThread]: Finished running 2 tests in 0.79s.
00:34:54.297072 [debug] [MainThread]: Connection 'master' was properly closed.
00:34:54.301226 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
00:34:54.331316 [info ] [MainThread]: 
00:34:54.335820 [info ] [MainThread]: [32mCompleted successfully[0m
00:34:54.342759 [info ] [MainThread]: 
00:34:54.347851 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 00:35:00.607555 | c5a88c90-be5e-4dfd-abe2-d2c616a48a6e ==============================
00:35:00.607555 [info ] [MainThread]: Running with dbt=1.0.0
00:35:00.610066 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:35:00.615176 [debug] [MainThread]: Tracking: do not track
00:35:00.698200 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:35:00.751513 [debug] [MainThread]: Parsing macros/catalog.sql
00:35:00.760209 [debug] [MainThread]: Parsing macros/adapters.sql
00:35:00.812288 [debug] [MainThread]: Parsing macros/relations.sql
00:35:00.817519 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:35:00.823817 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:35:00.828202 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:35:00.833769 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:35:00.837484 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:35:00.841541 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:35:00.848668 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:35:00.864436 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:35:00.889710 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:35:00.894894 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:35:00.916266 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:35:00.926874 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:35:00.960939 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:35:00.969037 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:35:00.985358 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:35:01.002155 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:35:01.023973 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:35:01.030009 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:35:01.037284 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:35:01.048448 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:35:01.055756 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:35:01.069458 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:35:01.089889 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:35:01.139214 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:35:01.183116 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:35:01.218691 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:35:01.251241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:35:01.257435 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:35:01.263774 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:35:01.272493 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:35:01.278389 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:35:01.287332 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:35:01.294429 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:35:01.303414 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:35:01.314342 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:35:01.335515 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:35:01.371043 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:35:01.397564 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:35:01.419533 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:35:01.431420 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:35:01.794490 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:35:01.823382 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:35:01.833548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:35:01.998952 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:35:02.003997 [info ] [MainThread]: 
00:35:02.007460 [debug] [MainThread]: Acquiring new postgres connection "master"
00:35:02.012748 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:35:02.031063 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:35:02.034407 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:35:02.038134 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:35:02.052922 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.01 seconds
00:35:02.058666 [debug] [ThreadPool]: On list_dbt: Close
00:35:02.071510 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:35:02.083377 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:35:02.086276 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:35:02.088897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:35:02.103583 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:35:02.107250 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:35:02.109904 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:35:02.116388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:35:02.121182 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:35:02.124977 [debug] [ThreadPool]: On list_dbt_dev: Close
00:35:02.135902 [debug] [MainThread]: Using postgres connection "master"
00:35:02.138855 [debug] [MainThread]: On master: BEGIN
00:35:02.141795 [debug] [MainThread]: Opening a new connection, currently in state init
00:35:02.152807 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:35:02.157151 [debug] [MainThread]: Using postgres connection "master"
00:35:02.160158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:35:02.173103 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:35:02.178199 [debug] [MainThread]: On master: ROLLBACK
00:35:02.181379 [debug] [MainThread]: Using postgres connection "master"
00:35:02.184229 [debug] [MainThread]: On master: BEGIN
00:35:02.188954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:35:02.192485 [debug] [MainThread]: On master: COMMIT
00:35:02.200952 [debug] [MainThread]: Using postgres connection "master"
00:35:02.205020 [debug] [MainThread]: On master: COMMIT
00:35:02.209328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:35:02.213450 [debug] [MainThread]: On master: Close
00:35:02.218638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:35:02.224052 [info ] [MainThread]: 
00:35:02.255812 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
00:35:02.259528 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
00:35:02.264451 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
00:35:02.271089 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
00:35:02.274374 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
00:35:02.282510 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
00:35:02.291894 [debug] [Thread-1  ]: finished collecting timing info
00:35:02.297807 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
00:35:02.389915 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:35:02.393400 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp003502361676"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
00:35:02.397770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:35:02.417131 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
00:35:02.436224 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:35:02.439902 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
00:35:02.445261 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
00:35:02.449546 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:35:02.453385 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp003502361676'
        
      order by ordinal_position

  
00:35:02.464699 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
00:35:02.475059 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:35:02.477744 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:35:02.485197 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:35:02.500607 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:35:02.503173 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:35:02.509263 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:35:02.525553 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
00:35:02.533789 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:35:02.537377 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (dt) in (
        select (dt)
        from "agg_users__dbt_tmp003502361676"
    );
    

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp003502361676"
    )
  
00:35:02.541721 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
00:35:02.556663 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:35:02.560059 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:35:02.562693 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:35:02.567477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:35:02.571442 [debug] [Thread-1  ]: finished collecting timing info
00:35:02.575955 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
00:35:02.581352 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 5[0m in 0.32s]
00:35:02.585113 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
00:35:02.603102 [debug] [MainThread]: Acquiring new postgres connection "master"
00:35:02.607893 [debug] [MainThread]: Using postgres connection "master"
00:35:02.611545 [debug] [MainThread]: On master: BEGIN
00:35:02.617304 [debug] [MainThread]: Opening a new connection, currently in state closed
00:35:02.634388 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:35:02.640055 [debug] [MainThread]: On master: COMMIT
00:35:02.646040 [debug] [MainThread]: Using postgres connection "master"
00:35:02.651885 [debug] [MainThread]: On master: COMMIT
00:35:02.658968 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:35:02.665939 [debug] [MainThread]: On master: Close
00:35:02.682415 [info ] [MainThread]: 
00:35:02.689329 [info ] [MainThread]: Finished running 1 incremental model in 0.68s.
00:35:02.700421 [debug] [MainThread]: Connection 'master' was properly closed.
00:35:02.711712 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
00:35:02.759314 [info ] [MainThread]: 
00:35:02.768087 [info ] [MainThread]: [32mCompleted successfully[0m
00:35:02.776014 [info ] [MainThread]: 
00:35:02.783871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:45:54.608191 | 50e5a256-6a03-4f16-9121-7920fa052322 ==============================
00:45:54.608191 [info ] [MainThread]: Running with dbt=1.0.0
00:45:54.610817 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:45:54.614729 [debug] [MainThread]: Tracking: do not track
00:45:54.725540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:45:54.731289 [debug] [MainThread]: Partial parsing: update schema file: bungie_dwh://models/staging/schema.yml
00:45:54.766352 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:45:54.802613 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:45:54.933534 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:45:54.940817 [info ] [MainThread]: 
00:45:54.944701 [debug] [MainThread]: Acquiring new postgres connection "master"
00:45:54.949949 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:45:55.003037 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:45:55.006960 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:45:55.010649 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:45:55.026881 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.02 seconds
00:45:55.032951 [debug] [ThreadPool]: On list_dbt: Close
00:45:55.041341 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:45:55.053129 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:45:55.055851 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:45:55.058681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:45:55.071842 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:45:55.080521 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:45:55.084498 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:45:55.093210 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:45:55.100460 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:45:55.104487 [debug] [ThreadPool]: On list_dbt_dev: Close
00:45:55.118163 [debug] [MainThread]: Using postgres connection "master"
00:45:55.120813 [debug] [MainThread]: On master: BEGIN
00:45:55.123584 [debug] [MainThread]: Opening a new connection, currently in state init
00:45:55.133769 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:45:55.137432 [debug] [MainThread]: Using postgres connection "master"
00:45:55.140254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:45:55.151416 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:45:55.156204 [debug] [MainThread]: On master: ROLLBACK
00:45:55.159402 [debug] [MainThread]: Using postgres connection "master"
00:45:55.161943 [debug] [MainThread]: On master: BEGIN
00:45:55.165500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:45:55.169797 [debug] [MainThread]: On master: COMMIT
00:45:55.172905 [debug] [MainThread]: Using postgres connection "master"
00:45:55.176194 [debug] [MainThread]: On master: COMMIT
00:45:55.179967 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:45:55.183687 [debug] [MainThread]: On master: Close
00:45:55.190283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:45:55.193182 [info ] [MainThread]: 
00:45:55.219485 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:45:55.224509 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:45:55.230707 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:45:55.234526 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:45:55.239167 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:45:55.255442 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:45:55.265765 [debug] [Thread-1  ]: finished collecting timing info
00:45:55.271250 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:45:55.343768 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:45:55.353923 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:45:55.357336 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:45:55.360409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:45:55.373288 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:45:55.376615 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:45:55.380618 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
00:45:55.395197 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
00:45:55.407986 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:45:55.411417 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
00:45:55.416148 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:45:55.422691 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:45:55.426772 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
00:45:55.431144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:45:55.453139 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:45:55.455806 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:45:55.458678 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:45:55.464273 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:45:55.476296 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:45:55.481187 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
00:45:55.490136 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:45:55.497476 [debug] [Thread-1  ]: finished collecting timing info
00:45:55.500993 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:45:55.507378 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 5[0m in 0.28s]
00:45:55.511475 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:45:55.516031 [debug] [MainThread]: Acquiring new postgres connection "master"
00:45:55.518594 [debug] [MainThread]: Using postgres connection "master"
00:45:55.521307 [debug] [MainThread]: On master: BEGIN
00:45:55.524221 [debug] [MainThread]: Opening a new connection, currently in state closed
00:45:55.534193 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:45:55.537571 [debug] [MainThread]: On master: COMMIT
00:45:55.540534 [debug] [MainThread]: Using postgres connection "master"
00:45:55.543350 [debug] [MainThread]: On master: COMMIT
00:45:55.547559 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:45:55.551277 [debug] [MainThread]: On master: Close
00:45:55.556649 [info ] [MainThread]: 
00:45:55.560227 [info ] [MainThread]: Finished running 1 table model in 0.61s.
00:45:55.563652 [debug] [MainThread]: Connection 'master' was properly closed.
00:45:55.566697 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:45:55.596749 [info ] [MainThread]: 
00:45:55.601002 [info ] [MainThread]: [32mCompleted successfully[0m
00:45:55.610923 [info ] [MainThread]: 
00:45:55.617359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:46:01.477285 | 13060ad6-5d4d-4a2c-9f40-932b3dfee09b ==============================
00:46:01.477285 [info ] [MainThread]: Running with dbt=1.0.0
00:46:01.482132 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:46:01.486711 [debug] [MainThread]: Tracking: do not track
00:46:01.592106 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:46:01.659986 [debug] [MainThread]: Parsing macros/catalog.sql
00:46:01.674127 [debug] [MainThread]: Parsing macros/adapters.sql
00:46:01.750576 [debug] [MainThread]: Parsing macros/relations.sql
00:46:01.759827 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:46:01.776078 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:46:01.787212 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:46:01.809468 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:46:01.819792 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:46:01.830203 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:46:01.855850 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:46:01.904174 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:46:01.949308 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:46:01.955158 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:46:01.985055 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:46:02.000383 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:46:02.046781 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:46:02.057659 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:46:02.078096 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:46:02.087890 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:46:02.107918 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:46:02.114485 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:46:02.123351 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:46:02.138254 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:46:02.152674 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:46:02.162180 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:46:02.179833 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:46:02.221957 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:46:02.264478 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:46:02.294101 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:46:02.323037 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:46:02.330912 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:46:02.338104 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:46:02.347461 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:46:02.354181 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:46:02.364973 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:46:02.347675 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:46:02.358278 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:46:02.372434 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:46:02.394262 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:46:02.418725 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:46:02.444341 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:46:02.464675 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:46:02.475308 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:46:02.844575 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:46:02.866915 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:46:02.876380 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:46:03.051536 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:46:03.056935 [info ] [MainThread]: 
00:46:03.060174 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:03.065134 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:46:03.083513 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:03.086212 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:46:03.088716 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:03.104157 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:46:03.108172 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:03.113232 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:46:03.121012 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:46:03.128036 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:46:03.131461 [debug] [ThreadPool]: On list_dbt_dev: Close
00:46:03.144516 [debug] [MainThread]: Using postgres connection "master"
00:46:03.147437 [debug] [MainThread]: On master: BEGIN
00:46:03.150289 [debug] [MainThread]: Opening a new connection, currently in state init
00:46:03.161958 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:03.167436 [debug] [MainThread]: Using postgres connection "master"
00:46:03.171206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:46:03.182013 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:46:03.187294 [debug] [MainThread]: On master: ROLLBACK
00:46:03.190964 [debug] [MainThread]: Using postgres connection "master"
00:46:03.193727 [debug] [MainThread]: On master: BEGIN
00:46:03.198010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:46:03.202261 [debug] [MainThread]: On master: COMMIT
00:46:03.205880 [debug] [MainThread]: Using postgres connection "master"
00:46:03.208961 [debug] [MainThread]: On master: COMMIT
00:46:03.212141 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:03.214951 [debug] [MainThread]: On master: Close
00:46:03.220376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:46:03.223886 [info ] [MainThread]: 
00:46:03.251689 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:03.254512 [info ] [Thread-1  ]: 1 of 3 START test not_null_agg_users_stage_dt................................... [RUN]
00:46:03.258267 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:03.265595 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:03.271395 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:03.294167 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:03.303990 [debug] [Thread-1  ]: finished collecting timing info
00:46:03.307006 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:03.361687 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:03.371316 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:03.377277 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:46:03.380667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:03.398105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:46:03.403128 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:03.406282 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:46:03.410463 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:46:03.425059 [debug] [Thread-1  ]: finished collecting timing info
00:46:03.428328 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:46:03.432199 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:46:03.441139 [info ] [Thread-1  ]: 1 of 3 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.18s]
00:46:03.446745 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:03.451406 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:03.455489 [info ] [Thread-1  ]: 2 of 3 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:46:03.463023 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:03.465617 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:03.468548 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:03.478446 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:03.487096 [debug] [Thread-1  ]: finished collecting timing info
00:46:03.489727 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:03.495202 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:03.505814 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:03.508912 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:46:03.512146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:03.523384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:46:03.527608 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:03.530598 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:46:03.534638 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:46:03.539307 [debug] [Thread-1  ]: finished collecting timing info
00:46:03.541986 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:46:03.545227 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:46:03.549528 [info ] [Thread-1  ]: 2 of 3 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.09s]
00:46:03.553321 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:03.556058 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:03.558764 [info ] [Thread-1  ]: 3 of 3 START test unique_agg_users_stage_user_id................................ [RUN]
00:46:03.562033 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:03.565216 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:03.600686 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:03.657146 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:03.683516 [debug] [Thread-1  ]: finished collecting timing info
00:46:03.688076 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:03.697182 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:03.710115 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:03.713566 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: BEGIN
00:46:03.718690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:03.739229 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:46:03.742677 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:03.746434 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."agg_users_stage"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
00:46:03.754610 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:46:03.762040 [debug] [Thread-1  ]: finished collecting timing info
00:46:03.765409 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: ROLLBACK
00:46:03.772833 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: Close
00:46:03.776471 [info ] [Thread-1  ]: 3 of 3 PASS unique_agg_users_stage_user_id...................................... [[32mPASS[0m in 0.21s]
00:46:03.781399 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:03.787589 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:03.790383 [debug] [MainThread]: Using postgres connection "master"
00:46:03.793381 [debug] [MainThread]: On master: BEGIN
00:46:03.795935 [debug] [MainThread]: Opening a new connection, currently in state closed
00:46:03.811199 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:03.814871 [debug] [MainThread]: On master: COMMIT
00:46:03.817990 [debug] [MainThread]: Using postgres connection "master"
00:46:03.820744 [debug] [MainThread]: On master: COMMIT
00:46:03.824366 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:03.826979 [debug] [MainThread]: On master: Close
00:46:03.830478 [info ] [MainThread]: 
00:46:03.834816 [info ] [MainThread]: Finished running 3 tests in 0.77s.
00:46:03.838208 [debug] [MainThread]: Connection 'master' was properly closed.
00:46:03.840723 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6' was properly closed.
00:46:03.862744 [info ] [MainThread]: 
00:46:03.869242 [info ] [MainThread]: [32mCompleted successfully[0m
00:46:03.883062 [info ] [MainThread]: 
00:46:03.890368 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3


============================== 2021-12-27 00:46:09.151384 | 72eeb196-69ba-4cbc-a0a1-2d99ff28d1f9 ==============================
00:46:09.151384 [info ] [MainThread]: Running with dbt=1.0.0
00:46:09.155502 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:46:09.159981 [debug] [MainThread]: Tracking: do not track
00:46:09.221311 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:46:09.282299 [debug] [MainThread]: Parsing macros/catalog.sql
00:46:09.297707 [debug] [MainThread]: Parsing macros/adapters.sql
00:46:09.350747 [debug] [MainThread]: Parsing macros/relations.sql
00:46:09.360082 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:46:09.368659 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:46:09.373237 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:46:09.378383 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:46:09.382619 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:46:09.387034 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:46:09.395267 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:46:09.407433 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:46:09.433819 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:46:09.439406 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:46:09.461845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:46:09.475525 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:46:09.510372 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:46:09.524306 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:46:09.540271 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:46:09.558760 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:46:09.591296 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:46:09.603979 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:46:09.618266 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:46:09.642452 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:46:09.653932 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:46:09.666057 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:46:09.685136 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:46:09.723549 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:46:09.766044 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:46:09.799075 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:46:09.824374 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:46:09.835283 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:46:09.846688 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:46:09.854490 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:46:09.860097 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:46:09.868347 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:46:09.875474 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:46:09.883535 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:46:09.907086 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:46:09.936256 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:46:09.964538 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:46:09.993132 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:46:10.012281 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:46:10.025086 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:46:10.365582 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:46:10.386507 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:46:10.402736 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:46:10.580811 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:46:10.588642 [info ] [MainThread]: 
00:46:10.593287 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:10.599264 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:46:10.616706 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:46:10.619640 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:46:10.622571 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:10.637996 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.02 seconds
00:46:10.645676 [debug] [ThreadPool]: On list_dbt: Close
00:46:10.653595 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:46:10.672904 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:10.676561 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:46:10.680729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:46:10.694226 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:46:10.698633 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:10.702254 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:46:10.708947 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:46:10.717085 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:46:10.720564 [debug] [ThreadPool]: On list_dbt_dev: Close
00:46:10.738960 [debug] [MainThread]: Using postgres connection "master"
00:46:10.742270 [debug] [MainThread]: On master: BEGIN
00:46:10.745262 [debug] [MainThread]: Opening a new connection, currently in state init
00:46:10.756735 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:10.760542 [debug] [MainThread]: Using postgres connection "master"
00:46:10.763669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:46:10.802203 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
00:46:10.810639 [debug] [MainThread]: On master: ROLLBACK
00:46:10.814501 [debug] [MainThread]: Using postgres connection "master"
00:46:10.817481 [debug] [MainThread]: On master: BEGIN
00:46:10.822332 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:46:10.841490 [debug] [MainThread]: On master: COMMIT
00:46:10.846314 [debug] [MainThread]: Using postgres connection "master"
00:46:10.849184 [debug] [MainThread]: On master: COMMIT
00:46:10.852427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:10.857194 [debug] [MainThread]: On master: Close
00:46:10.865277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:46:10.870335 [info ] [MainThread]: 
00:46:10.912984 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
00:46:10.916307 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
00:46:10.922045 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
00:46:10.926415 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
00:46:10.929313 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
00:46:10.944487 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
00:46:10.957254 [debug] [Thread-1  ]: finished collecting timing info
00:46:10.961108 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
00:46:11.069265 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:46:11.074852 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp004611035787"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
00:46:11.079251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:11.102970 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
00:46:11.131287 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:46:11.136963 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
00:46:11.145237 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
00:46:11.152817 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:46:11.160208 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp004611035787'
        
      order by ordinal_position

  
00:46:11.189075 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.02 seconds
00:46:11.210350 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:46:11.215471 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:46:11.235683 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
00:46:11.276819 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:46:11.280767 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:46:11.293105 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
00:46:11.332563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
00:46:11.344016 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:46:11.349749 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (dt) in (
        select (dt)
        from "agg_users__dbt_tmp004611035787"
    );
    

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp004611035787"
    )
  
00:46:11.356785 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
00:46:11.386915 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:46:11.390405 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:46:11.394408 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:46:11.400593 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:46:11.406662 [debug] [Thread-1  ]: finished collecting timing info
00:46:11.411628 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
00:46:11.416914 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 5[0m in 0.49s]
00:46:11.426748 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
00:46:11.435126 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:11.437617 [debug] [MainThread]: Using postgres connection "master"
00:46:11.442084 [debug] [MainThread]: On master: BEGIN
00:46:11.445373 [debug] [MainThread]: Opening a new connection, currently in state closed
00:46:11.457508 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:11.462263 [debug] [MainThread]: On master: COMMIT
00:46:11.466295 [debug] [MainThread]: Using postgres connection "master"
00:46:11.470523 [debug] [MainThread]: On master: COMMIT
00:46:11.473618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:11.478977 [debug] [MainThread]: On master: Close
00:46:11.483756 [info ] [MainThread]: 
00:46:11.487618 [info ] [MainThread]: Finished running 1 incremental model in 0.89s.
00:46:11.492588 [debug] [MainThread]: Connection 'master' was properly closed.
00:46:11.496059 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
00:46:11.517439 [info ] [MainThread]: 
00:46:11.521355 [info ] [MainThread]: [32mCompleted successfully[0m
00:46:11.524631 [info ] [MainThread]: 
00:46:11.528185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:46:48.752704 | ddf9bea4-bba9-4e4a-9299-3a83e4f10551 ==============================
00:46:48.752704 [info ] [MainThread]: Running with dbt=1.0.0
00:46:48.754795 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:46:48.760200 [debug] [MainThread]: Tracking: do not track
00:46:48.947637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:46:48.955049 [debug] [MainThread]: Partial parsing: update schema file: bungie_dwh://models/staging/schema.yml
00:46:48.999398 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:46:49.049985 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:46:49.195806 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:46:49.201699 [info ] [MainThread]: 
00:46:49.205789 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:49.212618 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:46:49.283606 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:46:49.288096 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:46:49.291500 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:49.310464 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.02 seconds
00:46:49.318726 [debug] [ThreadPool]: On list_dbt: Close
00:46:49.327123 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:46:49.339048 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:49.341942 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:46:49.344576 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:49.355406 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:46:49.358778 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:49.361971 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:46:49.367745 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:46:49.375721 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:46:49.380397 [debug] [ThreadPool]: On list_dbt_dev: Close
00:46:49.392463 [debug] [MainThread]: Using postgres connection "master"
00:46:49.395199 [debug] [MainThread]: On master: BEGIN
00:46:49.398143 [debug] [MainThread]: Opening a new connection, currently in state init
00:46:49.409406 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:49.413676 [debug] [MainThread]: Using postgres connection "master"
00:46:49.416970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:46:49.430435 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:46:49.435000 [debug] [MainThread]: On master: ROLLBACK
00:46:49.438737 [debug] [MainThread]: Using postgres connection "master"
00:46:49.441829 [debug] [MainThread]: On master: BEGIN
00:46:49.448205 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:46:49.452192 [debug] [MainThread]: On master: COMMIT
00:46:49.456311 [debug] [MainThread]: Using postgres connection "master"
00:46:49.459731 [debug] [MainThread]: On master: COMMIT
00:46:49.463643 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:49.466830 [debug] [MainThread]: On master: Close
00:46:49.473197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:46:49.476999 [info ] [MainThread]: 
00:46:49.509364 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:46:49.519891 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:46:49.527074 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:46:49.530428 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:46:49.534544 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:46:49.548482 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:46:49.558979 [debug] [Thread-1  ]: finished collecting timing info
00:46:49.562742 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:46:49.646177 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:46:49.678207 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:46:49.690151 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:46:49.695060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:49.722609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
00:46:49.726782 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:46:49.732075 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
00:46:49.754493 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.02 seconds
00:46:49.795794 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:46:49.799983 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
00:46:49.805875 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:46:49.814511 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:46:49.819334 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
00:46:49.824530 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:46:49.864710 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:46:49.868843 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:46:49.872107 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:46:49.883675 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:46:49.899884 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:46:49.903510 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
00:46:49.922189 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
00:46:49.953626 [debug] [Thread-1  ]: finished collecting timing info
00:46:49.960514 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:46:49.978224 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 5[0m in 0.45s]
00:46:49.987795 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:46:50.004876 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:50.009854 [debug] [MainThread]: Using postgres connection "master"
00:46:50.013482 [debug] [MainThread]: On master: BEGIN
00:46:50.017759 [debug] [MainThread]: Opening a new connection, currently in state closed
00:46:50.039218 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:46:50.043704 [debug] [MainThread]: On master: COMMIT
00:46:50.046410 [debug] [MainThread]: Using postgres connection "master"
00:46:50.055215 [debug] [MainThread]: On master: COMMIT
00:46:50.060439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:50.062903 [debug] [MainThread]: On master: Close
00:46:50.068808 [info ] [MainThread]: 
00:46:50.072416 [info ] [MainThread]: Finished running 1 table model in 0.86s.
00:46:50.076970 [debug] [MainThread]: Connection 'master' was properly closed.
00:46:50.079765 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
00:46:50.084618 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:46:50.146089 [info ] [MainThread]: 
00:46:50.157171 [info ] [MainThread]: [32mCompleted successfully[0m
00:46:50.171339 [info ] [MainThread]: 
00:46:50.184710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:46:55.463211 | 56deb357-3dfa-407f-b4a5-2220e4d8ce33 ==============================
00:46:55.463211 [info ] [MainThread]: Running with dbt=1.0.0
00:46:55.469628 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:46:55.474175 [debug] [MainThread]: Tracking: do not track
00:46:55.540851 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:46:55.594791 [debug] [MainThread]: Parsing macros/catalog.sql
00:46:55.603682 [debug] [MainThread]: Parsing macros/adapters.sql
00:46:55.651536 [debug] [MainThread]: Parsing macros/relations.sql
00:46:55.657189 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:46:55.663190 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:46:55.669181 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:46:55.674858 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:46:55.679320 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:46:55.683278 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:46:55.690626 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:46:55.701864 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:46:55.727935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:46:55.733723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:46:55.754966 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:46:55.766679 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:46:55.800410 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:46:55.808407 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:46:55.827143 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:46:55.835392 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:46:55.851667 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:46:55.857031 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:46:55.863735 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:46:55.875234 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:46:55.881574 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:46:55.887574 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:46:55.901931 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:46:55.946729 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:46:56.003239 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:46:56.044335 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:46:56.073996 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:46:56.082095 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:46:56.089831 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:46:56.099136 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:46:56.106252 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:46:56.126619 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:46:56.149140 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:46:56.163613 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:46:56.194451 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:46:56.220656 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:46:56.246719 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:46:56.272423 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:46:56.299230 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:46:56.314419 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:46:56.698468 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:46:56.719668 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:46:56.729163 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:46:56.923461 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:46:56.929177 [info ] [MainThread]: 
00:46:56.932616 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:56.938332 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:46:56.957376 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:56.967727 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:46:56.970476 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:56.980766 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:46:56.985267 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:46:56.989133 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:46:56.995761 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:46:57.004471 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:46:57.007936 [debug] [ThreadPool]: On list_dbt_dev: Close
00:46:57.028322 [debug] [MainThread]: Using postgres connection "master"
00:46:57.032063 [debug] [MainThread]: On master: BEGIN
00:46:57.036495 [debug] [MainThread]: Opening a new connection, currently in state init
00:46:57.055415 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:46:57.059130 [debug] [MainThread]: Using postgres connection "master"
00:46:57.061791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:46:57.077719 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:46:57.081949 [debug] [MainThread]: On master: ROLLBACK
00:46:57.085498 [debug] [MainThread]: Using postgres connection "master"
00:46:57.087831 [debug] [MainThread]: On master: BEGIN
00:46:57.093213 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:46:57.097252 [debug] [MainThread]: On master: COMMIT
00:46:57.100218 [debug] [MainThread]: Using postgres connection "master"
00:46:57.103117 [debug] [MainThread]: On master: COMMIT
00:46:57.106653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:57.110121 [debug] [MainThread]: On master: Close
00:46:57.112879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:46:57.118366 [info ] [MainThread]: 
00:46:57.154305 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:57.157133 [info ] [Thread-1  ]: 1 of 4 START test not_null_agg_users_stage_dt................................... [RUN]
00:46:57.160347 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:57.163314 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:57.165733 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:57.183112 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:57.191766 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.194892 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:57.228249 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:57.238714 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:57.242601 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:46:57.248072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:57.268523 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:46:57.272532 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:46:57.278547 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:46:57.283626 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:46:57.295688 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.299134 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:46:57.304064 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:46:57.312296 [info ] [Thread-1  ]: 1 of 4 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.15s]
00:46:57.315825 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:46:57.321739 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:57.325824 [info ] [Thread-1  ]: 2 of 4 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:46:57.330797 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:57.333645 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:57.336966 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:57.344987 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:57.353934 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.357822 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:57.364184 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:57.372244 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:57.375061 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:46:57.377889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:57.387989 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:46:57.392762 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:46:57.395841 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:46:57.400468 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:46:57.405573 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.408663 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:46:57.412253 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:46:57.418001 [info ] [Thread-1  ]: 2 of 4 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.09s]
00:46:57.422084 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:46:57.425249 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60
00:46:57.428684 [info ] [Thread-1  ]: 3 of 4 START test unique_agg_users_stage_dt..................................... [RUN]
00:46:57.434614 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60"
00:46:57.437536 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60
00:46:57.440743 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60
00:46:57.452990 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60"
00:46:57.461575 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.464889 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60
00:46:57.470841 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60"
00:46:57.481383 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60"
00:46:57.484738 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60: BEGIN
00:46:57.487390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:57.498051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:46:57.501630 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60"
00:46:57.504420 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    dt as unique_field,
    count(*) as n_records

from "dbt"."dev"."agg_users_stage"
where dt is not null
group by dt
having count(*) > 1



      
    ) dbt_internal_test
00:46:57.509286 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:46:57.514548 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.517358 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60: ROLLBACK
00:46:57.520750 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60: Close
00:46:57.526610 [error] [Thread-1  ]: 3 of 4 FAIL 1 unique_agg_users_stage_dt......................................... [[31mFAIL 1[0m in 0.09s]
00:46:57.530516 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_agg_users_stage_dt.28c00fba60
00:46:57.533737 [debug] [Thread-1  ]: Began running node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:57.536746 [info ] [Thread-1  ]: 4 of 4 START test unique_agg_users_stage_user_id................................ [RUN]
00:46:57.541310 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:57.546501 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:57.549478 [debug] [Thread-1  ]: Compiling test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:57.559555 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:57.570206 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.574042 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:57.582216 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:57.597456 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:57.601711 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: BEGIN
00:46:57.605222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:46:57.617724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:46:57.622451 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"
00:46:57.625926 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."agg_users_stage"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
00:46:57.630841 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:46:57.635734 [debug] [Thread-1  ]: finished collecting timing info
00:46:57.638844 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: ROLLBACK
00:46:57.643410 [debug] [Thread-1  ]: On test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6: Close
00:46:57.649022 [info ] [Thread-1  ]: 4 of 4 PASS unique_agg_users_stage_user_id...................................... [[32mPASS[0m in 0.11s]
00:46:57.653599 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6
00:46:57.659990 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:57.663266 [debug] [MainThread]: Using postgres connection "master"
00:46:57.668257 [debug] [MainThread]: On master: BEGIN
00:46:57.671449 [debug] [MainThread]: Opening a new connection, currently in state closed
00:46:57.684265 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:57.688537 [debug] [MainThread]: On master: COMMIT
00:46:57.692273 [debug] [MainThread]: Using postgres connection "master"
00:46:57.695816 [debug] [MainThread]: On master: COMMIT
00:46:57.700070 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:46:57.704341 [debug] [MainThread]: On master: Close
00:46:57.707829 [info ] [MainThread]: 
00:46:57.712848 [info ] [MainThread]: Finished running 4 tests in 0.78s.
00:46:57.715786 [debug] [MainThread]: Connection 'master' was properly closed.
00:46:57.718504 [debug] [MainThread]: Connection 'test.bungie_dwh.unique_agg_users_stage_user_id.fdf84194c6' was properly closed.
00:46:57.739551 [info ] [MainThread]: 
00:46:57.744136 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
00:46:57.747667 [info ] [MainThread]: 
00:46:57.751542 [error] [MainThread]: [31mFailure in test unique_agg_users_stage_dt (models/staging/schema.yml)[0m
00:46:57.755853 [error] [MainThread]:   Got 1 result, configured to fail if != 0
00:46:57.760041 [info ] [MainThread]: 
00:46:57.764966 [info ] [MainThread]:   compiled SQL at target/compiled/bungie_dwh/models/staging/schema.yml/unique_agg_users_stage_dt.sql
00:46:57.768933 [info ] [MainThread]: 
00:46:57.771781 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4


============================== 2021-12-27 00:50:09.451025 | fe9be645-7d3b-4eb0-bc56-e25469fc730d ==============================
00:50:09.451025 [info ] [MainThread]: Running with dbt=1.0.0
00:50:09.453609 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:50:09.456199 [debug] [MainThread]: Tracking: do not track
00:50:09.506373 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:50:09.586079 [debug] [MainThread]: Parsing macros/catalog.sql
00:50:09.600898 [debug] [MainThread]: Parsing macros/adapters.sql
00:50:09.663519 [debug] [MainThread]: Parsing macros/relations.sql
00:50:09.673714 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:50:09.685105 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:50:09.690453 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:50:09.695529 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:50:09.700901 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:50:09.704679 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:50:09.717599 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:50:09.728427 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:50:09.757663 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:50:09.776337 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:50:09.812397 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:50:09.833154 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:50:09.874896 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:50:09.891043 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:50:09.911666 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:50:09.919595 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:50:09.935967 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:50:09.941436 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:50:09.949563 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:50:09.961062 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:50:09.971583 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:50:09.977681 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:50:09.992347 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:50:10.027526 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:50:10.069179 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:50:10.103214 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:50:10.141588 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:50:10.154842 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:50:10.166575 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:50:10.181986 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:50:10.191201 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:50:10.206951 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:50:10.218179 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:50:10.227085 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:50:10.239207 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:50:10.257037 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:50:10.283327 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:50:10.305326 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:50:10.328032 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:50:10.339479 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:50:10.745119 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:50:10.767961 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:50:10.781697 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:50:11.016404 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:50:11.021407 [info ] [MainThread]: 
00:50:11.025623 [debug] [MainThread]: Acquiring new postgres connection "master"
00:50:11.030308 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:50:11.047919 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:50:11.051045 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:50:11.053560 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:50:11.073089 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.02 seconds
00:50:11.082362 [debug] [ThreadPool]: On list_dbt: Close
00:50:11.090438 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:50:11.103305 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:50:11.107209 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:50:11.110202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:50:11.120703 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:50:11.124924 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:50:11.127974 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:50:11.134587 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:50:11.139367 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:50:11.142447 [debug] [ThreadPool]: On list_dbt_dev: Close
00:50:11.156931 [debug] [MainThread]: Using postgres connection "master"
00:50:11.159563 [debug] [MainThread]: On master: BEGIN
00:50:11.162301 [debug] [MainThread]: Opening a new connection, currently in state init
00:50:11.172458 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:50:11.176689 [debug] [MainThread]: Using postgres connection "master"
00:50:11.180950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:50:11.202209 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
00:50:11.206515 [debug] [MainThread]: On master: ROLLBACK
00:50:11.209834 [debug] [MainThread]: Using postgres connection "master"
00:50:11.212661 [debug] [MainThread]: On master: BEGIN
00:50:11.218610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:50:11.222611 [debug] [MainThread]: On master: COMMIT
00:50:11.225407 [debug] [MainThread]: Using postgres connection "master"
00:50:11.228780 [debug] [MainThread]: On master: COMMIT
00:50:11.233600 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:50:11.235970 [debug] [MainThread]: On master: Close
00:50:11.238899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:50:11.245100 [info ] [MainThread]: 
00:50:11.271081 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
00:50:11.274725 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
00:50:11.278198 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
00:50:11.280791 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
00:50:11.283845 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
00:50:11.293637 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
00:50:11.302573 [debug] [Thread-1  ]: finished collecting timing info
00:50:11.307757 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
00:50:11.417209 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
00:50:11.441901 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:50:11.445864 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
00:50:11.449557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:11.462966 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:50:11.467035 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:50:11.469932 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
00:50:11.483073 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
00:50:11.502553 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:50:11.505895 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
00:50:11.509378 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:50:11.522349 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:50:11.525666 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
00:50:11.529838 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:50:11.549081 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:50:11.551969 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:50:11.554267 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
00:50:11.558999 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:50:11.568775 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
00:50:11.571234 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
00:50:11.578035 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:50:11.584939 [debug] [Thread-1  ]: finished collecting timing info
00:50:11.589131 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
00:50:11.595094 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 5[0m in 0.32s]
00:50:11.600511 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
00:50:11.604634 [debug] [MainThread]: Acquiring new postgres connection "master"
00:50:11.607247 [debug] [MainThread]: Using postgres connection "master"
00:50:11.609669 [debug] [MainThread]: On master: BEGIN
00:50:11.612365 [debug] [MainThread]: Opening a new connection, currently in state closed
00:50:11.623281 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:50:11.627783 [debug] [MainThread]: On master: COMMIT
00:50:11.632370 [debug] [MainThread]: Using postgres connection "master"
00:50:11.634798 [debug] [MainThread]: On master: COMMIT
00:50:11.637953 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:50:11.640543 [debug] [MainThread]: On master: Close
00:50:11.647104 [info ] [MainThread]: 
00:50:11.650755 [info ] [MainThread]: Finished running 1 table model in 0.62s.
00:50:11.654174 [debug] [MainThread]: Connection 'master' was properly closed.
00:50:11.657705 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
00:50:11.678960 [info ] [MainThread]: 
00:50:11.683219 [info ] [MainThread]: [32mCompleted successfully[0m
00:50:11.687589 [info ] [MainThread]: 
00:50:11.692417 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 00:50:18.276501 | be30ece0-c75b-49d8-a9c1-192dd28628e3 ==============================
00:50:18.276501 [info ] [MainThread]: Running with dbt=1.0.0
00:50:18.278807 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
00:50:18.281852 [debug] [MainThread]: Tracking: do not track
00:50:18.344106 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:50:18.431621 [debug] [MainThread]: Parsing macros/catalog.sql
00:50:18.448706 [debug] [MainThread]: Parsing macros/adapters.sql
00:50:18.502748 [debug] [MainThread]: Parsing macros/relations.sql
00:50:18.512076 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:50:18.518153 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:50:18.522741 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:50:18.528095 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:50:18.533605 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:50:18.538498 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:50:18.546194 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:50:18.556953 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:50:18.584830 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:50:18.590542 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:50:18.613216 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:50:18.625983 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:50:18.660007 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:50:18.668380 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:50:18.684888 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:50:18.698763 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:50:18.714499 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:50:18.719304 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:50:18.725996 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:50:18.737804 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:50:18.744155 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:50:18.749919 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:50:18.765840 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:50:18.800248 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:50:18.834929 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:50:18.860342 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:50:18.887043 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:50:18.892996 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:50:18.898854 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:50:18.906736 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:50:18.912304 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:50:18.920448 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:50:18.926980 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:50:18.935532 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:50:18.952789 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:50:18.975766 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:50:19.002493 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:50:19.025559 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:50:19.045166 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:50:19.056987 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:50:19.406668 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:50:19.428314 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:50:19.438884 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:50:19.622395 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:50:19.628102 [info ] [MainThread]: 
00:50:19.632042 [debug] [MainThread]: Acquiring new postgres connection "master"
00:50:19.637050 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:50:19.655425 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:50:19.659392 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:50:19.662508 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:50:19.673188 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:50:19.677450 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:50:19.680648 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:50:19.689101 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:50:19.694145 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:50:19.698664 [debug] [ThreadPool]: On list_dbt_dev: Close
00:50:19.712907 [debug] [MainThread]: Using postgres connection "master"
00:50:19.715694 [debug] [MainThread]: On master: BEGIN
00:50:19.718204 [debug] [MainThread]: Opening a new connection, currently in state init
00:50:19.729073 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:50:19.733629 [debug] [MainThread]: Using postgres connection "master"
00:50:19.736981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:50:19.746334 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:50:19.750520 [debug] [MainThread]: On master: ROLLBACK
00:50:19.754228 [debug] [MainThread]: Using postgres connection "master"
00:50:19.758044 [debug] [MainThread]: On master: BEGIN
00:50:19.763845 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:50:19.767546 [debug] [MainThread]: On master: COMMIT
00:50:19.770381 [debug] [MainThread]: Using postgres connection "master"
00:50:19.773043 [debug] [MainThread]: On master: COMMIT
00:50:19.776277 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:50:19.779455 [debug] [MainThread]: On master: Close
00:50:19.782686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:50:19.786383 [info ] [MainThread]: 
00:50:19.810610 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:50:19.813115 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
00:50:19.816824 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:50:19.820684 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:50:19.823918 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:50:19.841516 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:50:19.849762 [debug] [Thread-1  ]: finished collecting timing info
00:50:19.856630 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:50:19.887073 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:50:19.895550 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:50:19.898722 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
00:50:19.901724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:19.919334 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:50:19.924102 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
00:50:19.928768 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
00:50:19.933601 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:50:19.940774 [debug] [Thread-1  ]: finished collecting timing info
00:50:19.943846 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
00:50:19.946988 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
00:50:19.953126 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.14s]
00:50:19.956808 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
00:50:19.960024 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:50:19.962895 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
00:50:19.967273 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:50:19.970587 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:50:19.973135 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:50:19.980728 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:50:19.987788 [debug] [Thread-1  ]: finished collecting timing info
00:50:19.990132 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:50:19.995535 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:50:20.005114 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:50:20.008083 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
00:50:20.010935 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:20.020868 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:50:20.024553 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
00:50:20.027594 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
00:50:20.032612 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
00:50:20.037517 [debug] [Thread-1  ]: finished collecting timing info
00:50:20.040433 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
00:50:20.043177 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
00:50:20.048827 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.08s]
00:50:20.054113 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
00:50:20.062134 [debug] [MainThread]: Acquiring new postgres connection "master"
00:50:20.065881 [debug] [MainThread]: Using postgres connection "master"
00:50:20.070235 [debug] [MainThread]: On master: BEGIN
00:50:20.073460 [debug] [MainThread]: Opening a new connection, currently in state closed
00:50:20.087017 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:50:20.091050 [debug] [MainThread]: On master: COMMIT
00:50:20.094962 [debug] [MainThread]: Using postgres connection "master"
00:50:20.097899 [debug] [MainThread]: On master: COMMIT
00:50:20.101858 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:50:20.105628 [debug] [MainThread]: On master: Close
00:50:20.110790 [info ] [MainThread]: 
00:50:20.115934 [info ] [MainThread]: Finished running 2 tests in 0.48s.
00:50:20.119879 [debug] [MainThread]: Connection 'master' was properly closed.
00:50:20.124248 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
00:50:20.143552 [info ] [MainThread]: 
00:50:20.148884 [info ] [MainThread]: [32mCompleted successfully[0m
00:50:20.153887 [info ] [MainThread]: 
00:50:20.158121 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 00:50:25.633235 | 478c4a1e-a244-4bec-b073-2ed407ecaddd ==============================
00:50:25.633235 [info ] [MainThread]: Running with dbt=1.0.0
00:50:25.637213 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
00:50:25.642368 [debug] [MainThread]: Tracking: do not track
00:50:25.737138 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
00:50:25.858078 [debug] [MainThread]: Parsing macros/catalog.sql
00:50:25.877479 [debug] [MainThread]: Parsing macros/adapters.sql
00:50:25.940712 [debug] [MainThread]: Parsing macros/relations.sql
00:50:25.951385 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
00:50:25.964879 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:50:25.970599 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:50:25.976938 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:50:25.981364 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:50:25.989911 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:50:26.007379 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:50:26.021075 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:50:26.057524 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:50:26.064381 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:50:26.092941 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:50:26.106319 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:50:26.150963 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:50:26.160558 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:50:26.178494 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:50:26.187183 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:50:26.208126 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:50:26.218753 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:50:26.226980 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:50:26.238887 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:50:26.245992 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:50:26.253447 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:50:26.271866 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:50:26.338194 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:50:26.388722 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:50:26.423270 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:50:26.454240 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:50:26.465752 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:50:26.476892 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:50:26.491443 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:50:26.502077 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:50:26.518001 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:50:26.530064 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:50:26.554656 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:50:26.587086 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:50:26.607594 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:50:26.657216 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:50:26.683414 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:50:26.707497 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:50:26.722261 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:50:27.224471 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
00:50:27.254632 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
00:50:27.271349 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
00:50:27.436815 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
00:50:27.442149 [info ] [MainThread]: 
00:50:27.446441 [debug] [MainThread]: Acquiring new postgres connection "master"
00:50:27.451242 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
00:50:27.469147 [debug] [ThreadPool]: Using postgres connection "list_dbt"
00:50:27.472007 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
00:50:27.474551 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:50:27.485054 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.01 seconds
00:50:27.489574 [debug] [ThreadPool]: On list_dbt: Close
00:50:27.497492 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
00:50:27.511845 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:50:27.514947 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
00:50:27.517971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:50:27.531064 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:50:27.534782 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
00:50:27.538721 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
00:50:27.546150 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
00:50:27.551498 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
00:50:27.554658 [debug] [ThreadPool]: On list_dbt_dev: Close
00:50:27.574849 [debug] [MainThread]: Using postgres connection "master"
00:50:27.578563 [debug] [MainThread]: On master: BEGIN
00:50:27.582386 [debug] [MainThread]: Opening a new connection, currently in state init
00:50:27.593731 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:50:27.597171 [debug] [MainThread]: Using postgres connection "master"
00:50:27.600148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:50:27.609609 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
00:50:27.614735 [debug] [MainThread]: On master: ROLLBACK
00:50:27.619197 [debug] [MainThread]: Using postgres connection "master"
00:50:27.624504 [debug] [MainThread]: On master: BEGIN
00:50:27.628664 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:50:27.633069 [debug] [MainThread]: On master: COMMIT
00:50:27.636798 [debug] [MainThread]: Using postgres connection "master"
00:50:27.640261 [debug] [MainThread]: On master: COMMIT
00:50:27.643484 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:50:27.646510 [debug] [MainThread]: On master: Close
00:50:27.652730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
00:50:27.656064 [info ] [MainThread]: 
00:50:27.680213 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
00:50:27.682938 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
00:50:27.685894 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
00:50:27.688586 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
00:50:27.691007 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
00:50:27.697392 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
00:50:27.705187 [debug] [Thread-1  ]: finished collecting timing info
00:50:27.708206 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
00:50:27.789660 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:50:27.792284 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp005027761021"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
00:50:27.794895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:50:27.809870 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
00:50:27.830697 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:50:27.833957 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
00:50:27.840406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
00:50:27.844193 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:50:27.847608 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp005027761021'
        
      order by ordinal_position

  
00:50:27.858654 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
00:50:27.868351 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:50:27.870948 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:50:27.877372 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:50:27.891080 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:50:27.893856 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
00:50:27.900755 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
00:50:27.918011 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
00:50:27.927708 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:50:27.930671 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (dt) in (
        select (dt)
        from "agg_users__dbt_tmp005027761021"
    );
    

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp005027761021"
    )
  
00:50:27.934178 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
00:50:27.948121 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:50:27.950983 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
00:50:27.953851 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
00:50:27.957707 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:50:27.961170 [debug] [Thread-1  ]: finished collecting timing info
00:50:27.963904 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
00:50:27.970994 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 5[0m in 0.29s]
00:50:27.984442 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
00:50:27.989325 [debug] [MainThread]: Acquiring new postgres connection "master"
00:50:27.992836 [debug] [MainThread]: Using postgres connection "master"
00:50:27.996069 [debug] [MainThread]: On master: BEGIN
00:50:28.000172 [debug] [MainThread]: Opening a new connection, currently in state closed
00:50:28.015206 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:50:28.020171 [debug] [MainThread]: On master: COMMIT
00:50:28.023680 [debug] [MainThread]: Using postgres connection "master"
00:50:28.028632 [debug] [MainThread]: On master: COMMIT
00:50:28.034535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:50:28.037346 [debug] [MainThread]: On master: Close
00:50:28.042892 [info ] [MainThread]: 
00:50:28.047074 [info ] [MainThread]: Finished running 1 incremental model in 0.60s.
00:50:28.053648 [debug] [MainThread]: Connection 'master' was properly closed.
00:50:28.056497 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
00:50:28.084767 [info ] [MainThread]: 
00:50:28.089046 [info ] [MainThread]: [32mCompleted successfully[0m
00:50:28.096925 [info ] [MainThread]: 
00:50:28.104624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 04:59:41.663328 | 14e81166-4496-41f5-ac4f-cc1b4825ac24 ==============================
04:59:41.663328 [info ] [MainThread]: Running with dbt=1.0.0
04:59:41.665512 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
04:59:41.666948 [debug] [MainThread]: Tracking: tracking
04:59:41.693669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aaebdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aaebdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aaebd250>]}
04:59:41.739866 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
04:59:41.740531 [info ] [MainThread]: Unable to do partial parsing because profile has changed
04:59:41.741113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14e81166-4496-41f5-ac4f-cc1b4825ac24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ab098f90>]}
04:59:41.787027 [debug] [MainThread]: Parsing macros/catalog.sql
04:59:41.793518 [debug] [MainThread]: Parsing macros/relations.sql
04:59:41.795428 [debug] [MainThread]: Parsing macros/adapters.sql
04:59:41.827380 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
04:59:41.829891 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
04:59:41.835515 [debug] [MainThread]: Parsing macros/materializations/configs.sql
04:59:41.838819 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
04:59:41.841133 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
04:59:41.868579 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
04:59:41.886148 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
04:59:41.905547 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
04:59:41.911961 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
04:59:41.914451 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
04:59:41.916939 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
04:59:41.923304 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
04:59:41.939334 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
04:59:41.941521 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
04:59:41.956503 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
04:59:41.978454 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
04:59:41.990037 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
04:59:41.994333 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
04:59:42.004613 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
04:59:42.006591 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
04:59:42.010410 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
04:59:42.013726 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
04:59:42.022654 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
04:59:42.046212 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
04:59:42.048341 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
04:59:42.051720 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
04:59:42.053899 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
04:59:42.055114 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
04:59:42.055877 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
04:59:42.056834 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
04:59:42.058913 [debug] [MainThread]: Parsing macros/etc/statement.sql
04:59:42.065136 [debug] [MainThread]: Parsing macros/etc/datetime.sql
04:59:42.076801 [debug] [MainThread]: Parsing macros/adapters/schema.sql
04:59:42.079842 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
04:59:42.084916 [debug] [MainThread]: Parsing macros/adapters/relation.sql
04:59:42.099458 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
04:59:42.103553 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
04:59:42.109795 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
04:59:42.119999 [debug] [MainThread]: Parsing macros/adapters/columns.sql
04:59:42.133707 [debug] [MainThread]: Parsing tests/generic/builtin.sql
04:59:42.404601 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
04:59:42.429122 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
04:59:42.431302 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
04:59:42.560701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14e81166-4496-41f5-ac4f-cc1b4825ac24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ab21c950>]}
04:59:42.568641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14e81166-4496-41f5-ac4f-cc1b4825ac24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ab0da190>]}
04:59:42.569093 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
04:59:42.570686 [info ] [MainThread]: 
04:59:42.571388 [debug] [MainThread]: Acquiring new postgres connection "master"
04:59:42.572548 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
04:59:42.584851 [debug] [ThreadPool]: Using postgres connection "list_dbt"
04:59:42.585135 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
04:59:42.585329 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:59:42.588203 [debug] [ThreadPool]: Postgres adapter: Got an error when attempting to open a postgres connection: 'connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
'
04:59:42.588538 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
04:59:42.588724 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
04:59:42.588955 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
04:59:42.589128 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
04:59:42.589336 [debug] [ThreadPool]: On list_dbt: No close available on handle
04:59:42.589999 [debug] [MainThread]: Connection 'master' was properly closed.
04:59:42.590214 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
04:59:42.591219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ab217cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ab0acf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aaebdc90>]}


============================== 2021-12-27 05:00:48.941152 | de8cea68-b4e1-4ce0-8615-9e459cbdb192 ==============================
05:00:48.941152 [info ] [MainThread]: Running with dbt=1.0.0
05:00:48.944934 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8000, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
05:00:48.946502 [debug] [MainThread]: Tracking: tracking
05:00:49.016029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb58f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb58fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb58f090>]}
05:00:49.114653 [info ] [MainThread]: Serving docs at 0.0.0.0:8000
05:00:49.115996 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8000
05:00:49.118659 [info ] [MainThread]: 
05:00:49.123874 [info ] [MainThread]: 
05:00:49.125334 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-27 05:02:59.908554 | 9e87eafc-2c36-43cc-8677-aa4dd581278b ==============================
05:02:59.908554 [info ] [MainThread]: Running with dbt=1.0.0
05:02:59.913022 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
05:02:59.917598 [debug] [MainThread]: Tracking: do not track
05:03:00.000905 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:03:00.004326 [info ] [MainThread]: Unable to do partial parsing because profile has changed
05:03:00.155278 [debug] [MainThread]: Parsing macros/catalog.sql
05:03:00.164410 [debug] [MainThread]: Parsing macros/adapters.sql
05:03:00.209869 [debug] [MainThread]: Parsing macros/relations.sql
05:03:00.216494 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:03:00.224420 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:03:00.230094 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:03:00.237385 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:03:00.241536 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:03:00.246304 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:03:00.256703 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:03:00.269698 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:03:00.302769 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:03:00.308053 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:03:00.328692 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:03:00.339153 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:03:00.372647 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:03:00.380103 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:03:00.396474 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:03:00.404366 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:03:00.420130 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:03:00.425066 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:03:00.431378 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:03:00.442765 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:03:00.449446 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:03:00.454819 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:03:00.469115 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:03:00.502946 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:03:00.536783 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:03:00.574668 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:03:00.611052 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:03:00.616631 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:03:00.621864 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:03:00.629555 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:03:00.634630 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:03:00.646840 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:03:00.666024 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:03:00.674456 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:03:00.688930 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:03:00.706524 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:03:00.726267 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:03:00.746973 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:03:00.766247 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:03:00.777504 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:03:01.151093 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:03:01.175335 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:03:01.184536 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:03:01.352899 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:03:01.358802 [info ] [MainThread]: 
05:03:01.362519 [debug] [MainThread]: Acquiring new postgres connection "master"
05:03:01.367558 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
05:03:01.388613 [debug] [ThreadPool]: Using postgres connection "list_dbt"
05:03:01.391128 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
05:03:01.393680 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:03:01.411446 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
05:03:01.416840 [debug] [ThreadPool]: On list_dbt: Close
05:03:01.421291 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
05:03:01.424207 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev"
05:03:01.426780 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev', identifier=None)"
05:03:01.440557 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
05:03:01.442896 [debug] [ThreadPool]: On create_dbt_dev: BEGIN
05:03:01.445467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
05:03:01.456151 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:03:01.458748 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
05:03:01.461091 [debug] [ThreadPool]: On create_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "create_dbt_dev"} */
create schema if not exists "dev"
05:03:01.464824 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
05:03:01.468219 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
05:03:01.470794 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
05:03:01.473447 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
05:03:01.478504 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
05:03:01.481876 [debug] [ThreadPool]: On create_dbt_dev: Close
05:03:01.488540 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:03:01.500140 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:03:01.502414 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:03:01.504418 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:03:01.512285 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:03:01.514372 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:03:01.516525 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:03:01.522789 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
05:03:01.526763 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:03:01.529460 [debug] [ThreadPool]: On list_dbt_dev: Close
05:03:01.538814 [debug] [MainThread]: Using postgres connection "master"
05:03:01.541134 [debug] [MainThread]: On master: BEGIN
05:03:01.543202 [debug] [MainThread]: Opening a new connection, currently in state init
05:03:01.551702 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:03:01.554606 [debug] [MainThread]: Using postgres connection "master"
05:03:01.557338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:03:01.567514 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
05:03:01.570566 [debug] [MainThread]: On master: ROLLBACK
05:03:01.574367 [debug] [MainThread]: Using postgres connection "master"
05:03:01.576699 [debug] [MainThread]: On master: BEGIN
05:03:01.580414 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:03:01.582788 [debug] [MainThread]: On master: COMMIT
05:03:01.585216 [debug] [MainThread]: Using postgres connection "master"
05:03:01.587559 [debug] [MainThread]: On master: COMMIT
05:03:01.590417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:03:01.592626 [debug] [MainThread]: On master: Close
05:03:01.595518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:03:01.600481 [info ] [MainThread]: 
05:03:01.628913 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
05:03:01.631529 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
05:03:01.634321 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
05:03:01.636421 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
05:03:01.638300 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
05:03:01.646274 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
05:03:01.656053 [debug] [Thread-1  ]: finished collecting timing info
05:03:01.658263 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
05:03:01.706823 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
05:03:01.717058 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:03:01.719177 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
05:03:01.722048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:03:01.733542 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:03:01.736645 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:03:01.739251 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
05:03:01.743903 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dev.users" does not exist
LINE 16: FROM "dbt"."dev"."users" a
              ^

05:03:01.746903 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: ROLLBACK
05:03:01.750392 [debug] [Thread-1  ]: finished collecting timing info
05:03:01.753196 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
05:03:01.757159 [debug] [Thread-1  ]: Database Error in model agg_users_stage (models/staging/agg_users_stage.sql)
  relation "dev.users" does not exist
  LINE 16: FROM "dbt"."dev"."users" a
                ^
  compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
05:03:01.762289 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev.agg_users_stage........................... [[31mERROR[0m in 0.13s]
05:03:01.766010 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
05:03:01.771042 [debug] [MainThread]: Acquiring new postgres connection "master"
05:03:01.773085 [debug] [MainThread]: Using postgres connection "master"
05:03:01.775043 [debug] [MainThread]: On master: BEGIN
05:03:01.777575 [debug] [MainThread]: Opening a new connection, currently in state closed
05:03:01.785386 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:03:01.788132 [debug] [MainThread]: On master: COMMIT
05:03:01.791276 [debug] [MainThread]: Using postgres connection "master"
05:03:01.793766 [debug] [MainThread]: On master: COMMIT
05:03:01.796142 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:03:01.798428 [debug] [MainThread]: On master: Close
05:03:01.803542 [info ] [MainThread]: 
05:03:01.806527 [info ] [MainThread]: Finished running 1 table model in 0.44s.
05:03:01.809589 [debug] [MainThread]: Connection 'master' was properly closed.
05:03:01.812372 [debug] [MainThread]: Connection 'create_dbt_dev' was properly closed.
05:03:01.815106 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
05:03:01.837057 [info ] [MainThread]: 
05:03:01.839601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
05:03:01.842366 [info ] [MainThread]: 
05:03:01.844820 [error] [MainThread]: [33mDatabase Error in model agg_users_stage (models/staging/agg_users_stage.sql)[0m
05:03:01.847478 [error] [MainThread]:   relation "dev.users" does not exist
05:03:01.850585 [error] [MainThread]:   LINE 16: FROM "dbt"."dev"."users" a
05:03:01.853295 [error] [MainThread]:                 ^
05:03:01.855751 [error] [MainThread]:   compiled SQL at target/run/bungie_dwh/models/staging/agg_users_stage.sql
05:03:01.858506 [info ] [MainThread]: 
05:03:01.860973 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 05:04:10.152848 | cfe8b5c7-9d30-412d-9d66-647dd52b72f8 ==============================
05:04:10.152848 [info ] [MainThread]: Running with dbt=1.0.0
05:04:10.154243 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
05:04:10.154769 [debug] [MainThread]: Tracking: tracking
05:04:10.171518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e671350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e6712d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e671310>]}
05:04:10.204947 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:04:10.205535 [info ] [MainThread]: Unable to do partial parsing because profile has changed
05:04:10.206363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfe8b5c7-9d30-412d-9d66-647dd52b72f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46f058fd0>]}
05:04:10.252989 [debug] [MainThread]: Parsing macros/catalog.sql
05:04:10.258146 [debug] [MainThread]: Parsing macros/relations.sql
05:04:10.263331 [debug] [MainThread]: Parsing macros/adapters.sql
05:04:10.300743 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:04:10.303161 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:04:10.308832 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:04:10.312237 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:04:10.314593 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:04:10.340604 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:04:10.356780 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:04:10.374777 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:04:10.381250 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:04:10.383869 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:04:10.386423 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:04:10.393696 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:04:10.409869 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:04:10.412088 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:04:10.427517 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:04:10.466015 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:04:10.477129 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:04:10.481391 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:04:10.491585 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:04:10.494325 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:04:10.498230 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:04:10.501575 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:04:10.510610 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:04:10.535136 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:04:10.537285 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:04:10.541062 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:04:10.544281 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:04:10.545622 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:04:10.546447 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:04:10.547457 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:04:10.549668 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:04:10.556000 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:04:10.569109 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:04:10.573463 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:04:10.578875 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:04:10.597284 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:04:10.602261 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:04:10.609723 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:04:10.620406 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:04:10.638863 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:04:10.899865 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:04:10.918532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:04:10.920229 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:04:11.019747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfe8b5c7-9d30-412d-9d66-647dd52b72f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46f0db450>]}
05:04:11.028212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfe8b5c7-9d30-412d-9d66-647dd52b72f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46f0bf810>]}
05:04:11.028661 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:04:11.030283 [info ] [MainThread]: 
05:04:11.031030 [debug] [MainThread]: Acquiring new postgres connection "master"
05:04:11.032311 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
05:04:11.050603 [debug] [ThreadPool]: Using postgres connection "list_dbt"
05:04:11.050954 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
05:04:11.051249 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:04:11.108684 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
05:04:11.111165 [debug] [ThreadPool]: On list_dbt: Close
05:04:11.113730 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:04:11.123211 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:04:11.123554 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:04:11.123776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
05:04:11.136989 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:04:11.137730 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:04:11.138162 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:04:11.144042 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
05:04:11.147043 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:04:11.148925 [debug] [ThreadPool]: On list_dbt_dev: Close
05:04:11.155468 [debug] [MainThread]: Using postgres connection "master"
05:04:11.155783 [debug] [MainThread]: On master: BEGIN
05:04:11.155998 [debug] [MainThread]: Opening a new connection, currently in state init
05:04:11.169288 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:04:11.169803 [debug] [MainThread]: Using postgres connection "master"
05:04:11.170074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:04:11.176206 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
05:04:11.177807 [debug] [MainThread]: On master: ROLLBACK
05:04:11.179604 [debug] [MainThread]: Using postgres connection "master"
05:04:11.179950 [debug] [MainThread]: On master: BEGIN
05:04:11.183470 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:04:11.184014 [debug] [MainThread]: On master: COMMIT
05:04:11.184294 [debug] [MainThread]: Using postgres connection "master"
05:04:11.184509 [debug] [MainThread]: On master: COMMIT
05:04:11.185929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:04:11.186318 [debug] [MainThread]: On master: Close
05:04:11.187028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:04:11.187604 [info ] [MainThread]: 
05:04:11.193108 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.payments
05:04:11.194265 [info ] [Thread-1  ]: 1 of 3 START seed file dev.payments............................................. [RUN]
05:04:11.195552 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.payments"
05:04:11.195846 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.payments
05:04:11.196119 [debug] [Thread-1  ]: finished collecting timing info
05:04:11.196396 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.payments
05:04:11.245124 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
05:04:11.245379 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: BEGIN
05:04:11.245568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:04:11.257423 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:04:11.257973 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
05:04:11.258254 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.payments"} */

    create table "dbt"."dev"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
05:04:11.264996 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
05:04:11.290648 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
05:04:11.290990 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: 
          insert into "dbt"."dev"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
05:04:11.294793 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
05:04:11.305142 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.payments"
05:04:11.321987 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
05:04:11.322423 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.payments"
05:04:11.322880 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: COMMIT
05:04:11.328209 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
05:04:11.329087 [debug] [Thread-1  ]: finished collecting timing info
05:04:11.329400 [debug] [Thread-1  ]: On seed.bungie_dwh.payments: Close
05:04:11.330156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8b5c7-9d30-412d-9d66-647dd52b72f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46f267050>]}
05:04:11.330772 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev.payments......................................... [[32mINSERT 3[0m in 0.13s]
05:04:11.331717 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.payments
05:04:11.332358 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.sessions
05:04:11.333094 [info ] [Thread-1  ]: 2 of 3 START seed file dev.sessions............................................. [RUN]
05:04:11.334393 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.sessions"
05:04:11.334740 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.sessions
05:04:11.334995 [debug] [Thread-1  ]: finished collecting timing info
05:04:11.335273 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.sessions
05:04:11.386511 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
05:04:11.386769 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: BEGIN
05:04:11.386978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:04:11.400788 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:04:11.401177 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
05:04:11.401461 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.sessions"} */

    create table "dbt"."dev"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
05:04:11.404386 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
05:04:11.409450 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
05:04:11.409767 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: 
          insert into "dbt"."dev"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
05:04:11.412016 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
05:04:11.412674 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.sessions"
05:04:11.414949 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
05:04:11.415364 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.sessions"
05:04:11.415614 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: COMMIT
05:04:11.418372 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
05:04:11.419153 [debug] [Thread-1  ]: finished collecting timing info
05:04:11.419486 [debug] [Thread-1  ]: On seed.bungie_dwh.sessions: Close
05:04:11.420231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8b5c7-9d30-412d-9d66-647dd52b72f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e7816d0>]}
05:04:11.420931 [info ] [Thread-1  ]: 2 of 3 OK loaded seed file dev.sessions......................................... [[32mINSERT 4[0m in 0.09s]
05:04:11.421534 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.sessions
05:04:11.422041 [debug] [Thread-1  ]: Began running node seed.bungie_dwh.users
05:04:11.422594 [info ] [Thread-1  ]: 3 of 3 START seed file dev.users................................................ [RUN]
05:04:11.423459 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.bungie_dwh.users"
05:04:11.424058 [debug] [Thread-1  ]: Began compiling node seed.bungie_dwh.users
05:04:11.424747 [debug] [Thread-1  ]: finished collecting timing info
05:04:11.425454 [debug] [Thread-1  ]: Began executing node seed.bungie_dwh.users
05:04:11.440828 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
05:04:11.441563 [debug] [Thread-1  ]: On seed.bungie_dwh.users: BEGIN
05:04:11.442542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:04:11.470559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
05:04:11.471359 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
05:04:11.471924 [debug] [Thread-1  ]: On seed.bungie_dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "seed.bungie_dwh.users"} */

    create table "dbt"."dev"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text,"created_at" timestamp without time zone)
  
05:04:11.485564 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
05:04:11.500176 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
05:04:11.500736 [debug] [Thread-1  ]: On seed.bungie_dwh.users: 
          insert into "dbt"."dev"."users" ("user_id", "first_name", "last_name", "country_code", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
05:04:11.503481 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
05:04:11.504963 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bungie_dwh.users"
05:04:11.508797 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
05:04:11.509358 [debug] [Thread-1  ]: Using postgres connection "seed.bungie_dwh.users"
05:04:11.509824 [debug] [Thread-1  ]: On seed.bungie_dwh.users: COMMIT
05:04:11.514304 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
05:04:11.517556 [debug] [Thread-1  ]: finished collecting timing info
05:04:11.519996 [debug] [Thread-1  ]: On seed.bungie_dwh.users: Close
05:04:11.522300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfe8b5c7-9d30-412d-9d66-647dd52b72f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e71ec90>]}
05:04:11.524754 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev.users............................................ [[32mINSERT 5[0m in 0.10s]
05:04:11.527527 [debug] [Thread-1  ]: Finished running node seed.bungie_dwh.users
05:04:11.607281 [debug] [MainThread]: Acquiring new postgres connection "master"
05:04:11.607869 [debug] [MainThread]: Using postgres connection "master"
05:04:11.608245 [debug] [MainThread]: On master: BEGIN
05:04:11.608580 [debug] [MainThread]: Opening a new connection, currently in state closed
05:04:11.621268 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:04:11.621666 [debug] [MainThread]: On master: COMMIT
05:04:11.621908 [debug] [MainThread]: Using postgres connection "master"
05:04:11.622198 [debug] [MainThread]: On master: COMMIT
05:04:11.623651 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:04:11.624159 [debug] [MainThread]: On master: Close
05:04:11.625248 [info ] [MainThread]: 
05:04:11.626187 [info ] [MainThread]: Finished running 3 seeds in 0.59s.
05:04:11.627543 [debug] [MainThread]: Connection 'master' was properly closed.
05:04:11.628081 [debug] [MainThread]: Connection 'seed.bungie_dwh.users' was properly closed.
05:04:11.634681 [info ] [MainThread]: 
05:04:11.635152 [info ] [MainThread]: [32mCompleted successfully[0m
05:04:11.635607 [info ] [MainThread]: 
05:04:11.635962 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
05:04:11.636779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46f27a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e71ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46e71e550>]}


============================== 2021-12-27 05:04:52.647857 | 9326753e-a13e-4bbe-9c64-8db3e134645e ==============================
05:04:52.647857 [info ] [MainThread]: Running with dbt=1.0.0
05:04:52.654414 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
05:04:52.660659 [debug] [MainThread]: Tracking: do not track
05:04:52.775231 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:04:52.779446 [info ] [MainThread]: Unable to do partial parsing because profile has changed
05:04:52.875191 [debug] [MainThread]: Parsing macros/catalog.sql
05:04:52.891858 [debug] [MainThread]: Parsing macros/adapters.sql
05:04:52.961511 [debug] [MainThread]: Parsing macros/relations.sql
05:04:52.976333 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:04:52.985361 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:04:52.989969 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:04:52.997854 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:04:53.003781 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:04:53.009605 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:04:53.020160 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:04:53.035210 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:04:53.069518 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:04:53.076204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:04:53.107148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:04:53.121562 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:04:53.169454 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:04:53.181024 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:04:53.202416 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:04:53.212050 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:04:53.240464 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:04:53.250826 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:04:53.260935 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:04:53.284076 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:04:53.299352 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:04:53.314476 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:04:53.360470 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:04:53.583837 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:04:53.624992 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:04:53.667535 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:04:53.724928 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:04:53.740901 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:04:53.757164 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:04:53.773864 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:04:53.788319 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:04:53.807303 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:04:53.820570 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:04:53.830404 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:04:53.845110 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:04:53.864509 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:04:53.894250 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:04:53.923997 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:04:53.943143 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:04:53.954469 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:04:54.405265 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:04:54.437926 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:04:54.453332 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:04:54.672721 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:04:54.682190 [info ] [MainThread]: 
05:04:54.687288 [debug] [MainThread]: Acquiring new postgres connection "master"
05:04:54.696428 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
05:04:54.729222 [debug] [ThreadPool]: Using postgres connection "list_dbt"
05:04:54.731819 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
05:04:54.734535 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:04:54.755560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
05:04:54.763605 [debug] [ThreadPool]: On list_dbt: Close
05:04:54.770966 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:04:54.790705 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:04:54.794232 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:04:54.797919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
05:04:54.808059 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:04:54.811490 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:04:54.814477 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:04:54.820951 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
05:04:54.825490 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:04:54.829203 [debug] [ThreadPool]: On list_dbt_dev: Close
05:04:54.848081 [debug] [MainThread]: Using postgres connection "master"
05:04:54.854016 [debug] [MainThread]: On master: BEGIN
05:04:54.857212 [debug] [MainThread]: Opening a new connection, currently in state init
05:04:54.867552 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:04:54.870557 [debug] [MainThread]: Using postgres connection "master"
05:04:54.873661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:04:54.887471 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
05:04:54.891969 [debug] [MainThread]: On master: ROLLBACK
05:04:54.894681 [debug] [MainThread]: Using postgres connection "master"
05:04:54.897473 [debug] [MainThread]: On master: BEGIN
05:04:54.901053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:04:54.908717 [debug] [MainThread]: On master: COMMIT
05:04:54.913688 [debug] [MainThread]: Using postgres connection "master"
05:04:54.918386 [debug] [MainThread]: On master: COMMIT
05:04:54.922161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:04:54.926341 [debug] [MainThread]: On master: Close
05:04:54.932764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:04:54.937043 [info ] [MainThread]: 
05:04:54.979106 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
05:04:54.983063 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
05:04:54.987452 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
05:04:54.991300 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
05:04:54.994802 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
05:04:55.004415 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
05:04:55.013022 [debug] [Thread-1  ]: finished collecting timing info
05:04:55.016180 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
05:04:55.063798 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
05:04:55.070986 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:04:55.073825 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
05:04:55.076409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:04:55.088509 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:04:55.090691 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:04:55.092647 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
05:04:55.104782 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
05:04:55.119158 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:04:55.121837 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
05:04:55.125952 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
05:04:55.148822 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
05:04:55.152510 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:04:55.155555 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
05:04:55.159943 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
05:04:55.172664 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:04:55.174950 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
05:04:55.182940 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
05:04:55.187844 [debug] [Thread-1  ]: finished collecting timing info
05:04:55.191424 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
05:04:55.196068 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 5[0m in 0.21s]
05:04:55.202610 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
05:04:55.208880 [debug] [MainThread]: Acquiring new postgres connection "master"
05:04:55.211775 [debug] [MainThread]: Using postgres connection "master"
05:04:55.214332 [debug] [MainThread]: On master: BEGIN
05:04:55.217087 [debug] [MainThread]: Opening a new connection, currently in state closed
05:04:55.229393 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:04:55.232968 [debug] [MainThread]: On master: COMMIT
05:04:55.235300 [debug] [MainThread]: Using postgres connection "master"
05:04:55.238206 [debug] [MainThread]: On master: COMMIT
05:04:55.242081 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:04:55.245166 [debug] [MainThread]: On master: Close
05:04:55.249694 [info ] [MainThread]: 
05:04:55.255963 [info ] [MainThread]: Finished running 1 table model in 0.56s.
05:04:55.260960 [debug] [MainThread]: Connection 'master' was properly closed.
05:04:55.265099 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
05:04:55.287443 [info ] [MainThread]: 
05:04:55.291183 [info ] [MainThread]: [32mCompleted successfully[0m
05:04:55.294542 [info ] [MainThread]: 
05:04:55.298304 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 05:05:00.873223 | a68b6665-fd21-4d61-ae46-f453b8eac196 ==============================
05:05:00.873223 [info ] [MainThread]: Running with dbt=1.0.0
05:05:00.876000 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
05:05:00.879280 [debug] [MainThread]: Tracking: do not track
05:05:00.960720 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:05:01.033089 [debug] [MainThread]: Parsing macros/catalog.sql
05:05:01.041524 [debug] [MainThread]: Parsing macros/adapters.sql
05:05:01.089069 [debug] [MainThread]: Parsing macros/relations.sql
05:05:01.094361 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:05:01.100986 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:05:01.105443 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:05:01.112406 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:05:01.116556 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:05:01.121134 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:05:01.129490 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:05:01.140470 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:05:01.169569 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:05:01.177197 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:05:01.202487 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:05:01.216348 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:05:01.253269 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:05:01.261859 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:05:01.283571 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:05:01.292441 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:05:01.311097 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:05:01.317302 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:05:01.325232 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:05:01.337377 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:05:01.343625 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:05:01.351573 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:05:01.367631 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:05:01.404069 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:05:01.443123 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:05:01.470233 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:05:01.497028 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:05:01.504325 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:05:01.510186 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:05:01.519251 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:05:01.527264 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:05:01.538490 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:05:01.546888 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:05:01.558047 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:05:01.584365 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:05:01.624616 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:05:01.670701 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:05:01.758426 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:05:01.799375 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:05:01.822381 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:05:02.320050 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:05:02.355739 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:05:02.373174 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:05:02.562031 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:05:02.569041 [info ] [MainThread]: 
05:05:02.574125 [debug] [MainThread]: Acquiring new postgres connection "master"
05:05:02.580367 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:05:02.601854 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:05:02.604682 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:05:02.607267 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:05:02.617503 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:05:02.620645 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:05:02.624112 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:05:02.633237 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
05:05:02.639948 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:05:02.643434 [debug] [ThreadPool]: On list_dbt_dev: Close
05:05:02.659580 [debug] [MainThread]: Using postgres connection "master"
05:05:02.662837 [debug] [MainThread]: On master: BEGIN
05:05:02.665572 [debug] [MainThread]: Opening a new connection, currently in state init
05:05:02.676060 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:05:02.678638 [debug] [MainThread]: Using postgres connection "master"
05:05:02.681023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:05:02.691274 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
05:05:02.696102 [debug] [MainThread]: On master: ROLLBACK
05:05:02.699119 [debug] [MainThread]: Using postgres connection "master"
05:05:02.701615 [debug] [MainThread]: On master: BEGIN
05:05:02.705229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:05:02.708126 [debug] [MainThread]: On master: COMMIT
05:05:02.711314 [debug] [MainThread]: Using postgres connection "master"
05:05:02.714821 [debug] [MainThread]: On master: COMMIT
05:05:02.719876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:05:02.722923 [debug] [MainThread]: On master: Close
05:05:02.726426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:05:02.729415 [info ] [MainThread]: 
05:05:02.755900 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:05:02.759192 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
05:05:02.763827 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:05:02.767207 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:05:02.770236 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:05:02.795706 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:05:02.805819 [debug] [Thread-1  ]: finished collecting timing info
05:05:02.808774 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:05:02.839740 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:05:02.850119 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:05:02.853404 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
05:05:02.856154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:05:02.867139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:05:02.871074 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:05:02.873977 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
05:05:02.879954 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
05:05:02.888220 [debug] [Thread-1  ]: finished collecting timing info
05:05:02.890969 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
05:05:02.894284 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
05:05:02.899234 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.14s]
05:05:02.906812 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:05:02.911220 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:05:02.914787 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
05:05:02.919487 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:05:02.923109 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:05:02.926163 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:05:02.940319 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:05:02.950104 [debug] [Thread-1  ]: finished collecting timing info
05:05:02.953286 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:05:02.958489 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:05:02.970095 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:05:02.974007 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
05:05:02.977740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:05:02.989829 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:05:02.992893 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:05:02.994910 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
05:05:03.005264 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
05:05:03.011117 [debug] [Thread-1  ]: finished collecting timing info
05:05:03.013411 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
05:05:03.016293 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
05:05:03.027903 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.11s]
05:05:03.033120 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:05:03.041267 [debug] [MainThread]: Acquiring new postgres connection "master"
05:05:03.044107 [debug] [MainThread]: Using postgres connection "master"
05:05:03.046576 [debug] [MainThread]: On master: BEGIN
05:05:03.049251 [debug] [MainThread]: Opening a new connection, currently in state closed
05:05:03.059340 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:05:03.062276 [debug] [MainThread]: On master: COMMIT
05:05:03.064703 [debug] [MainThread]: Using postgres connection "master"
05:05:03.067610 [debug] [MainThread]: On master: COMMIT
05:05:03.070474 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:05:03.072780 [debug] [MainThread]: On master: Close
05:05:03.078381 [info ] [MainThread]: 
05:05:03.081278 [info ] [MainThread]: Finished running 2 tests in 0.50s.
05:05:03.084157 [debug] [MainThread]: Connection 'master' was properly closed.
05:05:03.087285 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
05:05:03.109482 [info ] [MainThread]: 
05:05:03.112320 [info ] [MainThread]: [32mCompleted successfully[0m
05:05:03.115580 [info ] [MainThread]: 
05:05:03.119016 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 05:05:08.983435 | fac1e4a4-50d5-4f66-98ba-43fb57f6e1a2 ==============================
05:05:08.983435 [info ] [MainThread]: Running with dbt=1.0.0
05:05:08.988998 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
05:05:08.993400 [debug] [MainThread]: Tracking: do not track
05:05:09.052795 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:05:09.117981 [debug] [MainThread]: Parsing macros/catalog.sql
05:05:09.132447 [debug] [MainThread]: Parsing macros/adapters.sql
05:05:09.182231 [debug] [MainThread]: Parsing macros/relations.sql
05:05:09.188127 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:05:09.196898 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:05:09.201168 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:05:09.210199 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:05:09.213604 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:05:09.217939 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:05:09.225212 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:05:09.237626 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:05:09.265336 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:05:09.271414 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:05:09.296752 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:05:09.309018 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:05:09.344052 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:05:09.352454 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:05:09.370290 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:05:09.382348 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:05:09.401045 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:05:09.405659 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:05:09.412763 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:05:09.427651 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:05:09.435359 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:05:09.441610 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:05:09.459218 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:05:09.495265 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:05:09.533728 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:05:09.560862 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:05:09.587526 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:05:09.593987 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:05:09.599986 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:05:09.607562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:05:09.616417 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:05:09.628574 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:05:09.640090 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:05:09.649501 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:05:09.665321 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:05:09.688168 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:05:09.718019 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:05:09.753792 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:05:09.785602 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:05:09.799633 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:05:10.176252 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:05:10.202456 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:05:10.217382 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:05:10.396335 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:05:10.402586 [info ] [MainThread]: 
05:05:10.407681 [debug] [MainThread]: Acquiring new postgres connection "master"
05:05:10.413764 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
05:05:10.435276 [debug] [ThreadPool]: Using postgres connection "list_dbt"
05:05:10.439060 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
05:05:10.441447 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:05:10.455896 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
05:05:10.462487 [debug] [ThreadPool]: On list_dbt: Close
05:05:10.471136 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:05:10.486064 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:05:10.489051 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:05:10.491564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
05:05:10.505471 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:05:10.509055 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:05:10.512508 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:05:10.521544 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
05:05:10.527319 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:05:10.531775 [debug] [ThreadPool]: On list_dbt_dev: Close
05:05:10.550631 [debug] [MainThread]: Using postgres connection "master"
05:05:10.553224 [debug] [MainThread]: On master: BEGIN
05:05:10.556577 [debug] [MainThread]: Opening a new connection, currently in state init
05:05:10.566582 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:05:10.569926 [debug] [MainThread]: Using postgres connection "master"
05:05:10.572516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:05:10.593550 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
05:05:10.603703 [debug] [MainThread]: On master: ROLLBACK
05:05:10.607227 [debug] [MainThread]: Using postgres connection "master"
05:05:10.610725 [debug] [MainThread]: On master: BEGIN
05:05:10.614805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:05:10.618582 [debug] [MainThread]: On master: COMMIT
05:05:10.621131 [debug] [MainThread]: Using postgres connection "master"
05:05:10.623875 [debug] [MainThread]: On master: COMMIT
05:05:10.626781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:05:10.629209 [debug] [MainThread]: On master: Close
05:05:10.638905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:05:10.643038 [info ] [MainThread]: 
05:05:10.703295 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
05:05:10.707544 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
05:05:10.711606 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
05:05:10.715645 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
05:05:10.720431 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
05:05:10.732430 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
05:05:10.751266 [debug] [Thread-1  ]: finished collecting timing info
05:05:10.756010 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
05:05:10.879968 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
05:05:10.911062 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:05:10.914562 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
05:05:10.923671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:05:10.938227 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:05:10.941913 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:05:10.949048 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      

  create  table "dbt"."dev"."agg_users"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
05:05:10.963302 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
05:05:10.996349 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
05:05:10.999178 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:05:11.002598 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
05:05:11.009838 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
05:05:11.014103 [debug] [Thread-1  ]: finished collecting timing info
05:05:11.017234 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
05:05:11.023809 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mSELECT 5[0m in 0.31s]
05:05:11.028315 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
05:05:11.034325 [debug] [MainThread]: Acquiring new postgres connection "master"
05:05:11.039196 [debug] [MainThread]: Using postgres connection "master"
05:05:11.042222 [debug] [MainThread]: On master: BEGIN
05:05:11.045951 [debug] [MainThread]: Opening a new connection, currently in state closed
05:05:11.057987 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:05:11.062424 [debug] [MainThread]: On master: COMMIT
05:05:11.066283 [debug] [MainThread]: Using postgres connection "master"
05:05:11.071056 [debug] [MainThread]: On master: COMMIT
05:05:11.074547 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:05:11.078020 [debug] [MainThread]: On master: Close
05:05:11.082124 [info ] [MainThread]: 
05:05:11.087911 [info ] [MainThread]: Finished running 1 incremental model in 0.68s.
05:05:11.092160 [debug] [MainThread]: Connection 'master' was properly closed.
05:05:11.097430 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
05:05:11.124071 [info ] [MainThread]: 
05:05:11.128234 [info ] [MainThread]: [32mCompleted successfully[0m
05:05:11.132110 [info ] [MainThread]: 
05:05:11.137214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 05:07:09.313476 | e807af5a-f4f9-4f5d-a228-3c19f363129f ==============================
05:07:09.313476 [info ] [MainThread]: Running with dbt=1.0.0
05:07:09.322897 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-26"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
05:07:09.330738 [debug] [MainThread]: Tracking: do not track
05:07:09.414671 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:07:09.470293 [debug] [MainThread]: Parsing macros/catalog.sql
05:07:09.485610 [debug] [MainThread]: Parsing macros/adapters.sql
05:07:09.534851 [debug] [MainThread]: Parsing macros/relations.sql
05:07:09.541397 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:07:09.555068 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:07:09.561188 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:07:09.567560 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:07:09.574432 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:07:09.580321 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:07:09.591447 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:07:09.607492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:07:09.639314 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:07:09.645308 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:07:09.670150 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:07:09.687494 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:07:09.722225 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:07:09.730093 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:07:09.746783 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:07:09.755459 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:07:09.771357 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:07:09.776147 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:07:09.782793 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:07:09.793790 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:07:09.800384 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:07:09.807550 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:07:09.830908 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:07:09.890009 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:07:09.934464 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:07:09.970202 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:07:10.004006 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:07:10.012304 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:07:10.020730 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:07:10.029218 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:07:10.036184 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:07:10.049881 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:07:10.062024 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:07:10.071957 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:07:10.084828 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:07:10.103251 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:07:10.135320 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:07:10.167085 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:07:10.191979 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:07:10.205502 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:07:10.646086 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:07:10.670579 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:07:10.681116 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:07:10.852005 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:07:10.858329 [info ] [MainThread]: 
05:07:10.862441 [debug] [MainThread]: Acquiring new postgres connection "master"
05:07:10.867193 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
05:07:10.886643 [debug] [ThreadPool]: Using postgres connection "list_dbt"
05:07:10.889109 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
05:07:10.890914 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:07:10.902899 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
05:07:10.907445 [debug] [ThreadPool]: On list_dbt: Close
05:07:10.913390 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:07:10.924983 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:07:10.927037 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:07:10.929021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
05:07:10.937378 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:07:10.940258 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:07:10.942994 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:07:10.950064 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
05:07:10.954118 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:07:10.956760 [debug] [ThreadPool]: On list_dbt_dev: Close
05:07:10.968540 [debug] [MainThread]: Using postgres connection "master"
05:07:10.970203 [debug] [MainThread]: On master: BEGIN
05:07:10.973118 [debug] [MainThread]: Opening a new connection, currently in state init
05:07:10.986106 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:07:10.989004 [debug] [MainThread]: Using postgres connection "master"
05:07:10.993740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:07:11.003509 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
05:07:11.010577 [debug] [MainThread]: On master: ROLLBACK
05:07:11.012995 [debug] [MainThread]: Using postgres connection "master"
05:07:11.025835 [debug] [MainThread]: On master: BEGIN
05:07:11.033179 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:07:11.037265 [debug] [MainThread]: On master: COMMIT
05:07:11.040525 [debug] [MainThread]: Using postgres connection "master"
05:07:11.043252 [debug] [MainThread]: On master: COMMIT
05:07:11.045803 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:07:11.048450 [debug] [MainThread]: On master: Close
05:07:11.054523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:07:11.057813 [info ] [MainThread]: 
05:07:11.084821 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users_stage
05:07:11.086988 [info ] [Thread-1  ]: 1 of 1 START table model dev.agg_users_stage.................................... [RUN]
05:07:11.090169 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users_stage"
05:07:11.092744 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users_stage
05:07:11.095077 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users_stage
05:07:11.104419 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users_stage"
05:07:11.110441 [debug] [Thread-1  ]: finished collecting timing info
05:07:11.114230 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users_stage
05:07:11.181170 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users_stage"
05:07:11.193561 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:07:11.196292 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: BEGIN
05:07:11.200300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:07:11.222006 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
05:07:11.227346 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:07:11.232630 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */


  create  table "dbt"."dev"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-26' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev"."users" a
LEFT JOIN "dbt"."dev"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-26'
LEFT JOIN "dbt"."dev"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-26'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-26'
GROUP BY 1,2,3,4,5
  );
05:07:11.248005 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.01 seconds
05:07:11.269189 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:07:11.272747 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage" rename to "agg_users_stage__dbt_backup"
05:07:11.276420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
05:07:11.285854 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:07:11.289140 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
alter table "dbt"."dev"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
05:07:11.292729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
05:07:11.314802 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
05:07:11.317145 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:07:11.320196 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: COMMIT
05:07:11.325013 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
05:07:11.335423 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users_stage"
05:07:11.337556 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users_stage"} */
drop table if exists "dbt"."dev"."agg_users_stage__dbt_backup" cascade
05:07:11.342808 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
05:07:11.346386 [debug] [Thread-1  ]: finished collecting timing info
05:07:11.348491 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users_stage: Close
05:07:11.354159 [info ] [Thread-1  ]: 1 of 1 OK created table model dev.agg_users_stage............................... [[32mSELECT 4[0m in 0.26s]
05:07:11.357102 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users_stage
05:07:11.361371 [debug] [MainThread]: Acquiring new postgres connection "master"
05:07:11.363452 [debug] [MainThread]: Using postgres connection "master"
05:07:11.365767 [debug] [MainThread]: On master: BEGIN
05:07:11.368093 [debug] [MainThread]: Opening a new connection, currently in state closed
05:07:11.375951 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:07:11.378587 [debug] [MainThread]: On master: COMMIT
05:07:11.381169 [debug] [MainThread]: Using postgres connection "master"
05:07:11.383145 [debug] [MainThread]: On master: COMMIT
05:07:11.385875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:07:11.388010 [debug] [MainThread]: On master: Close
05:07:11.392391 [info ] [MainThread]: 
05:07:11.394913 [info ] [MainThread]: Finished running 1 table model in 0.53s.
05:07:11.397205 [debug] [MainThread]: Connection 'master' was properly closed.
05:07:11.398972 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users_stage' was properly closed.
05:07:11.422576 [info ] [MainThread]: 
05:07:11.426604 [info ] [MainThread]: [32mCompleted successfully[0m
05:07:11.430397 [info ] [MainThread]: 
05:07:11.434065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 05:07:18.110272 | d8701e1c-2971-4a72-9bad-815daec324ea ==============================
05:07:18.110272 [info ] [MainThread]: Running with dbt=1.0.0
05:07:18.113931 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
05:07:18.116777 [debug] [MainThread]: Tracking: do not track
05:07:18.198534 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:07:18.280469 [debug] [MainThread]: Parsing macros/catalog.sql
05:07:18.288906 [debug] [MainThread]: Parsing macros/adapters.sql
05:07:18.333342 [debug] [MainThread]: Parsing macros/relations.sql
05:07:18.338024 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:07:18.343080 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:07:18.346897 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:07:18.351591 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:07:18.354558 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:07:18.358936 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:07:18.369116 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:07:18.381851 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:07:18.407181 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:07:18.412579 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:07:18.432756 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:07:18.442631 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:07:18.476618 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:07:18.484540 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:07:18.500380 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:07:18.507817 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:07:18.522929 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:07:18.527871 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:07:18.534833 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:07:18.546609 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:07:18.552063 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:07:18.557560 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:07:18.571520 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:07:18.605165 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:07:18.637020 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:07:18.661382 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:07:18.686519 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:07:18.692817 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:07:18.697815 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:07:18.705217 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:07:18.710288 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:07:18.717467 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:07:18.723851 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:07:18.732491 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:07:18.743330 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:07:18.758540 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:07:18.777952 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:07:18.798692 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:07:18.816430 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:07:18.826450 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:07:19.175035 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:07:19.202842 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:07:19.216561 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:07:19.379235 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:07:19.383781 [info ] [MainThread]: 
05:07:19.386668 [debug] [MainThread]: Acquiring new postgres connection "master"
05:07:19.391131 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:07:19.409968 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:07:19.412415 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:07:19.414631 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:07:19.424009 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:07:19.426838 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:07:19.429624 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:07:19.436854 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
05:07:19.440997 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:07:19.443879 [debug] [ThreadPool]: On list_dbt_dev: Close
05:07:19.452968 [debug] [MainThread]: Using postgres connection "master"
05:07:19.455360 [debug] [MainThread]: On master: BEGIN
05:07:19.457591 [debug] [MainThread]: Opening a new connection, currently in state init
05:07:19.466424 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:07:19.468872 [debug] [MainThread]: Using postgres connection "master"
05:07:19.471282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:07:19.480858 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
05:07:19.484562 [debug] [MainThread]: On master: ROLLBACK
05:07:19.486672 [debug] [MainThread]: Using postgres connection "master"
05:07:19.488572 [debug] [MainThread]: On master: BEGIN
05:07:19.491507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:07:19.493828 [debug] [MainThread]: On master: COMMIT
05:07:19.496390 [debug] [MainThread]: Using postgres connection "master"
05:07:19.498618 [debug] [MainThread]: On master: COMMIT
05:07:19.501519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:07:19.503995 [debug] [MainThread]: On master: Close
05:07:19.508654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:07:19.511673 [info ] [MainThread]: 
05:07:19.538465 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:07:19.540997 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
05:07:19.544791 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:07:19.547149 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:07:19.549191 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:07:19.566059 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:07:19.576261 [debug] [Thread-1  ]: finished collecting timing info
05:07:19.579769 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:07:19.609231 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:07:19.615997 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:07:19.618662 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
05:07:19.620910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:07:19.630186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:07:19.632751 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"
05:07:19.635024 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
05:07:19.639321 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
05:07:19.644461 [debug] [Thread-1  ]: finished collecting timing info
05:07:19.646845 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
05:07:19.649533 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
05:07:19.655269 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.11s]
05:07:19.658778 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_dt.068f05fb1a
05:07:19.661587 [debug] [Thread-1  ]: Began running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:07:19.663937 [info ] [Thread-1  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
05:07:19.668637 [debug] [Thread-1  ]: Acquiring new postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:07:19.671895 [debug] [Thread-1  ]: Began compiling node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:07:19.674696 [debug] [Thread-1  ]: Compiling test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:07:19.688734 [debug] [Thread-1  ]: Writing injected SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:07:19.695862 [debug] [Thread-1  ]: finished collecting timing info
05:07:19.699041 [debug] [Thread-1  ]: Began executing node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:07:19.709650 [debug] [Thread-1  ]: Writing runtime SQL for node "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:07:19.718479 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:07:19.722160 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
05:07:19.725299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:07:19.740202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
05:07:19.743362 [debug] [Thread-1  ]: Using postgres connection "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
05:07:19.746410 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
05:07:19.753801 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
05:07:19.761436 [debug] [Thread-1  ]: finished collecting timing info
05:07:19.764782 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
05:07:19.768533 [debug] [Thread-1  ]: On test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
05:07:19.776152 [info ] [Thread-1  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.11s]
05:07:19.780380 [debug] [Thread-1  ]: Finished running node test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55
05:07:19.785816 [debug] [MainThread]: Acquiring new postgres connection "master"
05:07:19.789467 [debug] [MainThread]: Using postgres connection "master"
05:07:19.793252 [debug] [MainThread]: On master: BEGIN
05:07:19.796054 [debug] [MainThread]: Opening a new connection, currently in state closed
05:07:19.809655 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:07:19.812135 [debug] [MainThread]: On master: COMMIT
05:07:19.813989 [debug] [MainThread]: Using postgres connection "master"
05:07:19.816308 [debug] [MainThread]: On master: COMMIT
05:07:19.818829 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:07:19.821415 [debug] [MainThread]: On master: Close
05:07:19.824131 [info ] [MainThread]: 
05:07:19.826510 [info ] [MainThread]: Finished running 2 tests in 0.44s.
05:07:19.828924 [debug] [MainThread]: Connection 'master' was properly closed.
05:07:19.831522 [debug] [MainThread]: Connection 'test.bungie_dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
05:07:19.846752 [info ] [MainThread]: 
05:07:19.850445 [info ] [MainThread]: [32mCompleted successfully[0m
05:07:19.852908 [info ] [MainThread]: 
05:07:19.855542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 05:07:25.421898 | 178c055b-089f-4378-9479-c406779cfc36 ==============================
05:07:25.421898 [info ] [MainThread]: Running with dbt=1.0.0
05:07:25.424177 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-26"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
05:07:25.428338 [debug] [MainThread]: Tracking: do not track
05:07:25.501046 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
05:07:25.585184 [debug] [MainThread]: Parsing macros/catalog.sql
05:07:25.602947 [debug] [MainThread]: Parsing macros/adapters.sql
05:07:25.650888 [debug] [MainThread]: Parsing macros/relations.sql
05:07:25.657336 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
05:07:25.665266 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:07:25.670461 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:07:25.677445 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:07:25.681473 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:07:25.686355 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:07:25.694238 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:07:25.704342 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:07:25.728726 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:07:25.734067 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:07:25.755151 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:07:25.765981 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:07:25.800085 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:07:25.807879 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:07:25.823899 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:07:25.831060 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:07:25.846173 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:07:25.850936 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:07:25.858305 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:07:25.869396 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:07:25.875486 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:07:25.881537 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:07:25.895366 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:07:25.930257 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:07:25.979160 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:07:26.010195 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:07:26.038020 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:07:26.043383 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:07:26.048227 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:07:26.054863 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:07:26.062720 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:07:26.072266 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:07:26.081322 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:07:26.090612 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:07:26.102911 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:07:26.119834 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:07:26.140031 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:07:26.161673 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:07:26.180099 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:07:26.190892 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:07:26.635531 [debug] [MainThread]: 1699: static parser successfully parsed example/agg_users.sql
05:07:26.655845 [debug] [MainThread]: 1603: static parser failed on staging/agg_users_stage.sql
05:07:26.665445 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/agg_users_stage.sql
05:07:26.812989 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
05:07:26.817701 [info ] [MainThread]: 
05:07:26.820690 [debug] [MainThread]: Acquiring new postgres connection "master"
05:07:26.824752 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
05:07:26.842532 [debug] [ThreadPool]: Using postgres connection "list_dbt"
05:07:26.844670 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
05:07:26.846818 [debug] [ThreadPool]: Opening a new connection, currently in state init
05:07:26.855236 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
05:07:26.860905 [debug] [ThreadPool]: On list_dbt: Close
05:07:26.867680 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev"
05:07:26.880039 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:07:26.882441 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
05:07:26.884479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
05:07:26.893028 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
05:07:26.895578 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
05:07:26.898286 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
05:07:26.903144 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
05:07:26.907429 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
05:07:26.910266 [debug] [ThreadPool]: On list_dbt_dev: Close
05:07:26.921820 [debug] [MainThread]: Using postgres connection "master"
05:07:26.924256 [debug] [MainThread]: On master: BEGIN
05:07:26.926290 [debug] [MainThread]: Opening a new connection, currently in state init
05:07:26.935810 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:07:26.938753 [debug] [MainThread]: Using postgres connection "master"
05:07:26.941559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
05:07:26.952583 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
05:07:26.957206 [debug] [MainThread]: On master: ROLLBACK
05:07:26.959821 [debug] [MainThread]: Using postgres connection "master"
05:07:26.962427 [debug] [MainThread]: On master: BEGIN
05:07:26.966497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
05:07:26.971296 [debug] [MainThread]: On master: COMMIT
05:07:26.974193 [debug] [MainThread]: Using postgres connection "master"
05:07:26.978157 [debug] [MainThread]: On master: COMMIT
05:07:26.981660 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:07:26.984233 [debug] [MainThread]: On master: Close
05:07:26.989707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
05:07:26.993824 [info ] [MainThread]: 
05:07:27.032910 [debug] [Thread-1  ]: Began running node model.bungie_dwh.agg_users
05:07:27.036368 [info ] [Thread-1  ]: 1 of 1 START incremental model dev.agg_users.................................... [RUN]
05:07:27.041915 [debug] [Thread-1  ]: Acquiring new postgres connection "model.bungie_dwh.agg_users"
05:07:27.046829 [debug] [Thread-1  ]: Began compiling node model.bungie_dwh.agg_users
05:07:27.052181 [debug] [Thread-1  ]: Compiling model.bungie_dwh.agg_users
05:07:27.070335 [debug] [Thread-1  ]: Writing injected SQL for node "model.bungie_dwh.agg_users"
05:07:27.087215 [debug] [Thread-1  ]: finished collecting timing info
05:07:27.093602 [debug] [Thread-1  ]: Began executing node model.bungie_dwh.agg_users
05:07:27.202191 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:07:27.205330 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

    

  create temporary table "agg_users__dbt_tmp050727171621"
  as (
    

SELECT
    *
FROM "dbt"."dev"."agg_users_stage"
  );
  
05:07:27.209270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
05:07:27.223307 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.01 seconds
05:07:27.242547 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:07:27.245285 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: BEGIN
05:07:27.248662 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
05:07:27.251234 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:07:27.253478 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'agg_users__dbt_tmp050727171621'
        
      order by ordinal_position

  
05:07:27.268216 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
05:07:27.277798 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:07:27.281122 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
05:07:27.290634 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.01 seconds
05:07:27.305016 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:07:27.307732 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt".INFORMATION_SCHEMA.columns
      where table_name = 'agg_users'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
05:07:27.313776 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.0 seconds
05:07:27.334349 [debug] [Thread-1  ]: Writing runtime SQL for node "model.bungie_dwh.agg_users"
05:07:27.342021 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:07:27.346319 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "bungie_dwh", "target_name": "dev", "node_id": "model.bungie_dwh.agg_users"} */

      
    delete from "dbt"."dev"."agg_users"
    where (dt) in (
        select (dt)
        from "agg_users__dbt_tmp050727171621"
    );
    

    insert into "dbt"."dev"."agg_users" ("dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue")
    (
        select "dt", "user_id", "first_name", "last_name", "country_code", "session_count", "total_revenue"
        from "agg_users__dbt_tmp050727171621"
    )
  
05:07:27.352960 [debug] [Thread-1  ]: SQL status: INSERT 0 4 in 0.0 seconds
05:07:27.375575 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
05:07:27.378004 [debug] [Thread-1  ]: Using postgres connection "model.bungie_dwh.agg_users"
05:07:27.380723 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: COMMIT
05:07:27.389293 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
05:07:27.392847 [debug] [Thread-1  ]: finished collecting timing info
05:07:27.395615 [debug] [Thread-1  ]: On model.bungie_dwh.agg_users: Close
05:07:27.402727 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev.agg_users............................... [[32mINSERT 0 4[0m in 0.36s]
05:07:27.409647 [debug] [Thread-1  ]: Finished running node model.bungie_dwh.agg_users
05:07:27.414393 [debug] [MainThread]: Acquiring new postgres connection "master"
05:07:27.418534 [debug] [MainThread]: Using postgres connection "master"
05:07:27.420868 [debug] [MainThread]: On master: BEGIN
05:07:27.425283 [debug] [MainThread]: Opening a new connection, currently in state closed
05:07:27.439334 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
05:07:27.443234 [debug] [MainThread]: On master: COMMIT
05:07:27.445688 [debug] [MainThread]: Using postgres connection "master"
05:07:27.448590 [debug] [MainThread]: On master: COMMIT
05:07:27.454897 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
05:07:27.458937 [debug] [MainThread]: On master: Close
05:07:27.462123 [info ] [MainThread]: 
05:07:27.468773 [info ] [MainThread]: Finished running 1 incremental model in 0.64s.
05:07:27.474888 [debug] [MainThread]: Connection 'master' was properly closed.
05:07:27.478393 [debug] [MainThread]: Connection 'model.bungie_dwh.agg_users' was properly closed.
05:07:27.511210 [info ] [MainThread]: 
05:07:27.518082 [info ] [MainThread]: [32mCompleted successfully[0m
05:07:27.521900 [info ] [MainThread]: 
05:07:27.527859 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 17:50:33.169137 | 44bb5996-5cd2-4a48-be64-7e0a776d15c0 ==============================
17:50:33.169137 [info ] [MainThread]: Running with dbt=1.0.0
17:50:33.174124 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{ds:2021-12-27}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:50:33.178843 [debug] [MainThread]: Tracking: do not track
17:50:33.306086 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
17:50:33.312887 [info ] [MainThread]: Unable to do partial parsing because profile has changed
17:50:33.318237 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
17:50:33.632264 [debug] [MainThread]: Parsing macros/catalog.sql
17:50:33.647756 [debug] [MainThread]: Parsing macros/adapters.sql
17:50:33.703430 [debug] [MainThread]: Parsing macros/relations.sql
17:50:33.712100 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:50:33.720232 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:50:33.728777 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:50:33.736109 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:50:33.741302 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:50:33.746926 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:50:33.759010 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:50:33.778380 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:50:33.817569 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:50:33.828259 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:50:33.869710 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:50:33.897516 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:50:33.974327 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:50:33.986632 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:50:34.034706 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:50:34.052432 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:50:34.085922 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:50:34.093948 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:50:34.106024 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:50:34.121302 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:50:34.134293 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:50:34.143505 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:50:34.181152 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:50:34.568136 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:50:34.654037 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:50:34.739544 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:50:34.811587 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:50:34.821801 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:50:34.830248 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:50:34.843558 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:50:34.851058 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:50:34.865457 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:50:34.887773 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:50:34.907928 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:50:34.926572 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:50:34.956226 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:50:34.997171 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:50:35.039499 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:50:35.063747 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:50:35.078606 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:50:35.452079 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
17:50:35.474265 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
17:50:35.484483 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
17:50:35.610195 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.staging.core

17:50:35.646808 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:50:35.652063 [info ] [MainThread]: 
17:50:35.655190 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:35.659697 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:50:35.680714 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:50:35.683227 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:50:35.686064 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:50:35.729559 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
17:50:35.734481 [debug] [ThreadPool]: On list_dbt: Close
17:50:35.740009 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner"
17:50:35.743267 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner"
17:50:35.746088 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_hturner', identifier=None)"
17:50:35.759633 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner"
17:50:35.763731 [debug] [ThreadPool]: On create_dbt_dev_hturner: BEGIN
17:50:35.766794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:50:35.793239 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
17:50:35.796668 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner"
17:50:35.799637 [debug] [ThreadPool]: On create_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "create_dbt_dev_hturner"} */
create schema if not exists "dev_hturner"
17:50:35.804814 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
17:50:35.809674 [debug] [ThreadPool]: On create_dbt_dev_hturner: COMMIT
17:50:35.812136 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner"
17:50:35.814539 [debug] [ThreadPool]: On create_dbt_dev_hturner: COMMIT
17:50:35.819271 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
17:50:35.822265 [debug] [ThreadPool]: On create_dbt_dev_hturner: Close
17:50:35.828626 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
17:50:35.842822 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:50:35.845484 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
17:50:35.848109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:50:35.860078 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:50:35.864182 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:50:35.867043 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
17:50:35.873830 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
17:50:35.880170 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
17:50:35.883468 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
17:50:35.895644 [debug] [MainThread]: Using postgres connection "master"
17:50:35.899703 [debug] [MainThread]: On master: BEGIN
17:50:35.902323 [debug] [MainThread]: Opening a new connection, currently in state init
17:50:35.913121 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:50:35.916674 [debug] [MainThread]: Using postgres connection "master"
17:50:35.919003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:50:35.925669 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
17:50:35.930011 [debug] [MainThread]: On master: ROLLBACK
17:50:35.932455 [debug] [MainThread]: Using postgres connection "master"
17:50:35.934694 [debug] [MainThread]: On master: BEGIN
17:50:35.937764 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:35.941133 [debug] [MainThread]: On master: COMMIT
17:50:35.944096 [debug] [MainThread]: Using postgres connection "master"
17:50:35.947011 [debug] [MainThread]: On master: COMMIT
17:50:35.952767 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:35.956552 [debug] [MainThread]: On master: Close
17:50:35.960158 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
17:50:35.964037 [info ] [MainThread]: 
17:50:35.992608 [debug] [Thread-1  ]: Began running node model.dwh.agg_users_stage
17:50:35.995572 [info ] [Thread-1  ]: 1 of 1 START table model dev_hturner.agg_users_stage............................ [RUN]
17:50:35.999778 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
17:50:36.001934 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users_stage
17:50:36.004080 [debug] [Thread-1  ]: Compiling model.dwh.agg_users_stage
17:50:36.015401 [debug] [Thread-1  ]: finished collecting timing info
17:50:36.017864 [debug] [Thread-1  ]: Compilation Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {
      "ds:2021-12-27": null
  }
  
  > in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:50:36.020563 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev_hturner.agg_users_stage................... [[31mERROR[0m in 0.02s]
17:50:36.023717 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users_stage
17:50:36.027711 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:36.029862 [debug] [MainThread]: Using postgres connection "master"
17:50:36.031775 [debug] [MainThread]: On master: BEGIN
17:50:36.033569 [debug] [MainThread]: Opening a new connection, currently in state closed
17:50:36.053719 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:50:36.057466 [debug] [MainThread]: On master: COMMIT
17:50:36.059656 [debug] [MainThread]: Using postgres connection "master"
17:50:36.061664 [debug] [MainThread]: On master: COMMIT
17:50:36.063939 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:36.065806 [debug] [MainThread]: On master: Close
17:50:36.068289 [info ] [MainThread]: 
17:50:36.070791 [info ] [MainThread]: Finished running 1 table model in 0.41s.
17:50:36.075482 [debug] [MainThread]: Connection 'master' was properly closed.
17:50:36.077875 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
17:50:36.121242 [info ] [MainThread]: 
17:50:36.125861 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:50:36.130530 [info ] [MainThread]: 
17:50:36.134257 [error] [MainThread]: [33mCompilation Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)[0m
17:50:36.141090 [error] [MainThread]:   Required var 'ds' not found in config:
17:50:36.146669 [error] [MainThread]:   Vars supplied to agg_users_stage = {
17:50:36.150072 [error] [MainThread]:       "ds:2021-12-27": null
17:50:36.153516 [error] [MainThread]:   }
17:50:36.156360 [error] [MainThread]:   
17:50:36.159819 [error] [MainThread]:   > in model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:50:36.163557 [error] [MainThread]:   > called by model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:50:36.166748 [info ] [MainThread]: 
17:50:36.169869 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 17:52:47.585593 | e4e3598d-94b6-4d7d-8de7-3dfca927910e ==============================
17:52:47.585593 [info ] [MainThread]: Running with dbt=1.0.0
17:52:47.596836 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{ds:2021-12-27}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:52:47.599843 [debug] [MainThread]: Tracking: do not track
17:52:47.763828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:52:47.767602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:52:47.773455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.staging.core

17:52:47.830783 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:52:47.838283 [info ] [MainThread]: 
17:52:47.843901 [debug] [MainThread]: Acquiring new postgres connection "master"
17:52:47.850408 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:52:47.871681 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:52:47.874931 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:52:47.892409 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:52:47.905058 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
17:52:47.910360 [debug] [ThreadPool]: On list_dbt: Close
17:52:47.921220 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
17:52:47.938036 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:52:47.941447 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
17:52:47.944033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:52:47.955588 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:52:47.959062 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:52:47.962121 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
17:52:47.968115 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
17:52:47.972796 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
17:52:47.976637 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
17:52:47.990449 [debug] [MainThread]: Using postgres connection "master"
17:52:47.993363 [debug] [MainThread]: On master: BEGIN
17:52:47.996599 [debug] [MainThread]: Opening a new connection, currently in state init
17:52:48.008172 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:52:48.012532 [debug] [MainThread]: Using postgres connection "master"
17:52:48.094635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:52:48.108025 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:52:48.114914 [debug] [MainThread]: On master: ROLLBACK
17:52:48.119157 [debug] [MainThread]: Using postgres connection "master"
17:52:48.122089 [debug] [MainThread]: On master: BEGIN
17:52:48.126755 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:52:48.131060 [debug] [MainThread]: On master: COMMIT
17:52:48.135713 [debug] [MainThread]: Using postgres connection "master"
17:52:48.138152 [debug] [MainThread]: On master: COMMIT
17:52:48.141192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:52:48.145565 [debug] [MainThread]: On master: Close
17:52:48.156296 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
17:52:48.160410 [info ] [MainThread]: 
17:52:48.201120 [debug] [Thread-1  ]: Began running node model.dwh.agg_users_stage
17:52:48.204102 [info ] [Thread-1  ]: 1 of 1 START table model dev_hturner.agg_users_stage............................ [RUN]
17:52:48.208541 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
17:52:48.211299 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users_stage
17:52:48.214486 [debug] [Thread-1  ]: Compiling model.dwh.agg_users_stage
17:52:48.226209 [debug] [Thread-1  ]: finished collecting timing info
17:52:48.231170 [debug] [Thread-1  ]: Compilation Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {
      "ds:2021-12-27": null
  }
  
  > in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:52:48.235359 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev_hturner.agg_users_stage................... [[31mERROR[0m in 0.03s]
17:52:48.239847 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users_stage
17:52:48.246085 [debug] [MainThread]: Acquiring new postgres connection "master"
17:52:48.248779 [debug] [MainThread]: Using postgres connection "master"
17:52:48.251676 [debug] [MainThread]: On master: BEGIN
17:52:48.253876 [debug] [MainThread]: Opening a new connection, currently in state closed
17:52:48.265358 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:52:48.268385 [debug] [MainThread]: On master: COMMIT
17:52:48.271696 [debug] [MainThread]: Using postgres connection "master"
17:52:48.274313 [debug] [MainThread]: On master: COMMIT
17:52:48.277405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:52:48.280232 [debug] [MainThread]: On master: Close
17:52:48.283010 [info ] [MainThread]: 
17:52:48.288921 [info ] [MainThread]: Finished running 1 table model in 0.44s.
17:52:48.292492 [debug] [MainThread]: Connection 'master' was properly closed.
17:52:48.294812 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
17:52:48.316929 [info ] [MainThread]: 
17:52:48.321150 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:52:48.325100 [info ] [MainThread]: 
17:52:48.328939 [error] [MainThread]: [33mCompilation Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)[0m
17:52:48.332462 [error] [MainThread]:   Required var 'ds' not found in config:
17:52:48.337086 [error] [MainThread]:   Vars supplied to agg_users_stage = {
17:52:48.340937 [error] [MainThread]:       "ds:2021-12-27": null
17:52:48.345044 [error] [MainThread]:   }
17:52:48.348735 [error] [MainThread]:   
17:52:48.351910 [error] [MainThread]:   > in model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:52:48.355276 [error] [MainThread]:   > called by model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:52:48.359363 [info ] [MainThread]: 
17:52:48.366462 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 17:53:55.472875 | 49acf748-d8e5-4037-93e6-a9912b23e28b ==============================
17:53:55.472875 [info ] [MainThread]: Running with dbt=1.0.0
17:53:55.492223 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{ds:2021-12-27}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:53:55.499197 [debug] [MainThread]: Tracking: do not track
17:53:55.691029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:53:55.700357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:53:55.708508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.staging.core

17:53:55.757645 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:53:55.766382 [info ] [MainThread]: 
17:53:55.772739 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:55.776856 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:53:55.807217 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:53:55.810217 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:53:55.814573 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:55.832816 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
17:53:55.841408 [debug] [ThreadPool]: On list_dbt: Close
17:53:55.852289 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
17:53:55.866306 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:53:55.869023 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
17:53:55.871985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:53:55.882819 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:53:55.886408 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:53:55.891009 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
17:53:55.898821 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
17:53:55.902141 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
17:53:55.905455 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
17:53:55.921958 [debug] [MainThread]: Using postgres connection "master"
17:53:55.925706 [debug] [MainThread]: On master: BEGIN
17:53:55.930706 [debug] [MainThread]: Opening a new connection, currently in state init
17:53:55.949905 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:53:55.954374 [debug] [MainThread]: Using postgres connection "master"
17:53:55.958286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:53:55.981639 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
17:53:55.991385 [debug] [MainThread]: On master: ROLLBACK
17:53:55.995557 [debug] [MainThread]: Using postgres connection "master"
17:53:56.002662 [debug] [MainThread]: On master: BEGIN
17:53:56.011320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:56.018448 [debug] [MainThread]: On master: COMMIT
17:53:56.022196 [debug] [MainThread]: Using postgres connection "master"
17:53:56.027960 [debug] [MainThread]: On master: COMMIT
17:53:56.034697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:56.038816 [debug] [MainThread]: On master: Close
17:53:56.045008 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
17:53:56.053253 [info ] [MainThread]: 
17:53:56.097142 [debug] [Thread-1  ]: Began running node model.dwh.agg_users_stage
17:53:56.105411 [info ] [Thread-1  ]: 1 of 1 START table model dev_hturner.agg_users_stage............................ [RUN]
17:53:56.114664 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
17:53:56.118341 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users_stage
17:53:56.123530 [debug] [Thread-1  ]: Compiling model.dwh.agg_users_stage
17:53:56.148658 [debug] [Thread-1  ]: finished collecting timing info
17:53:56.154513 [debug] [Thread-1  ]: Compilation Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {
      "ds:2021-12-27": null
  }
  
  > in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:53:56.163006 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev_hturner.agg_users_stage................... [[31mERROR[0m in 0.05s]
17:53:56.171140 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users_stage
17:53:56.180045 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:56.183680 [debug] [MainThread]: Using postgres connection "master"
17:53:56.185607 [debug] [MainThread]: On master: BEGIN
17:53:56.188015 [debug] [MainThread]: Opening a new connection, currently in state closed
17:53:56.209928 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:53:56.213561 [debug] [MainThread]: On master: COMMIT
17:53:56.218527 [debug] [MainThread]: Using postgres connection "master"
17:53:56.221271 [debug] [MainThread]: On master: COMMIT
17:53:56.228351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:56.233542 [debug] [MainThread]: On master: Close
17:53:56.237416 [info ] [MainThread]: 
17:53:56.242644 [info ] [MainThread]: Finished running 1 table model in 0.47s.
17:53:56.248070 [debug] [MainThread]: Connection 'master' was properly closed.
17:53:56.251256 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
17:53:56.290935 [info ] [MainThread]: 
17:53:56.299755 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:53:56.304530 [info ] [MainThread]: 
17:53:56.307446 [error] [MainThread]: [33mCompilation Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)[0m
17:53:56.312284 [error] [MainThread]:   Required var 'ds' not found in config:
17:53:56.318597 [error] [MainThread]:   Vars supplied to agg_users_stage = {
17:53:56.325822 [error] [MainThread]:       "ds:2021-12-27": null
17:53:56.334150 [error] [MainThread]:   }
17:53:56.338051 [error] [MainThread]:   
17:53:56.349708 [error] [MainThread]:   > in model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:53:56.353475 [error] [MainThread]:   > called by model agg_users_stage (models/staging/core/agg_users_stage.sql)
17:53:56.357794 [info ] [MainThread]: 
17:53:56.362076 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 17:57:15.147341 | 55949812-4e04-46be-af00-2f07117c3402 ==============================
17:57:15.147341 [info ] [MainThread]: Running with dbt=1.0.0
17:57:15.150203 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:57:15.152873 [debug] [MainThread]: Tracking: do not track
17:57:15.261459 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
17:57:15.406506 [debug] [MainThread]: Parsing macros/catalog.sql
17:57:15.424598 [debug] [MainThread]: Parsing macros/adapters.sql
17:57:15.503081 [debug] [MainThread]: Parsing macros/relations.sql
17:57:15.511013 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
17:57:15.518746 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:57:15.530915 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:57:15.540398 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:57:15.545340 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:57:15.550676 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:57:15.562834 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:57:15.582478 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:57:15.632471 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:57:15.646336 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:57:15.710522 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:57:15.743427 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:57:15.810395 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:57:15.823282 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:57:15.845968 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:57:15.860758 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:57:15.879444 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:57:15.886307 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:57:15.892744 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:57:15.910098 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:57:15.919384 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:57:15.925934 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:57:15.943355 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:57:16.422998 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:57:16.484518 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:57:16.519542 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:57:16.549032 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:57:16.556935 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:57:16.563235 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:57:16.572792 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:57:16.579004 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:57:16.589000 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:57:16.596759 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:57:16.609234 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:57:16.623030 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:57:16.641862 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:57:16.664768 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:57:16.687550 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:57:16.717139 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:57:16.731926 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:57:17.296165 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
17:57:17.330633 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
17:57:17.353640 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
17:57:17.522106 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.staging.core

17:57:17.573508 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
17:57:17.579499 [info ] [MainThread]: 
17:57:17.582989 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:17.588774 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
17:57:17.629912 [debug] [ThreadPool]: Using postgres connection "list_dbt"
17:57:17.632836 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
17:57:17.636544 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:57:17.700519 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
17:57:17.710176 [debug] [ThreadPool]: On list_dbt: Close
17:57:17.719203 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
17:57:17.741633 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:57:17.746023 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
17:57:17.750514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:57:17.767144 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:57:17.772699 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
17:57:17.783730 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
17:57:17.801177 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
17:57:17.809430 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
17:57:17.814928 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
17:57:17.837107 [debug] [MainThread]: Using postgres connection "master"
17:57:17.840454 [debug] [MainThread]: On master: BEGIN
17:57:17.844737 [debug] [MainThread]: Opening a new connection, currently in state init
17:57:17.863070 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:57:17.867462 [debug] [MainThread]: Using postgres connection "master"
17:57:17.872295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:57:17.899418 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
17:57:17.910081 [debug] [MainThread]: On master: ROLLBACK
17:57:17.914563 [debug] [MainThread]: Using postgres connection "master"
17:57:17.918255 [debug] [MainThread]: On master: BEGIN
17:57:17.932662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:57:17.935977 [debug] [MainThread]: On master: COMMIT
17:57:17.943233 [debug] [MainThread]: Using postgres connection "master"
17:57:17.948619 [debug] [MainThread]: On master: COMMIT
17:57:17.951794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:17.954483 [debug] [MainThread]: On master: Close
17:57:17.958389 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
17:57:17.963630 [info ] [MainThread]: 
17:57:18.006882 [debug] [Thread-1  ]: Began running node model.dwh.agg_users_stage
17:57:18.009954 [info ] [Thread-1  ]: 1 of 1 START table model dev_hturner.agg_users_stage............................ [RUN]
17:57:18.013950 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
17:57:18.016985 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users_stage
17:57:18.021037 [debug] [Thread-1  ]: Compiling model.dwh.agg_users_stage
17:57:18.036644 [debug] [Thread-1  ]: Writing injected SQL for node "model.dwh.agg_users_stage"
17:57:18.066596 [debug] [Thread-1  ]: finished collecting timing info
17:57:18.069415 [debug] [Thread-1  ]: Began executing node model.dwh.agg_users_stage
17:57:18.118918 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dwh.agg_users_stage"
17:57:18.145812 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
17:57:18.148472 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: BEGIN
17:57:18.151570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:57:18.159870 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:57:18.163290 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
17:57:18.166143 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */


  create  table "dbt"."dev_hturner"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev_hturner"."users" a
LEFT JOIN "dbt"."dev_hturner"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev_hturner"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
17:57:18.173208 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dev_hturner.users" does not exist
LINE 16: FROM "dbt"."dev_hturner"."users" a
              ^

17:57:18.179449 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: ROLLBACK
17:57:18.184331 [debug] [Thread-1  ]: finished collecting timing info
17:57:18.186868 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: Close
17:57:18.189778 [debug] [Thread-1  ]: Database Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  relation "dev_hturner.users" does not exist
  LINE 16: FROM "dbt"."dev_hturner"."users" a
                ^
  compiled SQL at target/run/dwh/models/staging/core/agg_users_stage.sql
17:57:18.194176 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dev_hturner.agg_users_stage................... [[31mERROR[0m in 0.18s]
17:57:18.198546 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users_stage
17:57:18.203741 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:18.206535 [debug] [MainThread]: Using postgres connection "master"
17:57:18.209524 [debug] [MainThread]: On master: BEGIN
17:57:18.213597 [debug] [MainThread]: Opening a new connection, currently in state closed
17:57:18.221887 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:57:18.225202 [debug] [MainThread]: On master: COMMIT
17:57:18.227430 [debug] [MainThread]: Using postgres connection "master"
17:57:18.230293 [debug] [MainThread]: On master: COMMIT
17:57:18.232609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:18.234930 [debug] [MainThread]: On master: Close
17:57:18.239570 [info ] [MainThread]: 
17:57:18.242025 [info ] [MainThread]: Finished running 1 table model in 0.66s.
17:57:18.244793 [debug] [MainThread]: Connection 'master' was properly closed.
17:57:18.246865 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
17:57:18.264667 [info ] [MainThread]: 
17:57:18.267684 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:57:18.270559 [info ] [MainThread]: 
17:57:18.273055 [error] [MainThread]: [33mDatabase Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)[0m
17:57:18.276110 [error] [MainThread]:   relation "dev_hturner.users" does not exist
17:57:18.278710 [error] [MainThread]:   LINE 16: FROM "dbt"."dev_hturner"."users" a
17:57:18.281284 [error] [MainThread]:                 ^
17:57:18.284152 [error] [MainThread]:   compiled SQL at target/run/dwh/models/staging/core/agg_users_stage.sql
17:57:18.289635 [info ] [MainThread]: 
17:57:18.293553 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1


============================== 2021-12-27 18:02:28.045151 | bc83c0d9-b3ad-4f99-ac01-bc8287207a07 ==============================
18:02:28.045151 [info ] [MainThread]: Running with dbt=1.0.0
18:02:28.048617 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, send_anonymous_usage_stats=None, show=False, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='seed', write_json=None)
18:02:28.050592 [debug] [MainThread]: Tracking: tracking
18:02:28.098044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b267aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b267a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b267a490>]}
18:02:28.137489 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:02:28.138134 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:02:28.140088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc83c0d9-b3ad-4f99-ac01-bc8287207a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b2998fd0>]}
18:02:28.197410 [debug] [MainThread]: Parsing macros/catalog.sql
18:02:28.202894 [debug] [MainThread]: Parsing macros/relations.sql
18:02:28.205300 [debug] [MainThread]: Parsing macros/adapters.sql
18:02:28.238515 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:02:28.240990 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:02:28.246641 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:02:28.250039 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:02:28.252463 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:02:28.278255 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:02:28.295989 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:02:28.313471 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:02:28.320239 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:02:28.323273 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:02:28.326842 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:02:28.334564 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:02:28.351658 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:02:28.353971 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:02:28.370128 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:02:28.395021 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:02:28.406169 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:02:28.410495 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:02:28.421523 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:02:28.423683 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:02:28.427727 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:02:28.431289 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:02:28.440765 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:02:28.464866 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:02:28.467159 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:02:28.471275 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:02:28.473804 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:02:28.475140 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:02:28.475980 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:02:28.477008 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:02:28.479577 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:02:28.486347 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:02:28.498361 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:02:28.501690 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:02:28.505702 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:02:28.520517 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:02:28.524711 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:02:28.531207 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:02:28.542574 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:02:28.558457 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:02:28.823896 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:02:28.842870 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:02:28.844829 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:02:28.937031 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.staging.core

18:02:28.945321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc83c0d9-b3ad-4f99-ac01-bc8287207a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b17bdd10>]}
18:02:28.961685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc83c0d9-b3ad-4f99-ac01-bc8287207a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b2911650>]}
18:02:28.963045 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:02:28.969040 [info ] [MainThread]: 
18:02:28.970952 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:28.977155 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:02:29.011225 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:02:29.012685 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:02:29.013775 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:02:29.092472 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.08 seconds
18:02:29.094797 [debug] [ThreadPool]: On list_dbt: Close
18:02:29.097821 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:02:29.111836 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:02:29.112258 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:02:29.112837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:02:29.137406 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:02:29.138022 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:02:29.138626 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:02:29.144840 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
18:02:29.147330 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:02:29.149653 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:02:29.156482 [debug] [MainThread]: Using postgres connection "master"
18:02:29.156847 [debug] [MainThread]: On master: BEGIN
18:02:29.157141 [debug] [MainThread]: Opening a new connection, currently in state init
18:02:29.172896 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:02:29.173478 [debug] [MainThread]: Using postgres connection "master"
18:02:29.173921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:02:29.179266 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:02:29.181047 [debug] [MainThread]: On master: ROLLBACK
18:02:29.183253 [debug] [MainThread]: Using postgres connection "master"
18:02:29.183680 [debug] [MainThread]: On master: BEGIN
18:02:29.187678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:02:29.188196 [debug] [MainThread]: On master: COMMIT
18:02:29.188585 [debug] [MainThread]: Using postgres connection "master"
18:02:29.188876 [debug] [MainThread]: On master: COMMIT
18:02:29.221947 [debug] [MainThread]: SQL status: COMMIT in 0.03 seconds
18:02:29.222539 [debug] [MainThread]: On master: Close
18:02:29.223483 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:02:29.224292 [info ] [MainThread]: 
18:02:29.233777 [debug] [Thread-1  ]: Began running node seed.dwh.payments
18:02:29.234338 [debug] [Thread-2  ]: Began running node seed.dwh.sessions
18:02:29.235212 [info ] [Thread-1  ]: 1 of 3 START seed file dev_hturner.payments..................................... [RUN]
18:02:29.236017 [info ] [Thread-2  ]: 2 of 3 START seed file dev_hturner.sessions..................................... [RUN]
18:02:29.237395 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dwh.payments"
18:02:29.238685 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.dwh.sessions"
18:02:29.239103 [debug] [Thread-1  ]: Began compiling node seed.dwh.payments
18:02:29.239607 [debug] [Thread-2  ]: Began compiling node seed.dwh.sessions
18:02:29.240582 [debug] [Thread-2  ]: finished collecting timing info
18:02:29.240118 [debug] [Thread-1  ]: finished collecting timing info
18:02:29.241082 [debug] [Thread-2  ]: Began executing node seed.dwh.sessions
18:02:29.241562 [debug] [Thread-1  ]: Began executing node seed.dwh.payments
18:02:29.376383 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:02:29.376649 [debug] [Thread-1  ]: On seed.dwh.payments: BEGIN
18:02:29.376882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:29.377275 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:02:29.377697 [debug] [Thread-2  ]: On seed.dwh.sessions: BEGIN
18:02:29.378043 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:02:29.397440 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:02:29.398645 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:02:29.400224 [debug] [Thread-1  ]: On seed.dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.payments"} */

    create table "dbt"."dev_hturner"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
18:02:29.403864 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:02:29.404669 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:02:29.405564 [debug] [Thread-2  ]: On seed.dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.sessions"} */

    create table "dbt"."dev_hturner"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
18:02:29.411258 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
18:02:29.411683 [debug] [Thread-2  ]: SQL status: CREATE TABLE in 0.01 seconds
18:02:29.494459 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:02:29.497632 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:02:29.497887 [debug] [Thread-2  ]: On seed.dwh.sessions: 
          insert into "dbt"."dev_hturner"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
18:02:29.498137 [debug] [Thread-1  ]: On seed.dwh.payments: 
          insert into "dbt"."dev_hturner"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
18:02:29.500125 [debug] [Thread-2  ]: SQL status: INSERT 0 4 in 0.0 seconds
18:02:29.500521 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
18:02:29.506616 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.dwh.sessions"
18:02:29.507130 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dwh.payments"
18:02:29.545938 [debug] [Thread-2  ]: On seed.dwh.sessions: COMMIT
18:02:29.547323 [debug] [Thread-1  ]: On seed.dwh.payments: COMMIT
18:02:29.547606 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:02:29.547947 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:02:29.548283 [debug] [Thread-2  ]: On seed.dwh.sessions: COMMIT
18:02:29.548599 [debug] [Thread-1  ]: On seed.dwh.payments: COMMIT
18:02:29.553224 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:02:29.554630 [debug] [Thread-2  ]: finished collecting timing info
18:02:29.554970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:02:29.555287 [debug] [Thread-2  ]: On seed.dwh.sessions: Close
18:02:29.556019 [debug] [Thread-1  ]: finished collecting timing info
18:02:29.556907 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc83c0d9-b3ad-4f99-ac01-bc8287207a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b2a78b50>]}
18:02:29.557446 [debug] [Thread-1  ]: On seed.dwh.payments: Close
18:02:29.558160 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file dev_hturner.sessions................................. [[32mINSERT 4[0m in 0.32s]
18:02:29.559675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc83c0d9-b3ad-4f99-ac01-bc8287207a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b2a78dd0>]}
18:02:29.560173 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_hturner.payments................................. [[32mINSERT 3[0m in 0.32s]
18:02:29.561065 [debug] [Thread-2  ]: Finished running node seed.dwh.sessions
18:02:29.561733 [debug] [Thread-2  ]: Began running node seed.dwh.users
18:02:29.562352 [info ] [Thread-2  ]: 3 of 3 START seed file dev_hturner.users........................................ [RUN]
18:02:29.563096 [debug] [Thread-1  ]: Finished running node seed.dwh.payments
18:02:29.564883 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.dwh.users"
18:02:29.565770 [debug] [Thread-2  ]: Began compiling node seed.dwh.users
18:02:29.566332 [debug] [Thread-2  ]: finished collecting timing info
18:02:29.567002 [debug] [Thread-2  ]: Began executing node seed.dwh.users
18:02:29.575590 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:02:29.575943 [debug] [Thread-2  ]: On seed.dwh.users: BEGIN
18:02:29.576511 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:02:29.614665 [debug] [Thread-2  ]: SQL status: BEGIN in 0.04 seconds
18:02:29.616164 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:02:29.616535 [debug] [Thread-2  ]: On seed.dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.users"} */

    create table "dbt"."dev_hturner"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text,"created_at" timestamp without time zone)
  
18:02:29.629569 [debug] [Thread-2  ]: SQL status: CREATE TABLE in 0.01 seconds
18:02:29.636262 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:02:29.636621 [debug] [Thread-2  ]: On seed.dwh.users: 
          insert into "dbt"."dev_hturner"."users" ("user_id", "first_name", "last_name", "country_code", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
18:02:29.639115 [debug] [Thread-2  ]: SQL status: INSERT 0 5 in 0.0 seconds
18:02:29.639813 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.dwh.users"
18:02:29.642630 [debug] [Thread-2  ]: On seed.dwh.users: COMMIT
18:02:29.642967 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:02:29.643263 [debug] [Thread-2  ]: On seed.dwh.users: COMMIT
18:02:29.646655 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:02:29.647874 [debug] [Thread-2  ]: finished collecting timing info
18:02:29.648365 [debug] [Thread-2  ]: On seed.dwh.users: Close
18:02:29.649523 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc83c0d9-b3ad-4f99-ac01-bc8287207a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b275a410>]}
18:02:29.650068 [info ] [Thread-2  ]: 3 of 3 OK loaded seed file dev_hturner.users.................................... [[32mINSERT 5[0m in 0.09s]
18:02:29.650722 [debug] [Thread-2  ]: Finished running node seed.dwh.users
18:02:29.683098 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:29.683491 [debug] [MainThread]: Using postgres connection "master"
18:02:29.683738 [debug] [MainThread]: On master: BEGIN
18:02:29.683959 [debug] [MainThread]: Opening a new connection, currently in state closed
18:02:29.708148 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:02:29.708825 [debug] [MainThread]: On master: COMMIT
18:02:29.709158 [debug] [MainThread]: Using postgres connection "master"
18:02:29.709409 [debug] [MainThread]: On master: COMMIT
18:02:29.711192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:02:29.711593 [debug] [MainThread]: On master: Close
18:02:29.712272 [info ] [MainThread]: 
18:02:29.712976 [info ] [MainThread]: Finished running 3 seeds in 0.74s.
18:02:29.713608 [debug] [MainThread]: Connection 'master' was properly closed.
18:02:29.713913 [debug] [MainThread]: Connection 'seed.dwh.payments' was properly closed.
18:02:29.714548 [debug] [MainThread]: Connection 'seed.dwh.users' was properly closed.
18:02:29.727121 [info ] [MainThread]: 
18:02:29.727656 [info ] [MainThread]: [32mCompleted successfully[0m
18:02:29.728337 [info ] [MainThread]: 
18:02:29.728916 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
18:02:29.729591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b2a78cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b292a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b292a090>]}


============================== 2021-12-27 18:02:46.558267 | 98878f6b-c11f-46cf-8dba-b9206c6bc1da ==============================
18:02:46.558267 [info ] [MainThread]: Running with dbt=1.0.0
18:02:46.561598 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:02:46.564761 [debug] [MainThread]: Tracking: do not track
18:02:46.627820 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:02:46.631992 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:02:46.691273 [debug] [MainThread]: Parsing macros/catalog.sql
18:02:46.709023 [debug] [MainThread]: Parsing macros/adapters.sql
18:02:46.769292 [debug] [MainThread]: Parsing macros/relations.sql
18:02:46.776251 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:02:46.784386 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:02:46.790614 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:02:46.797838 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:02:46.801832 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:02:46.806424 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:02:46.816513 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:02:46.828469 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:02:46.853804 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:02:46.858830 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:02:46.880334 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:02:46.895261 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:02:46.930379 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:02:46.938023 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:02:46.952756 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:02:46.963461 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:02:46.980794 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:02:46.985390 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:02:46.991898 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:02:47.006630 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:02:47.014924 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:02:47.021132 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:02:47.038498 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:02:47.075996 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:02:47.109237 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:02:47.133260 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:02:47.156482 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:02:47.163784 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:02:47.169228 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:02:47.175966 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:02:47.180675 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:02:47.187566 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:02:47.193927 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:02:47.201023 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:02:47.210622 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:02:47.227292 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:02:47.249464 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:02:47.269547 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:02:47.287332 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:02:47.298049 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:02:47.639707 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:02:47.661459 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:02:47.670976 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:02:47.904104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.staging.core

18:02:47.954956 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:02:47.964258 [info ] [MainThread]: 
18:02:47.969299 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:47.974375 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:02:47.997478 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:02:48.000617 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:02:48.003803 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:02:48.017780 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:02:48.023845 [debug] [ThreadPool]: On list_dbt: Close
18:02:48.035812 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:02:48.049611 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:02:48.052836 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:02:48.054933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:02:48.066962 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:02:48.070764 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:02:48.072895 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:02:48.080905 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
18:02:48.085969 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:02:48.089701 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:02:48.101935 [debug] [MainThread]: Using postgres connection "master"
18:02:48.104293 [debug] [MainThread]: On master: BEGIN
18:02:48.106741 [debug] [MainThread]: Opening a new connection, currently in state init
18:02:48.118929 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:02:48.122014 [debug] [MainThread]: Using postgres connection "master"
18:02:48.124383 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:02:48.135903 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:02:48.139774 [debug] [MainThread]: On master: ROLLBACK
18:02:48.143169 [debug] [MainThread]: Using postgres connection "master"
18:02:48.146970 [debug] [MainThread]: On master: BEGIN
18:02:48.149908 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:02:48.154077 [debug] [MainThread]: On master: COMMIT
18:02:48.156439 [debug] [MainThread]: Using postgres connection "master"
18:02:48.158949 [debug] [MainThread]: On master: COMMIT
18:02:48.162884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:02:48.165087 [debug] [MainThread]: On master: Close
18:02:48.171199 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:02:48.173752 [info ] [MainThread]: 
18:02:48.203999 [debug] [Thread-1  ]: Began running node model.dwh.agg_users_stage
18:02:48.206055 [info ] [Thread-1  ]: 1 of 1 START table model dev_hturner.agg_users_stage............................ [RUN]
18:02:48.208892 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
18:02:48.212792 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users_stage
18:02:48.214604 [debug] [Thread-1  ]: Compiling model.dwh.agg_users_stage
18:02:48.224985 [debug] [Thread-1  ]: Writing injected SQL for node "model.dwh.agg_users_stage"
18:02:48.233977 [debug] [Thread-1  ]: finished collecting timing info
18:02:48.237000 [debug] [Thread-1  ]: Began executing node model.dwh.agg_users_stage
18:02:48.295173 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dwh.agg_users_stage"
18:02:48.303735 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:02:48.306805 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: BEGIN
18:02:48.310649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:48.321617 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:02:48.325160 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:02:48.329259 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */


  create  table "dbt"."dev_hturner"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev_hturner"."users" a
LEFT JOIN "dbt"."dev_hturner"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev_hturner"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
18:02:48.342448 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:02:48.357393 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:02:48.360032 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */
alter table "dbt"."dev_hturner"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
18:02:48.364973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:02:48.395001 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: COMMIT
18:02:48.397407 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:02:48.400017 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: COMMIT
18:02:48.404255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:02:48.416659 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:02:48.419270 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */
drop table if exists "dbt"."dev_hturner"."agg_users_stage__dbt_backup" cascade
18:02:48.423031 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:02:48.428375 [debug] [Thread-1  ]: finished collecting timing info
18:02:48.431542 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: Close
18:02:48.435873 [info ] [Thread-1  ]: 1 of 1 OK created table model dev_hturner.agg_users_stage....................... [[32mSELECT 5[0m in 0.23s]
18:02:48.441735 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users_stage
18:02:48.447120 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:48.449696 [debug] [MainThread]: Using postgres connection "master"
18:02:48.451690 [debug] [MainThread]: On master: BEGIN
18:02:48.453883 [debug] [MainThread]: Opening a new connection, currently in state closed
18:02:48.463188 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:02:48.466838 [debug] [MainThread]: On master: COMMIT
18:02:48.470165 [debug] [MainThread]: Using postgres connection "master"
18:02:48.472951 [debug] [MainThread]: On master: COMMIT
18:02:48.476158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:02:48.480183 [debug] [MainThread]: On master: Close
18:02:48.485960 [info ] [MainThread]: 
18:02:48.488766 [info ] [MainThread]: Finished running 1 table model in 0.52s.
18:02:48.491764 [debug] [MainThread]: Connection 'master' was properly closed.
18:02:48.494784 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
18:02:48.513340 [info ] [MainThread]: 
18:02:48.517026 [info ] [MainThread]: [32mCompleted successfully[0m
18:02:48.519690 [info ] [MainThread]: 
18:02:48.522731 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 18:02:53.511711 | adce52f7-d177-407f-9c66-5f0c0c805528 ==============================
18:02:53.511711 [info ] [MainThread]: Running with dbt=1.0.0
18:02:53.513504 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
18:02:53.515786 [debug] [MainThread]: Tracking: do not track
18:02:53.591588 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:02:53.687563 [debug] [MainThread]: Parsing macros/catalog.sql
18:02:53.699359 [debug] [MainThread]: Parsing macros/adapters.sql
18:02:53.870541 [debug] [MainThread]: Parsing macros/relations.sql
18:02:53.889885 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:02:53.906524 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:02:53.915399 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:02:53.929681 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:02:53.934665 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:02:53.940770 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:02:53.955821 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:02:53.981338 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:02:54.025681 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:02:54.041606 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:02:54.084892 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:02:54.103728 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:02:54.150281 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:02:54.166293 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:02:54.194111 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:02:54.206730 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:02:54.228357 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:02:54.235466 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:02:54.244884 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:02:54.262394 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:02:54.275684 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:02:54.286192 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:02:54.306550 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:02:54.366049 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:02:54.428304 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:02:54.459815 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:02:54.493574 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:02:54.510369 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:02:54.521316 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:02:54.537364 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:02:54.543191 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:02:54.550896 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:02:54.558591 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:02:54.575495 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:02:54.591800 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:02:54.635180 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:02:54.660154 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:02:54.685845 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:02:54.709288 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:02:54.721951 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:02:55.268383 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:02:55.295262 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:02:55.308673 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:02:55.434535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.staging.core

18:02:55.480296 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:02:55.488599 [info ] [MainThread]: 
18:02:55.491882 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:55.499383 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:02:55.519828 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:02:55.524371 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:02:55.528140 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:02:55.546244 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:02:55.551871 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:02:55.564819 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:02:55.613414 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:02:55.620242 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:02:55.630423 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:02:55.643934 [debug] [MainThread]: Using postgres connection "master"
18:02:55.646772 [debug] [MainThread]: On master: BEGIN
18:02:55.649103 [debug] [MainThread]: Opening a new connection, currently in state init
18:02:55.661651 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:02:55.665835 [debug] [MainThread]: Using postgres connection "master"
18:02:55.668802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:02:55.677828 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:02:55.683245 [debug] [MainThread]: On master: ROLLBACK
18:02:55.686690 [debug] [MainThread]: Using postgres connection "master"
18:02:55.690157 [debug] [MainThread]: On master: BEGIN
18:02:55.694331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:02:55.698596 [debug] [MainThread]: On master: COMMIT
18:02:55.701297 [debug] [MainThread]: Using postgres connection "master"
18:02:55.703597 [debug] [MainThread]: On master: COMMIT
18:02:55.706449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:02:55.709159 [debug] [MainThread]: On master: Close
18:02:55.714538 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:02:55.717288 [info ] [MainThread]: 
18:02:55.744128 [debug] [Thread-1  ]: Began running node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:02:55.744428 [debug] [Thread-2  ]: Began running node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:02:55.747079 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
18:02:55.749618 [info ] [Thread-2  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
18:02:55.753675 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:02:55.757441 [debug] [Thread-2  ]: Acquiring new postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:02:55.760207 [debug] [Thread-1  ]: Began compiling node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:02:55.762802 [debug] [Thread-2  ]: Began compiling node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:02:55.765676 [debug] [Thread-1  ]: Compiling test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:02:55.768050 [debug] [Thread-2  ]: Compiling test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:02:55.804312 [debug] [Thread-2  ]: Writing injected SQL for node "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:02:55.806202 [debug] [Thread-1  ]: Writing injected SQL for node "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:02:55.817835 [debug] [Thread-2  ]: finished collecting timing info
18:02:55.822676 [debug] [Thread-1  ]: finished collecting timing info
18:02:55.828477 [debug] [Thread-1  ]: Began executing node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:02:55.822999 [debug] [Thread-2  ]: Began executing node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:02:55.875127 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:02:55.890513 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:02:55.902413 [debug] [Thread-1  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:02:55.906198 [debug] [Thread-2  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:02:55.907019 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
18:02:55.909619 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
18:02:55.911943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:02:55.914661 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:02:55.930097 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:02:55.935538 [debug] [Thread-2  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:02:55.935059 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:02:55.941540 [debug] [Thread-1  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:02:55.944295 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev_hturner"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
18:02:55.938760 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev_hturner"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
18:02:55.953343 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:02:55.954821 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:02:55.961874 [debug] [Thread-1  ]: finished collecting timing info
18:02:55.967395 [debug] [Thread-2  ]: finished collecting timing info
18:02:55.970715 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
18:02:55.973153 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
18:02:55.976847 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
18:02:55.980886 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
18:02:55.986777 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.23s]
18:02:55.991655 [info ] [Thread-2  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.23s]
18:02:55.999671 [debug] [Thread-2  ]: Finished running node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:02:55.996456 [debug] [Thread-1  ]: Finished running node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:02:56.007871 [debug] [MainThread]: Acquiring new postgres connection "master"
18:02:56.011151 [debug] [MainThread]: Using postgres connection "master"
18:02:56.013355 [debug] [MainThread]: On master: BEGIN
18:02:56.016261 [debug] [MainThread]: Opening a new connection, currently in state closed
18:02:56.023939 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:02:56.027041 [debug] [MainThread]: On master: COMMIT
18:02:56.029410 [debug] [MainThread]: Using postgres connection "master"
18:02:56.031847 [debug] [MainThread]: On master: COMMIT
18:02:56.036602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:02:56.039179 [debug] [MainThread]: On master: Close
18:02:56.043788 [info ] [MainThread]: 
18:02:56.046816 [info ] [MainThread]: Finished running 2 tests in 0.55s.
18:02:56.050247 [debug] [MainThread]: Connection 'master' was properly closed.
18:02:56.052704 [debug] [MainThread]: Connection 'test.dwh.not_null_agg_users_stage_dt.068f05fb1a' was properly closed.
18:02:56.054728 [debug] [MainThread]: Connection 'test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
18:02:56.073244 [info ] [MainThread]: 
18:02:56.077522 [info ] [MainThread]: [32mCompleted successfully[0m
18:02:56.081929 [info ] [MainThread]: 
18:02:56.084596 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 18:03:01.778297 | bb3babe6-4c29-4bde-88a7-558f2d13d239 ==============================
18:03:01.778297 [info ] [MainThread]: Running with dbt=1.0.0
18:03:01.780471 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:03:01.783033 [debug] [MainThread]: Tracking: do not track
18:03:01.838184 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:03:01.909617 [debug] [MainThread]: Parsing macros/catalog.sql
18:03:01.921310 [debug] [MainThread]: Parsing macros/adapters.sql
18:03:01.992373 [debug] [MainThread]: Parsing macros/relations.sql
18:03:01.999326 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:03:02.007864 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:03:02.014030 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:03:02.022698 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:03:02.027315 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:03:02.032270 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:03:02.043642 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:03:02.058312 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:03:02.091015 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:03:02.099445 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:03:02.120426 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:03:02.130417 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:03:02.163281 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:03:02.170494 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:03:02.185154 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:03:02.192271 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:03:02.208656 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:03:02.213514 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:03:02.220262 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:03:02.231916 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:03:02.238087 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:03:02.243396 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:03:02.257638 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:03:02.292197 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:03:02.329714 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:03:02.371290 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:03:02.395293 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:03:02.400749 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:03:02.406397 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:03:02.413296 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:03:02.418302 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:03:02.426152 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:03:02.432322 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:03:02.440344 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:03:02.450439 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:03:02.466492 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:03:02.488310 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:03:02.511573 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:03:02.533590 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:03:02.548143 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:03:02.976749 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:03:03.006459 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:03:03.024766 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:03:03.185968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging.core
- models.staging

18:03:03.225503 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:03:03.231657 [info ] [MainThread]: 
18:03:03.235229 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:03.240523 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:03:03.260425 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:03:03.264461 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:03:03.266642 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:03:03.278395 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:03:03.283405 [debug] [ThreadPool]: On list_dbt: Close
18:03:03.291662 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:03:03.309603 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:03:03.312310 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:03:03.315195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:03:03.324992 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:03:03.328164 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:03:03.332482 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:03:03.340691 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:03:03.345088 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:03:03.348787 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:03:03.365835 [debug] [MainThread]: Using postgres connection "master"
18:03:03.368042 [debug] [MainThread]: On master: BEGIN
18:03:03.370190 [debug] [MainThread]: Opening a new connection, currently in state init
18:03:03.386144 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:03:03.391239 [debug] [MainThread]: Using postgres connection "master"
18:03:03.395337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:03:03.406006 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:03:03.412670 [debug] [MainThread]: On master: ROLLBACK
18:03:03.416182 [debug] [MainThread]: Using postgres connection "master"
18:03:03.419468 [debug] [MainThread]: On master: BEGIN
18:03:03.423732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:03:03.428164 [debug] [MainThread]: On master: COMMIT
18:03:03.431416 [debug] [MainThread]: Using postgres connection "master"
18:03:03.434380 [debug] [MainThread]: On master: COMMIT
18:03:03.438017 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:03.441014 [debug] [MainThread]: On master: Close
18:03:03.444722 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:03:03.449565 [info ] [MainThread]: 
18:03:03.481547 [debug] [Thread-1  ]: Began running node model.dwh.agg_users
18:03:03.483946 [info ] [Thread-1  ]: 1 of 1 START incremental model dev_hturner.agg_users............................ [RUN]
18:03:03.487544 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users"
18:03:03.490133 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users
18:03:03.492828 [debug] [Thread-1  ]: Compiling model.dwh.agg_users
18:03:03.500846 [debug] [Thread-1  ]: Writing injected SQL for node "model.dwh.agg_users"
18:03:03.524776 [debug] [Thread-1  ]: finished collecting timing info
18:03:03.527522 [debug] [Thread-1  ]: Began executing node model.dwh.agg_users
18:03:03.613522 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dwh.agg_users"
18:03:03.627529 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:03:03.629860 [debug] [Thread-1  ]: On model.dwh.agg_users: BEGIN
18:03:03.631812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:03:03.641246 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:03:03.644263 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:03:03.646530 [debug] [Thread-1  ]: On model.dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users"} */

      

  create  table "dbt"."dev_hturner"."agg_users"
  as (
    

SELECT
    *
FROM "dbt"."dev_hturner"."agg_users_stage"
  );
  
18:03:03.654499 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:03:03.676313 [debug] [Thread-1  ]: On model.dwh.agg_users: COMMIT
18:03:03.678483 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:03:03.681187 [debug] [Thread-1  ]: On model.dwh.agg_users: COMMIT
18:03:03.685128 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:03:03.688554 [debug] [Thread-1  ]: finished collecting timing info
18:03:03.690907 [debug] [Thread-1  ]: On model.dwh.agg_users: Close
18:03:03.695651 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev_hturner.agg_users....................... [[32mSELECT 5[0m in 0.21s]
18:03:03.699724 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users
18:03:03.704738 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:03.707355 [debug] [MainThread]: Using postgres connection "master"
18:03:03.709973 [debug] [MainThread]: On master: BEGIN
18:03:03.712394 [debug] [MainThread]: Opening a new connection, currently in state closed
18:03:03.722212 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:03:03.725564 [debug] [MainThread]: On master: COMMIT
18:03:03.728672 [debug] [MainThread]: Using postgres connection "master"
18:03:03.731254 [debug] [MainThread]: On master: COMMIT
18:03:03.734220 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:03.737066 [debug] [MainThread]: On master: Close
18:03:03.741154 [info ] [MainThread]: 
18:03:03.745335 [info ] [MainThread]: Finished running 1 incremental model in 0.51s.
18:03:03.748399 [debug] [MainThread]: Connection 'master' was properly closed.
18:03:03.750883 [debug] [MainThread]: Connection 'model.dwh.agg_users' was properly closed.
18:03:03.776100 [info ] [MainThread]: 
18:03:03.780654 [info ] [MainThread]: [32mCompleted successfully[0m
18:03:03.785043 [info ] [MainThread]: 
18:03:03.788589 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 18:16:44.485413 | f7d367a1-90f8-4f8a-a1f1-7cbf3c6d8d4d ==============================
18:16:44.485413 [info ] [MainThread]: Running with dbt=1.0.0
18:16:44.495664 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, full_refresh=False, show=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.seed.SeedTask'>, which='seed', rpc_method='seed')
18:16:44.502826 [debug] [MainThread]: Tracking: do not track
18:16:44.655740 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:16:44.662824 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:16:44.851852 [debug] [MainThread]: Parsing macros/catalog.sql
18:16:44.869068 [debug] [MainThread]: Parsing macros/adapters.sql
18:16:44.957583 [debug] [MainThread]: Parsing macros/relations.sql
18:16:44.969299 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:16:44.982283 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:16:44.989496 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:16:45.004098 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:16:45.009474 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:16:45.016044 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:16:45.027099 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:16:45.044371 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:16:45.154940 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:16:45.184936 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:16:45.219454 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:16:45.233987 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:16:45.275076 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:16:45.288009 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:16:45.304260 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:16:45.312166 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:16:45.329256 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:16:45.334002 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:16:45.340730 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:16:45.356693 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:16:45.363159 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:16:45.369684 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:16:45.388371 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:16:45.432787 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:16:45.477610 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:16:45.512080 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:16:45.542983 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:16:45.552055 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:16:45.560865 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:16:45.572667 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:16:45.584323 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:16:45.599263 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:16:45.611089 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:16:45.626515 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:16:45.643339 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:16:45.663136 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:16:45.688873 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:16:45.714126 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:16:45.740274 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:16:45.755147 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:16:46.190964 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:16:46.217102 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:16:46.231183 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:16:46.414398 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts.core
- models.staging.core

18:16:46.471379 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:16:46.481655 [info ] [MainThread]: 
18:16:46.487072 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:46.494951 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:16:46.530380 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:16:46.535530 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:16:46.539110 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:16:46.558397 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
18:16:46.572935 [debug] [ThreadPool]: On list_dbt: Close
18:16:46.582342 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_src"
18:16:46.587222 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_src"
18:16:46.591462 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_hturner_src', identifier=None)"
18:16:46.610226 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_src"
18:16:46.615017 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: BEGIN
18:16:46.618396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:16:46.634031 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:16:46.646151 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_src"
18:16:46.649746 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "create_dbt_dev_hturner_src"} */
create schema if not exists "dev_hturner_src"
18:16:46.653973 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:16:46.658996 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: COMMIT
18:16:46.664939 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_src"
18:16:46.667949 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: COMMIT
18:16:46.673309 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:16:46.676464 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: Close
18:16:46.684026 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:16:46.685939 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:16:46.707182 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:16:46.709809 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:16:46.712166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:16:46.703678 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:16:46.721477 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:16:46.732182 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:16:46.731704 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:16:46.743941 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:16:46.753295 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:16:46.756049 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:16:46.766751 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:16:46.769885 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
18:16:46.778739 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:16:46.786645 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:16:46.793745 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:16:46.797080 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:16:46.800703 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:16:46.811010 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:16:46.828135 [debug] [MainThread]: Using postgres connection "master"
18:16:46.831402 [debug] [MainThread]: On master: BEGIN
18:16:46.834241 [debug] [MainThread]: Opening a new connection, currently in state init
18:16:46.843202 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:16:46.848622 [debug] [MainThread]: Using postgres connection "master"
18:16:46.856900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:16:46.867133 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
18:16:46.877710 [debug] [MainThread]: On master: ROLLBACK
18:16:46.880993 [debug] [MainThread]: Using postgres connection "master"
18:16:46.883634 [debug] [MainThread]: On master: BEGIN
18:16:46.887741 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:16:46.893125 [debug] [MainThread]: On master: COMMIT
18:16:46.899303 [debug] [MainThread]: Using postgres connection "master"
18:16:46.909957 [debug] [MainThread]: On master: COMMIT
18:16:46.917168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:46.925949 [debug] [MainThread]: On master: Close
18:16:46.935369 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:16:46.942761 [info ] [MainThread]: 
18:16:46.983457 [debug] [Thread-1  ]: Began running node seed.dwh.payments
18:16:46.983975 [debug] [Thread-2  ]: Began running node seed.dwh.sessions
18:16:46.992056 [info ] [Thread-2  ]: 2 of 3 START seed file dev_hturner_src.sessions................................. [RUN]
18:16:46.986679 [info ] [Thread-1  ]: 1 of 3 START seed file dev_hturner_src.payments................................. [RUN]
18:16:47.003537 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dwh.payments"
18:16:46.997511 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.dwh.sessions"
18:16:47.010670 [debug] [Thread-1  ]: Began compiling node seed.dwh.payments
18:16:47.021963 [debug] [Thread-1  ]: finished collecting timing info
18:16:47.018396 [debug] [Thread-2  ]: Began compiling node seed.dwh.sessions
18:16:47.032613 [debug] [Thread-2  ]: finished collecting timing info
18:16:47.035412 [debug] [Thread-2  ]: Began executing node seed.dwh.sessions
18:16:47.027826 [debug] [Thread-1  ]: Began executing node seed.dwh.payments
18:16:47.210101 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:16:47.213407 [debug] [Thread-1  ]: On seed.dwh.payments: BEGIN
18:16:47.218256 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:16:47.217791 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:16:47.225312 [debug] [Thread-2  ]: On seed.dwh.sessions: BEGIN
18:16:47.228754 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:16:47.237241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:16:47.247654 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:16:47.242342 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:16:47.261920 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:16:47.256369 [debug] [Thread-1  ]: On seed.dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.payments"} */

    create table "dbt"."dev_hturner_src"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
18:16:47.270812 [debug] [Thread-2  ]: On seed.dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.sessions"} */

    create table "dbt"."dev_hturner_src"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
18:16:47.286264 [debug] [Thread-2  ]: SQL status: CREATE TABLE in 0.0 seconds
18:16:47.289533 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
18:16:47.369995 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:16:47.378947 [debug] [Thread-1  ]: On seed.dwh.payments: 
          insert into "dbt"."dev_hturner_src"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
18:16:47.376155 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:16:47.384909 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
18:16:47.387301 [debug] [Thread-2  ]: On seed.dwh.sessions: 
          insert into "dbt"."dev_hturner_src"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
18:16:47.415218 [debug] [Thread-2  ]: SQL status: INSERT 0 4 in 0.0 seconds
18:16:47.419687 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.dwh.sessions"
18:16:47.410695 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dwh.payments"
18:16:47.477404 [debug] [Thread-1  ]: On seed.dwh.payments: COMMIT
18:16:47.478243 [debug] [Thread-2  ]: On seed.dwh.sessions: COMMIT
18:16:47.486995 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:16:47.491849 [debug] [Thread-2  ]: On seed.dwh.sessions: COMMIT
18:16:47.482283 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:16:47.503063 [debug] [Thread-1  ]: On seed.dwh.payments: COMMIT
18:16:47.502542 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:16:47.536531 [debug] [Thread-2  ]: finished collecting timing info
18:16:47.537231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:16:47.541743 [debug] [Thread-2  ]: On seed.dwh.sessions: Close
18:16:47.551747 [debug] [Thread-1  ]: finished collecting timing info
18:16:47.563352 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file dev_hturner_src.sessions............................. [[32mINSERT 4[0m in 0.57s]
18:16:47.567069 [debug] [Thread-1  ]: On seed.dwh.payments: Close
18:16:47.584916 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_hturner_src.payments............................. [[32mINSERT 3[0m in 0.58s]
18:16:47.575397 [debug] [Thread-2  ]: Finished running node seed.dwh.sessions
18:16:47.604913 [debug] [Thread-2  ]: Began running node seed.dwh.users
18:16:47.607958 [info ] [Thread-2  ]: 3 of 3 START seed file dev_hturner_src.users.................................... [RUN]
18:16:47.602704 [debug] [Thread-1  ]: Finished running node seed.dwh.payments
18:16:47.633065 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.dwh.users"
18:16:47.641731 [debug] [Thread-2  ]: Began compiling node seed.dwh.users
18:16:47.644296 [debug] [Thread-2  ]: finished collecting timing info
18:16:47.650987 [debug] [Thread-2  ]: Began executing node seed.dwh.users
18:16:47.691968 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:16:47.694365 [debug] [Thread-2  ]: On seed.dwh.users: BEGIN
18:16:47.696904 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:16:47.710435 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:16:47.715464 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:16:47.718997 [debug] [Thread-2  ]: On seed.dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.users"} */

    create table "dbt"."dev_hturner_src"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text,"created_at" timestamp without time zone)
  
18:16:47.740671 [debug] [Thread-2  ]: SQL status: CREATE TABLE in 0.01 seconds
18:16:47.756978 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:16:47.759769 [debug] [Thread-2  ]: On seed.dwh.users: 
          insert into "dbt"."dev_hturner_src"."users" ("user_id", "first_name", "last_name", "country_code", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
18:16:47.763628 [debug] [Thread-2  ]: SQL status: INSERT 0 5 in 0.0 seconds
18:16:47.766309 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.dwh.users"
18:16:47.780454 [debug] [Thread-2  ]: On seed.dwh.users: COMMIT
18:16:47.784106 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.users"
18:16:47.788632 [debug] [Thread-2  ]: On seed.dwh.users: COMMIT
18:16:47.794925 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:16:47.800921 [debug] [Thread-2  ]: finished collecting timing info
18:16:47.804911 [debug] [Thread-2  ]: On seed.dwh.users: Close
18:16:47.810865 [info ] [Thread-2  ]: 3 of 3 OK loaded seed file dev_hturner_src.users................................ [[32mINSERT 5[0m in 0.18s]
18:16:47.820991 [debug] [Thread-2  ]: Finished running node seed.dwh.users
18:16:47.844632 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:47.868166 [debug] [MainThread]: Using postgres connection "master"
18:16:47.879826 [debug] [MainThread]: On master: BEGIN
18:16:47.883819 [debug] [MainThread]: Opening a new connection, currently in state closed
18:16:47.906546 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:16:47.926971 [debug] [MainThread]: On master: COMMIT
18:16:47.945354 [debug] [MainThread]: Using postgres connection "master"
18:16:48.038203 [debug] [MainThread]: On master: COMMIT
18:16:48.041559 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:48.057834 [debug] [MainThread]: On master: Close
18:16:48.065355 [info ] [MainThread]: 
18:16:48.068935 [info ] [MainThread]: Finished running 3 seeds in 1.58s.
18:16:48.078807 [debug] [MainThread]: Connection 'master' was properly closed.
18:16:48.086186 [debug] [MainThread]: Connection 'seed.dwh.payments' was properly closed.
18:16:48.092623 [debug] [MainThread]: Connection 'seed.dwh.users' was properly closed.
18:16:48.127362 [info ] [MainThread]: 
18:16:48.131734 [info ] [MainThread]: [32mCompleted successfully[0m
18:16:48.136769 [info ] [MainThread]: 
18:16:48.144721 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3


============================== 2021-12-27 18:18:59.402519 | 9879b878-50ab-437c-b2e4-40de23168f73 ==============================
18:18:59.402519 [info ] [MainThread]: Running with dbt=1.0.0
18:18:59.407382 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:18:59.411940 [debug] [MainThread]: Tracking: do not track
18:18:59.531212 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:18:59.644492 [debug] [MainThread]: Parsing macros/catalog.sql
18:18:59.657209 [debug] [MainThread]: Parsing macros/adapters.sql
18:18:59.722664 [debug] [MainThread]: Parsing macros/relations.sql
18:18:59.731253 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:18:59.744340 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:18:59.751851 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:18:59.759857 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:18:59.763898 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:18:59.768328 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:18:59.777864 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:18:59.790757 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:18:59.821425 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:18:59.826697 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:18:59.850203 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:18:59.861383 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:18:59.893693 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:18:59.900940 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:18:59.916934 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:18:59.926701 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:18:59.943822 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:18:59.949344 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:18:59.956692 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:18:59.968102 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:18:59.974350 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:18:59.980097 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:18:59.996010 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:19:00.091091 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:19:00.152209 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:19:00.200974 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:19:00.227127 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:19:00.234019 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:19:00.239637 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:19:00.246630 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:19:00.251908 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:19:00.259645 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:19:00.266483 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:19:00.274629 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:19:00.288027 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:19:00.307308 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:19:00.328241 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:19:00.348794 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:19:00.368047 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:19:00.380100 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:19:00.796371 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:19:00.827264 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:19:00.842869 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:19:00.989521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging.core
- models.marts.core

18:19:01.022214 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:19:01.030027 [info ] [MainThread]: 
18:19:01.033904 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:01.039055 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:19:01.063076 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:19:01.065904 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:19:01.068313 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:01.084434 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
18:19:01.092063 [debug] [ThreadPool]: On list_dbt: Close
18:19:01.104930 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner"
18:19:01.109486 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner"
18:19:01.113323 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_hturner', identifier=None)"
18:19:01.129204 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner"
18:19:01.132237 [debug] [ThreadPool]: On create_dbt_dev_hturner: BEGIN
18:19:01.136204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:19:01.152217 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:19:01.166144 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner"
18:19:01.173278 [debug] [ThreadPool]: On create_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "create_dbt_dev_hturner"} */
create schema if not exists "dev_hturner"
18:19:01.179668 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:19:01.187700 [debug] [ThreadPool]: On create_dbt_dev_hturner: COMMIT
18:19:01.191049 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner"
18:19:01.194530 [debug] [ThreadPool]: On create_dbt_dev_hturner: COMMIT
18:19:01.199682 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:19:01.203698 [debug] [ThreadPool]: On create_dbt_dev_hturner: Close
18:19:01.216475 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:19:01.233464 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:01.234542 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:19:01.246388 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:01.237984 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:19:01.252777 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:01.249628 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:19:01.261429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:19:01.274515 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:19:01.287224 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:01.291938 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:19:01.300652 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
18:19:01.304760 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
18:19:01.310295 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:19:01.315748 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:01.320380 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:19:01.324281 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:19:01.345696 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
18:19:01.360796 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:19:01.365200 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:19:01.383377 [debug] [MainThread]: Using postgres connection "master"
18:19:01.389407 [debug] [MainThread]: On master: BEGIN
18:19:01.393256 [debug] [MainThread]: Opening a new connection, currently in state init
18:19:01.409752 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:19:01.414545 [debug] [MainThread]: Using postgres connection "master"
18:19:01.417720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:19:01.428400 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:19:01.436277 [debug] [MainThread]: On master: ROLLBACK
18:19:01.440266 [debug] [MainThread]: Using postgres connection "master"
18:19:01.443590 [debug] [MainThread]: On master: BEGIN
18:19:01.449029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:19:01.453206 [debug] [MainThread]: On master: COMMIT
18:19:01.457069 [debug] [MainThread]: Using postgres connection "master"
18:19:01.461051 [debug] [MainThread]: On master: COMMIT
18:19:01.465362 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:01.470118 [debug] [MainThread]: On master: Close
18:19:01.476059 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:19:01.482366 [info ] [MainThread]: 
18:19:01.522595 [debug] [Thread-1  ]: Began running node model.dwh.agg_users_stage
18:19:01.526310 [info ] [Thread-1  ]: 1 of 1 START table model dev_hturner.agg_users_stage............................ [RUN]
18:19:01.533804 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
18:19:01.538080 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users_stage
18:19:01.541795 [debug] [Thread-1  ]: Compiling model.dwh.agg_users_stage
18:19:01.555545 [debug] [Thread-1  ]: Writing injected SQL for node "model.dwh.agg_users_stage"
18:19:01.567867 [debug] [Thread-1  ]: finished collecting timing info
18:19:01.571376 [debug] [Thread-1  ]: Began executing node model.dwh.agg_users_stage
18:19:01.638310 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dwh.agg_users_stage"
18:19:01.652493 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:19:01.655980 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: BEGIN
18:19:01.659077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:19:01.677238 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:19:01.682076 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:19:01.686686 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */


  create  table "dbt"."dev_hturner"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev_hturner_src"."users" a
LEFT JOIN "dbt"."dev_hturner_src"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev_hturner_src"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
18:19:01.697059 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:19:01.714240 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:19:01.718083 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */
alter table "dbt"."dev_hturner"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
18:19:01.724889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:01.750444 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: COMMIT
18:19:01.753847 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:19:01.757207 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: COMMIT
18:19:01.762166 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:19:01.779178 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:19:01.782857 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */
drop table if exists "dbt"."dev_hturner"."agg_users_stage__dbt_backup" cascade
18:19:01.787079 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:19:01.793057 [debug] [Thread-1  ]: finished collecting timing info
18:19:01.796709 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: Close
18:19:01.805668 [info ] [Thread-1  ]: 1 of 1 OK created table model dev_hturner.agg_users_stage....................... [[32mSELECT 5[0m in 0.27s]
18:19:01.811978 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users_stage
18:19:01.820949 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:01.837174 [debug] [MainThread]: Using postgres connection "master"
18:19:01.841487 [debug] [MainThread]: On master: BEGIN
18:19:01.848771 [debug] [MainThread]: Opening a new connection, currently in state closed
18:19:01.858999 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:01.865225 [debug] [MainThread]: On master: COMMIT
18:19:01.874878 [debug] [MainThread]: Using postgres connection "master"
18:19:01.878177 [debug] [MainThread]: On master: COMMIT
18:19:01.883361 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:01.888669 [debug] [MainThread]: On master: Close
18:19:01.893275 [info ] [MainThread]: 
18:19:01.900720 [info ] [MainThread]: Finished running 1 table model in 0.86s.
18:19:01.911641 [debug] [MainThread]: Connection 'master' was properly closed.
18:19:01.918370 [debug] [MainThread]: Connection 'list_dbt_dev_hturner' was properly closed.
18:19:01.925977 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
18:19:02.007108 [info ] [MainThread]: 
18:19:02.028914 [info ] [MainThread]: [32mCompleted successfully[0m
18:19:02.044672 [info ] [MainThread]: 
18:19:02.049595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 18:19:09.488356 | a9a7d8fa-bc8e-4c10-b022-193e8054cc2b ==============================
18:19:09.488356 [info ] [MainThread]: Running with dbt=1.0.0
18:19:09.492141 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
18:19:09.496383 [debug] [MainThread]: Tracking: do not track
18:19:09.566074 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:19:09.630302 [debug] [MainThread]: Parsing macros/catalog.sql
18:19:09.643621 [debug] [MainThread]: Parsing macros/adapters.sql
18:19:09.723503 [debug] [MainThread]: Parsing macros/relations.sql
18:19:09.728641 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:19:09.734068 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:19:09.740530 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:19:09.746539 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:19:09.750740 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:19:09.757030 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:19:09.769650 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:19:09.781998 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:19:09.807272 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:19:09.812686 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:19:09.845632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:19:09.861417 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:19:09.904044 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:19:09.922292 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:19:09.945867 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:19:09.957546 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:19:09.972343 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:19:09.977617 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:19:09.985591 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:19:09.997577 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:19:10.006100 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:19:10.014838 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:19:10.035249 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:19:10.097292 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:19:10.146278 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:19:10.171567 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:19:10.196712 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:19:10.210789 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:19:10.218883 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:19:10.231493 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:19:10.237992 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:19:10.249678 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:19:10.261410 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:19:10.279308 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:19:10.298103 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:19:10.317551 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:19:10.341662 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:19:10.365246 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:19:10.384522 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:19:10.396179 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:19:10.750719 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:19:10.782372 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:19:10.793949 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:19:10.964209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts.core
- models.staging.core

18:19:11.014289 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:19:11.023521 [info ] [MainThread]: 
18:19:11.028621 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:11.035005 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:19:11.036997 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:19:11.060042 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:11.062772 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:11.065551 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:19:11.068743 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:19:11.073355 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:11.076063 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:11.090268 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:19:11.093030 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:19:11.096305 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:11.099783 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:11.103234 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:19:11.106019 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:19:11.114224 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
18:19:11.122028 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:19:11.122701 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
18:19:11.125735 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:19:11.128863 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:19:11.136388 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:19:11.147364 [debug] [MainThread]: Using postgres connection "master"
18:19:11.149787 [debug] [MainThread]: On master: BEGIN
18:19:11.151995 [debug] [MainThread]: Opening a new connection, currently in state init
18:19:11.161494 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:11.165033 [debug] [MainThread]: Using postgres connection "master"
18:19:11.167744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:19:11.176816 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:19:11.181754 [debug] [MainThread]: On master: ROLLBACK
18:19:11.184791 [debug] [MainThread]: Using postgres connection "master"
18:19:11.187580 [debug] [MainThread]: On master: BEGIN
18:19:11.190824 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:19:11.194977 [debug] [MainThread]: On master: COMMIT
18:19:11.198112 [debug] [MainThread]: Using postgres connection "master"
18:19:11.201050 [debug] [MainThread]: On master: COMMIT
18:19:11.204532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:11.207170 [debug] [MainThread]: On master: Close
18:19:11.211999 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:19:11.215147 [info ] [MainThread]: 
18:19:11.239237 [debug] [Thread-1  ]: Began running node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:19:11.239529 [debug] [Thread-2  ]: Began running node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:19:11.242193 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
18:19:11.245771 [info ] [Thread-2  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
18:19:11.254754 [debug] [Thread-2  ]: Acquiring new postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:19:11.252490 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:19:11.260008 [debug] [Thread-1  ]: Began compiling node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:19:11.257500 [debug] [Thread-2  ]: Began compiling node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:19:11.266511 [debug] [Thread-2  ]: Compiling test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:19:11.262628 [debug] [Thread-1  ]: Compiling test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:19:11.318988 [debug] [Thread-1  ]: Writing injected SQL for node "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:19:11.321412 [debug] [Thread-2  ]: Writing injected SQL for node "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:19:11.338992 [debug] [Thread-1  ]: finished collecting timing info
18:19:11.344502 [debug] [Thread-1  ]: Began executing node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:19:11.353581 [debug] [Thread-2  ]: finished collecting timing info
18:19:11.366782 [debug] [Thread-2  ]: Began executing node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:19:11.416311 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:19:11.420536 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:19:11.433118 [debug] [Thread-2  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:19:11.438479 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
18:19:11.437141 [debug] [Thread-1  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:19:11.441986 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:19:11.445135 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
18:19:11.458723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:19:11.470902 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:19:11.482723 [debug] [Thread-2  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:19:11.492856 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev_hturner"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
18:19:11.481192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:19:11.504238 [debug] [Thread-1  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:19:11.511756 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev_hturner"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
18:19:11.501128 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:19:11.520264 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:19:11.535316 [debug] [Thread-2  ]: finished collecting timing info
18:19:11.541802 [debug] [Thread-1  ]: finished collecting timing info
18:19:11.546009 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
18:19:11.549809 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
18:19:11.553784 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
18:19:11.557263 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
18:19:11.565632 [info ] [Thread-2  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.31s]
18:19:11.571013 [debug] [Thread-2  ]: Finished running node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:19:11.570056 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.32s]
18:19:11.579758 [debug] [Thread-1  ]: Finished running node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:19:11.586833 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:11.590122 [debug] [MainThread]: Using postgres connection "master"
18:19:11.592806 [debug] [MainThread]: On master: BEGIN
18:19:11.596123 [debug] [MainThread]: Opening a new connection, currently in state closed
18:19:11.615059 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:19:11.626880 [debug] [MainThread]: On master: COMMIT
18:19:11.639029 [debug] [MainThread]: Using postgres connection "master"
18:19:11.643765 [debug] [MainThread]: On master: COMMIT
18:19:11.648387 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:11.652731 [debug] [MainThread]: On master: Close
18:19:11.655860 [info ] [MainThread]: 
18:19:11.659973 [info ] [MainThread]: Finished running 2 tests in 0.63s.
18:19:11.663146 [debug] [MainThread]: Connection 'master' was properly closed.
18:19:11.665880 [debug] [MainThread]: Connection 'test.dwh.not_null_agg_users_stage_dt.068f05fb1a' was properly closed.
18:19:11.671295 [debug] [MainThread]: Connection 'test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
18:19:11.716982 [info ] [MainThread]: 
18:19:11.730804 [info ] [MainThread]: [32mCompleted successfully[0m
18:19:11.733769 [info ] [MainThread]: 
18:19:11.740631 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 18:19:18.189844 | 055a726b-a237-4542-8745-186c4b6aa51a ==============================
18:19:18.189844 [info ] [MainThread]: Running with dbt=1.0.0
18:19:18.193020 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
18:19:18.193939 [debug] [MainThread]: Tracking: tracking
18:19:18.250269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e669dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e669dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e669d610>]}
18:19:18.355875 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:19:18.357362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '055a726b-a237-4542-8745-186c4b6aa51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e6754fd0>]}
18:19:18.450276 [debug] [MainThread]: Parsing macros/catalog.sql
18:19:18.459349 [debug] [MainThread]: Parsing macros/relations.sql
18:19:18.463256 [debug] [MainThread]: Parsing macros/adapters.sql
18:19:18.530929 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:19:18.534030 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:19:18.544729 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:19:18.548989 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:19:18.554856 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:19:18.617173 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:19:18.644752 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:19:18.686223 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:19:18.695221 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:19:18.698696 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:19:18.705783 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql


============================== 2021-12-27 18:19:18.740273 | a291d01e-7e97-4fb4-95c0-b6383d8cfd0b ==============================
18:19:18.740273 [info ] [MainThread]: Running with dbt=1.0.0
18:19:18.743901 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:19:18.746738 [debug] [MainThread]: Tracking: do not track
18:19:18.760995 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:19:18.766543 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:19:18.800638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:19:18.854647 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:19:18.848607 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:19:18.869397 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:19:18.878211 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:19:18.900823 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:19:18.903308 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:19:18.912179 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:19:18.917885 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:19:18.945281 [debug] [MainThread]: Parsing macros/catalog.sql
18:19:18.929457 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:19:18.958706 [debug] [MainThread]: Parsing macros/adapters.sql
18:19:18.955920 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:19:18.958376 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:19:18.962406 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:19:18.964989 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:19:18.966527 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:19:18.967508 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:19:18.968727 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:19:18.971400 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:19:18.985476 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:19:19.023515 [debug] [MainThread]: Parsing macros/relations.sql
18:19:19.010667 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:19:19.034504 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:19:19.021130 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:19:19.046972 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:19:19.053438 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:19:19.059037 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:19:19.062331 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:19:19.042891 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:19:19.066199 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:19:19.049268 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:19:19.075843 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:19:19.060617 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:19:19.090400 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:19:19.075011 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:19:19.104884 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:19:19.128954 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:19:19.136260 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:19:19.160186 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:19:19.175408 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:19:19.213824 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:19:19.226064 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:19:19.244951 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:19:19.257160 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:19:19.277146 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:19:19.287653 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:19:19.298303 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:19:19.313270 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:19:19.324107 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:19:19.337824 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:19:19.368371 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:19:19.430862 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:19:19.477275 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:19:19.500536 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:19:19.499664 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:19:19.501697 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:19:19.526335 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:19:19.556168 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:19:19.565254 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:19:19.577166 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:19:19.585374 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:19:19.593247 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:19:19.605705 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:19:19.625410 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:19:19.642912 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:19:19.659460 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:19:19.642458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts.core
- models.staging.core

18:19:19.655945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055a726b-a237-4542-8745-186c4b6aa51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e6726510>]}
18:19:19.672011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055a726b-a237-4542-8745-186c4b6aa51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e66f5790>]}
18:19:19.673216 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:19:19.679262 [info ] [MainThread]: 
18:19:19.681192 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:19.688210 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:19:19.703975 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:19:19.703863 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:19:19.737503 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:19.737942 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:19:19.738275 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:19.750903 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:19.752141 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:19:19.756892 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:19.784592 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:19:19.809244 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
18:19:19.810031 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:19.810679 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:19:19.819702 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
18:19:19.823904 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:19:19.827089 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:19:19.835974 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
18:19:19.836635 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:19.837113 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:19:19.869220 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:19:19.855800 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.02 seconds
18:19:19.858747 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:19:19.860800 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:19:19.870998 [debug] [MainThread]: Using postgres connection "master"
18:19:19.871350 [debug] [MainThread]: On master: BEGIN
18:19:19.871619 [debug] [MainThread]: Opening a new connection, currently in state init
18:19:19.885023 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:19.885582 [debug] [MainThread]: Using postgres connection "master"
18:19:19.886224 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:19:19.916374 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:19:19.900125 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:19:19.902179 [debug] [MainThread]: On master: ROLLBACK
18:19:19.904033 [debug] [MainThread]: On master: Close
18:19:19.905105 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:19:19.906026 [info ] [MainThread]: 
18:19:19.912742 [debug] [Thread-1  ]: Began running node seed.dwh.payments
18:19:19.913403 [debug] [Thread-2  ]: Began running node seed.dwh.sessions
18:19:19.914429 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dwh.payments"
18:19:19.915583 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.dwh.sessions"
18:19:19.916224 [debug] [Thread-1  ]: Began compiling node seed.dwh.payments
18:19:19.916795 [debug] [Thread-2  ]: Began compiling node seed.dwh.sessions
18:19:19.917497 [debug] [Thread-1  ]: Compiling seed.dwh.payments
18:19:19.918928 [debug] [Thread-2  ]: Compiling seed.dwh.sessions
18:19:19.925420 [debug] [Thread-1  ]: Writing injected SQL for node "seed.dwh.payments"
18:19:19.929688 [debug] [Thread-2  ]: Writing injected SQL for node "seed.dwh.sessions"
18:19:19.930456 [debug] [Thread-1  ]: finished collecting timing info
18:19:19.931078 [debug] [Thread-2  ]: finished collecting timing info
18:19:19.931786 [debug] [Thread-1  ]: Began executing node seed.dwh.payments
18:19:19.932416 [debug] [Thread-2  ]: Began executing node seed.dwh.sessions
18:19:19.933971 [debug] [Thread-1  ]: finished collecting timing info
18:19:19.934838 [debug] [Thread-2  ]: finished collecting timing info
18:19:19.937657 [debug] [Thread-1  ]: Finished running node seed.dwh.payments
18:19:19.938858 [debug] [Thread-2  ]: Finished running node seed.dwh.sessions
18:19:19.941137 [debug] [Thread-1  ]: Began running node seed.dwh.users
18:19:19.942771 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dwh.users"
18:19:19.943373 [debug] [Thread-1  ]: Began compiling node seed.dwh.users
18:19:19.964649 [debug] [MainThread]: Parsing tests/generic/builtin.sql
947954 [debug] [Thread-1  ]: Writing injected SQL for node "seed.dwh.users"
18:19:19.948672 [debug] [Thread-1  ]: finished collecting timing info
18:19:19.949519 [debug] [Thread-1  ]: Began executing node seed.dwh.users
18:19:19.950143 [debug] [Thread-1  ]: finished collecting timing info
18:19:19.951112 [debug] [Thread-1  ]: Finished running node seed.dwh.users
18:19:19.951963 [debug] [Thread-2  ]: Began running node model.dwh.agg_users_stage
18:19:19.952687 [debug] [Thread-2  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
18:19:19.953160 [debug] [Thread-2  ]: Began compiling node model.dwh.agg_users_stage
18:19:19.953793 [debug] [Thread-2  ]: Compiling model.dwh.agg_users_stage
18:19:19.968383 [debug] [Thread-2  ]: finished collecting timing info
18:19:19.968978 [debug] [Thread-2  ]: Compilation Error in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  Required var 'ds' not found in config:
  Vars supplied to agg_users_stage = {}
  
  > in model agg_users_stage (models/staging/core/agg_users_stage.sql)
  > called by model agg_users_stage (models/staging/core/agg_users_stage.sql)
18:19:19.969404 [debug] [Thread-2  ]: Finished running node model.dwh.agg_users_stage
18:19:19.969957 [debug] [MainThread]: Connection 'master' was properly closed.
18:19:19.970261 [debug] [MainThread]: Connection 'seed.dwh.users' was properly closed.
18:19:19.970495 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
18:19:19.970834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e6715790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e6a76210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9e6a3b790>]}
18:19:20.418067 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:19:20.441154 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:19:20.450798 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:19:20.681573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts.core
- models.staging.core

18:19:20.708100 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:19:20.717920 [info ] [MainThread]: 
18:19:20.723502 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:20.730619 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:19:20.751975 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:19:20.754996 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:19:20.757564 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:20.769032 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
18:19:20.776957 [debug] [ThreadPool]: On list_dbt: Close
18:19:20.821937 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:19:20.824764 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner"
18:19:20.931365 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:20.949182 [debug] [ThreadPool]: On list_dbt_dev_hturner: BEGIN
18:19:20.952474 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:20.925190 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:20.992369 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:19:21.000777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:19:20.994580 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
18:19:21.015408 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner"
18:19:21.023923 [debug] [ThreadPool]: On list_dbt_dev_hturner: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner'
  
18:19:21.026813 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:19:21.059885 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:19:21.067911 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:19:21.064212 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
18:19:21.077940 [debug] [ThreadPool]: On list_dbt_dev_hturner: ROLLBACK
18:19:21.080983 [debug] [ThreadPool]: On list_dbt_dev_hturner: Close
18:19:21.094876 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.02 seconds
18:19:21.101845 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:19:21.106360 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:19:21.142832 [debug] [MainThread]: Using postgres connection "master"
18:19:21.146126 [debug] [MainThread]: On master: BEGIN
18:19:21.149049 [debug] [MainThread]: Opening a new connection, currently in state init
18:19:21.163737 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:21.168826 [debug] [MainThread]: Using postgres connection "master"
18:19:21.174420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:19:21.187774 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:19:21.206042 [debug] [MainThread]: On master: ROLLBACK
18:19:21.211972 [debug] [MainThread]: Using postgres connection "master"
18:19:21.214455 [debug] [MainThread]: On master: BEGIN
18:19:21.218389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:19:21.223144 [debug] [MainThread]: On master: COMMIT
18:19:21.227561 [debug] [MainThread]: Using postgres connection "master"
18:19:21.229969 [debug] [MainThread]: On master: COMMIT
18:19:21.232543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:21.235085 [debug] [MainThread]: On master: Close
18:19:21.240949 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:19:21.244406 [info ] [MainThread]: 
18:19:21.269465 [debug] [Thread-1  ]: Began running node model.dwh.agg_users
18:19:21.271910 [info ] [Thread-1  ]: 1 of 1 START incremental model dev_hturner.agg_users............................ [RUN]
18:19:21.274907 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users"
18:19:21.277074 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users
18:19:21.279029 [debug] [Thread-1  ]: Compiling model.dwh.agg_users
18:19:21.284862 [debug] [Thread-1  ]: Writing injected SQL for node "model.dwh.agg_users"
18:19:21.293460 [debug] [Thread-1  ]: finished collecting timing info
18:19:21.296113 [debug] [Thread-1  ]: Began executing node model.dwh.agg_users
18:19:21.376434 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dwh.agg_users"
18:19:21.384005 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:19:21.386451 [debug] [Thread-1  ]: On model.dwh.agg_users: BEGIN
18:19:21.388683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:19:21.397435 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:19:21.401143 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:19:21.404413 [debug] [Thread-1  ]: On model.dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users"} */

      

  create  table "dbt"."dev_hturner"."agg_users"
  as (
    

SELECT
    *
FROM "dbt"."dev_hturner"."agg_users_stage"
  );
  
18:19:21.413774 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:19:21.435241 [debug] [Thread-1  ]: On model.dwh.agg_users: COMMIT
18:19:21.438162 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:19:21.440833 [debug] [Thread-1  ]: On model.dwh.agg_users: COMMIT
18:19:21.443803 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:19:21.446433 [debug] [Thread-1  ]: finished collecting timing info
18:19:21.448381 [debug] [Thread-1  ]: On model.dwh.agg_users: Close
18:19:21.454525 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev_hturner.agg_users....................... [[32mSELECT 5[0m in 0.18s]
18:19:21.459246 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users
18:19:21.464511 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:21.466745 [debug] [MainThread]: Using postgres connection "master"
18:19:21.469537 [debug] [MainThread]: On master: BEGIN
18:19:21.472251 [debug] [MainThread]: Opening a new connection, currently in state closed
18:19:21.485415 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:21.490877 [debug] [MainThread]: On master: COMMIT
18:19:21.495267 [debug] [MainThread]: Using postgres connection "master"
18:19:21.499158 [debug] [MainThread]: On master: COMMIT
18:19:21.502432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:21.505036 [debug] [MainThread]: On master: Close
18:19:21.508335 [info ] [MainThread]: 
18:19:21.513948 [info ] [MainThread]: Finished running 1 incremental model in 0.79s.
18:19:21.516577 [debug] [MainThread]: Connection 'master' was properly closed.
18:19:21.518962 [debug] [MainThread]: Connection 'model.dwh.agg_users' was properly closed.
18:19:21.521143 [debug] [MainThread]: Connection 'list_dbt_dev_hturner' was properly closed.
18:19:21.540054 [info ] [MainThread]: 
18:19:21.543616 [info ] [MainThread]: [32mCompleted successfully[0m
18:19:21.546397 [info ] [MainThread]: 
18:19:21.549061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 18:20:14.185648 | 564367d4-dda9-40ec-9286-75f38c2bc8d9 ==============================
18:20:14.185648 [info ] [MainThread]: Running with dbt=1.0.0
18:20:14.187978 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=False, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
18:20:14.188985 [debug] [MainThread]: Tracking: tracking
18:20:14.221699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e1671290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e1671590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e1671210>]}
18:20:14.267377 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:20:14.268339 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:20:14.269667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '564367d4-dda9-40ec-9286-75f38c2bc8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e2158f90>]}
18:20:14.324460 [debug] [MainThread]: Parsing macros/catalog.sql
18:20:14.329858 [debug] [MainThread]: Parsing macros/relations.sql
18:20:14.332062 [debug] [MainThread]: Parsing macros/adapters.sql
18:20:14.364361 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:20:14.366832 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:20:14.372556 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:20:14.375965 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:20:14.378422 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:20:14.403346 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:20:14.419409 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:20:14.436299 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:20:14.442715 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:20:14.445265 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:20:14.447849 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:20:14.454197 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:20:14.470202 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:20:14.472445 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:20:14.490233 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:20:14.516034 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:20:14.526990 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:20:14.531264 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:20:14.541340 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:20:14.543259 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:20:14.547708 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:20:14.551370 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:20:14.560201 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:20:14.583589 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:20:14.585820 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:20:14.589305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:20:14.591667 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:20:14.592987 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:20:14.593823 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:20:14.594851 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:20:14.597216 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:20:14.603887 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:20:14.615826 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:20:14.619021 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:20:14.622880 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:20:14.636550 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:20:14.640709 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:20:14.647049 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:20:14.658162 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:20:14.673595 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:20:14.932152 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:20:14.951106 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:20:14.953021 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:20:15.046996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging.core
- models.marts.core

18:20:15.055406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '564367d4-dda9-40ec-9286-75f38c2bc8d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e2204a90>]}
18:20:15.067835 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
18:20:15.068473 [info ] [MainThread]: Building catalog
18:20:15.075770 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
18:20:15.112450 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:20:15.112793 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
18:20:15.113053 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:20:15.159216 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
18:20:15.159697 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:20:15.159980 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_hturner_src') or upper(sch.nspname) = upper('dev_hturner'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:20:15.171544 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.01 seconds
18:20:15.185301 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
18:20:15.187578 [debug] [ThreadPool]: On dbt.information_schema: Close
18:20:15.193106 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dbt-airflow/dwh/target/catalog.json
18:20:15.194121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e21279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e0c1f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e2214690>]}
18:20:15.604001 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:20:15.604412 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-27 18:21:02.813530 | adab7075-1ebd-4a41-bbc5-432798235465 ==============================
18:21:02.813530 [info ] [MainThread]: Running with dbt=1.0.0
18:21:02.814795 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8080, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
18:21:02.815459 [debug] [MainThread]: Tracking: tracking
18:21:02.846036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2087d4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2087d4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2087d4710>]}
18:21:02.856520 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
18:21:02.858369 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
18:21:02.859388 [info ] [MainThread]: 
18:21:02.860522 [info ] [MainThread]: 
18:21:02.861632 [info ] [MainThread]: Press Ctrl+C to exit.
18:21:02.863334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2086bd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2086bdf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2086bd1d0>]}


============================== 2021-12-27 18:21:15.299012 | 01c79ac5-ac44-4fda-9d95-ab0dcdc96006 ==============================
18:21:15.299012 [info ] [MainThread]: Running with dbt=1.0.0
18:21:15.301231 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8000, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
18:21:15.301837 [debug] [MainThread]: Tracking: tracking
18:21:15.332931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5946bcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5946bc150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5946bc410>]}
18:21:15.344925 [info ] [MainThread]: Serving docs at 0.0.0.0:8000
18:21:15.346342 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8000
18:21:15.347722 [info ] [MainThread]: 
18:21:15.348910 [info ] [MainThread]: 
18:21:15.349828 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-27 18:24:32.585648 | 31a2ad92-4c74-4686-82ba-979ec6977200 ==============================
18:24:32.585648 [info ] [MainThread]: Running with dbt=1.0.0
18:24:32.587230 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=False, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
18:24:32.587612 [debug] [MainThread]: Tracking: tracking
18:24:32.626245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff96591d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff9659510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff96595d0>]}
18:24:32.662079 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:24:32.662877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31a2ad92-4c74-4686-82ba-979ec6977200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff9957fd0>]}
18:24:32.720517 [debug] [MainThread]: Parsing macros/catalog.sql
18:24:32.726702 [debug] [MainThread]: Parsing macros/relations.sql
18:24:32.729882 [debug] [MainThread]: Parsing macros/adapters.sql
18:24:32.767340 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:24:32.769804 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:24:32.775436 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:24:32.778875 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:24:32.781421 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:24:32.806773 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:24:32.822873 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:24:32.843786 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:24:32.852035 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:24:32.854748 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:24:32.857786 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:24:32.864317 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:24:32.880442 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:24:32.882730 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:24:32.897520 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:24:32.920154 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:24:32.931205 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:24:32.935988 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:24:32.947124 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:24:32.949250 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:24:32.953354 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:24:32.956827 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:24:32.968232 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:24:32.992759 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:24:32.995003 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:24:32.998831 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:24:33.001335 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:24:33.002650 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:24:33.003499 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:24:33.004536 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:24:33.006718 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:24:33.013087 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:24:33.024841 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:24:33.027973 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:24:33.031928 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:24:33.046104 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:24:33.050799 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:24:33.057705 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:24:33.068952 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:24:33.084489 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:24:33.360233 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:24:33.383615 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:24:33.385624 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:24:33.477617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.seeds

18:24:33.485962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31a2ad92-4c74-4686-82ba-979ec6977200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff98f4b50>]}
18:24:33.497116 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
18:24:33.498864 [info ] [MainThread]: Building catalog
18:24:33.503654 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
18:24:33.543822 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:24:33.544234 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
18:24:33.544553 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:24:33.627940 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
18:24:33.628988 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:24:33.629650 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_hturner_core') or upper(sch.nspname) = upper('dev_hturner') or upper(sch.nspname) = upper('dev_hturner_core_stage'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:24:33.647410 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.02 seconds
18:24:33.658527 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
18:24:33.660589 [debug] [ThreadPool]: On dbt.information_schema: Close
18:24:33.664328 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dbt-airflow/dwh/target/catalog.json
18:24:33.665454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff9a32810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff9989b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff8c242d0>]}
18:24:34.091832 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:24:34.092166 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-27 18:24:47.654857 | 6db8fafd-87f4-43de-a4f9-da5e30bbc6bb ==============================
18:24:47.654857 [info ] [MainThread]: Running with dbt=1.0.0
18:24:47.656431 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=False, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
18:24:47.656831 [debug] [MainThread]: Tracking: tracking
18:24:47.684925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacd68edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacd68ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacd68e910>]}
18:24:47.722465 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:24:47.723133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6db8fafd-87f4-43de-a4f9-da5e30bbc6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fface197fd0>]}
18:24:47.781594 [debug] [MainThread]: Parsing macros/catalog.sql
18:24:47.787949 [debug] [MainThread]: Parsing macros/relations.sql
18:24:47.791639 [debug] [MainThread]: Parsing macros/adapters.sql
18:24:47.831299 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:24:47.834513 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:24:47.842996 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:24:47.847687 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:24:47.851264 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:24:47.881386 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:24:47.897694 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:24:47.917042 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:24:47.924391 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:24:47.927843 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:24:47.931078 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:24:47.939938 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:24:47.957430 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:24:47.959768 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:24:47.974488 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:24:47.997247 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:24:48.010627 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:24:48.015272 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:24:48.026003 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:24:48.028104 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:24:48.032131 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:24:48.035550 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:24:48.044520 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:24:48.069754 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:24:48.072002 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:24:48.075702 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:24:48.078216 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:24:48.079580 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:24:48.080614 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:24:48.081784 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:24:48.084027 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:24:48.090401 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:24:48.102773 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:24:48.106170 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:24:48.110124 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:24:48.125917 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:24:48.130318 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:24:48.136955 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:24:48.147436 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:24:48.161436 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:24:48.424902 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:24:48.446651 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:24:48.448529 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:24:48.543000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dwh.seeds

18:24:48.551628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6db8fafd-87f4-43de-a4f9-da5e30bbc6bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fface249f50>]}
18:24:48.561134 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
18:24:48.561885 [info ] [MainThread]: Building catalog
18:24:48.566663 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
18:24:48.593101 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:24:48.593875 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
18:24:48.594442 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:24:48.619882 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:24:48.620628 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:24:48.621117 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_hturner') or upper(sch.nspname) = upper('dev_hturner_core_stage') or upper(sch.nspname) = upper('dev_hturner_core'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:24:48.630866 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.01 seconds
18:24:48.645623 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
18:24:48.647645 [debug] [ThreadPool]: On dbt.information_schema: Close
18:24:48.653957 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dbt-airflow/dwh/target/catalog.json
18:24:48.655445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffacd44d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fface265650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fface10e310>]}
18:24:49.051145 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:24:49.051500 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-27 18:25:07.501895 | 8ed0e5cc-896b-4dd9-9578-6ac37027da00 ==============================
18:25:07.501895 [info ] [MainThread]: Running with dbt=1.0.0
18:25:07.503413 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=False, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
18:25:07.503890 [debug] [MainThread]: Tracking: tracking
18:25:07.529583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c9e75d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c9e75990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c9e753d0>]}
18:25:07.569149 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:25:07.569860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ed0e5cc-896b-4dd9-9578-6ac37027da00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ca157f90>]}
18:25:07.632940 [debug] [MainThread]: Parsing macros/catalog.sql
18:25:07.638126 [debug] [MainThread]: Parsing macros/relations.sql
18:25:07.640307 [debug] [MainThread]: Parsing macros/adapters.sql
18:25:07.671830 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:25:07.674218 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:25:07.680510 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:25:07.683954 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:25:07.686364 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:25:07.711460 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:25:07.728934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:25:07.745944 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:25:07.752480 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:25:07.755118 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:25:07.758115 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:25:07.766620 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:25:07.787156 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:25:07.790288 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:25:07.808485 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:25:07.831250 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:25:07.842241 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:25:07.846613 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:25:07.857111 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:25:07.859396 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:25:07.863284 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:25:07.866673 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:25:07.875802 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:25:07.898956 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:25:07.901287 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:25:07.904945 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:25:07.907237 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:25:07.908504 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:25:07.909335 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:25:07.910366 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:25:07.912599 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:25:07.919192 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:25:07.931010 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:25:07.934151 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:25:07.938156 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:25:07.951760 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:25:07.955888 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:25:07.962119 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:25:07.972317 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:25:07.986622 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:25:08.252619 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:25:08.273612 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:25:08.275527 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:25:08.375210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ed0e5cc-896b-4dd9-9578-6ac37027da00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ca1fb710>]}
18:25:08.381745 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
18:25:08.382482 [info ] [MainThread]: Building catalog
18:25:08.388472 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
18:25:08.415996 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:25:08.416362 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
18:25:08.416649 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:08.469654 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
18:25:08.470004 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:25:08.470230 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_hturner_src') or upper(sch.nspname) = upper('dev_hturner_core_stage') or upper(sch.nspname) = upper('dev_hturner_core'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:25:08.488137 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.02 seconds
18:25:08.498129 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
18:25:08.499972 [debug] [ThreadPool]: On dbt.information_schema: Close
18:25:08.505542 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dbt-airflow/dwh/target/catalog.json
18:25:08.506385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c9feea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ca196710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3c9e7c790>]}
18:25:08.885205 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:25:08.885548 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-27 18:25:27.095983 | 94a37732-9a68-425f-bee4-751e07dce182 ==============================
18:25:27.095983 [info ] [MainThread]: Running with dbt=1.0.0
18:25:27.097310 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8000, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
18:25:27.097801 [debug] [MainThread]: Tracking: tracking
18:25:27.115803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d5ebc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d5ebc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4d5ebc7d0>]}
18:25:27.123466 [info ] [MainThread]: Serving docs at 0.0.0.0:8000
18:25:27.124691 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8000
18:25:27.125497 [info ] [MainThread]: 
18:25:27.126250 [info ] [MainThread]: 
18:25:27.126952 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-27 18:26:19.079883 | f6c61b4a-0fec-4a90-b898-622641bf2b6c ==============================
18:26:19.079883 [info ] [MainThread]: Running with dbt=1.0.0
18:26:19.083552 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, full_refresh=False, show=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.seed.SeedTask'>, which='seed', rpc_method='seed')
18:26:19.097240 [debug] [MainThread]: Tracking: do not track
18:26:19.197438 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:26:19.365809 [debug] [MainThread]: Parsing macros/catalog.sql
18:26:19.375054 [debug] [MainThread]: Parsing macros/adapters.sql
18:26:19.421522 [debug] [MainThread]: Parsing macros/relations.sql
18:26:19.427033 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:26:19.432972 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:26:19.436817 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:26:19.441811 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:26:19.445243 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:26:19.449125 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:26:19.455614 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:26:19.467363 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:26:19.494060 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:26:19.499695 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:26:19.520719 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:26:19.531632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:26:19.572169 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:26:19.580483 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:26:19.598755 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:26:19.608422 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:26:19.626523 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:26:19.631743 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:26:19.638152 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:26:19.651108 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:26:19.657835 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:26:19.666937 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:26:19.684880 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:26:19.722607 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:26:19.760030 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:26:19.787991 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:26:19.819444 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:26:19.829305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:26:19.838949 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:26:19.850770 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:26:19.862579 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:26:19.876001 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:26:19.886877 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:26:19.902036 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:26:19.924544 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:26:19.948178 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:26:19.974830 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:26:20.024150 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:26:20.050859 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:26:20.066211 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:26:20.564812 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:26:20.583463 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:26:20.602644 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:26:20.840587 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:26:20.854612 [info ] [MainThread]: 
18:26:20.862813 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:20.875235 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:26:20.901693 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:26:20.908050 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:26:20.911412 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:20.932852 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
18:26:20.938643 [debug] [ThreadPool]: On list_dbt: Close
18:26:20.949404 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_src"
18:26:20.953213 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_src"
18:26:20.956507 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_hturner_src', identifier=None)"
18:26:20.971523 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_src"
18:26:20.974374 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: BEGIN
18:26:20.977875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:26:20.990083 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:26:20.997889 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_src"
18:26:21.004189 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "create_dbt_dev_hturner_src"} */
create schema if not exists "dev_hturner_src"
18:26:21.009379 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:26:21.018724 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: COMMIT
18:26:21.021778 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_src"
18:26:21.024922 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: COMMIT
18:26:21.033691 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:26:21.036773 [debug] [ThreadPool]: On create_dbt_dev_hturner_src: Close
18:26:21.049181 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core"
18:26:21.051345 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core_stage"
18:26:21.071391 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:26:21.081058 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: BEGIN
18:26:21.083899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:26:21.079373 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:26:21.091958 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: BEGIN
18:26:21.096209 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:21.105200 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:26:21.124345 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:26:21.135865 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core_stage"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core_stage'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core_stage'
  
18:26:21.125976 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:26:21.153061 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:26:21.177592 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core'
  
18:26:21.181591 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.04 seconds
18:26:21.198796 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: ROLLBACK
18:26:21.202312 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: Close
18:26:21.194588 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
18:26:21.211451 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:26:21.216605 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: ROLLBACK
18:26:21.229329 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: Close
18:26:21.224446 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:26:21.240980 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:26:21.243962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:26:21.256118 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:26:21.261113 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:26:21.265644 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:26:21.273946 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:26:21.283871 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:26:21.287883 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:26:21.305142 [debug] [MainThread]: Using postgres connection "master"
18:26:21.307956 [debug] [MainThread]: On master: BEGIN
18:26:21.311828 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:21.323242 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:21.327434 [debug] [MainThread]: Using postgres connection "master"
18:26:21.335373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:21.349035 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:26:21.358879 [debug] [MainThread]: On master: ROLLBACK
18:26:21.364610 [debug] [MainThread]: Using postgres connection "master"
18:26:21.368119 [debug] [MainThread]: On master: BEGIN
18:26:21.371325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:21.377366 [debug] [MainThread]: On master: COMMIT
18:26:21.381809 [debug] [MainThread]: Using postgres connection "master"
18:26:21.389157 [debug] [MainThread]: On master: COMMIT
18:26:21.393250 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:21.396638 [debug] [MainThread]: On master: Close
18:26:21.407557 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:26:21.410911 [info ] [MainThread]: 
18:26:21.466815 [debug] [Thread-1  ]: Began running node seed.dwh.payments
18:26:21.468651 [debug] [Thread-2  ]: Began running node seed.dwh.sessions
18:26:21.472015 [info ] [Thread-1  ]: 1 of 3 START seed file dev_hturner_src.payments................................. [RUN]
18:26:21.478187 [info ] [Thread-2  ]: 2 of 3 START seed file dev_hturner_src.sessions................................. [RUN]
18:26:21.483152 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dwh.payments"
18:26:21.501361 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.dwh.sessions"
18:26:21.504259 [debug] [Thread-1  ]: Began compiling node seed.dwh.payments
18:26:21.512863 [debug] [Thread-2  ]: Began compiling node seed.dwh.sessions
18:26:21.518990 [debug] [Thread-1  ]: finished collecting timing info
18:26:21.524216 [debug] [Thread-2  ]: finished collecting timing info
18:26:21.528138 [debug] [Thread-1  ]: Began executing node seed.dwh.payments
18:26:21.532516 [debug] [Thread-2  ]: Began executing node seed.dwh.sessions
18:26:21.726842 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:26:21.732943 [debug] [Thread-1  ]: On seed.dwh.payments: BEGIN
18:26:21.736171 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:26:21.737939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:21.742225 [debug] [Thread-2  ]: On seed.dwh.sessions: BEGIN
18:26:21.750246 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:26:21.765643 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:26:21.770226 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:26:21.779418 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:26:21.792182 [debug] [Thread-2  ]: On seed.dwh.sessions: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.sessions"} */

    create table "dbt"."dev_hturner_src"."sessions" ("session_id" integer,"user_id" integer,"created_at" timestamp without time zone,"ended_at" timestamp without time zone)
  
18:26:21.772207 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:26:21.800909 [debug] [Thread-1  ]: On seed.dwh.payments: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.payments"} */

    create table "dbt"."dev_hturner_src"."payments" ("payment_id" integer,"user_id" integer,"price" float8,"created_at" timestamp without time zone)
  
18:26:21.809147 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
18:26:21.803343 [debug] [Thread-2  ]: SQL status: CREATE TABLE in 0.01 seconds
18:26:21.895745 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:26:21.900020 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:26:21.910322 [debug] [Thread-1  ]: On seed.dwh.payments: 
          insert into "dbt"."dev_hturner_src"."payments" ("payment_id", "user_id", "price", "created_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
18:26:21.904777 [debug] [Thread-2  ]: On seed.dwh.sessions: 
          insert into "dbt"."dev_hturner_src"."sessions" ("session_id", "user_id", "created_at", "ended_at") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
18:26:21.927408 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.0 seconds
18:26:21.931323 [debug] [Thread-2  ]: SQL status: INSERT 0 4 in 0.0 seconds
18:26:21.966864 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dwh.payments"
18:26:21.969266 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.dwh.sessions"
18:26:22.088809 [debug] [Thread-1  ]: On seed.dwh.payments: COMMIT
18:26:22.099470 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.payments"
18:26:22.103836 [debug] [Thread-1  ]: On seed.dwh.payments: COMMIT
18:26:22.098860 [debug] [Thread-2  ]: On seed.dwh.sessions: COMMIT
18:26:22.110580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:26:22.119818 [debug] [Thread-1  ]: finished collecting timing info
18:26:22.113366 [debug] [Thread-2  ]: Using postgres connection "seed.dwh.sessions"
18:26:22.124404 [debug] [Thread-1  ]: On seed.dwh.payments: Close
18:26:22.128059 [debug] [Thread-2  ]: On seed.dwh.sessions: COMMIT
18:26:22.138267 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dev_hturner_src.payments............................. [[32mINSERT 3[0m in 0.66s]
18:26:22.151332 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:26:22.177527 [debug] [Thread-2  ]: finished collecting timing info
18:26:22.196498 [debug] [Thread-2  ]: On seed.dwh.sessions: Close
18:26:22.208873 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file dev_hturner_src.sessions............................. [[32mINSERT 4[0m in 0.71s]
18:26:22.162327 [debug] [Thread-1  ]: Finished running node seed.dwh.payments
18:26:22.230305 [debug] [Thread-1  ]: Began running node seed.dwh.users
18:26:22.221724 [debug] [Thread-2  ]: Finished running node seed.dwh.sessions
18:26:22.245024 [info ] [Thread-1  ]: 3 of 3 START seed file dev_hturner_src.users.................................... [RUN]
18:26:22.274972 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.dwh.users"
18:26:22.289906 [debug] [Thread-1  ]: Began compiling node seed.dwh.users
18:26:22.292006 [debug] [Thread-1  ]: finished collecting timing info
18:26:22.296982 [debug] [Thread-1  ]: Began executing node seed.dwh.users
18:26:22.333614 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.users"
18:26:22.336324 [debug] [Thread-1  ]: On seed.dwh.users: BEGIN
18:26:22.339468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:22.349409 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:26:22.353868 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.users"
18:26:22.358628 [debug] [Thread-1  ]: On seed.dwh.users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "seed.dwh.users"} */

    create table "dbt"."dev_hturner_src"."users" ("user_id" integer,"first_name" text,"last_name" text,"country_code" text,"created_at" timestamp without time zone)
  
18:26:22.374367 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
18:26:22.396744 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.users"
18:26:22.399823 [debug] [Thread-1  ]: On seed.dwh.users: 
          insert into "dbt"."dev_hturner_src"."users" ("user_id", "first_name", "last_name", "country_code", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
18:26:22.404973 [debug] [Thread-1  ]: SQL status: INSERT 0 5 in 0.0 seconds
18:26:22.408840 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dwh.users"
18:26:22.423395 [debug] [Thread-1  ]: On seed.dwh.users: COMMIT
18:26:22.427172 [debug] [Thread-1  ]: Using postgres connection "seed.dwh.users"
18:26:22.431110 [debug] [Thread-1  ]: On seed.dwh.users: COMMIT
18:26:22.435898 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:26:22.439939 [debug] [Thread-1  ]: finished collecting timing info
18:26:22.442347 [debug] [Thread-1  ]: On seed.dwh.users: Close
18:26:22.448404 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file dev_hturner_src.users................................ [[32mINSERT 5[0m in 0.18s]
18:26:22.452137 [debug] [Thread-1  ]: Finished running node seed.dwh.users
18:26:22.467338 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:22.470794 [debug] [MainThread]: Using postgres connection "master"
18:26:22.475201 [debug] [MainThread]: On master: BEGIN
18:26:22.479555 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:22.491472 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:22.510514 [debug] [MainThread]: On master: COMMIT
18:26:22.519851 [debug] [MainThread]: Using postgres connection "master"
18:26:22.524549 [debug] [MainThread]: On master: COMMIT
18:26:22.530620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:22.544537 [debug] [MainThread]: On master: Close
18:26:22.562799 [info ] [MainThread]: 
18:26:22.566388 [info ] [MainThread]: Finished running 3 seeds in 1.70s.
18:26:22.572214 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:22.580807 [debug] [MainThread]: Connection 'seed.dwh.users' was properly closed.
18:26:22.591402 [debug] [MainThread]: Connection 'seed.dwh.sessions' was properly closed.
18:26:22.630199 [info ] [MainThread]: 
18:26:22.634512 [info ] [MainThread]: [32mCompleted successfully[0m
18:26:22.639544 [info ] [MainThread]: 
18:26:22.652849 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3


============================== 2021-12-27 18:27:33.126672 | 8140bfd9-7317-418d-937a-80113430d59b ==============================
18:27:33.126672 [info ] [MainThread]: Running with dbt=1.0.0
18:27:33.128226 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=False, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
18:27:33.128946 [debug] [MainThread]: Tracking: tracking
18:27:33.155348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6fea5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6fea57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d6fea5710>]}
18:27:33.188542 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:27:33.189229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8140bfd9-7317-418d-937a-80113430d59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d70199fd0>]}
18:27:33.272456 [debug] [MainThread]: Parsing macros/catalog.sql
18:27:33.277736 [debug] [MainThread]: Parsing macros/relations.sql
18:27:33.279658 [debug] [MainThread]: Parsing macros/adapters.sql
18:27:33.312149 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:27:33.314623 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:27:33.320285 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:27:33.324723 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:27:33.327594 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:27:33.352621 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:27:33.370034 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:27:33.387200 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:27:33.393658 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:27:33.396233 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:27:33.398816 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:27:33.405576 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:27:33.422358 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:27:33.424658 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:27:33.440037 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:27:33.462266 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:27:33.473720 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:27:33.478041 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:27:33.488321 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:27:33.490432 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:27:33.494476 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:27:33.498207 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:27:33.507851 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:27:33.531868 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:27:33.534181 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:27:33.537792 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:27:33.540185 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:27:33.541487 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:27:33.542281 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:27:33.543270 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:27:33.546132 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:27:33.552724 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:27:33.565368 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:27:33.568735 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:27:33.572912 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:27:33.589884 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:27:33.594261 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:27:33.600666 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:27:33.611118 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:27:33.626888 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:27:33.884836 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:27:33.905504 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:27:33.907355 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:27:34.004056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8140bfd9-7317-418d-937a-80113430d59b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d7022fdd0>]}
18:27:34.010825 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
18:27:34.011885 [info ] [MainThread]: Building catalog
18:27:34.018816 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
18:27:34.049905 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:27:34.050279 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
18:27:34.050548 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:27:34.108831 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
18:27:34.109237 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:27:34.109511 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_hturner_core_stage') or upper(sch.nspname) = upper('dev_hturner_core') or upper(sch.nspname) = upper('dev_hturner_src'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:27:34.126106 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.02 seconds
18:27:34.137759 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
18:27:34.139773 [debug] [ThreadPool]: On dbt.information_schema: Close
18:27:34.144638 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dbt-airflow/dwh/target/catalog.json
18:27:34.146941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d701e1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d701e1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d701e18d0>]}
18:27:34.547977 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:27:34.548323 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-27 18:27:44.275216 | 1f31cd04-f793-41f2-8a2d-232049d7a53b ==============================
18:27:44.275216 [info ] [MainThread]: Running with dbt=1.0.0
18:27:44.277671 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8000, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
18:27:44.278585 [debug] [MainThread]: Tracking: tracking
18:27:44.323463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc71ebd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc71ebd590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc71ebd710>]}
18:27:44.341811 [info ] [MainThread]: Serving docs at 0.0.0.0:8000
18:27:44.343316 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8000
18:27:44.344205 [info ] [MainThread]: 
18:27:44.344645 [info ] [MainThread]: 
18:27:44.345056 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2021-12-27 18:28:57.155036 | 837d49cb-4435-4c1b-b4db-56907b3434ef ==============================
18:28:57.155036 [info ] [MainThread]: Running with dbt=1.0.0
18:28:57.158819 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:28:57.163043 [debug] [MainThread]: Tracking: do not track
18:28:57.243285 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:28:57.249940 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:28:57.365827 [debug] [MainThread]: Parsing macros/catalog.sql
18:28:57.377150 [debug] [MainThread]: Parsing macros/adapters.sql
18:28:57.443185 [debug] [MainThread]: Parsing macros/relations.sql
18:28:57.451524 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:28:57.458622 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:28:57.463895 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:28:57.471009 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:28:57.477116 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:28:57.482853 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:28:57.495302 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:28:57.513685 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:28:57.553015 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:28:57.564541 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:28:57.594806 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:28:57.625969 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:28:57.710768 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:28:57.721314 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:28:57.739781 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:28:57.751010 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:28:57.774915 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:28:57.783664 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:28:57.794145 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:28:57.810626 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:28:57.823120 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:28:57.841573 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:28:57.886524 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:28:57.954093 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:28:58.017421 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:28:58.054502 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:28:58.097970 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:28:58.109011 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:28:58.122895 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:28:58.139157 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:28:58.150206 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:28:58.165050 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:28:58.179029 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:28:58.197839 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:28:58.226506 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:28:58.270600 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:28:58.321116 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:28:58.365269 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:28:58.405991 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:28:58.421079 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:28:58.857516 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:28:58.901799 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:28:58.916884 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:28:59.110797 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:28:59.119130 [info ] [MainThread]: 
18:28:59.123027 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:59.128185 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:28:59.158813 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:28:59.161856 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:28:59.164403 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:59.178548 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
18:28:59.188095 [debug] [ThreadPool]: On list_dbt: Close
18:28:59.194639 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_core_stage"
18:28:59.198632 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_core_stage"
18:28:59.202153 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_hturner_core_stage', identifier=None)"
18:28:59.216039 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_core_stage"
18:28:59.218536 [debug] [ThreadPool]: On create_dbt_dev_hturner_core_stage: BEGIN
18:28:59.221591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:28:59.235112 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:28:59.238082 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_core_stage"
18:28:59.240714 [debug] [ThreadPool]: On create_dbt_dev_hturner_core_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "create_dbt_dev_hturner_core_stage"} */
create schema if not exists "dev_hturner_core_stage"
18:28:59.245027 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:28:59.249783 [debug] [ThreadPool]: On create_dbt_dev_hturner_core_stage: COMMIT
18:28:59.253253 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_core_stage"
18:28:59.255885 [debug] [ThreadPool]: On create_dbt_dev_hturner_core_stage: COMMIT
18:28:59.261147 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:28:59.263955 [debug] [ThreadPool]: On create_dbt_dev_hturner_core_stage: Close
18:28:59.270127 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:28:59.272772 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core"
18:28:59.287138 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:28:59.291647 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:28:59.294370 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:28:59.297088 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: BEGIN
18:28:59.299631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:28:59.302030 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:59.315401 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:28:59.319252 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:28:59.321911 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:28:59.328416 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
18:28:59.330318 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:28:59.337833 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:28:59.340997 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core'
  
18:28:59.334179 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:28:59.346434 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:28:59.352388 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core_stage"
18:28:59.352642 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
18:28:59.360952 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: ROLLBACK
18:28:59.357434 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:28:59.363891 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: Close
18:28:59.365158 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: BEGIN
18:28:59.369846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:28:59.381254 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:28:59.384666 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:28:59.387651 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core_stage"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core_stage'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core_stage'
  
18:28:59.393196 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
18:28:59.399818 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: ROLLBACK
18:28:59.403253 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: Close
18:28:59.416092 [debug] [MainThread]: Using postgres connection "master"
18:28:59.418497 [debug] [MainThread]: On master: BEGIN
18:28:59.421227 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:59.431309 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:59.438155 [debug] [MainThread]: Using postgres connection "master"
18:28:59.444049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:59.453484 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:28:59.458661 [debug] [MainThread]: On master: ROLLBACK
18:28:59.461650 [debug] [MainThread]: Using postgres connection "master"
18:28:59.464329 [debug] [MainThread]: On master: BEGIN
18:28:59.467615 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:59.471092 [debug] [MainThread]: On master: COMMIT
18:28:59.473441 [debug] [MainThread]: Using postgres connection "master"
18:28:59.475635 [debug] [MainThread]: On master: COMMIT
18:28:59.478318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:59.480606 [debug] [MainThread]: On master: Close
18:28:59.484325 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:28:59.487428 [info ] [MainThread]: 
18:28:59.511930 [debug] [Thread-1  ]: Began running node model.dwh.agg_users_stage
18:28:59.514377 [info ] [Thread-1  ]: 1 of 1 START table model dev_hturner_core_stage.agg_users_stage................. [RUN]
18:28:59.518039 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users_stage"
18:28:59.520706 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users_stage
18:28:59.523535 [debug] [Thread-1  ]: Compiling model.dwh.agg_users_stage
18:28:59.536394 [debug] [Thread-1  ]: Writing injected SQL for node "model.dwh.agg_users_stage"
18:28:59.546228 [debug] [Thread-1  ]: finished collecting timing info
18:28:59.550049 [debug] [Thread-1  ]: Began executing node model.dwh.agg_users_stage
18:28:59.599357 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dwh.agg_users_stage"
18:28:59.608172 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:28:59.611074 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: BEGIN
18:28:59.613559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:59.623676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:28:59.626929 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:28:59.629041 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */


  create  table "dbt"."dev_hturner_core_stage"."agg_users_stage__dbt_tmp"
  as (
    

SELECT
    '2021-12-27' AS dt
  , a.user_id
  , a.first_name
  , a.last_name
  , a.country_code
  , COUNT(b.*) AS session_count
  , SUM(c.price) AS total_revenue
FROM "dbt"."dev_hturner_src"."users" a
LEFT JOIN "dbt"."dev_hturner_src"."sessions" b
    ON a.user_id = b.user_id
    AND DATE_TRUNC('day', b.created_at) <= '2021-12-27'
LEFT JOIN "dbt"."dev_hturner_src"."payments" c
    ON a.user_id = c.user_id
    AND DATE_TRUNC('day', c.created_at) <= '2021-12-27'
WHERE DATE_TRUNC('day', a.created_at) <= '2021-12-27'
GROUP BY 1,2,3,4,5
  );
18:28:59.638647 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:28:59.648988 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:28:59.651670 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */
alter table "dbt"."dev_hturner_core_stage"."agg_users_stage__dbt_tmp" rename to "agg_users_stage"
18:28:59.654588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:59.676211 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: COMMIT
18:28:59.679048 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:28:59.682613 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: COMMIT
18:28:59.688476 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:28:59.704469 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users_stage"
18:28:59.707610 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users_stage"} */
drop table if exists "dbt"."dev_hturner_core_stage"."agg_users_stage__dbt_backup" cascade
18:28:59.711240 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:28:59.716913 [debug] [Thread-1  ]: finished collecting timing info
18:28:59.719952 [debug] [Thread-1  ]: On model.dwh.agg_users_stage: Close
18:28:59.725509 [info ] [Thread-1  ]: 1 of 1 OK created table model dev_hturner_core_stage.agg_users_stage............ [[32mSELECT 5[0m in 0.21s]
18:28:59.728543 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users_stage
18:28:59.733699 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:59.737238 [debug] [MainThread]: Using postgres connection "master"
18:28:59.741594 [debug] [MainThread]: On master: BEGIN
18:28:59.749385 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:59.765518 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:28:59.769569 [debug] [MainThread]: On master: COMMIT
18:28:59.774282 [debug] [MainThread]: Using postgres connection "master"
18:28:59.778206 [debug] [MainThread]: On master: COMMIT
18:28:59.783008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:59.786509 [debug] [MainThread]: On master: Close
18:28:59.795629 [info ] [MainThread]: 
18:28:59.799681 [info ] [MainThread]: Finished running 1 table model in 0.67s.
18:28:59.804720 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:59.808231 [debug] [MainThread]: Connection 'model.dwh.agg_users_stage' was properly closed.
18:28:59.811670 [debug] [MainThread]: Connection 'list_dbt_dev_hturner_core' was properly closed.
18:28:59.847865 [info ] [MainThread]: 
18:28:59.858477 [info ] [MainThread]: [32mCompleted successfully[0m
18:28:59.862720 [info ] [MainThread]: 
18:28:59.866698 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 18:29:06.975329 | 5e8b99f4-0e18-4379-b74d-86d007434ede ==============================
18:29:06.975329 [info ] [MainThread]: Running with dbt=1.0.0
18:29:06.978227 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['agg_users_stage'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
18:29:06.981556 [debug] [MainThread]: Tracking: do not track
18:29:07.052303 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:29:07.112296 [debug] [MainThread]: Parsing macros/catalog.sql
18:29:07.123541 [debug] [MainThread]: Parsing macros/adapters.sql
18:29:07.174510 [debug] [MainThread]: Parsing macros/relations.sql
18:29:07.182292 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:29:07.187530 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:29:07.191847 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:29:07.196654 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:29:07.200007 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:29:07.204314 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:29:07.215430 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:29:07.228583 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:29:07.254377 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:29:07.262208 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:29:07.286344 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:29:07.299153 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:29:07.335413 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:29:07.343158 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:29:07.359125 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:29:07.367101 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:29:07.384254 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:29:07.388599 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:29:07.395429 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:29:07.406887 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:29:07.413267 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:29:07.421489 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:29:07.438910 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:29:07.476264 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:29:07.533060 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:29:07.604104 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:29:07.689224 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:29:07.707865 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:29:07.727184 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:29:07.740619 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:29:07.754213 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:29:07.771527 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:29:07.783208 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:29:07.797803 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:29:07.815590 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:29:07.844599 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:29:07.882930 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:29:07.960565 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:29:08.027563 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:29:08.086004 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:29:08.819430 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:29:08.869636 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:29:08.897925 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:29:09.135250 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:29:09.145149 [info ] [MainThread]: 
18:29:09.147789 [debug] [MainThread]: Acquiring new postgres connection "master"
18:29:09.154242 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core"
18:29:09.156669 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core_stage"
18:29:09.193961 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:29:09.209438 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: BEGIN
18:29:09.211282 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:29:09.217849 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: BEGIN
18:29:09.213266 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:29:09.221066 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:29:09.239853 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:29:09.242684 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:29:09.245242 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:29:09.250449 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:29:09.253212 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core'
  
18:29:09.256967 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core_stage"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core_stage'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core_stage'
  
18:29:09.272412 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
18:29:09.278817 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: ROLLBACK
18:29:09.281626 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: Close
18:29:09.282248 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
18:29:09.291637 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: ROLLBACK
18:29:09.294531 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:29:09.297445 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: Close
18:29:09.301574 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:29:09.307611 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:29:09.311153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:29:09.323175 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:29:09.327570 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:29:09.329978 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:29:09.341380 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
18:29:09.347533 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:29:09.351466 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:29:09.364717 [debug] [MainThread]: Using postgres connection "master"
18:29:09.368532 [debug] [MainThread]: On master: BEGIN
18:29:09.371348 [debug] [MainThread]: Opening a new connection, currently in state init
18:29:09.383749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:29:09.386525 [debug] [MainThread]: Using postgres connection "master"
18:29:09.389544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:29:09.400209 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
18:29:09.405656 [debug] [MainThread]: On master: ROLLBACK
18:29:09.408937 [debug] [MainThread]: Using postgres connection "master"
18:29:09.411687 [debug] [MainThread]: On master: BEGIN
18:29:09.415328 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:29:09.419027 [debug] [MainThread]: On master: COMMIT
18:29:09.421536 [debug] [MainThread]: Using postgres connection "master"
18:29:09.424274 [debug] [MainThread]: On master: COMMIT
18:29:09.427550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:29:09.430408 [debug] [MainThread]: On master: Close
18:29:09.435914 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:29:09.438867 [info ] [MainThread]: 
18:29:09.474450 [debug] [Thread-1  ]: Began running node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:29:09.480952 [info ] [Thread-1  ]: 1 of 2 START test not_null_agg_users_stage_dt................................... [RUN]
18:29:09.477968 [debug] [Thread-2  ]: Began running node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:29:09.489455 [info ] [Thread-2  ]: 2 of 2 START test not_null_agg_users_stage_user_id.............................. [RUN]
18:29:09.491668 [debug] [Thread-1  ]: Acquiring new postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:29:09.494583 [debug] [Thread-2  ]: Acquiring new postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:29:09.498212 [debug] [Thread-1  ]: Began compiling node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:29:09.501701 [debug] [Thread-2  ]: Began compiling node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:29:09.505027 [debug] [Thread-1  ]: Compiling test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:29:09.509019 [debug] [Thread-2  ]: Compiling test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:29:09.570731 [debug] [Thread-1  ]: Writing injected SQL for node "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:29:09.575235 [debug] [Thread-2  ]: Writing injected SQL for node "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:29:09.591599 [debug] [Thread-1  ]: finished collecting timing info
18:29:09.594707 [debug] [Thread-2  ]: finished collecting timing info
18:29:09.599738 [debug] [Thread-1  ]: Began executing node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:29:09.602580 [debug] [Thread-2  ]: Began executing node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:29:09.688964 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:29:09.694404 [debug] [Thread-2  ]: Writing runtime SQL for node "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:29:09.705291 [debug] [Thread-1  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:29:09.710505 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: BEGIN
18:29:09.710078 [debug] [Thread-2  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:29:09.713419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:29:09.717722 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: BEGIN
18:29:09.727717 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:29:09.738372 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:29:09.744822 [debug] [Thread-1  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"
18:29:09.752215 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "test.dwh.not_null_agg_users_stage_dt.068f05fb1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev_hturner_core_stage"."agg_users_stage"
where dt is null



      
    ) dbt_internal_test
18:29:09.753171 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:29:09.761245 [debug] [Thread-2  ]: Using postgres connection "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"
18:29:09.765705 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "dbt"."dev_hturner_core_stage"."agg_users_stage"
where user_id is null



      
    ) dbt_internal_test
18:29:09.766693 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:29:09.779027 [debug] [Thread-1  ]: finished collecting timing info
18:29:09.780052 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:29:09.790377 [debug] [Thread-2  ]: finished collecting timing info
18:29:09.783315 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: ROLLBACK
18:29:09.793364 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: ROLLBACK
18:29:09.798829 [debug] [Thread-1  ]: On test.dwh.not_null_agg_users_stage_dt.068f05fb1a: Close
18:29:09.801207 [debug] [Thread-2  ]: On test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55: Close
18:29:09.804022 [info ] [Thread-1  ]: 1 of 2 PASS not_null_agg_users_stage_dt......................................... [[32mPASS[0m in 0.31s]
18:29:09.817483 [debug] [Thread-1  ]: Finished running node test.dwh.not_null_agg_users_stage_dt.068f05fb1a
18:29:09.811136 [info ] [Thread-2  ]: 2 of 2 PASS not_null_agg_users_stage_user_id.................................... [[32mPASS[0m in 0.32s]
18:29:09.832317 [debug] [Thread-2  ]: Finished running node test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55
18:29:09.840041 [debug] [MainThread]: Acquiring new postgres connection "master"
18:29:09.843664 [debug] [MainThread]: Using postgres connection "master"
18:29:09.846955 [debug] [MainThread]: On master: BEGIN
18:29:09.850205 [debug] [MainThread]: Opening a new connection, currently in state closed
18:29:09.866046 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:29:09.873078 [debug] [MainThread]: On master: COMMIT
18:29:09.879045 [debug] [MainThread]: Using postgres connection "master"
18:29:09.884019 [debug] [MainThread]: On master: COMMIT
18:29:09.888650 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:29:09.895577 [debug] [MainThread]: On master: Close
18:29:09.904330 [info ] [MainThread]: 
18:29:09.910561 [info ] [MainThread]: Finished running 2 tests in 0.76s.
18:29:09.922782 [debug] [MainThread]: Connection 'master' was properly closed.
18:29:09.927048 [debug] [MainThread]: Connection 'test.dwh.not_null_agg_users_stage_dt.068f05fb1a' was properly closed.
18:29:09.931286 [debug] [MainThread]: Connection 'test.dwh.not_null_agg_users_stage_user_id.e8fcf27e55' was properly closed.
18:29:09.982716 [info ] [MainThread]: 
18:29:09.993170 [info ] [MainThread]: [32mCompleted successfully[0m
18:29:09.999908 [info ] [MainThread]: 
18:29:10.005808 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2021-12-27 18:29:15.867552 | 459def68-d284-4171-85d9-071fd6ea532d ==============================
18:29:15.867552 [info ] [MainThread]: Running with dbt=1.0.0
18:29:15.870148 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/airflow/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{"ds":"2021-12-27"}', log_cache_events=False, threads=None, select=['agg_users'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
18:29:15.876215 [debug] [MainThread]: Tracking: do not track
18:29:15.956201 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:29:16.054813 [debug] [MainThread]: Parsing macros/catalog.sql
18:29:16.070478 [debug] [MainThread]: Parsing macros/adapters.sql
18:29:16.135309 [debug] [MainThread]: Parsing macros/relations.sql
18:29:16.140726 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:29:16.154694 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:29:16.163591 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:29:16.179514 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:29:16.187553 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:29:16.196124 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:29:16.214445 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:29:16.233298 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:29:16.261678 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:29:16.269694 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:29:16.292238 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:29:16.302450 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:29:16.335361 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:29:16.342568 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:29:16.358382 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:29:16.365852 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:29:16.380808 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:29:16.385640 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:29:16.392041 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:29:16.402672 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:29:16.407875 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:29:16.413512 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:29:16.431257 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:29:16.465800 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:29:16.516479 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:29:16.552687 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:29:16.588549 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:29:16.596912 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:29:16.602200 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:29:16.609551 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:29:16.617718 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:29:16.631398 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:29:16.642036 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:29:16.651849 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:29:16.663622 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:29:16.701515 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:29:16.744886 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:29:16.794450 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:29:16.837322 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:29:16.853071 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:29:17.401902 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:29:17.437036 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:29:17.452721 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:29:17.720364 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 165 macros, 0 operations, 3 seed files, 0 sources, 0 exposures, 0 metrics
18:29:17.731896 [info ] [MainThread]: 
18:29:17.740440 [debug] [MainThread]: Acquiring new postgres connection "master"
18:29:17.751266 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt"
18:29:17.803100 [debug] [ThreadPool]: Using postgres connection "list_dbt"
18:29:17.807170 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
18:29:17.811201 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:29:17.835112 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
18:29:17.845852 [debug] [ThreadPool]: On list_dbt: Close
18:29:17.854039 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_core"
18:29:17.860719 [debug] [ThreadPool]: Acquiring new postgres connection "create_dbt_dev_hturner_core"
18:29:17.866687 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt', schema='dev_hturner_core', identifier=None)"
18:29:17.885833 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_core"
18:29:17.888967 [debug] [ThreadPool]: On create_dbt_dev_hturner_core: BEGIN
18:29:17.892306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:29:17.907366 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:29:17.910925 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_core"
18:29:17.914299 [debug] [ThreadPool]: On create_dbt_dev_hturner_core: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "create_dbt_dev_hturner_core"} */
create schema if not exists "dev_hturner_core"
18:29:17.918755 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
18:29:17.925242 [debug] [ThreadPool]: On create_dbt_dev_hturner_core: COMMIT
18:29:17.928307 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_hturner_core"
18:29:17.933030 [debug] [ThreadPool]: On create_dbt_dev_hturner_core: COMMIT
18:29:17.940264 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
18:29:17.942468 [debug] [ThreadPool]: On create_dbt_dev_hturner_core: Close
18:29:17.950102 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_src"
18:29:17.952443 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core"
18:29:17.970024 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:29:17.991920 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: BEGIN
18:29:17.995467 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:29:17.988333 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:29:18.008116 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: BEGIN
18:29:18.013606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:29:18.023525 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:29:18.033577 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_src"
18:29:18.037376 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_src"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_src'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_src'
  
18:29:18.047062 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
18:29:18.051087 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core"
18:29:18.054437 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core'
  
18:29:18.060847 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.02 seconds
18:29:18.067235 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: ROLLBACK
18:29:18.070574 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
18:29:18.075714 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: ROLLBACK
18:29:18.071069 [debug] [ThreadPool]: On list_dbt_dev_hturner_src: Close
18:29:18.087267 [debug] [ThreadPool]: Acquiring new postgres connection "list_dbt_dev_hturner_core_stage"
18:29:18.082658 [debug] [ThreadPool]: On list_dbt_dev_hturner_core: Close
18:29:18.100657 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:29:18.111540 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: BEGIN
18:29:18.114579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:29:18.128704 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:29:18.138368 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_hturner_core_stage"
18:29:18.141582 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "list_dbt_dev_hturner_core_stage"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_hturner_core_stage'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_hturner_core_stage'
  
18:29:18.149459 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
18:29:18.154939 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: ROLLBACK
18:29:18.158856 [debug] [ThreadPool]: On list_dbt_dev_hturner_core_stage: Close
18:29:18.178136 [debug] [MainThread]: Using postgres connection "master"
18:29:18.181517 [debug] [MainThread]: On master: BEGIN
18:29:18.185449 [debug] [MainThread]: Opening a new connection, currently in state init
18:29:18.207381 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:29:18.214992 [debug] [MainThread]: Using postgres connection "master"
18:29:18.218674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:29:18.238768 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
18:29:18.244208 [debug] [MainThread]: On master: ROLLBACK
18:29:18.248530 [debug] [MainThread]: Using postgres connection "master"
18:29:18.251327 [debug] [MainThread]: On master: BEGIN
18:29:18.254750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:29:18.260071 [debug] [MainThread]: On master: COMMIT
18:29:18.263511 [debug] [MainThread]: Using postgres connection "master"
18:29:18.267285 [debug] [MainThread]: On master: COMMIT
18:29:18.271101 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:29:18.274521 [debug] [MainThread]: On master: Close
18:29:18.279240 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
18:29:18.284612 [info ] [MainThread]: 
18:29:18.311501 [debug] [Thread-1  ]: Began running node model.dwh.agg_users
18:29:18.315670 [info ] [Thread-1  ]: 1 of 1 START incremental model dev_hturner_core.agg_users....................... [RUN]
18:29:18.320879 [debug] [Thread-1  ]: Acquiring new postgres connection "model.dwh.agg_users"
18:29:18.323824 [debug] [Thread-1  ]: Began compiling node model.dwh.agg_users
18:29:18.327162 [debug] [Thread-1  ]: Compiling model.dwh.agg_users
18:29:18.338037 [debug] [Thread-1  ]: Writing injected SQL for node "model.dwh.agg_users"
18:29:18.348175 [debug] [Thread-1  ]: finished collecting timing info
18:29:18.351303 [debug] [Thread-1  ]: Began executing node model.dwh.agg_users
18:29:18.461231 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dwh.agg_users"
18:29:18.472566 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:29:18.476204 [debug] [Thread-1  ]: On model.dwh.agg_users: BEGIN
18:29:18.478971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:29:18.492429 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:29:18.497140 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:29:18.501021 [debug] [Thread-1  ]: On model.dwh.agg_users: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "node_id": "model.dwh.agg_users"} */

      

  create  table "dbt"."dev_hturner_core"."agg_users"
  as (
    

SELECT
    *
FROM "dbt"."dev_hturner_core_stage"."agg_users_stage"
  );
  
18:29:18.518858 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.01 seconds
18:29:18.546891 [debug] [Thread-1  ]: On model.dwh.agg_users: COMMIT
18:29:18.551439 [debug] [Thread-1  ]: Using postgres connection "model.dwh.agg_users"
18:29:18.554354 [debug] [Thread-1  ]: On model.dwh.agg_users: COMMIT
18:29:18.560086 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:29:18.563975 [debug] [Thread-1  ]: finished collecting timing info
18:29:18.568164 [debug] [Thread-1  ]: On model.dwh.agg_users: Close
18:29:18.572922 [info ] [Thread-1  ]: 1 of 1 OK created incremental model dev_hturner_core.agg_users.................. [[32mSELECT 5[0m in 0.25s]
18:29:18.577010 [debug] [Thread-1  ]: Finished running node model.dwh.agg_users
18:29:18.583689 [debug] [MainThread]: Acquiring new postgres connection "master"
18:29:18.586468 [debug] [MainThread]: Using postgres connection "master"
18:29:18.589066 [debug] [MainThread]: On master: BEGIN
18:29:18.595944 [debug] [MainThread]: Opening a new connection, currently in state closed
18:29:18.615705 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:29:18.622420 [debug] [MainThread]: On master: COMMIT
18:29:18.634542 [debug] [MainThread]: Using postgres connection "master"
18:29:18.639218 [debug] [MainThread]: On master: COMMIT
18:29:18.644154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:29:18.649485 [debug] [MainThread]: On master: Close
18:29:18.654838 [info ] [MainThread]: 
18:29:18.660629 [info ] [MainThread]: Finished running 1 incremental model in 0.92s.
18:29:18.665579 [debug] [MainThread]: Connection 'master' was properly closed.
18:29:18.671863 [debug] [MainThread]: Connection 'list_dbt_dev_hturner_core' was properly closed.
18:29:18.675211 [debug] [MainThread]: Connection 'model.dwh.agg_users' was properly closed.
18:29:18.725190 [info ] [MainThread]: 
18:29:18.729924 [info ] [MainThread]: [32mCompleted successfully[0m
18:29:18.734290 [info ] [MainThread]: 
18:29:18.737925 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1


============================== 2021-12-27 18:29:39.336469 | 6a64afd9-ad85-44c3-9a12-b0341cfea395 ==============================
18:29:39.336469 [info ] [MainThread]: Running with dbt=1.0.0
18:29:39.337771 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=False, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='generate', write_json=None)
18:29:39.338162 [debug] [MainThread]: Tracking: tracking
18:29:39.362635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef337b4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef337b45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef337b4850>]}
18:29:39.406542 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:29:39.407070 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:29:39.407502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a64afd9-ad85-44c3-9a12-b0341cfea395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef33999f90>]}
18:29:39.466247 [debug] [MainThread]: Parsing macros/catalog.sql
18:29:39.470881 [debug] [MainThread]: Parsing macros/relations.sql
18:29:39.472730 [debug] [MainThread]: Parsing macros/adapters.sql
18:29:39.506573 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
18:29:39.508989 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:29:39.515118 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:29:39.518934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:29:39.522247 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:29:39.549100 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:29:39.565531 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:29:39.582869 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:29:39.589415 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:29:39.592032 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:29:39.594761 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:29:39.601441 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:29:39.617463 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:29:39.619824 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:29:39.634885 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:29:39.657211 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:29:39.668792 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:29:39.673492 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:29:39.683970 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:29:39.686031 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:29:39.689979 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:29:39.693526 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:29:39.702425 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:29:39.725791 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:29:39.728820 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:29:39.735395 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:29:39.737931 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:29:39.739262 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:29:39.740113 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:29:39.741141 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:29:39.743552 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:29:39.750332 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:29:39.762673 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:29:39.765969 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:29:39.769827 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:29:39.783327 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:29:39.787484 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:29:39.793908 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:29:39.804765 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:29:39.818876 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:29:40.085394 [debug] [MainThread]: 1603: static parser failed on staging/core/agg_users_stage.sql
18:29:40.108454 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/core/agg_users_stage.sql
18:29:40.110674 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/agg_users.sql
18:29:40.212448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a64afd9-ad85-44c3-9a12-b0341cfea395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef33a3c710>]}
18:29:40.220630 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
18:29:40.221386 [info ] [MainThread]: Building catalog
18:29:40.225630 [debug] [ThreadPool]: Acquiring new postgres connection "dbt.information_schema"
18:29:40.253832 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:29:40.254191 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
18:29:40.254448 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:29:40.303252 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
18:29:40.304156 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
18:29:40.304819 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "dwh", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev_hturner_core_stage') or upper(sch.nspname) = upper('dev_hturner_core') or upper(sch.nspname) = upper('dev_hturner_src'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
18:29:40.317378 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.01 seconds
18:29:40.329665 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
18:29:40.331582 [debug] [ThreadPool]: On dbt.information_schema: Close
18:29:40.336547 [info ] [MainThread]: Catalog written to /Users/turnerh27/repos/dbt-airflow/dwh/target/catalog.json
18:29:40.337795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef339f1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef33952a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3399b050>]}
18:29:40.736012 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
18:29:40.737550 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2021-12-27 18:29:47.200179 | 9b74abdc-9ccf-4585-bf90-b06acc4cd8f1 ==============================
18:29:47.200179 [info ] [MainThread]: Running with dbt=1.0.0
18:29:47.201652 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8000, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
18:29:47.202598 [debug] [MainThread]: Tracking: tracking
18:29:47.257727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334e71390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334e834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334e71690>]}
18:29:47.270753 [info ] [MainThread]: Serving docs at 0.0.0.0:8000
18:29:47.273266 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8000
18:29:47.273836 [info ] [MainThread]: 
18:29:47.274265 [info ] [MainThread]: 
18:29:47.275308 [info ] [MainThread]: Press Ctrl+C to exit.
18:29:47.276412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334e711d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334e71d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb334e71390>]}


============================== 2021-12-27 18:30:02.984680 | 93e1d171-b0d9-4985-b397-4308828e6e71 ==============================
18:30:02.984680 [info ] [MainThread]: Running with dbt=1.0.0
18:30:02.986193 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=None, defer=None, event_buffer_size=None, fail_fast=None, log_cache_events=False, log_format=None, open_browser=True, partial_parse=None, port=8000, printer_width=None, profile=None, profiles_dir='/Users/turnerh27/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='serve', write_json=None)
18:30:02.987613 [debug] [MainThread]: Tracking: tracking
18:30:03.022932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29fea5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29fea57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe29fea5990>]}
18:30:03.031924 [info ] [MainThread]: Serving docs at 0.0.0.0:8000
18:30:03.033260 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8000
18:30:03.033866 [info ] [MainThread]: 
18:30:03.034309 [info ] [MainThread]: 
18:30:03.034710 [info ] [MainThread]: Press Ctrl+C to exit.
